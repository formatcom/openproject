(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{lrTx:function(t,e,i){"use strict";i.r(e),i.d(e,"OpenprojectBoardsModule",(function(){return Vn}));var n=i("u4T9"),s=i("VpST"),o=i("0loS"),a=i("mrSG"),r=i("fXoL"),c=i("Y0Nk"),l=i("FDFi"),d=i("VgZ9"),h=i("E2tj"),u=i("kTsZ"),b=i("Jui0"),p=i("wZYP"),g=i("XNiG"),f=i("LRne"),m=i("Kj3r"),v=i("/uUt"),w=i("vkgz"),y=i("eIep"),C=i("lJxs"),k=i("JIr8"),x=i("ZOsW"),I=i("sjKJ"),P=i("RhL0"),S=i("dMmB"),j=i("87fy"),O=i("qc15"),M=i("pL6k"),A=i("CNq7"),D=i("ofXK");function R(t,e){if(1&t&&r.Vc(0),2&t){const t=e.item;r.Zc(" ",t.type.name," #",t.id," ",t.subject," ")}}function T(t,e){if(1&t&&r.Vc(0),2&t){const t=e.item;r.Zc(" ",t.type.name," #",t.id," ",t.subject," ")}}class q{constructor(t,e,i,n,s,o,a,c,l,d,h){this.querySpace=t,this.pathHelper=e,this.apiV3Service=i,this.urlParamsHelper=n,this.notificationService=s,this.CurrentProject=o,this.halResourceService=a,this.schemaCacheService=c,this.cdRef=l,this.I18n=d,this.wpCardDragDrop=h,this.text={placeholder:this.I18n.t("js.relations_autocomplete.placeholder")},this.appendToContainer="body",this.onCancel=new r.s,this.onReferenced=new r.s,this.isLoading=!1,this.searchInput$=new g.a,this.results$=this.searchInput$.pipe(Object(m.a)(250),Object(v.a)(),Object(w.a)(()=>this.isLoading=!0),Object(y.a)(t=>this.autocompleteWorkPackages(t)))}ngAfterViewInit(){this.ngSelectComponent&&(this.ngSelectComponent.open(),setTimeout(()=>{this.ngSelectComponent.focus()},25),this.wpCardDragDrop.removeReferenceWorkPackageForm())}cancel(){this.onCancel.emit()}addWorkPackageToQuery(t){t&&this.schemaCacheService.ensureLoaded(t).then(()=>{this.onReferenced.emit(t),this.ngSelectComponent.close()})}opened(){setTimeout(()=>{const t=this.ngSelectComponent;t&&t.dropdownPanel&&t.dropdownPanel._updatePosition()},25)}autocompleteWorkPackages(t){if(0===t.length)return this.isLoading=!1,Object(f.a)([]);const e=new P.a,i=this.querySpace.results.value;e.add("subjectOrId","**",[t]),i&&i.elements.length>0&&e.add("id","!",i.elements.map(t=>t.id));const n=this.querySpace.query.value;if(null==n?void 0:n.filters){const t=this.urlParamsHelper.buildV3GetFilters(n.filters);e.merge(t,"subprojectId")}return this.apiV3Service.withOptionalProject(this.CurrentProject.id).work_packages.filtered(e).get().pipe(Object(C.a)(t=>t.elements),Object(k.a)(t=>(this.notificationService.handleRawError(t),Object(f.a)([]))),Object(w.a)(()=>this.isLoading=!1))}}q.\u0275fac=function(t){return new(t||q)(r.bc(h.a),r.bc(b.a),r.bc(A.a),r.bc(M.a),r.bc(O.a),r.bc(I.a),r.bc(u.a),r.bc(S.a),r.bc(r.i),r.bc(p.a),r.bc(j.a))},q.\u0275cmp=r.Vb({type:q,selectors:[["board-inline-add-autocompleter"]],viewQuery:function(t,e){var i;(1&t&&r.ad(x.a,!0),2&t)&&(r.Ic(i=r.qc())&&(e.ngSelectComponent=i.first))},inputs:{appendToContainer:"appendToContainer"},outputs:{onCancel:"onCancel",onReferenced:"onReferenced"},decls:4,vars:8,consts:[["ngClass","wp-inline-create--reference-autocompleter",3,"items","appendTo","multiple","loading","typeahead","closeOnSelect","open","close","change"],["ng-label-tmp",""],["ng-option-tmp",""]],template:function(t,e){1&t&&(r.hc(0,"ng-select",0),r.pc("open",(function(){return e.opened()}))("close",(function(){return e.cancel()}))("change",(function(t){return e.addWorkPackageToQuery(t)})),r.sc(1,"async"),r.Tc(2,R,1,3,"ng-template",1),r.Tc(3,T,1,3,"ng-template",2),r.gc()),2&t&&r.wc("items",r.tc(1,6,e.results$))("appendTo",e.appendToContainer)("multiple",!1)("loading",e.isLoading)("typeahead",e.searchInput$)("closeOnSelect",!1)},directives:[x.a,D.n,x.e,x.c],pipes:[D.a],styles:["ng-select.wp-inline-create--reference-autocompleter{border:none}ng-select.wp-inline-create--reference-autocompleter .ng-clear-wrapper{display:none}"],encapsulation:2});var F=i("DHgU");class V extends l.a{constructor(t,e,i,n,s,o){super(t),this.injector=t,this.querySpace=e,this.halResourceService=i,this.pathHelperService=n,this.Gon=s,this.wpRelationsHierarchyService=o,this.referenceComponentClass=q,this.referenceTarget=null,this.buttonTexts={reference:this.I18n.t("js.relation_buttons.add_existing_child"),create:this.I18n.t("js.relation_buttons.add_new_child")}}get canAdd(){return this.authorisationService.can("work_packages","createWorkPackage")}get canReference(){return this.authorisationService.can("work_packages","editWorkPackage")}}V.\u0275fac=function(t){return new(t||V)(r.lc(r.A),r.lc(h.a),r.lc(u.a),r.lc(b.a),r.lc(F.a),r.lc(d.a))},V.\u0275prov=r.Xb({token:V,factory:V.\u0275fac});var L=i("CejQ"),B=i("d/TE"),$=(i("Bz7v"),i("Kg8T")),E=i("RGDJ"),N=i("hvpr"),W=i("+oAL"),Q=i("XV4z"),H=i("SKFm"),U=i("POAS"),z=i("AAic"),X=i("x5It"),J=i("IaZ+"),Y=i("AdL0");function Z(t,e){if(1&t&&(r.fc(0,1),r.cc(1,"icon-triggered-context-menu",2),r.ec()),2&t){const t=r.rc();r.Pb(1),r.wc("menu-items",t.menuItems)}}class K{constructor(t,e,i,n,s,o){this.opModalService=t,this.authorisationService=e,this.querySpace=i,this.boardService=n,this.boardActionRegistry=s,this.I18n=o,this.onRemove=new r.s}get menuItems(){return()=>Object(a.b)(this,void 0,void 0,(function*(){let t=[{disabled:!this.canDelete,linkText:this.I18n.t("js.boards.lists.delete"),onClick:()=>(this.onRemove.emit(),!0)}];if(this.board.isAction){const e=yield this.actionService.getAdditionalListMenuItems(this.query);return t.concat(e)}return t}))}get actionService(){return this.boardActionRegistry.get(this.board.actionAttribute)}get canManage(){return this.boardService.canManage(this.board)}canDelete(){return this.canManage&&!!this.query.delete}get query(){return this.querySpace.query.value}}K.\u0275fac=function(t){return new(t||K)(r.bc(J.b),r.bc($.a),r.bc(h.a),r.bc(Q.a),r.bc(z.a),r.bc(p.a))},K.\u0275cmp=r.Vb({type:K,selectors:[["board-list-menu"]],inputs:{board:"board"},outputs:{onRemove:"onRemove"},decls:1,vars:1,consts:[["class","board-list--more-menu",4,"ngIf"],[1,"board-list--more-menu"],[3,"menu-items"]],template:function(t,e){1&t&&r.Tc(0,Z,2,1,"ng-container",0),2&t&&r.wc("ngIf",e.canDelete())},directives:[D.q,Y.a],encapsulation:2});var G=i("qHU1"),tt=i("Hg4z"),et=i("FnNU");class it{constructor(){this.filters=Object(et.g)([])}get current(){return this.filters.getValueOr([])}}it.\u0275fac=function(t){return new(t||it)},it.\u0275prov=r.Xb({token:it,factory:it.\u0275fac});var nt=i("iB+3"),st=i("Y/CA"),ot=i("eyhC"),at=i("pLZG");class rt{constructor(){this.selections$=new g.a}updateSelection(t){this.selections$.next(t)}selectionsForQuery(t){return this.selections$.pipe(Object(at.a)(e=>e.withinQuery!==t))}selections(){return this.selections$}}rt.\u0275fac=function(t){return new(t||rt)},rt.\u0275prov=r.Xb({token:rt,factory:rt.\u0275fac});var ct=i("7o/Q");class lt{constructor(t,e){this.count=t,this.source=e}call(t,e){return e.subscribe(new dt(t,this.count,this.source))}}class dt extends ct.a{constructor(t,e,i){super(t),this.count=e,this.source=i}error(t){if(!this.isStopped){const{source:e,count:i}=this;if(0===i)return super.error(t);i>-1&&(this.count=i-1),e.subscribe(this._unsubscribeAndRecycle())}}}var ht=i("/C7M");const ut=["loadingIndicator"];function bt(t,e){if(1&t&&r.cc(0,"div",13),2&t){const t=r.rc(2);r.wc("ngClass",t.actionResourceClass)}}const pt=function(t){return{resource:t}};function gt(t,e){if(1&t&&r.cc(0,"ndc-dynamic",14),2&t){const t=r.rc(2);r.wc("ndcDynamicComponent",t.headerComponent)("ndcDynamicInputs",r.Bc(2,pt,t.actionResource))}}function ft(t,e){if(1&t){const t=r.ic();r.hc(0,"editable-toolbar-title",15),r.pc("onSave",(function(e){r.Lc(t);const i=r.rc(2);return i.renameQuery(i.query,e)})),r.gc()}if(2&t){const t=r.rc(2);r.wc("title",t.query.name)("smallHeader",!0)("inFlight",t.inFlight)("editable",t.canRename)("initialFocus",t.initiallyFocused)}}function mt(t,e){if(1&t&&(r.hc(0,"button",16),r.cc(1,"op-icon",17),r.gc()),2&t){const t=r.rc(2);r.wc("title",t.text.addCard)}}const vt=function(t){return{"-with-create-button":t}};function wt(t,e){if(1&t){const t=r.ic();r.fc(0),r.Tc(1,bt,1,1,"div",4),r.hc(2,"div",5),r.Tc(3,gt,1,4,"ndc-dynamic",6),r.Tc(4,ft,1,5,"editable-toolbar-title",7),r.hc(5,"board-list-menu",8),r.pc("onRemove",(function(){r.Lc(t);return r.rc().deleteList()})),r.gc(),r.gc(),r.hc(6,"div",9),r.hc(7,"div",10),r.Tc(8,mt,2,1,"button",11),r.gc(),r.hc(9,"wp-card-view",12),r.pc("itemClicked",(function(e){r.Lc(t);return r.rc().openFullViewOnDoubleClick(e)}))("stateLinkClicked",(function(e){r.Lc(t);return r.rc().openStateLink(e)})),r.gc(),r.gc(),r.ec()}if(2&t){const t=r.rc();r.Pb(1),r.wc("ngIf",t.board.isAction),r.Pb(2),r.wc("ngIf",t.headerComponent),r.Pb(1),r.wc("ngIf",!t.headerComponent),r.Pb(1),r.wc("board",t.board),r.Pb(1),r.wc("ngClass",r.Bc(13,vt,t.board.isAction||t.showAddButton)),r.Pb(2),r.wc("ngIf",t.showAddButton),r.Pb(1),r.wc("dragOutOfHandler",t.canDragOutOfHandler)("dragInto",t.canDragInto)("workPackageAddedHandler",t.workPackageAddedHandler)("cardsRemovable",t.board.isFree&&t.canDragOutOf)("showInfoButton",!0)("highlightingMode",t.board.highlightingMode)("showStatusButton",t.showCardStatusButton())}}function yt(t,e){if(1&t){const t=r.ic();r.hc(0,"div",18),r.hc(1,"p"),r.cc(2,"span",19),r.Vc(3," "),r.hc(4,"a",20),r.pc("accessibleClick",(function(){r.Lc(t);return r.rc().onRemove.emit()})),r.cc(5,"span",19),r.gc(),r.gc(),r.gc()}if(2&t){const t=r.rc();r.Pb(2),r.wc("textContent",t.errorMessage),r.Pb(3),r.wc("textContent",t.text.click_to_remove)}}const _t=function(t){return{"-action-list":t}};class Ct extends L.a{constructor(t,e,i,n,s,o,a,c,l,d,h,u,b,p,g,f,m,v,w,y,_,C,k,x){super(e,m),this.apiv3Service=t,this.I18n=e,this.state=i,this.cdRef=n,this.transitions=s,this.boardFilters=o,this.notifications=a,this.querySpace=c,this.halNotification=l,this.halEvents=d,this.wpStatesInitialization=h,this.wpViewFocusService=u,this.wpViewSelectionService=b,this.boardListCrossSelectionService=p,this.authorisationService=g,this.wpInlineCreate=f,this.injector=m,this.halEditing=v,this.loadingIndicator=w,this.schemaCache=y,this.boardService=_,this.boardActionRegistry=C,this.causedUpdates=k,this.$state=x,this.onRemove=new r.s,this.actionResourceClass="",this.showAddButton=!1,this.text={addCard:this.I18n.t("js.boards.add_card"),updateSuccessful:this.I18n.t("js.notice_successful_update"),areYouSure:this.I18n.t("js.text_are_you_sure"),unnamed_list:this.I18n.t("js.boards.label_unnamed_list"),click_to_remove:this.I18n.t("js.boards.click_to_remove_list")},this.canDragInto=!1,this.initiallyFocused=!1,this.workPackageAddedHandler=t=>this.addWorkPackage(t),this.canDragOutOf=!1,this.canDragOutOfHandler=t=>this.canMove(t)}ngOnInit(){if(this.initiallyFocused=this.resource.isNewWidget,this.resource.isNewWidget=!1,this.state.includes(this.state.current.data.baseRoute+".details")){let t=this.state.params.workPackageId;this.wpViewSelectionService.initializeSelection([t])}this.authorisationService.observeUntil(Object(tt.b)(this)).subscribe(()=>{this.board.isAction||(this.showAddButton=this.canDragInto&&(this.wpInlineCreate.canAdd||this.canReference),this.cdRef.detectChanges())}),this.wpViewSelectionService.updates$().pipe(Object(m.a)(100),this.untilDestroyed()).subscribe(t=>{let e=Object.keys(_.pickBy(t.selected,(t,e)=>!0===t));const i=this.wpViewFocusService.focusedWorkPackage;this.boardListCrossSelectionService.updateSelection({withinQuery:this.queryId,focusedWorkPackage:i,allSelected:e})}),this.boardListCrossSelectionService.selectionsForQuery(this.queryId).pipe(this.untilDestroyed()).subscribe(t=>{this.wpViewSelectionService.initializeSelection(t.allSelected)}),this.boardFilters.filters.values$().pipe(this.untilDestroyed()).subscribe(()=>this.updateQuery(!0)),this.listenToActionAttributeChanges(),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(t=>{this.query=t,this.canDragOutOf=!!this.query.updateOrderedWorkPackages,this.loadActionAttribute(t),this.cdRef.detectChanges()})}ngOnDestroy(){super.ngOnDestroy()}get errorMessage(){return this.I18n.t("js.boards.error_loading_the_list",{error_message:this.loadingError})}canMove(t){return this.canDragOutOf&&(!this.actionService||this.actionService.canMove(t))}get canReference(){return this.wpInlineCreate.canReference}get canManage(){return this.boardService.canManage(this.board)}get canRename(){return this.canManage&&!!this.query.updateImmediately&&this.board.isFree}addReferenceCard(){this.cardView.setReferenceMode(!0)}addNewCard(){this.cardView.addNewCard()}deleteList(t){t=t||this.query,window.confirm(this.text.areYouSure)&&this.apiv3Service.queries.id(t).delete().subscribe(()=>this.onRemove.emit())}renameQuery(t,e){this.inFlight=!0,this.query.name=e,this.apiv3Service.queries.id(this.query).patch({name:e}).subscribe(()=>{this.inFlight=!1,this.notifications.addSuccess(this.text.updateSuccessful)},t=>this.inFlight=!1)}boardListActionColorClass(t){const e=this.board.actionAttribute;return t&&t.id?E.a.backgroundClass(e,t.id):""}get listName(){return this.query&&this.query.name}showCardStatusButton(){return this.board.showStatusButton()}refreshQueryUnlessCaused(t,e=!0){this.causedUpdates.includes(t)||(Object(G.a)(`Refreshing ${t.name} visibly due to external changes`),this.updateQuery(e))}updateQuery(t=!0){this.setQueryProps(this.boardFilters.current),this.loadQuery(t)}loadActionAttribute(t){if(!this.board.isAction)return this.actionResource=void 0,this.headerComponent=void 0,void(this.canDragInto=!!t.updateOrderedWorkPackages);let e=this.actionService;const i=e.getActionValueId(t);this.actionResource&&i===this.actionResource.href||e.getLoadedActionValue(t).then(i=>Object(a.b)(this,void 0,void 0,(function*(){this.actionResource=i,this.headerComponent=e.headerComponent(),this.buttonPlaceholder=e.disabledAddButtonPlaceholder(i),this.actionResourceClass=this.boardListActionColorClass(i),this.canDragInto=e.dragIntoAllowed(t,i);const n=yield e.canAddToQuery(t);this.showAddButton=this.canDragInto&&this.wpInlineCreate.canAdd&&n,this.cdRef.detectChanges()})))}get actionService(){if(this.board.actionAttribute)return this.boardActionRegistry.get(this.board.actionAttribute)}addWorkPackage(t){var e;let i=this.querySpace.query.value;const n=this.halEditing.changeFor(t);return null===(e=this.actionService)||void 0===e||e.assignToWorkPackage(n,i),n.isEmpty()?this.apiv3Service.work_packages.cache.updateWorkPackage(t):this.halEditing.save(n)}get queryId(){return this.resource.options.queryId.toString()}loadQuery(t=!0){let e=this.apiv3Service.queries.find(this.columnsQueryProps,this.queryId).pipe(function(t=-1){return e=>e.lift(new lt(t,e))}(3));t&&(e=e.pipe(Object(c.c)(this.indicatorInstance,50))),e.subscribe(t=>this.wpStatesInitialization.updateQuerySpace(t,t.results),t=>{this.loadingError=this.halNotification.retrieveErrorMessage(t),this.cdRef.detectChanges()})}get indicatorInstance(){return this.loadingIndicator.indicator(jQuery(this.indicator.nativeElement))}setQueryProps(t){const e=(this.resource.options.filters||[]).concat(t),i={"columns[]":["id","subject"],showHierarchies:!1,pageSize:500,filters:JSON.stringify(e)};this.columnsQueryProps=i}listenToActionAttributeChanges(){this.board.actionAttribute&&this.halEvents.events$.pipe(Object(at.a)(t=>"WorkPackage"===t.resourceType),Object(at.a)(t=>"updated"===t.eventType),Object(C.a)(t=>{var e;return null===(e=t.commit)||void 0===e?void 0:e.changes[this.actionService.filterName]}),Object(at.a)(t=>!!t),Object(at.a)(t=>{var e,i,n;const s=null===(e=this.actionResource)||void 0===e?void 0:e.href,o=null===(i=t.to)||void 0===i?void 0:i.href,a=null===(n=t.from)||void 0===n?void 0:n.href;return!!s&&(s===o||s===a)})).subscribe(t=>{this.updateQuery(!0)})}openFullViewOnDoubleClick(t){t.double&&this.state.go("work-packages.show",{workPackageId:t.workPackageId})}openStateLink(t){const e={workPackageId:t.workPackageId};this.$state.go(t.requestedState,e)}schema(t){return this.schemaCache.of(t)}}Ct.\u0275fac=function(t){return new(t||Ct)(r.bc(A.a),r.bc(p.a),r.bc(nt.StateService),r.bc(r.i),r.bc(nt.TransitionService),r.bc(it),r.bc(B.a),r.bc(h.a),r.bc(U.a),r.bc(ht.a),r.bc(W.a),r.bc(st.a),r.bc(ot.a),r.bc(rt),r.bc($.a),r.bc(l.a),r.bc(r.A),r.bc(H.a),r.bc(c.a),r.bc(S.a),r.bc(Q.a),r.bc(z.a),r.bc(X.a),r.bc(nt.StateService))},Ct.\u0275cmp=r.Vb({type:Ct,selectors:[["board-list"]],viewQuery:function(t,e){var i;(1&t&&(r.Rc(ut,!0),r.ad(N.a,!0)),2&t)&&(r.Ic(i=r.qc())&&(e.indicator=i.first),r.Ic(i=r.qc())&&(e.cardView=i.first))},inputs:{board:"board"},outputs:{onRemove:"onRemove"},features:[r.Ob([{provide:l.a,useClass:V},K,j.a]),r.Mb],decls:4,vars:6,consts:[[1,"board-list--container","loading-indicator--location",3,"ngClass"],["loadingIndicator",""],[4,"ngIf"],["class","notification-box -error",4,"ngIf"],["class","board-list--action-bar",3,"ngClass",4,"ngIf"],[1,"board-list--header"],[3,"ndcDynamicComponent","ndcDynamicInputs",4,"ngIf"],["class","-small",3,"title","smallHeader","inFlight","editable","initialFocus","onSave",4,"ngIf"],[1,"board-list--menu",3,"board","onRemove"],[1,"board-list--query-container","drop-zone",3,"ngClass"],[1,"board-list--button-container"],["class","board-list--add-button board-list--card-dropdown-button button","addCardDropdown","",3,"title",4,"ngIf"],[3,"dragOutOfHandler","dragInto","workPackageAddedHandler","cardsRemovable","showInfoButton","highlightingMode","showStatusButton","itemClicked","stateLinkClicked"],[1,"board-list--action-bar",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs"],[1,"-small",3,"title","smallHeader","inFlight","editable","initialFocus","onSave"],["addCardDropdown","",1,"board-list--add-button","board-list--card-dropdown-button","button",3,"title"],["icon-classes","icon-small icon-add"],[1,"notification-box","-error"],[3,"textContent"],["role","button",3,"accessibleClick"]],template:function(t,e){1&t&&(r.hc(0,"div",0,1),r.Tc(2,wt,10,15,"ng-container",2),r.Tc(3,yt,6,2,"div",3),r.gc()),2&t&&(r.wc("ngClass",r.Bc(4,_t,e.board.isAction)),r.Qb("data-query-name",e.listName),r.Pb(2),r.wc("ngIf",e.query),r.Pb(1),r.wc("ngIf",e.loadingError))},styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.board-list--query-container[_ngcontent-%COMP%]{max-width:inherit;overflow:hidden;height:100%}.board-list--query-container.-with-create-button[_ngcontent-%COMP%]{display:grid;grid-template:34px minmax(0,1fr)/1fr}.board-list--button-container[_ngcontent-%COMP%]{background-color:var(--body-background);position:sticky;top:0;z-index:1}.board-list--container[_ngcontent-%COMP%]{height:100%;max-width:300px;display:flex;flex-direction:column}.board-list--container[_ngcontent-%COMP%]:hover   .board-list--menu[_ngcontent-%COMP%]{visibility:visible}.board-list--action-bar[_ngcontent-%COMP%]{width:calc(100% - 30px);height:5px;margin:auto}.board-list--header[_ngcontent-%COMP%]{padding:5px 15px;display:flex;align-items:center;max-height:52px}.board-list--header[_ngcontent-%COMP%]   editable-toolbar-title[_ngcontent-%COMP%]{flex:1;margin-bottom:0;margin-right:.25rem}.notification-box[_ngcontent-%COMP%]{margin-top:0;z-index:100}.board-list--add-button[_ngcontent-%COMP%]{background-color:var(--body-background);width:calc(100% - 30px - 10px);margin:0 15px;box-shadow:1px 1px 3px 0 #d3d3d3}.board-list--add-button[_ngcontent-%COMP%]:hover{background-color:hsla(0,0%,93.3%,.3137254901960784)}.board-list--add-button[_ngcontent-%COMP%]:disabled{background-color:hsla(0,0%,80%,.3137254901960784)}.board-list--menu[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0});var kt=i("3Pt+");class xt{constructor(t,e,i){this.injector=t,this.locals=e,this.I18n=i,this.highlightingMode="none",this.entireCardMode=!1,this.lastEntireCardAttribute="type",this.text={highlighting_mode:{description:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.description"),none:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.none"),type:this.I18n.t("js.work_packages.properties.type"),priority:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.priority"),entire_card_by:this.I18n.t("js.card.highlighting.entire_card_by")}}}onSave(){this.updateMode(this.highlightingMode),this.board.highlightingMode=this.highlightingMode}ngOnInit(){this.board=this.locals.board,this.highlightingMode=this.board.highlightingMode,this.updateMode(this.highlightingMode)}updateMode(t){this.highlightingMode="inline"===t?this.lastEntireCardAttribute:t,-1!==["priority","type"].indexOf(this.highlightingMode)?(this.lastEntireCardAttribute=this.highlightingMode,this.entireCardMode=!0):this.entireCardMode=!1}}xt.\u0275fac=function(t){return new(t||xt)(r.bc(r.A),r.bc(J.a),r.bc(p.a))},xt.\u0275cmp=r.Vb({type:xt,selectors:[["ng-component"]],decls:17,vars:10,consts:[[3,"textContent"],[1,"form--field","-full-width"],[1,"form--field-container"],[1,"option-label"],["type","radio","name","entire_card_switch",3,"ngModel","value","ngModelChange","change"],["id","selected_attribute","name","selected_attribute",1,"form--select","form--inline-select",3,"change"],["value","type",3,"textContent","selected"],["value","priority",3,"textContent","selected"],["type","radio","value","none","name","highlighting_mode_switch",3,"ngModel","ngModelChange","change"]],template:function(t,e){1&t&&(r.hc(0,"div"),r.hc(1,"form"),r.cc(2,"p",0),r.hc(3,"div",1),r.hc(4,"div",2),r.hc(5,"label",3),r.hc(6,"input",4),r.pc("ngModelChange",(function(t){return e.entireCardMode=t}))("change",(function(){return e.updateMode("inline")})),r.gc(),r.cc(7,"span",0),r.Vc(8," "),r.hc(9,"select",5),r.pc("change",(function(t){return e.updateMode(t.target.value)})),r.cc(10,"option",6),r.cc(11,"option",7),r.gc(),r.gc(),r.gc(),r.gc(),r.hc(12,"div",1),r.hc(13,"div",2),r.hc(14,"label",3),r.hc(15,"input",8),r.pc("ngModelChange",(function(t){return e.highlightingMode=t}))("change",(function(t){return e.updateMode(t.target.value)})),r.gc(),r.cc(16,"span",0),r.gc(),r.gc(),r.gc(),r.gc(),r.gc()),2&t&&(r.Pb(2),r.wc("textContent",e.text.highlighting_mode.description),r.Pb(4),r.wc("ngModel",e.entireCardMode)("value",!0),r.Pb(1),r.wc("textContent",e.text.highlighting_mode.entire_card_by),r.Pb(3),r.wc("textContent",e.text.highlighting_mode.type)("selected","type"===e.lastEntireCardAttribute),r.Pb(1),r.wc("textContent",e.text.highlighting_mode.priority)("selected","priority"===e.lastEntireCardAttribute),r.Pb(4),r.wc("ngModel",e.highlightingMode),r.Pb(1),r.wc("textContent",e.text.highlighting_mode.none))},directives:[kt.C,kt.n,kt.o,kt.u,kt.c,kt.m,kt.p,kt.r,kt.B],encapsulation:2});class It{constructor(t){this.I18n=t,this._tabs=[{name:"highlighting",title:this.I18n.t("js.work_packages.table_configuration.highlighting"),componentClass:xt}]}get tabs(){return this._tabs}}It.\u0275fac=function(t){return new(t||It)(r.lc(p.a))},It.\u0275prov=r.Xb({token:It,factory:It.\u0275fac});var Pt=i("Mo6U"),St=i("t8SH"),jt=i("sBdf"),Ot=i("fMMW");class Mt{constructor(t,e,i,n,s,o,a,r){this.injector=t,this.boardListsService=e,this.I18n=i,this.halResourceService=n,this.pathHelper=s,this.currentProject=o,this.apiV3Service=a,this.schemaCache=r}getActionFilter(t,e=!1){return t.filters.find(t=>t.id===this.filterName)}getActionValueId(t,e=!1){const i=this.getActionFilter(t);if(!i)return;const n=i.values[0];return n instanceof Pt.a?e?n.href:n.id:n}getLoadedActionValue(t){const e=this.getActionValueId(t);return e?this.require(e):Promise.resolve(void 0)}addInitialColumnsForAction(t){return Promise.resolve(t)}addColumnWithActionAttribute(t,e){let i={name:e.name},n={[this.filterName]:{operator:"=",values:[e.idFromLink]}};return this.boardListsService.addQuery(t,i,[n])}loadAvailable(t,e,i){return this.loadValues(i).pipe(Object(C.a)(t=>t.filter(t=>!e.has(t.id))))}getAdditionalListMenuItems(t){return Promise.resolve([])}autocompleterComponent(){return St.a}headerComponent(){}disabledAddButtonPlaceholder(t){}warningTextWhenNoOptionsAvailable(t){return Promise.resolve(void 0)}dragIntoAllowed(t,e){return!0}canAddToQuery(t){return Promise.resolve(!0)}canMove(t){const e=this.schemaCache.of(t)[this.filterName];return null==e?void 0:e.writable}assignToWorkPackage(t,e){if(!t.isWritable(this.filterName))throw new Error(this.I18n.t("js.boards.error_attribute_not_writable",{attribute:t.humanName(this.filterName)}));new Ot.a(this.injector,e.filters).applyDefaultsFromFilters(t)}}Mt.\u0275fac=function(t){return new(t||Mt)(r.lc(r.A),r.lc(jt.a),r.lc(p.a),r.lc(u.a),r.lc(b.a),r.lc(I.a),r.lc(A.a),r.lc(S.a))},Mt.\u0275prov=r.Xb({token:Mt,factory:Mt.\u0275fac});var At=i("IzEk");class Dt extends Mt{constructor(){super(...arguments),this.cache=Object(et.g)()}loadValues(t){return this.cache.putFromPromiseIfPristine(()=>this.loadUncached()),this.cache.values$().pipe(Object(C.a)(e=>t?e.filter(e=>e.name.includes(t)):e),Object(At.a)(1))}addColumnWithActionAttribute(t,e){if(this.cache.value){let t=[...this.cache.value,e];this.cache.putValue(t)}return super.addColumnWithActionAttribute(t,e)}require(t){return this.cache.putFromPromiseIfPristine(()=>this.loadUncached()),this.cache.values$().pipe(Object(At.a)(1)).toPromise().then(e=>e.find(e=>e.id===t))}}Dt.\u0275fac=function(t){return Rt(t||Dt)},Dt.\u0275prov=r.Xb({token:Dt,factory:Dt.\u0275fac});const Rt=r.jc(Dt);i("ev9f");function Tt(t,e){if(1&t&&(r.hc(0,"div",1),r.hc(1,"h2",2),r.cc(2,"small",3),r.cc(3,"br"),r.Vc(4),r.gc(),r.gc()),2&t){const t=r.rc();r.Pb(2),r.wc("textContent",t.text.status),r.Pb(2),r.Xc(" ",t.status.name," ")}}class qt{constructor(t){this.I18n=t,this.text={status:this.I18n.t("js.work_packages.properties.status")}}}qt.\u0275fac=function(t){return new(t||qt)(r.bc(p.a))},qt.\u0275cmp=r.Vb({type:qt,selectors:[["ng-component"]],hostAttrs:[1,"title-container","-small"],inputs:{status:["resource","status"]},decls:1,vars:1,consts:[["class","status-board-header",4,"ngIf"],[1,"status-board-header"],[1,"editable-toolbar-title--fixed"],[3,"textContent"]],template:function(t,e){1&t&&r.Tc(0,Tt,5,2,"div",0),2&t&&r.wc("ngIf",e.status)},directives:[D.q],styles:[".editable-toolbar-title--fixed[_ngcontent-%COMP%]{line-height:1!important}"]});var Ft=i("pXJr");class Vt extends Dt{constructor(){super(...arguments),this.filterName="status",this.text=this.I18n.t("js.boards.board_type.board_type_title.status"),this.description=this.I18n.t("js.boards.board_type.action_text_status"),this.label=this.I18n.t("js.boards.add_list_modal.labels.status"),this.icon="icon-workflow",this.image=Ft.a.imagePath("board_creation_modal/status.svg")}get localizedName(){return this.I18n.t("js.work_packages.properties.status")}headerComponent(){return qt}addInitialColumnsForAction(t){return this.loadValues().toPromise().then(e=>Promise.all(e.map(e=>e.isDefault?this.addColumnWithActionAttribute(t,e):Promise.resolve(t))).then(()=>t))}warningTextWhenNoOptionsAvailable(){return Promise.resolve(this.I18n.t("js.boards.add_list_modal.warning.status"))}loadUncached(){return this.apiV3Service.statuses.get().toPromise().then(t=>t.elements)}}Vt.\u0275fac=function(t){return Lt(t||Vt)},Vt.\u0275prov=r.Xb({token:Vt,factory:Vt.\u0275fac});const Lt=r.jc(Vt);var Bt=i("Nnhs"),$t=i("mg4W"),Et=i("13ri");const Nt=function(t,e){return{"-closed":t,"-locked":e}};function Wt(t,e){if(1&t&&(r.hc(0,"div",1),r.hc(1,"h2",2),r.cc(2,"small",3),r.cc(3,"br"),r.cc(4,"a",4),r.gc(),r.hc(5,"span",5),r.Vc(6),r.gc(),r.gc()),2&t){const t=r.rc();r.wc("ngClass",r.Cc(5,Nt,t.version.isClosed(),t.version.isLocked())),r.Pb(2),r.wc("textContent",t.text.version),r.Pb(2),r.wc("href",t.pathHelper.versionShowPath(t.version.id),r.Oc)("textContent",t.version.name),r.Pb(2),r.Xc(" ",t.version.endDate," ")}}class Qt{constructor(t,e){this.I18n=t,this.pathHelper=e,this.text={isLocked:this.I18n.t("js.boards.version.is_locked"),isClosed:this.I18n.t("js.boards.version.is_closed"),version:this.I18n.t("js.work_packages.properties.version")}}}Qt.\u0275fac=function(t){return new(t||Qt)(r.bc(p.a),r.bc(b.a))},Qt.\u0275cmp=r.Vb({type:Qt,selectors:[["ng-component"]],hostAttrs:[1,"title-container","-small"],inputs:{version:["resource","version"]},decls:1,vars:1,consts:[["class","version-board-header",3,"ngClass",4,"ngIf"],[1,"version-board-header",3,"ngClass"],[1,"editable-toolbar-title--fixed"],[3,"textContent"],["target","_blank",3,"href","textContent"],[1,"version-board-header--info-row","-italic","-small-font"]],template:function(t,e){1&t&&r.Tc(0,Wt,7,8,"div",0),2&t&&r.wc("ngIf",e.version)},directives:[D.q,D.n],styles:[".version-board-header[_ngcontent-%COMP%]{display:flex;flex-direction:column}.editable-toolbar-title--fixed[_ngcontent-%COMP%]{line-height:1!important}"]});var Ht=i("r0MM");class Ut extends Dt{constructor(){super(...arguments),this.filterName="version",this.text=this.I18n.t("js.boards.board_type.board_type_title.version"),this.description=this.I18n.t("js.boards.board_type.action_text_version"),this.label=this.I18n.t("js.boards.add_list_modal.labels.version"),this.icon="icon-getting-started",this.image=Ft.a.imagePath("board_creation_modal/version.svg")}get localizedName(){return this.I18n.t("js.work_packages.properties.version")}canAddToQuery(t){return _.get(t,"results.createWorkPackage.href",null)?(this.writable$||(this.writable$=t.results.createWorkPackage().then(t=>t.schema.version.writable)),this.writable$):Promise.resolve(!1)}addInitialColumnsForAction(t){return this.loadValues().toPromise().then(e=>Promise.all(e.map(e=>{const i=_.get(e,"definingProject.name",null);return e.isOpen()&&i&&i===this.currentProject.name?this.addColumnWithActionAttribute(t,e):Promise.resolve(t)})).then(()=>t))}getAdditionalListMenuItems(t){return this.getLoadedActionValue(t).then(t=>t?this.buildItemsForVersion(t):[])}autocompleterComponent(){return $t.a}headerComponent(){return Qt}disabledAddButtonPlaceholder(t){return t.isLocked()?{icon:"locked",text:this.I18n.t("js.boards.version.locked")}:t.isClosed()?{icon:"not-supported",text:this.I18n.t("js.boards.version.closed")}:void 0}dragIntoAllowed(t,e){return e instanceof Bt.a&&e.isOpen()}loadUncached(){return null===this.currentProject.id?Promise.resolve([]):this.apiV3Service.projects.id(this.currentProject.id).versions.get().toPromise().then(t=>t.elements)}patchVersionStatus(t,e){this.apiV3Service.versions.id(t).patch({status:e}).subscribe(t=>{this.state.go(".",{},{reload:!0})},t=>this.halNotification.handleRawError(t))}buildItemsForVersion(t){const e=t.id;return[{hidden:!t.isOpen()||t.isLocked()&&!t.$links.update,linkText:this.I18n.t("js.boards.version.lock_version"),onClick:()=>(this.patchVersionStatus(t,"locked"),!0)},{hidden:!t.isLocked()||t.isOpen()&&!t.$links.update,linkText:this.I18n.t("js.boards.version.unlock_version"),onClick:()=>(this.patchVersionStatus(t,"open"),!0)},{hidden:t.isClosed()||!t.isClosed()&&!t.$links.update,linkText:this.I18n.t("js.boards.version.close_version"),onClick:()=>(this.patchVersionStatus(t,"closed"),!0)},{hidden:!t.isClosed()||t.isClosed()&&!t.$links.update,linkText:this.I18n.t("js.boards.version.open_version"),onClick:()=>(this.patchVersionStatus(t,"open"),!0)},{linkText:this.I18n.t("js.boards.version.show_version"),href:this.pathHelper.versionShowPath(e),onClick:t=>!Et.a.isClickedWithModifier(t)&&(window.open(this.pathHelper.versionShowPath(e),"_blank"),!0)},{hidden:!t.$links.update,linkText:this.I18n.t("js.boards.version.edit_version"),href:this.pathHelper.versionEditPath(e),onClick:t=>!Et.a.isClickedWithModifier(t)&&(window.open(this.pathHelper.versionEditPath(e),"_blank"),!0)}]}}Ut.\u0275fac=function(t){return zt(t||Ut)},Ut.\u0275prov=r.Xb({token:Ut,factory:Ut.\u0275fac}),Object(a.c)([Object(Ht.a)(),Object(a.e)("design:type",nt.StateService)],Ut.prototype,"state",void 0),Object(a.c)([Object(Ht.a)(),Object(a.e)("design:type",U.a)],Ut.prototype,"halNotification",void 0);const zt=r.jc(Ut);var Xt=i("l5mm"),Jt=i("JX91"),Yt=i("2Vo4");class Zt{constructor(t){this.activeState$=new Yt.a(!0),t.addEventListener("visibilitychange",()=>{t.visibilityState&&(Object(G.a)("Browser window has visibility state changed to "+t.visibilityState),this.activeState$.next("visible"===t.visibilityState))})}get isActive(){return this.activeState$.value}get active$(){return this.activeState$.asObservable()}}Zt.\u0275fac=function(t){return new(t||Zt)(r.lc(D.d))},Zt.\u0275prov=r.Xb({token:Zt,factory:Zt.\u0275fac,providedIn:"root"});class Kt{constructor(t,e){this.activeWindow=t,this.apiV3Service=e}monitor(t){let e=new Date;return Object(Xt.a)(2e3).pipe(Object(Jt.a)(0),Object(at.a)(()=>t.length>0),Object(at.a)(()=>this.activeWindow.isActive),Object(y.a)(()=>{let i=this.queryForUpdates(t,e);return e=new Date,i}),Object(at.a)(t=>t.count>0))}queryForUpdates(t,e){return this.apiV3Service.queries.list({filters:[["id","=",t],["updatedAt","<>d",[e.toISOString()]]]})}}Kt.\u0275fac=function(t){return new(t||Kt)(r.lc(Zt),r.lc(A.a))},Kt.\u0275prov=r.Xb({token:Kt,factory:Kt.\u0275fac});i("y2Tr");var Gt=i("u8Ab");function te(t,e){if(1&t&&r.cc(0,"user-avatar",6),2&t){const t=r.rc(2);r.wc("user",t.user)}}function ee(t,e){if(1&t&&(r.hc(0,"div",1),r.Tc(1,te,1,1,"user-avatar",2),r.hc(2,"h2",3),r.cc(3,"small",4),r.cc(4,"br"),r.cc(5,"a",5),r.gc(),r.gc()),2&t){const t=r.rc();r.Pb(1),r.wc("ngIf",t.user.id),r.Pb(2),r.wc("textContent",t.text.assignee),r.Pb(2),r.wc("href",t.pathHelper.userPath(t.user.id),r.Oc)("textContent",t.user.name)}}class ie{constructor(t,e){this.pathHelper=t,this.I18n=e,this.text={assignee:this.I18n.t("js.work_packages.properties.assignee")}}}ie.\u0275fac=function(t){return new(t||ie)(r.bc(b.a),r.bc(p.a))},ie.\u0275cmp=r.Vb({type:ie,selectors:[["ng-component"]],hostAttrs:[1,"title-container","-small"],inputs:{user:["resource","user"]},decls:1,vars:1,consts:[["class","assignee-board-header",4,"ngIf"],[1,"assignee-board-header"],["data-class-list","avatar-mini",3,"user",4,"ngIf"],[1,"editable-toolbar-title--fixed"],[3,"textContent"],["target","_blank",3,"href","textContent"],["data-class-list","avatar-mini",3,"user"]],template:function(t,e){1&t&&r.Tc(0,ee,6,4,"div",0),2&t&&r.wc("ngIf",e.user)},directives:[D.q,Gt.a],styles:[".assignee-board-header[_ngcontent-%COMP%]{display:flex}.assignee-board-header[_ngcontent-%COMP%]   user-avatar[_ngcontent-%COMP%]{align-self:center;padding-right:5px}.editable-toolbar-title--fixed[_ngcontent-%COMP%]{line-height:1!important}"]});class ne extends Dt{constructor(){super(...arguments),this.filterName="assignee",this.text=this.I18n.t("js.boards.board_type.board_type_title.assignee"),this.description=this.I18n.t("js.boards.board_type.action_text_assignee"),this.label=this.I18n.t("js.boards.add_list_modal.labels.assignee"),this.icon="icon-user",this.image=Ft.a.imagePath("board_creation_modal/assignees.svg"),this.unassignedUser={id:null,href:null,name:this.I18n.t("js.filter.noneElement")}}addColumnWithActionAttribute(t,e){let i,n={name:e.name};return i=null===e.id?{assignee:{operator:"!*",values:[]}}:{assignee:{operator:"=",values:[e.idFromLink]}},this.boardListsService.addQuery(t,n,[i])}getLoadedActionValue(t){const e=this.getActionFilter(t);return e&&"!*"===e.operator.id?Promise.resolve(this.unassignedUser):super.getLoadedActionValue(t)}get localizedName(){return this.I18n.t("js.work_packages.properties.assignee")}headerComponent(){return ie}warningTextWhenNoOptionsAvailable(t){let e=t?this.I18n.t("js.boards.add_list_modal.warning.assignee"):this.I18n.t("js.boards.add_list_modal.warning.no_member");return this.apiV3Service.projects.id(this.currentProject.id).get().toPromise().then(t=>(t.memberships&&(e=e.concat(this.I18n.t("js.boards.add_list_modal.warning.add_members",{link:this.pathHelper.projectMembershipsPath(this.currentProject.identifier)}))),e))}loadUncached(){return this.apiV3Service.projects.id(this.currentProject.identifier).available_assignees.get().toPromise().then(t=>[this.unassignedUser].concat(t.elements))}}ne.\u0275fac=function(t){return se(t||ne)},ne.\u0275prov=r.Xb({token:ne,factory:ne.\u0275fac});const se=r.jc(ne);function oe(t,e){if(1&t&&(r.hc(0,"div",1),r.hc(1,"h2",2),r.cc(2,"small",3),r.cc(3,"br"),r.cc(4,"a",4),r.gc(),r.gc()),2&t){const t=r.rc();r.Pb(2),r.wc("textContent",t.text.project),r.Pb(2),r.wc("href",t.pathHelper.projectPath(t.resource.idFromLink),r.Oc)("textContent",t.resource.name)}}class ae{constructor(t,e){this.pathHelper=t,this.I18n=e,this.text={project:this.I18n.t("js.time_entry.project")}}}ae.\u0275fac=function(t){return new(t||ae)(r.bc(b.a),r.bc(p.a))},ae.\u0275cmp=r.Vb({type:ae,selectors:[["ng-component"]],hostAttrs:[1,"title-container","-small"],inputs:{resource:"resource"},decls:1,vars:1,consts:[["class","subproject-board-header",4,"ngIf"],[1,"subproject-board-header"],[1,"editable-toolbar-title--fixed"],[3,"textContent"],["target","_blank",3,"href","textContent"]],template:function(t,e){1&t&&r.Tc(0,oe,5,3,"div",0),2&t&&r.wc("ngIf",e.resource)},directives:[D.q],styles:[".editable-toolbar-title--fixed[_ngcontent-%COMP%]{line-height:1!important}"]});class re extends Dt{constructor(){super(...arguments),this.filterName="onlySubproject",this.text=this.I18n.t("js.boards.board_type.board_type_title.subproject"),this.description=this.I18n.t("js.boards.board_type.action_text_subprojects"),this.label=this.I18n.t("js.boards.add_list_modal.labels.subproject"),this.icon="icon-projects",this.image=Ft.a.imagePath("board_creation_modal/subproject.svg")}get localizedName(){return this.I18n.t("js.work_packages.properties.subproject")}headerComponent(){return ae}canMove(t){return!!t.move}assignToWorkPackage(t,e){const i=this.getActionValueId(e,!0);t.setValue("project",{href:i})}loadUncached(){const t=this.currentProject.id;return this.apiV3Service.projects.filtered(Object(P.b)("ancestor","=",[t])).get().toPromise().then(t=>t.elements)}}re.\u0275fac=function(t){return ce(t||re)},re.\u0275prov=r.Xb({token:re,factory:re.\u0275fac});const ce=r.jc(re);i("ii2/");function le(t,e){if(1&t&&(r.hc(0,"div",1),r.hc(1,"h2",2),r.cc(2,"small",3),r.cc(3,"br"),r.cc(4,"span",4),r.cc(5,"a",5),r.gc(),r.gc()),2&t){const t=r.rc();r.Pb(2),r.wc("textContent",t.text.workPackage),r.Pb(2),r.wc("ngClass",t.typeHighlightingClass)("textContent",t.resource.type.name),r.Pb(1),r.wc("href",t.pathHelper.workPackagePath(t.resource.idFromLink),r.Oc)("textContent",t.resource.subjectWithId())}}class de{constructor(t,e){this.pathHelper=t,this.I18n=e,this.text={workPackage:this.I18n.t("js.label_work_package_parent")}}ngOnInit(){this.typeHighlightingClass=E.a.inlineClass("type",this.resource.type.id)}}de.\u0275fac=function(t){return new(t||de)(r.bc(b.a),r.bc(p.a))},de.\u0275cmp=r.Vb({type:de,selectors:[["ng-component"]],hostAttrs:[1,"title-container","-small"],inputs:{resource:"resource"},decls:1,vars:1,consts:[["class","subtask-board-header",4,"ngIf"],[1,"subtask-board-header"],[1,"editable-toolbar-title--fixed"],[3,"textContent"],[1,"work-package-type",3,"ngClass","textContent"],["target","_blank",3,"href","textContent"]],template:function(t,e){1&t&&r.Tc(0,le,6,5,"div",0),2&t&&r.wc("ngIf",e.resource)},directives:[D.q,D.n],styles:[".editable-toolbar-title--fixed[_ngcontent-%COMP%]{line-height:1!important}.work-package-type[_ngcontent-%COMP%]{padding-right:.5rem}"]});class he extends Mt{constructor(){super(...arguments),this.filterName="parent",this.text=this.I18n.t("js.boards.board_type.board_type_title.subtasks"),this.description=this.I18n.t("js.boards.board_type.action_text_subtasks"),this.label=this.I18n.t("js.boards.add_list_modal.labels.subtasks"),this.icon="icon-hierarchy",this.image=Ft.a.imagePath("board_creation_modal/parent-child.svg")}get localizedName(){return this.I18n.t("js.boards.board_type.action_type.subtasks")}headerComponent(){return de}canMove(t){return!!t.changeParent}assignToWorkPackage(t,e){var i;if((null===(i=this.getActionValueId(e))||void 0===i?void 0:i.toString())===t.id)throw new Error(this.I18n.t("js.boards.error_cannot_move_into_self"));super.assignToWorkPackage(t,e)}loadValues(t){let e=new P.a;return e.add("is_milestone","=",!1),e.add("project","=",[this.currentProject.id]),t&&e.add("subjectOrId","**",[t]),this.apiV3Service.work_packages.filtered(e).get().pipe(Object(C.a)(t=>t.elements))}require(t){return this.apiV3Service.work_packages.id(t).get().toPromise()}}he.\u0275fac=function(t){return ue(t||he)},he.\u0275prov=r.Xb({token:he,factory:he.\u0275fac});const ue=r.jc(he);var be=i("HEQ6");class pe{constructor(t){this.injector=t;const e=t.get(z.a);e.add("status",t.get(Vt)),e.add("assignee",t.get(ne)),e.add("version",t.get(Ut)),e.add("subproject",t.get(re)),e.add("subtasks",t.get(he))}}pe.\u0275fac=function(t){return new(t||pe)(r.bc(r.A))},pe.\u0275cmp=r.Vb({type:pe,selectors:[["boards-entry"]],features:[r.Ob([It,Vt,Ut,ne,re,he,Kt])],decls:1,vars:0,consts:[["wp-isolated-query-space",""]],template:function(t,e){1&t&&r.cc(0,"ui-view",0)},directives:[o.UIView,be.a],encapsulation:2});var ge=i("PUHT"),fe=i("4lR/"),me=i("SqdZ"),ve=i("H3ou");const we=["tabContentOutlet"],ye=function(t){return{selected:t}},_e=function(t,e){return{"-disabled":t,selected:e}};function Ce(t,e){if(1&t){const t=r.ic();r.hc(0,"li",15),r.hc(1,"a",16),r.pc("click",(function(){r.Lc(t);const i=e.$implicit;return r.rc(2).switchTo(i.name)})),r.gc(),r.gc()}if(2&t){const t=e.$implicit,i=r.rc(2);r.wc("ngClass",r.Bc(4,ye,i.currentTab&&t.name===i.currentTab.name)),r.Pb(1),r.wc("ngClass",r.Cc(6,_e,null!=t.disableBecause,i.currentTab&&t.name===i.currentTab.name))("textContent",t.title),r.Qb("title",t.disableBecause||t.title)}}function ke(t,e){if(1&t&&(r.hc(0,"div",12),r.hc(1,"ul",13),r.Tc(2,Ce,2,9,"li",14),r.gc(),r.gc()),2&t){const t=r.rc();r.Pb(2),r.wc("ngForOf",t.availableTabs)}}class xe extends me.a{constructor(t,e,i,n,s,o,a,r,c){super(t,r,c),this.locals=t,this.I18n=e,this.boardService=i,this.boardConfigurationService=n,this.injector=s,this.appRef=o,this.componentFactoryResolver=a,this.cdRef=r,this.elementRef=c,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={title:this.I18n.t("js.boards.configuration_modal.title"),closePopup:this.I18n.t("js.close_popup_title"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel")}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.tabPortalHost=new ve.a(this.boardConfigurationService.tabs,this.tabContentOutlet.nativeElement,this.componentFactoryResolver,this.appRef,this.injector),setTimeout(()=>{const t=this.availableTabs[0].name;this.switchTo(t)})}ngOnDestroy(){this.tabPortalHost.dispose()}get availableTabs(){return this.tabPortalHost.availableTabs}get currentTab(){return this.tabPortalHost.currentTab}switchTo(t){this.tabPortalHost.switchTo(t)}saveChanges(){this.tabPortalHost.activeComponents.forEach(t=>{t.onSave()});const t=this.locals.board;this.boardService.save(t).subscribe(t=>{this.service.close()})}onClose(){return this.afterFocusOn.focus(),!0}get afterFocusOn(){return this.$element}}xe.\u0275fac=function(t){return new(t||xe)(r.bc(J.a),r.bc(p.a),r.bc(Q.a),r.bc(It),r.bc(r.A),r.bc(r.f),r.bc(r.l),r.bc(r.i),r.bc(r.q))},xe.\u0275cmp=r.Vb({type:xe,selectors:[["ng-component"]],viewQuery:function(t,e){var i;(1&t&&r.Rc(we,!0),2&t)&&(r.Ic(i=r.qc())&&(e.tabContentOutlet=i.first))},features:[r.Mb],decls:12,vars:5,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","-wide","wp-table--configuration-modal","loading-indicator--location"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],["class","content--tabs scrollable-tabs",4,"ngIf"],[1,"tab-content"],["tabContentOutlet",""],[1,"modal--form-actions"],[1,"button","-highlight",3,"textContent","click"],[1,"button",3,"textContent","click"],[1,"content--tabs","scrollable-tabs"],[1,"tabrow"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["role","button","href","",1,"tab-show",3,"ngClass","textContent","click"]],template:function(t,e){1&t&&(r.hc(0,"div",0),r.hc(1,"div",1),r.hc(2,"div",2),r.cc(3,"h3",3),r.hc(4,"a",4),r.hc(5,"i",5),r.pc("click",(function(t){return e.closeMe(t)})),r.gc(),r.gc(),r.gc(),r.Tc(6,ke,3,1,"div",6),r.cc(7,"div",7,8),r.hc(9,"div",9),r.hc(10,"button",10),r.pc("click",(function(){return e.saveChanges()})),r.gc(),r.hc(11,"button",11),r.pc("click",(function(t){return e.closeMe(t)})),r.gc(),r.gc(),r.gc(),r.gc()),2&t&&(r.Pb(3),r.wc("textContent",e.text.title),r.Pb(2),r.Qb("title",e.text.closePopup),r.Pb(1),r.wc("ngIf",!!e.tabPortalHost),r.Pb(4),r.wc("textContent",e.text.applyButton),r.Pb(1),r.wc("textContent",e.text.cancelButton))},directives:[D.q,D.p,D.n],encapsulation:2});var Ie=i("CV67");class Pe extends ge.a{constructor(t,e,i,n,s,o,a,r){super(t,e),this.elementRef=t,this.opContextMenu=e,this.opModalService=i,this.boardService=n,this.Notifications=s,this.State=o,this.injector=a,this.I18n=r,this.text={deleteSuccessful:this.I18n.t("js.notice_successful_delete")}}get locals(){return{contextMenuId:"boardsToolbarMenu",items:this.items}}open(t){this.buildItems(),this.opContextMenu.show(this,t)}buildItems(){this.items=[{linkText:this.I18n.t("js.toolbar.settings.configure_view"),icon:"icon-settings",onClick:t=>(this.opContextMenu.close(),this.opModalService.show(xe,this.injector,{board:this.board}),!0)},{linkText:this.I18n.t("js.toolbar.settings.page_settings"),icon:"icon-edit",onClick:t=>(this.board.grid.updateImmediately&&jQuery(".toolbar-container .editable-toolbar-title--input").trigger(Ie.c),!0)},{linkText:this.I18n.t("js.toolbar.settings.delete"),icon:"icon-delete",onClick:t=>(this.board.grid.delete&&window.confirm(this.I18n.t("js.text_query_destroy_confirmation"))&&this.boardService.delete(this.board).then(()=>{this.State.go("boards.list",{flash_message:{type:"success",message:this.text.deleteSuccessful}})}),!0)}]}}Pe.\u0275fac=function(t){return new(t||Pe)(r.bc(r.q),r.bc(fe.a),r.bc(J.b),r.bc(Q.a),r.bc(B.a),r.bc(nt.StateService),r.bc(r.A),r.bc(p.a))},Pe.\u0275dir=r.Wb({type:Pe,selectors:[["","boardsToolbarMenu",""]],inputs:{board:["boardsToolbarMenu-resource","board"]},features:[r.Mb]});var Se=i("kor4");function je(t,e){if(1&t){const t=r.ic();r.hc(0,"div",2),r.pc("accessibleClick",(function(){r.Lc(t);const i=e.$implicit;return r.rc().created(i.attribute)})),r.cc(1,"img",3),r.hc(2,"div"),r.hc(3,"span",4),r.Vc(4),r.gc(),r.cc(5,"p",5),r.gc(),r.gc()}if(2&t){const t=e.$implicit,i=r.rc();r.wc("disabled",i.disabled()),r.Pb(1),r.wc("src",t.image,r.Oc),r.Pb(3),r.Wc(t.text),r.Pb(1),r.wc("textContent",t.description)}}class Oe{constructor(){this.disable=!1,this.create=new r.s}disabled(){return this.disable}created(t){this.create.emit(t)}}Oe.\u0275fac=function(t){return new(t||Oe)},Oe.\u0275cmp=r.Vb({type:Oe,selectors:[["tile-view"]],inputs:{tiles:"tiles",disable:"disable"},outputs:{create:"create"},decls:2,vars:1,consts:[[1,"tile-blocks--container"],["class","tile-block button",3,"disabled","accessibleClick",4,"ngFor","ngForOf"],[1,"tile-block","button",3,"disabled","accessibleClick"],[1,"tile-block-image",3,"src"],[1,"tile-block-title"],[1,"tile-block-description",3,"textContent"]],template:function(t,e){1&t&&(r.hc(0,"div",0),r.Tc(1,je,6,4,"div",1),r.gc()),2&t&&(r.Pb(1),r.wc("ngForOf",e.tiles))},directives:[D.p,Se.a],styles:[".tile-blocks--container[_ngcontent-%COMP%]{display:grid;grid-template-rows:repeat(minmax(200px,auto));grid-template-columns:auto auto;grid-column-gap:10px;grid-row-gap:10px}.tile-block[_ngcontent-%COMP%]{border-radius:10px;display:grid;grid-template:95px 1fr/1fr;grid-template-columns:auto 1fr auto;grid-template-rows:auto;grid-row-gap:5px;justify-items:left;background:#f7fafc;min-height:150px}.tile-block[_ngcontent-%COMP%]:hover{text-decoration:none;border:1px solid grey;border-radius:10px!important;cursor:pointer}.tile-block-image[_ngcontent-%COMP%]{display:block;margin-top:auto;margin-bottom:auto}.tile-block-title[_ngcontent-%COMP%]{padding-top:30px;padding-bottom:5px;color:var(--primary-color-dark);display:block;text-align:left;font-weight:bolder;font-size:large}.tile-block[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:left;width:90%}"],changeDetection:0});var Me=Ft.a.imagePath;const Ae=["actionAttributeSelect"];function De(t,e){if(1&t){const t=r.ic();r.hc(0,"a",9),r.hc(1,"i",10),r.pc("click",(function(e){r.Lc(t);return r.rc().closeMe(e)})),r.gc(),r.gc()}if(2&t){const t=r.rc();r.Pb(1),r.Qb("title",t.text.close_popup)}}class Re extends me.a{constructor(t,e,i,n,s,o,a,r,c,l){super(e,i,t),this.elementRef=t,this.locals=e,this.cdRef=i,this.state=n,this.boardService=s,this.boardActions=o,this.halNotification=a,this.loadingIndicatorService=r,this.I18n=c,this.boardActionRegistry=l,this.showClose=!0,this.confirmed=!1,this.available=this.boardActions.available(),this.inFlight=!1,this.text={close_popup:this.I18n.t("js.close_popup_title"),free_board:this.I18n.t("js.boards.board_type.free"),free_board_text:this.I18n.t("js.boards.board_type.free_text"),free_board_title:this.I18n.t("js.boards.board_type.board_type_title.basic"),board_type:this.I18n.t("js.boards.board_type.text"),action_board:this.I18n.t("js.boards.board_type.action"),action_board_text:this.I18n.t("js.boards.board_type.action_text"),select_attribute:this.I18n.t("js.boards.board_type.select_attribute"),select_board_type:this.I18n.t("js.boards.board_type.select_board_type"),placeholder:this.I18n.t("js.placeholders.selection")},this.initiateTiles()}createBoard(t){"basic"===t?this.createFree():this.createAction(t)}initiateTiles(){this.available.unshift({attribute:"basic",text:this.text.free_board_title,icon:"icon-boards",description:this.text.free_board_text,image:Me("board_creation_modal/lists.svg")}),this.addIcon(this.available),this.addDescription(this.available),this.addText(this.available),this.addImage(this.available)}createFree(){this.create({type:"free"})}createAction(t){this.create({type:"action",attribute:t})}create(t){this.inFlight=!0,this.loadingIndicatorService.modal.promise=this.boardService.create(t).then(t=>{this.inFlight=!1,this.closeMe(),this.state.go("boards.partitioned.show",{board_id:t.id,isNew:!0})}).catch(t=>{this.inFlight=!1,this.halNotification.handleRawError(t)})}addDescription(t){t.forEach(t=>{if("basic"!==t.attribute){const e=this.boardActionRegistry.get(t.attribute);t.description=e.description}})}addIcon(t){t.forEach(t=>{if("basic"!==t.attribute){const e=this.boardActionRegistry.get(t.attribute);t.icon=e.icon}})}addText(t){t.forEach(t=>{if("basic"!==t.attribute){const e=this.boardActionRegistry.get(t.attribute);t.text=e.text}})}addImage(t){t.forEach(t=>{if("basic"!==t.attribute){const e=this.boardActionRegistry.get(t.attribute);t.image=e.image}})}}Re.\u0275fac=function(t){return new(t||Re)(r.bc(r.q),r.bc(J.a),r.bc(r.i),r.bc(nt.StateService),r.bc(Q.a),r.bc(z.a),r.bc(U.a),r.bc(c.a),r.bc(p.a),r.bc(z.a))},Re.\u0275cmp=r.Vb({type:Re,selectors:[["ng-component"]],viewQuery:function(t,e){var i;(1&t&&r.Rc(Ae,!0),2&t)&&(r.Ic(i=r.qc())&&(e.actionAttributeSelect=i.first))},features:[r.Mb],decls:9,vars:5,consts:[[1,"op-modal--portal","confirm-form-submit--modal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","confirm-dialog--modal","loading-indicator--location"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-add",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[3,"textContent"],[1,"new-board--section"],[3,"tiles","disable","create"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"]],template:function(t,e){1&t&&(r.hc(0,"div",0),r.hc(1,"div",1),r.hc(2,"div",2),r.Tc(3,De,2,1,"a",3),r.cc(4,"h3",4),r.gc(),r.hc(5,"div",5),r.cc(6,"p",6),r.hc(7,"section",7),r.hc(8,"tile-view",8),r.pc("create",(function(t){return e.createBoard(t)})),r.gc(),r.gc(),r.gc(),r.gc(),r.gc()),2&t&&(r.Pb(3),r.wc("ngIf",e.showClose),r.Pb(1),r.wc("textContent",e.text.board_type),r.Pb(2),r.wc("textContent",e.text.select_board_type),r.Pb(2),r.wc("tiles",e.available)("disable",e.inFlight))},directives:[D.q,Oe],encapsulation:2});var Te=i("fbLK"),qe=i("Qs0b");var Fe=i("AEvm"),Ve=i("jhN1"),Le=i("N5AO"),Be=i("HN1l"),$e=i("QihR"),Ee=i("/Rze");function Ne(t,e){if(1&t){const t=r.ic();r.hc(0,"li",10),r.hc(1,"a",11),r.pc("click",(function(){r.Lc(t);return r.rc(2).newBoard()})),r.cc(2,"op-icon",12),r.cc(3,"span",13),r.gc(),r.gc()}if(2&t){const t=r.rc(2);r.Pb(3),r.wc("textContent",t.text.board)}}function We(t,e){if(1&t&&(r.hc(0,"ul",8),r.Tc(1,Ne,4,1,"li",9),r.gc()),2&t){const t=r.rc();r.Pb(1),r.wc("ngIf",t.canAdd)}}function Qe(t,e){if(1&t&&(r.hc(0,"tr",23),r.hc(1,"td",24),r.hc(2,"span"),r.cc(3,"op-icon",25),r.hc(4,"span"),r.cc(5,"strong",3),r.gc(),r.gc(),r.gc(),r.gc()),2&t){const t=r.rc(2);r.Pb(5),r.wc("textContent",t.text.noResults)}}function He(t,e){if(1&t&&r.cc(0,"span",3),2&t){const t=r.rc(3);r.wc("textContent",t.text.type_free)}}function Ue(t,e){if(1&t&&r.cc(0,"span",3),2&t){const t=r.rc().$implicit,e=r.rc(2);r.wc("textContent",e.text.action_by_attribute(t.actionAttribute))}}function ze(t,e){if(1&t){const t=r.ic();r.hc(0,"accessible-by-keyboard",32),r.pc("execute",(function(){r.Lc(t);const e=r.rc().$implicit;return r.rc(2).destroyBoard(e)})),r.Vc(1),r.gc()}if(2&t){const t=r.rc(3);r.Pb(1),r.Xc(" ",t.text.delete," ")}}const Xe=function(t){return{board_id:t}};function Je(t,e){if(1&t&&(r.hc(0,"tr"),r.hc(1,"td",26),r.cc(2,"a",27),r.gc(),r.hc(3,"td"),r.Tc(4,He,1,1,"span",28),r.Tc(5,Ue,1,1,"span",28),r.gc(),r.hc(6,"td"),r.cc(7,"op-date-time",29),r.gc(),r.hc(8,"td",30),r.Tc(9,ze,2,1,"accessible-by-keyboard",31),r.gc(),r.gc()),2&t){const t=e.$implicit;r.Pb(2),r.wc("textContent",t.name)("uiParams",r.Bc(6,Xe,t.id)),r.Pb(2),r.wc("ngIf",t.isFree),r.Pb(1),r.wc("ngIf",t.isAction),r.Pb(2),r.wc("dateTimeValue",t.createdAt),r.Pb(2),r.wc("ngIf",t.editable)}}function Ye(t,e){if(1&t&&(r.hc(0,"div",14),r.hc(1,"div",15),r.hc(2,"table",16),r.hc(3,"colgroup"),r.cc(4,"col",17),r.cc(5,"col",17),r.cc(6,"col",17),r.cc(7,"col",17),r.cc(8,"col"),r.gc(),r.hc(9,"thead"),r.hc(10,"tr"),r.hc(11,"th"),r.hc(12,"div",18),r.hc(13,"div",19),r.cc(14,"span",3),r.gc(),r.gc(),r.gc(),r.hc(15,"th"),r.hc(16,"div",18),r.hc(17,"div",19),r.cc(18,"span",3),r.gc(),r.gc(),r.gc(),r.hc(19,"th"),r.hc(20,"div",18),r.hc(21,"div",19),r.cc(22,"span",3),r.gc(),r.gc(),r.gc(),r.hc(23,"th"),r.cc(24,"div",20),r.gc(),r.gc(),r.gc(),r.hc(25,"tbody"),r.Tc(26,Qe,6,1,"tr",21),r.Tc(27,Je,10,8,"tr",22),r.gc(),r.gc(),r.gc(),r.gc()),2&t){const t=e.ngIf,i=r.rc();r.Pb(14),r.wc("textContent",i.text.name),r.Pb(4),r.wc("textContent",i.text.type),r.Pb(4),r.wc("textContent",i.text.createdAt),r.Pb(4),r.wc("ngIf",0===t.length),r.Pb(1),r.wc("ngForOf",t)}}function Ze(t,e){if(1&t&&(r.hc(0,"div",33),r.hc(1,"p"),r.Vc(2),r.gc(),r.hc(3,"p"),r.Vc(4),r.gc(),r.hc(5,"a",34),r.Vc(6),r.gc(),r.hc(7,"a",35),r.Vc(8),r.gc(),r.hc(9,"div",36),r.cc(10,"iframe",37),r.gc(),r.gc()),2&t){const t=r.rc();r.Pb(2),r.Wc(t.text.teaser_text),r.Pb(2),r.Wc(t.text.enterprise),r.Pb(1),r.wc("href",t.eeLink(),r.Oc),r.Pb(1),r.Xc(" ",t.text.upgrade," "),r.Pb(1),r.wc("href",t.demoLink(),r.Oc),r.Pb(1),r.Xc(" ",t.text.personal_demo," "),r.Pb(2),r.wc("src",t.teaserVideoURL,r.Nc)}}class Ke extends Fe.a{constructor(t,e,i,n,s,o,a,r,c,l){super(),this.boardService=t,this.apiV3Service=e,this.I18n=i,this.notifications=n,this.opModalService=s,this.loadingIndicatorService=o,this.authorisationService=a,this.injector=r,this.bannerService=c,this.domSanitizer=l,this.text={name:this.I18n.t("js.modals.label_name"),board:this.I18n.t("js.label_board"),boards:this.I18n.t("js.label_board_plural"),type:this.I18n.t("js.boards.label_board_type"),type_free:this.I18n.t("js.boards.board_type.free"),action_by_attribute:t=>this.I18n.t("js.boards.board_type.action_by_attribute",{attribute:this.I18n.t("js.boards.board_type.action_type."+t)}),createdAt:this.I18n.t("js.label_created_on"),delete:this.I18n.t("js.button_delete"),areYouSure:this.I18n.t("js.text_are_you_sure"),deleteSuccessful:this.I18n.t("js.notice_successful_delete"),noResults:this.I18n.t("js.notice_no_results_to_display"),teaser_text:this.I18n.t("js.boards.upsale.teaser_text"),enterprise:this.I18n.t("js.boards.upsale.upgrade_to_ee_text"),upgrade:this.I18n.t("js.boards.upsale.upgrade"),personal_demo:this.I18n.t("js.boards.upsale.personal_demo")},this.canAdd=!1,this.boards$=this.apiV3Service.boards.observeAll(),this.teaserVideoURL=this.domSanitizer.bypassSecurityTrustResourceUrl("https://player.vimeo.com/video/337280106")}ngOnInit(){this.authorisationService.observeUntil(Object(tt.b)(this)).subscribe(()=>{this.canAdd=this.authorisationService.can("boards","create")})}ngAfterViewInit(){this.loadingIndicatorService.indicator("boards-module").promise=this.boardService.loadAllBoards()}newBoard(){this.opModalService.show(Re,this.injector)}destroyBoard(t){window.confirm(this.text.areYouSure)&&this.boardService.delete(t).then(()=>{this.notifications.addSuccess(this.text.deleteSuccessful)}).catch(t=>this.notifications.addError("Deletion failed: "+t))}showBoardIndexView(){return!this.bannerService.eeShowBanners}eeLink(){return qe.b+"&op_referrer=boards"}demoLink(){return qe.a}}Ke.\u0275fac=function(t){return new(t||Ke)(r.bc(Q.a),r.bc(A.a),r.bc(p.a),r.bc(B.a),r.bc(J.b),r.bc(c.a),r.bc($.a),r.bc(r.A),r.bc(Te.a),r.bc(Ve.b))},Ke.\u0275cmp=r.Vb({type:Ke,selectors:[["ng-component"]],features:[r.Mb],decls:9,vars:6,consts:[[1,"toolbar-container"],[1,"toolbar"],[1,"title-container"],[3,"textContent"],["class","toolbar-items",4,"ngIf"],["data-indicator-name","boards-module",1,"boards--listing-group","loading-indicator--location"],["class","generic-table--container",4,"ngIf"],["class","boards--teaser-container",4,"ngIf"],[1,"toolbar-items"],["class","toolbar-item",4,"ngIf"],[1,"toolbar-item"],[1,"button","-alt-highlight",3,"click"],["icon-classes","button--icon icon-add"],[1,"button--text",3,"textContent"],[1,"generic-table--container"],[1,"generic-table--results-container"],[1,"generic-table"],["highlight-col",""],[1,"generic-table--sort-header-outer"],[1,"generic-table--sort-header"],[1,"generic-table--empty-header"],["id","empty-row-notification",4,"ngIf"],[4,"ngFor","ngForOf"],["id","empty-row-notification"],["colspan","4"],["icon-classes","icon-info1 icon-context"],[1,"name"],["uiSref","boards.partitioned.show",3,"textContent","uiParams"],[3,"textContent",4,"ngIf"],[3,"dateTimeValue"],[1,"buttons"],["linkClass","icon icon-delete",3,"execute",4,"ngIf"],["linkClass","icon icon-delete",3,"execute"],[1,"boards--teaser-container"],["target","blank",1,"button","-alt-highlight","-with-icon","icon-checkmark",3,"href"],[1,"button","-highlight-inverted",3,"href"],[1,"boards--teaser-video-container"],["frameborder","0","allow","autoplay; fullscreen","allowfullscreen","",1,"boards--teaser-video",3,"src"]],template:function(t,e){1&t&&(r.hc(0,"div",0),r.hc(1,"div",1),r.hc(2,"div",2),r.cc(3,"h2",3),r.gc(),r.Tc(4,We,2,1,"ul",4),r.gc(),r.gc(),r.hc(5,"div",5),r.Tc(6,Ye,28,5,"div",6),r.sc(7,"async"),r.gc(),r.Tc(8,Ze,11,7,"div",7)),2&t&&(r.Pb(3),r.wc("textContent",e.text.boards),r.Pb(1),r.wc("ngIf",e.showBoardIndexView()),r.Pb(2),r.wc("ngIf",e.showBoardIndexView()&&r.tc(7,4,e.boards$)),r.Pb(2),r.wc("ngIf",!e.showBoardIndexView()))},directives:[D.q,Le.a,Be.a,D.p,o.AnchorUISref,o.UISref,$e.a,Ee.a],pipes:[D.a],styles:[".boards--listing-group[_ngcontent-%COMP%]{position:relative}.boards--teaser-video-container[_ngcontent-%COMP%]{height:50vh;text-align:center}.boards--teaser-video-container[_ngcontent-%COMP%]   .boards--teaser-video[_ngcontent-%COMP%]{width:100%;height:100%}"]});var Ge=i("yCBR"),ti=i("4EDS"),ei=i("iuWW"),ii=i("CS/5");function ni(t,e){if(1&t){const t=r.ic();r.hc(0,"a",15),r.hc(1,"i",16),r.pc("click",(function(e){r.Lc(t);return r.rc().closeMe(e)})),r.gc(),r.gc()}if(2&t){const t=r.rc();r.Pb(1),r.Qb("title",t.text.close_popup)}}function si(t,e){if(1&t&&(r.hc(0,"div",17),r.hc(1,"div",18),r.cc(2,"p",19),r.gc(),r.gc()),2&t){const t=r.rc();r.Pb(2),r.wc("innerHTML",t.warningText,r.Mc)}}const oi=function(t,e){return{availableValues:t,typeahead:e,appendTo:"body",model:"",classes:"new-list--action-select",finishedLoading:!0}};class ai extends me.a{constructor(t,e,i,n,s,o,a,r){super(e,i,t),this.elementRef=t,this.locals=e,this.cdRef=i,this.boardActions=n,this.halNotification=s,this.state=o,this.boardService=a,this.I18n=r,this.requests=new ei.a(t=>this.actionService.loadAvailable(this.board,this.active,t),Object(ei.b)(this.halNotification),!0),this.confirmed=!1,this.inFlight=!1,this.trackByHref=ti.a.trackByHref,this.closeOnOutsideClick=!1,this.text={title:this.I18n.t("js.boards.add_list"),button_add:this.I18n.t("js.button_add"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title"),free_board:this.I18n.t("js.boards.board_type.free"),free_board_text:this.I18n.t("js.boards.board_type.free_text"),action_board:this.I18n.t("js.boards.board_type.action"),action_board_text:this.I18n.t("js.boards.board_type.action_text"),select_attribute:this.I18n.t("js.boards.board_type.select_attribute"),placeholder:this.I18n.t("js.placeholders.selection")},this.referenceOutputs={onCreate:t=>this.onNewActionCreated(t),onOpen:()=>this.requests.input$.next(""),onChange:t=>this.onModelChange(t),onAfterViewInit:t=>t.focusInputField()},this.showWarning=!1}ngOnInit(){super.ngOnInit(),this.board=this.locals.board,this.active=new Set(this.locals.active),this.actionService=this.boardActions.get(this.board.actionAttribute),this.requests.output$.pipe(this.untilDestroyed()).subscribe(t=>{let e=!1;e=0===t.length&&(void 0!==this.requests.lastRequestedValue&&""!==this.requests.lastRequestedValue),this.actionService.warningTextWhenNoOptionsAvailable(e).then(t=>{this.warningText=t}),this.availableValues=t,this.showWarning=void 0!==this.requests.lastRequestedValue&&0===t.length,this.cdRef.detectChanges()}),this.requests.input$.next("")}onModelChange(t){this.selectedAttribute=t}create(){this.inFlight=!0,this.actionService.addColumnWithActionAttribute(this.board,this.selectedAttribute).then(t=>this.boardService.save(t).toPromise()).then(t=>{this.inFlight=!1,this.closeMe(),this.state.go("boards.partitioned.show",{board_id:t.id,isNew:!0})}).catch(()=>this.inFlight=!1)}onNewActionCreated(t){this.selectedAttribute=t,this.create()}autocompleterComponent(){return this.actionService.autocompleterComponent()}}ai.\u0275fac=function(t){return new(t||ai)(r.bc(r.q),r.bc(J.a),r.bc(r.i),r.bc(z.a),r.bc(U.a),r.bc(nt.StateService),r.bc(Q.a),r.bc(p.a))},ai.\u0275cmp=r.Vb({type:ai,selectors:[["ng-component"]],features:[r.Mb],decls:15,vars:15,consts:[[1,"op-modal--portal","confirm-form-submit--modal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","confirm-dialog--modal","loading-indicator--location","-slim"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-add",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],["class","notification-box -warning",4,"ngIf"],[1,"form--field"],[1,"form--field-container"],[1,"form--select-container"],[1,"form--label",3,"textContent"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"],[1,"op-modal--modal-footer"],[1,"button","-highlight",3,"disabled","textContent","click"],[1,"confirm-form-submit--cancel","button",3,"textContent","click"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[1,"notification-box","-warning"],[1,"notification-box--content"],[3,"innerHTML"]],template:function(t,e){1&t&&(r.hc(0,"div",0),r.hc(1,"div",1),r.hc(2,"div",2),r.Tc(3,ni,2,1,"a",3),r.cc(4,"h3",4),r.gc(),r.hc(5,"div",5),r.Tc(6,si,3,1,"div",6),r.hc(7,"div",7),r.hc(8,"div",8),r.hc(9,"div",9),r.cc(10,"label",10),r.cc(11,"ndc-dynamic",11),r.gc(),r.gc(),r.gc(),r.gc(),r.hc(12,"div",12),r.hc(13,"button",13),r.pc("click",(function(){return e.create()})),r.gc(),r.hc(14,"button",14),r.pc("click",(function(t){return e.closeMe(t)})),r.gc(),r.gc(),r.gc(),r.gc()),2&t&&(r.Pb(3),r.wc("ngIf",e.showClose),r.Pb(1),r.wc("textContent",e.text.title),r.Pb(2),r.wc("ngIf",e.showWarning&&e.warningText),r.Pb(4),r.wc("textContent",e.actionService.label),r.Pb(1),r.wc("ndcDynamicComponent",e.autocompleterComponent())("ndcDynamicInputs",r.Cc(12,oi,e.availableValues,e.requests.input$))("ndcDynamicOutputs",e.referenceOutputs),r.Pb(2),r.wc("disabled",!e.selectedAttribute||e.inFlight)("textContent",e.text.button_add),r.Qb("title",e.text.button_add),r.Pb(1),r.wc("textContent",e.text.button_cancel),r.Qb("title",e.text.button_cancel))},directives:[D.q,ii.c,ii.d],encapsulation:2});class ri extends ge.a{constructor(t,e,i,n,s,o,a,r,c,l){super(t,e),this.elementRef=t,this.opContextMenu=e,this.opModalService=i,this.authorisationService=n,this.wpInlineCreate=s,this.boardList=o,this.injector=a,this.querySpace=r,this.cdRef=c,this.I18n=l,this.focusAfterClose=!0}open(t){this.items=this.buildItems(),this.opContextMenu.show(this,t)}positionArgs(t){let e=super.positionArgs(t);return _.assign(e,{my:"left top",at:"left bottom"}),e}buildItems(){return[{disabled:!this.wpInlineCreate.canAdd,linkText:this.I18n.t("js.card.add_new"),onClick:()=>(this.boardList.addNewCard(),!0)},{disabled:!this.wpInlineCreate.canReference,linkText:this.I18n.t("js.relation_buttons.add_existing"),onClick:()=>(this.boardList.addReferenceCard(),!0)}]}}ri.\u0275fac=function(t){return new(t||ri)(r.bc(r.q),r.bc(fe.a),r.bc(J.b),r.bc($.a),r.bc(l.a),r.bc(Ct),r.bc(r.A),r.bc(h.a),r.bc(r.i),r.bc(p.a))},ri.\u0275dir=r.Wb({type:ri,selectors:[["","addCardDropdown",""]],features:[r.Mb]});var ci=i("F5Dh"),li=i("zP0r"),di=i("eaMR");class hi extends Fe.a{constructor(t,e,i,n,s,o,a,r,c){super(),this.currentProjectService=t,this.querySpace=e,this.apiV3Service=i,this.halResourceService=n,this.wpStatesInitialization=s,this.wpTableFilters=o,this.urlParamsHelper=a,this.boardFilters=r,this.$state=c,this.initialized=!1}ngAfterViewInit(){this.board$&&this.board$.pipe(Object(At.a)(1)).subscribe(t=>{this.loadQueryForm(),this.updateChecksumOnFilterChanges(),t.isAction&&this.wpTableFilters.hidden.push(t.actionAttribute)})}updateChecksumOnFilterChanges(){this.wpTableFilters.live$().pipe(this.untilDestroyed(),Object(li.a)(1),Object(m.a)(250)).subscribe(()=>{const t=this.wpTableFilters.current;let e=this.urlParamsHelper.buildV3GetFilters(t),i=JSON.stringify(e);this.boardFilters.filters.putValue(e),this.$state.go(".",{query_props:i},{custom:{notify:!1}})})}loadQueryForm(){this.apiV3Service.queries.form.loadWithParams({filters:JSON.stringify(this.boardFilters.current)},void 0,this.currentProjectService.id).subscribe(([t,e])=>{this.querySpace.query.putValue(e),this.wpStatesInitialization.updateStatesFromForm(e,t)})}}hi.\u0275fac=function(t){return new(t||hi)(r.bc(I.a),r.bc(h.a),r.bc(A.a),r.bc(u.a),r.bc(W.a),r.bc(ci.a),r.bc(M.a),r.bc(it),r.bc(nt.StateService))},hi.\u0275cmp=r.Vb({type:hi,selectors:[["board-filter"]],inputs:{board$:"board$"},features:[r.Mb],decls:1,vars:0,template:function(t,e){1&t&&r.cc(0,"filter-container")},directives:[di.a],encapsulation:2});var ui=i("5+WD"),bi=i("xgIS"),pi=i("1G5W");class gi{constructor(t,e){this.container=t,this.scrollCallback=e,this.margin=30,this.maxSpeed=25,this.point={x:0,y:0},this.boundaryRect=this.container.getBoundingClientRect()}onMove(t){this.point=t,cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(()=>this.scrollTick())}scrollTick(){cancelAnimationFrame(this.animationFrame),this.autoScroll()&&(this.animationFrame=requestAnimationFrame(()=>this.scrollTick()))}autoScroll(){let t,e;return t=this.point.x<this.boundaryRect.left+this.margin?Math.floor(Math.max(-1,(this.point.x-this.boundaryRect.left)/this.margin-1)*this.maxSpeed):this.point.x>this.boundaryRect.right-this.margin?Math.ceil(Math.min(1,(this.point.x-this.boundaryRect.right)/this.margin+1)*this.maxSpeed):0,e=this.point.y<this.boundaryRect.top+this.margin?Math.floor(Math.max(-1,(this.point.y-this.boundaryRect.top)/this.margin-1)*this.maxSpeed):this.point.y>this.boundaryRect.bottom-this.margin?Math.ceil(Math.min(1,(this.point.y-this.boundaryRect.bottom)/this.margin+1)*this.maxSpeed):0,setTimeout(()=>{e&&this.scrollY(e),t&&this.scrollX(t)}),t||e}scrollY(t){this.container.scrollTop+=t,this.scrollCallback&&this.scrollCallback({x:0,y:t})}scrollX(t){this.container.scrollLeft+=t,this.scrollCallback&&this.scrollCallback({x:t,y:0})}destroy(){cancelAnimationFrame(this.animationFrame)}}class fi{constructor(){this.debugInfo=new Yt.a(null),this.enabled=!1}log(t){this.debugInfo.next(t)}reset(){this.debugInfo.next(null)}}fi.\u0275fac=function(t){return new(t||fi)},fi.\u0275prov=r.Xb({token:fi,factory:fi.\u0275fac,providedIn:"root"}),fi.ctorParameters=()=>[],fi.ngInjectableDef=Object(r.Xb)({factory:function(){return new fi},token:fi,providedIn:"root"});class mi{constructor(t,e,i,n){this.cdkDrag=t,this.dragDebugService=e,this.zone=i,this.changeDetectorRef=n,this.destroy$=new g.a,this.stopDragging$=new g.a,this.lastScroll={top:0,left:0},this.dragRef=this.cdkDrag._dragRef,this.dragRef?this.zone.runOutsideAngular(()=>{this.dragRef.started.pipe(Object(pi.a)(this.destroy$)).subscribe(t=>{this.log("Started",t,this.dragRef.isDragging()),this.started()}),this.dragRef.ended.pipe(Object(pi.a)(this.destroy$)).subscribe(t=>{this.log("Ended",t),this.ended()}),this.dragRef.entered.pipe(Object(pi.a)(this.destroy$)).subscribe(t=>{this.log("Entered",t),this.entered()}),this.dragRef.exited.pipe(Object(pi.a)(this.destroy$)).subscribe(t=>{this.log("Exited",t),this.exited()})}):this.log("CdkDrag not found",this.cdkDrag,this.dragRef)}ngOnChanges(t){t.dragConnectedIds&&this.dragRef.isDragging()&&setTimeout(()=>{this.syncSiblings()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.stopDragging$.next(),this.stopDragging$.complete(),this.destroyAutoScroll()}started(){this.scrollContainer&&(this.destroyAutoScroll(),this.addDebugInfo(),this.autoScroll=new gi(this.scrollContainer),this.lastScroll.top=this.scrollContainer.scrollTop,this.lastScroll.left=this.scrollContainer.scrollLeft,Object(bi.a)(this.scrollContainer,"scroll").pipe(Object(pi.a)(this.stopDragging$)).subscribe(()=>{const t=this.scrollContainer.scrollLeft-this.lastScroll.left,e=this.scrollContainer.scrollTop-this.lastScroll.top;(t||e)&&this.handleScroll(t,e),this.lastScroll.top=this.scrollContainer.scrollTop,this.lastScroll.left=this.scrollContainer.scrollLeft}),this.dragRef.moved.pipe(Object(m.a)(10),Object(pi.a)(this.stopDragging$)).subscribe(t=>{this.autoScroll.onMove(t.pointerPosition)}))}ended(){this.destroyAutoScroll(),this.stopDragging$.next(),this.dragDebugService.reset()}entered(){this.dragFixContainer()}exited(){this.dragFixContainer()}handleScroll(t,e){const i=this.getDropListRef();this.adjustContainers(),this.adjustItems(t,e),i._draggables.length>i._itemPositions.length&&this.syncItems(),this.addDebugInfo()}destroyAutoScroll(){this.autoScroll&&(this.autoScroll.destroy(),this.autoScroll=null)}getDropListRef(){return this.dragRef._dropContainer}addDebugInfo(){if(!this.dragDebugService.enabled)return;const t=this.getDropListRef(),e=[...t._itemPositions.map(t=>({clientRect:t.clientRect,color:"blue",id:t.drag.data.data.name})),...t._siblings.map(t=>({clientRect:t._clientRect,color:"green",id:""})),{clientRect:t._clientRect,color:"#2FD1BB",id:""}];this.dragDebugService.log(e.filter(t=>t.clientRect))}dragFixContainer(){setTimeout(()=>{this.getDropListRef()._cacheOwnPosition(),this.addDebugInfo()}),this.changeDetectorRef.markForCheck()}syncSiblings(){const t=this.getDropListRef();this.log("syncSiblings before",t._siblings.length),t.beforeStarted.next(),this.log("syncSiblings after",t._siblings.length),this.adjustContainers()}syncItems(){const t=this.getDropListRef(),e=t._itemPositions;t._activeDraggables=t._draggables.slice(),t._cacheItemPositions();const i=t._itemPositions;t._itemPositions=[...e],i.forEach(i=>{e.find(t=>i.drag===t.drag)||t._itemPositions.push(i)}),t._activeDraggables.push(this.dragRef)}adjustContainers(){const t=this.getDropListRef();t._cacheOwnPosition(),t._siblings.forEach(t=>{t._cacheOwnPosition()})}adjustItems(t,e){this.getDropListRef()._itemPositions.forEach(i=>{i.originalRect=i.originalRect||i.clientRect,i.clientRect=Object.assign({},i.clientRect,{left:i.clientRect.left-t,right:i.clientRect.right-t,top:i.clientRect.top-e,bottom:i.clientRect.bottom-e})})}log(t,...e){this.dragDebugService.enabled&&console.log(t,e)}}mi.\u0275fac=function(t){return new(t||mi)(r.bc(ui.a),r.bc(fi),r.bc(r.K),r.bc(r.i))},mi.\u0275dir=r.Wb({type:mi,selectors:[["","vsDragScroll",""]],inputs:{dragConnectedIds:["vsDragScrollConnectedTo","dragConnectedIds"],scrollContainer:["vsDragScrollContainer","scrollContainer"]},exportAs:["vsDragScroll"],features:[r.Nb]}),mi.ctorParameters=()=>[{type:ui.a},{type:fi},{type:r.K},{type:r.i}],mi.propDecorators={dragConnectedIds:[{type:r.B,args:["vsDragScrollConnectedTo"]}],scrollContainer:[{type:r.B,args:["vsDragScrollContainer"]}]};class vi{}vi.\u0275mod=r.Zb({type:vi}),vi.\u0275inj=r.Yb({factory:function(t){return new(t||vi)},imports:[[ui.g]]});var wi=i("tmNb"),yi=i("p5fp"),_i=i("qvi4");class Ci{constructor(t){this.I18n=t,this.text={button_more:this.I18n.t("js.button_more")}}}Ci.\u0275fac=function(t){return new(t||Ci)(r.bc(p.a))},Ci.\u0275cmp=r.Vb({type:Ci,selectors:[["ng-component"]],inputs:{board$:"board$"},decls:3,vars:4,consts:[["boardsToolbarMenu","",1,"button","last","board--settings-dropdown","toolbar-icon",3,"title","boardsToolbarMenu-resource"],["icon-classes","button--icon icon-show-more"]],template:function(t,e){1&t&&(r.hc(0,"button",0),r.sc(1,"async"),r.cc(2,"op-icon",1),r.gc()),2&t&&(r.xc("title",e.text.button_more),r.wc("boardsToolbarMenu-resource",r.tc(1,2,e.board$)))},directives:[Pe,Le.a],pipes:[D.a],encapsulation:2});class ki{constructor(t){this.handler=t,this.requests=new g.a,this.responses$=this.requests.pipe(Object(y.a)(this.handler))}request(t){this.requests.next(t)}observe(t){return this.responses$.pipe(Object(pi.a)(t))}}var xi=i("quSY");class Ii{constructor(t){this.callback=t}call(t,e){return e.subscribe(new Pi(t,this.callback))}}class Pi extends ct.a{constructor(t,e){super(t),this.add(new xi.a(e))}}i("Wcm6");var Si=i("DLfB");function ji(t,e){if(1&t&&r.cc(0,"back-button",11),2&t){const t=r.rc();r.wc("customBackMethod",t.backButtonCallback)}}function Oi(t,e){if(1&t&&(r.hc(0,"li",15),r.cc(1,"ndc-dynamic",16),r.gc()),2&t){const t=r.rc().$implicit,e=r.rc(2);r.wc("ngClass",t.containerClasses),r.Pb(1),r.wc("ndcDynamicComponent",t.component)("ndcDynamicInputs",t.inputs)("ndcDynamicInjector",e.injector)("ndcDynamicOutputs",t.outputs)}}function Mi(t,e){if(1&t&&(r.fc(0),r.Tc(1,Oi,2,5,"li",14),r.ec()),2&t){const t=e.$implicit;r.Pb(1),r.wc("ngIf",!t.show||t.show())}}function Ai(t,e){if(1&t&&(r.hc(0,"ul",12),r.Tc(1,Mi,2,1,"ng-container",13),r.gc()),2&t){const t=r.rc();r.Pb(1),r.wc("ngForOf",t.toolbarButtonComponents)}}class Di extends Fe.a{constructor(t,e,i,n,s,o,a,r,c,l){super(),this.I18n=t,this.cdRef=e,this.$transitions=i,this.state=n,this.notifications=s,this.halNotification=o,this.injector=a,this.apiV3Service=r,this.boardFilters=c,this.Boards=l,this.text={button_more:this.I18n.t("js.button_more"),delete:this.I18n.t("js.button_delete"),areYouSure:this.I18n.t("js.text_are_you_sure"),deleteSuccessful:this.I18n.t("js.notice_successful_delete"),updateSuccessful:this.I18n.t("js.notice_successful_update"),unnamedBoard:this.I18n.t("js.boards.label_unnamed_board"),loadingError:"No such board found",addList:this.I18n.t("js.boards.add_list"),upsaleBoards:this.I18n.t("js.boards.upsale.teaser_text"),upsaleCheckOutLink:this.I18n.t("js.work_packages.table_configuration.upsale.check_out_link"),unnamed_list:this.I18n.t("js.boards.label_unnamed_list")},this.board$=this.apiV3Service.boards.id(this.state.params.board_id.toString()).observe(),this.isNew=!!this.state.params.isNew,this.backButtonCallback=()=>this.state.go("boards"),this.toolbarDisabled=!1,this.showToolbar=!0,this.filterAllowed=!0,this.currentPartition="-split",this.filterContainerDefinition={component:hi,inputs:{board$:this.board$}},this.boardSaver=new ki(t=>{return this.toolbarDisabled=!0,this.Boards.save(t).pipe((e=()=>this.toolbarDisabled=!1,t=>t.lift(new Ii(e))));var e}),this.toolbarButtonComponents=[{component:yi.a,containerClasses:"hidden-for-mobile"},{component:_i.a,containerClasses:"hidden-for-mobile"},{component:Ci,containerClasses:"hidden-for-mobile",show:()=>this.editable,inputs:{board$:this.board$}}]}ngOnInit(){this.Boards.loadAllBoards(),this.boardSaver.observe(Object(tt.b)(this)).subscribe(t=>{this.notifications.addSuccess(this.text.updateSuccessful)},t=>this.halNotification.handleRawError(t)),this.removeTransitionSubscription=this.$transitions.onSuccess({},t=>{const e=t.to(),i=t.params("to");this.showToolbarSaveButton=!!i.query_props,this.setPartition(e),this.cdRef.detectChanges()}),this.board$.pipe(this.untilDestroyed()).subscribe(t=>{let e=this.state.params.query_props;this.editable=t.editable,this.selectedTitle=t.name,this.boardFilters.filters.putValue(e?JSON.parse(e):t.filters),this.cdRef.detectChanges()})}ngOnDestroy(){super.ngOnDestroy(),this.removeTransitionSubscription()}changeChangesFromTitle(t){this.board$.pipe(Object(At.a)(1)).subscribe(e=>{e.name=t,e.filters=this.boardFilters.current;this.state.go(".",{isNew:!1,query_props:null},{custom:{notify:!1}}),this.boardSaver.request(e)})}updateTitleName(t){this.changeChangesFromTitle(t)}get titleEditingEnabled(){return this.editable}setPartition(t){this.currentPartition=t.data&&t.data.partition?t.data.partition:"-split"}}Di.\u0275fac=function(t){return new(t||Di)(r.bc(p.a),r.bc(r.i),r.bc(nt.TransitionService),r.bc(nt.StateService),r.bc(B.a),r.bc(U.a),r.bc(r.A),r.bc(A.a),r.bc(it),r.bc(Q.a))},Di.\u0275cmp=r.Vb({type:Di,selectors:[["ng-component"]],features:[r.Ob([wi.a,it]),r.Mb],decls:11,vars:11,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["linkClass","back-button",3,"customBackMethod",4,"ngIf"],[3,"title","inFlight","showSaveCondition","editable","onSave","onEmptySubmit"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"]],template:function(t,e){1&t&&(r.hc(0,"div",0),r.hc(1,"div",1),r.hc(2,"div",2),r.Tc(3,ji,1,1,"back-button",3),r.hc(4,"editable-toolbar-title",4),r.pc("onSave",(function(t){return e.changeChangesFromTitle(t)}))("onEmptySubmit",(function(){return e.updateTitleName("")})),r.gc(),r.Tc(5,Ai,2,1,"ul",5),r.gc(),r.gc(),r.hc(6,"div",6),r.cc(7,"ndc-dynamic",7),r.gc(),r.hc(8,"div",8),r.cc(9,"div",9),r.cc(10,"div",10),r.gc(),r.gc()),2&t&&(r.wc("ngClass",e.currentPartition),r.Pb(3),r.wc("ngIf",e.backButtonCallback),r.Pb(1),r.wc("title",e.selectedTitle)("inFlight",e.toolbarDisabled)("showSaveCondition",e.showToolbarSaveButton)("editable",e.titleEditingEnabled),r.Pb(1),r.wc("ngIf",e.showToolbar),r.Pb(2),r.wc("ndcDynamicComponent",e.filterContainerDefinition.component)("ndcDynamicInputs",e.filterContainerDefinition.inputs)("ndcDynamicOutputs",e.filterContainerDefinition.outputs)("ndcDynamicInjector",e.injector))},directives:[D.n,D.q,Ie.a,ii.c,ii.d,o.UIView,Si.a,D.p],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr)}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{overflow:auto}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   wp-resizer[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}@media only screen and (max-width:679px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:0;max-width:100vw;max-height:100%}}",".work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{overflow:hidden}"],changeDetection:0});var Ri=i("xFOf");const Ti=["container"];function qi(t,e){1&t&&r.cc(0,"span",10)}function Fi(t,e){if(1&t){const t=r.ic();r.hc(0,"div",7),r.Tc(1,qi,1,0,"span",8),r.hc(2,"board-list",9),r.pc("onRemove",(function(){r.Lc(t);const i=e.$implicit,n=r.rc(2).ngIf;return r.rc().removeList(n,i)})),r.gc(),r.gc()}if(2&t){const t=e.$implicit,i=r.rc(2).ngIf,n=r.rc();r.wc("cdkDragData",t)("vsDragScrollContainer",n._container),r.Pb(1),r.wc("ngIf",i.editable),r.Pb(1),r.wc("resource",t)("board",i)}}function Vi(t,e){if(1&t){const t=r.ic();r.hc(0,"div",11),r.pc("click",(function(){r.Lc(t);const e=r.rc(2).ngIf;return r.rc().addList(e)})),r.hc(1,"div",12),r.cc(2,"op-icon",13),r.cc(3,"span",14),r.gc(),r.gc()}if(2&t){const t=r.rc(3);r.Pb(3),r.wc("textContent",t.text.addList)}}const Li=function(t){return{"-free":t}};function Bi(t,e){if(1&t){const t=r.ic();r.hc(0,"div",3,4),r.pc("cdkDropListDropped",(function(e){r.Lc(t);const i=r.rc().ngIf;return r.rc().moveList(i,e)})),r.Tc(2,Fi,3,5,"div",5),r.Tc(3,Vi,4,1,"div",6),r.gc()}if(2&t){const t=r.rc().ngIf,e=r.rc();r.wc("ngClass",r.Bc(5,Li,t.isFree))("cdkDropListDisabled",!t.editable),r.Pb(2),r.wc("ngForOf",t.queries)("ngForTrackBy",e.trackByQueryId),r.Pb(1),r.wc("ngIf",t.editable)}}function $i(t,e){if(1&t&&r.cc(0,"enterprise-banner",15),2&t){const t=r.rc().ngIf,e=r.rc();r.wc("leftMargin",!0)("linkMessage",e.text.upsaleCheckOutLink)("textMessage",e.text.upsaleBoards)("opReferrer",e.opReferrer(t))}}function Ei(t,e){if(1&t&&(r.fc(0),r.Tc(1,Bi,4,7,"div",1),r.Tc(2,$i,1,4,"enterprise-banner",2),r.ec()),2&t){const t=r.rc();r.Pb(1),r.wc("ngIf",t.showBoardListView()),r.Pb(1),r.wc("ngIf",!t.showBoardListView())}}class Ni extends Fe.a{constructor(t,e,i,n,s,o,a,r,c,l,d,h,u,b,p){super(),this.I18n=t,this.state=e,this.notifications=i,this.halNotification=n,this.boardComponent=s,this.BoardList=o,this.boardActionRegistry=a,this.opModalService=r,this.injector=c,this.apiV3Service=l,this.Boards=d,this.Banner=h,this.boardListCrossSelectionService=u,this.Drag=b,this.QueryUpdated=p,this.text={button_more:this.I18n.t("js.button_more"),delete:this.I18n.t("js.button_delete"),areYouSure:this.I18n.t("js.text_are_you_sure"),deleteSuccessful:this.I18n.t("js.notice_successful_delete"),updateSuccessful:this.I18n.t("js.notice_successful_update"),loadingError:"No such board found",addList:this.I18n.t("js.boards.add_list"),upsaleBoards:this.I18n.t("js.boards.upsale.teaser_text"),upsaleCheckOutLink:this.I18n.t("js.work_packages.table_configuration.upsale.check_out_link"),unnamed_list:this.I18n.t("js.boards.label_unnamed_list")},this.trackByQueryId=(t,e)=>e.options.queryId}set container(t){void 0!==t&&(void 0===this._container&&this.Drag.addScrollContainer(t.nativeElement),setTimeout(()=>this._container=t.nativeElement))}ngOnInit(){const t=this.state.params.board_id.toString();this.board$=this.apiV3Service.boards.id(t).requireAndStream(),this.Boards.currentBoard$.next(t),this.board$.pipe(this.untilDestroyed()).subscribe(t=>{this.setupQueryUpdatedMonitoring(t)}),this.boardListCrossSelectionService.selections().pipe(this.untilDestroyed(),Object(at.a)(t=>null!==t.focusedWorkPackage),Object(at.a)(()=>this.state.includes(this.state.current.data.baseRoute+".details"))).subscribe(t=>{this.state.go(this.state.current.data.baseRoute+".details",{workPackageId:t.focusedWorkPackage})})}moveList(t,e){Object(ui.h)(t.queries,e.previousIndex,e.currentIndex),this.saveBoard(t)}removeList(t,e){t.removeQuery(e),this.saveBoard(t)}addList(t){if(t.isFree)return this.BoardList.addFreeQuery(t,{name:this.text.unnamed_list}).then(t=>this.Boards.save(t).toPromise()).catch(t=>this.showError(t));{const e=this.getActionFiltersFromWidget(t);this.opModalService.show(ai,this.injector,{board:t,active:e})}}showBoardListView(){return!this.Banner.eeShowBanners}opReferrer(t){return t.isFree?"boards#free":"boards#status"}saveBoard(t){this.boardComponent.boardSaver.request(t)}setupQueryUpdatedMonitoring(t){this.currentQueryUpdatedMonitoring&&this.currentQueryUpdatedMonitoring.unsubscribe(),this.currentQueryUpdatedMonitoring=this.QueryUpdated.monitor(t.queries.map(t=>t.options.queryId)).pipe(this.untilDestroyed()).subscribe(t=>this.requestRefreshOfUpdatedLists(t.elements))}showError(t=this.text.loadingError){this.notifications.addError(t)}requestRefreshOfUpdatedLists(t){t.forEach(t=>{this.lists.filter(e=>t.id.toString()===e.resource.options.queryId.toString()).forEach(e=>e.refreshQueryUnlessCaused(t,!1))})}getActionFiltersFromWidget(t){return t.grid.widgets.map(e=>{const i=this.boardActionRegistry.get(t.actionAttribute).filterName,n=e.options,s=_.find(n.filters,t=>!!t[i]);if(s)return s[i].values[0]||null}).filter(t=>void 0!==t)}}Ni.\u0275fac=function(t){return new(t||Ni)(r.bc(p.a),r.bc(nt.StateService),r.bc(B.a),r.bc(U.a),r.bc(Di),r.bc(jt.a),r.bc(z.a),r.bc(J.b),r.bc(r.A),r.bc(A.a),r.bc(Q.a),r.bc(Te.a),r.bc(rt),r.bc(wi.a),r.bc(Kt))},Ni.\u0275cmp=r.Vb({type:Ni,selectors:[["ng-component"]],viewQuery:function(t,e){var i;(1&t&&(r.ad(Ti,!0),r.ad(Ct,!0)),2&t)&&(r.Ic(i=r.qc())&&(e.container=i.first),r.Ic(i=r.qc())&&(e.lists=i))},features:[r.Ob([rt]),r.Mb],decls:2,vars:3,consts:[[4,"ngIf"],["class","boards-list--container","cdkDropList","","cdkDropListOrientation","horizontal",3,"ngClass","cdkDropListDisabled","cdkDropListDropped",4,"ngIf"],[3,"leftMargin","linkMessage","textMessage","opReferrer",4,"ngIf"],["cdkDropList","","cdkDropListOrientation","horizontal",1,"boards-list--container",3,"ngClass","cdkDropListDisabled","cdkDropListDropped"],["container",""],["class","boards-list--item","wp-isolated-query-space","","cdkDrag","","vsDragScroll","",3,"cdkDragData","vsDragScrollContainer",4,"ngFor","ngForOf","ngForTrackBy"],["class","boards-list--add-item -no-text-select",3,"click",4,"ngIf"],["wp-isolated-query-space","","cdkDrag","","vsDragScroll","",1,"boards-list--item",3,"cdkDragData","vsDragScrollContainer"],["class","boards-list-item-handle icon icon-drag-handle","cdkDragHandle","",4,"ngIf"],[3,"resource","board","onRemove"],["cdkDragHandle","",1,"boards-list-item-handle","icon","icon-drag-handle"],[1,"boards-list--add-item","-no-text-select",3,"click"],[1,"boards-list--add-item-text"],["icon-classes","icon-add icon-context"],[3,"textContent"],[3,"leftMargin","linkMessage","textMessage","opReferrer"]],template:function(t,e){1&t&&(r.Tc(0,Ei,3,2,"ng-container",0),r.sc(1,"async")),2&t&&r.wc("ngIf",r.tc(1,1,e.board$))},directives:[D.q,ui.e,D.n,D.p,be.a,ui.a,mi,Ct,ui.b,Le.a,Ri.a],pipes:[D.a],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.boards-list--container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap;flex-grow:1;height:100%;overflow-y:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.boards-list--container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.boards-list--container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.boards-list--container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.boards-list--container[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.boards-list--container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.boards-list-item-handle[_ngcontent-%COMP%]{position:absolute;font-size:14px;left:0;top:18px;z-index:100;opacity:0;cursor:grab}.boards-list--container.-free[_ngcontent-%COMP%]   .boards-list-item-handle[_ngcontent-%COMP%]{top:13px}.boards-list-item-handle[_ngcontent-%COMP%]:before{padding:0;color:var(--light-gray)}.boards-list--item[_ngcontent-%COMP%]:hover   .boards-list-item-handle[_ngcontent-%COMP%]{opacity:1}.boards-list--add-item[_ngcontent-%COMP%]{flex:0 0 auto;height:42px;line-height:42px;font-size:14px;cursor:pointer;color:var(--gray-dark)}.boards-list--add-item[_ngcontent-%COMP%]   .boards-list--add-item-text[_ngcontent-%COMP%]{padding:5px 15px 0}.boards-list--container.-free[_ngcontent-%COMP%]   .boards-list--add-item[_ngcontent-%COMP%]{margin-top:0}.boards-list--add-item[_ngcontent-%COMP%]:hover{color:var(--body-font-color)}.boards-list--item[_ngcontent-%COMP%]{flex:0 0 300px;max-width:300px;position:relative}.boards-list--item[_ngcontent-%COMP%]:first-of-type{margin-left:5px}.boards-list--item.cdk-drag-placeholder[_ngcontent-%COMP%]{border:1px dashed var(--primary-color);pointer-events:none}.boards-list--item.cdk-drag-placeholder[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{visibility:hidden}"]});var Wi=i("/qfM"),Qi=i("PwL/");const Hi="board-view-menu-item",Ui=[{name:"boards",parent:"root",url:"/boards/?query_props",data:{bodyClasses:"router--boards-view-base",menuItem:Hi},params:{query_props:{type:"opQueryString",dynamic:!0}},redirectTo:"boards.list",component:pe},{name:"boards.list",component:Ke,data:{parent:"boards",bodyClasses:"router--boards-list-view",menuItem:Hi}},{name:"boards.partitioned",url:"{board_id}",params:{board_id:{type:"int"},isNew:{type:"bool",inherit:!1,dynamic:!0}},data:{parent:"boards",bodyClasses:"router--boards-full-view",menuItem:Hi},reloadOnSearch:!1,component:Di,redirectTo:"boards.partitioned.show"},{name:"boards.partitioned.show",url:"",data:{baseRoute:"boards.partitioned.show"},views:{"content-left":{component:Ni}}},...Object(Wi.a)("boards.partitioned.show",Hi,Qi.a)];var zi=i("+rOU"),Xi=i("vxfF"),Ji=i("1EAr"),Yi=i("ximh"),Zi=i("ecJW"),Ki=i("RN/J"),Gi=i("th4C"),tn=i("oUDv"),en=i("2hMx"),nn=i("+1L4"),sn=i("cJ7v"),on=i("lmKF"),an=i("v9+U"),rn=i("mRSd"),cn=i("X4Sm"),ln=i("lfQJ"),dn=i("8h6p"),hn=i("IYP9"),un=i("upbp"),bn=i("gh2L"),pn=i("jQQo"),gn=i("S8rk"),fn=i("V0Il"),mn=i("lmDM"),vn=i("72oW"),wn=i("CVKj"),yn=i("SIjI"),_n=i("ZTEj"),Cn=i("70hh"),kn=i("f24R"),xn=i("2orT"),In=i("Eofd"),Pn=i("m3nR"),Sn=i("ZAVI"),jn=i("9pt+"),On=i("S2zE"),Mn=i("eJFM"),An=i("sngl"),Dn=i("byj5"),Rn=i("2TbE"),Tn=i("XZlt"),qn=i("2bW2"),Fn=i("aveh");class Vn{}Vn.\u0275mod=r.Zb({type:Vn}),Vn.\u0275inj=r.Yb({factory:function(t){return new(t||Vn)},imports:[[n.a,s.a,vi,ii.f.withComponents([Qt]),o.UIRouterModule.forChild({states:Ui,config:function(t){t.urlService.rules.when(new RegExp("^/projects/(.*)/boards$"),t=>`/projects/${t[1]}/boards/`)}})]]}),r.Pc(Ct,[o.UISref,o.AnchorUISref,o.UIView,o.UISrefActive,o.UISrefStatus,D.n,D.o,D.p,D.q,D.x,D.t,D.u,D.v,D.w,D.r,D.s,kt.C,kt.r,kt.B,kt.c,kt.s,kt.v,kt.a,kt.y,kt.z,kt.u,kt.m,kt.n,kt.x,kt.k,kt.j,kt.t,kt.b,kt.d,kt.p,kt.q,kt.o,zi.a,zi.b,zi.h,zi.e,Xi.a,ui.e,ui.f,ui.a,ui.b,ui.d,ui.c,Se.a,Ji.a,Ee.a,x.a,x.n,x.d,x.c,x.e,x.f,x.g,x.h,x.i,x.j,x.k,x.l,x.m,Yi.a,Zi.a,$e.a,Le.a,Ki.a,Gi.a,tn.a,en.a,nn.a,sn.a,on.a,Be.a,an.a,rn.a,cn.a,_i.a,ln.a,Y.a,dn.a,hn.a,un.a,Ie.a,Gt.a,Ri.a,ii.c,ii.d,ii.a,ii.b,ii.e,bn.a,pn.a,gn.a,fn.a,mn.a,vn.a,wn.a,N.a,yn.a,yi.a,di.a,be.a,_n.a,Cn.a,kn.a,xn.a,In.a,Pn.a,Sn.a,jn.a,On.a,Mn.a,An.a,Dn.a,Rn.a,Tn.a,qn.a,Fn.a,Qi.a,Si.a,mi,Ke,Di,Ni,Ct,pe,q,Ge.a,xt,xe,Pe,Ci,Re,ai,ri,K,hi,Qt,ie,ae,de,qt,Oe],[D.a,D.C,D.m,D.j,D.A,D.f,D.z,D.B,D.c,D.e,D.h,D.i,D.k])}}]);
//# sourceMappingURL=boards-openproject-boards-module.1b97dc35822f9a88975b.js.map