(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{"+1L4":function(e,t,i){"use strict";i.d(t,"b",(function(){return l})),i.d(t,"a",(function(){return d}));var n=i("d/TE"),s=i("AEvm"),r=i("fXoL"),a=i("ofXK"),c=i("cJ7v");function o(e,t){if(1&e&&r.cc(0,"notification",3),2&e){const e=t.$implicit;r.wc("notification",e)}}const l="notifications-container";class d extends s.a{constructor(e,t){super(),this.notificationsService=e,this.cdRef=t,this.stack=[]}ngOnInit(){this.notificationsService.current.values$("Subscribing to changes in the notification stack").pipe(this.untilDestroyed()).subscribe(e=>{this.stack=e,this.cdRef.detectChanges()})}}d.\u0275fac=function(e){return new(e||d)(r.bc(n.a),r.bc(r.i))},d.\u0275cmp=r.Vb({type:d,selectors:[["notifications-container"]],features:[r.Mb],decls:3,vars:1,consts:[[1,"notification-box--wrapper"],[1,"notification-box--casing"],[3,"notification",4,"ngFor","ngForOf"],[3,"notification"]],template:function(e,t){1&e&&(r.hc(0,"div",0),r.hc(1,"div",1),r.Tc(2,o,1,1,"notification",2),r.gc(),r.gc()),2&e&&(r.Pb(2),r.wc("ngForOf",t.stack))},directives:[a.p,c.a],encapsulation:2,changeDetection:0})},"+B5R":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("4lR/"),s=i("PUHT"),r=i("wZYP"),a=i("Va5K"),c=i("PtkW"),o=i("fXoL");class l extends s.a{constructor(e,t,i,n,s){super(e,t),this.elementRef=e,this.opContextMenu=t,this.I18n=i,this.wpDisplayRepresentationService=n,this.wpTableTimeline=s}open(e){this.buildItems(),this.opContextMenu.show(this,e)}get locals(){return{items:this.items,contextMenuId:"wp-view-context-menu"}}buildItems(){this.items=[],this.wpDisplayRepresentationService.current!==a.b&&this.items.push({linkText:this.I18n.t("js.views.card"),icon:"icon-view-card",onClick:e=>(this.wpDisplayRepresentationService.setDisplayRepresentation(a.b),this.wpTableTimeline.isVisible&&this.wpTableTimeline.toggle(),!0)}),(this.wpTableTimeline.isVisible||this.wpDisplayRepresentationService.current===a.b)&&this.items.push({linkText:this.I18n.t("js.views.list"),icon:"icon-view-list",onClick:e=>(this.wpDisplayRepresentationService.setDisplayRepresentation(a.c),this.wpTableTimeline.isVisible&&this.wpTableTimeline.toggle(),!0)}),this.wpTableTimeline.isVisible&&this.wpDisplayRepresentationService.current!==a.b||this.items.push({linkText:this.I18n.t("js.views.timeline"),icon:"icon-view-timeline",onClick:e=>(this.wpTableTimeline.isVisible||this.wpTableTimeline.toggle(),this.wpDisplayRepresentationService.setDisplayRepresentation(a.c),!0)})}}l.\u0275fac=function(e){return new(e||l)(o.bc(o.q),o.bc(n.a),o.bc(r.a),o.bc(a.a),o.bc(c.a))},l.\u0275dir=o.Wb({type:l,selectors:[["","wpViewDropdown",""]],features:[o.Mb]})},"+NA0":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("GntA"),s=i("7bpi");class r extends n.a{setValue(e,t){super.setValue(e,t),"project"!==e&&"type"!==e||this.updateForm()}applyChanges(e){return delete e.description,super.applyChanges(e)}setNewDefaultFor(e,t){"description"===e&&this.pristineResource.isNew?this.pristineResource.description=t:super.setNewDefaultFor(e,t)}get schema(){return this.form$.hasValue()?s.a.create(super.schema,this.projectedResource):super.schema}}},"+oAL":function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var n=i("iMRi"),s=i("W6hW"),r=i("Kg8T"),a=i("E2tj"),c=i("2Qcm"),o=i("IzEk"),l=i("Uyc6"),d=i("Va5K"),u=i("EnRq"),h=i("JY8V"),p=i("6yP5"),g=i("ONn1"),f=i("wyKs"),b=i("Zq3F"),m=i("PtkW"),w=i("AeZM"),v=i("F5Dh"),y=i("FB4C"),k=i("CNq7"),C=i("1RU0"),j=i("fXoL");class P{constructor(e,t,i,n,s,r,a,c,o,l,d,u,h,p,g,f,b,m,w){this.states=e,this.querySpace=t,this.wpTableColumns=i,this.wpTableGroupBy=n,this.wpTableGroupFold=s,this.wpTableSortBy=r,this.wpTableFilters=a,this.wpTableSum=c,this.wpTableTimeline=o,this.wpTableHierarchies=l,this.wpTableHighlighting=d,this.wpTableRelationColumns=u,this.wpTablePagination=h,this.wpTableOrder=p,this.wpTableAdditionalElements=g,this.apiV3Service=f,this.wpListChecksumService=b,this.authorisationService=m,this.wpDisplayRepresentation=w}initialize(e,t){this.clearStates(),this.querySpace.query.putValue(e),this.initializeFromQuery(e,t),this.updateQuerySpace(e,t),this.updateChecksum(e,t)}updateStatesFromForm(e,t){let i=t.schema;_.each(i.filtersSchemas.elements,e=>{this.states.schemas.get(e.$href).putValue(e)}),this.wpTableFilters.initializeFilters(e,i),this.querySpace.queryForm.putValue(t),this.states.queries.columns.putValue(i.columns.allowedValues),this.states.queries.sortBy.putValue(i.sortBy.allowedValues),this.states.queries.groupBy.putValue(i.groupBy.allowedValues),this.states.queries.displayRepresentation.putValue(i.displayRepresentation.allowedValues)}updateQuerySpace(e,t){this.querySpace.additionalRequiredWorkPackages.clear("Clearing additional WPs before updating rows"),this.querySpace.tableRendered.clear("Clearing rendered data before upgrading query space"),t.schemas&&_.each(t.schemas.elements,e=>{this.states.schemas.get(e.href).putValue(e)}),this.querySpace.query.putValue(e),this.authorisationService.initModelAuth("work_packages",t.$links),t.elements.forEach(e=>this.apiV3Service.work_packages.cache.updateWorkPackage(e,!0)),this.querySpace.results.putValue(t),this.querySpace.groups.putValue(t.groups),this.wpTablePagination.initialize(e,t),this.wpTableRelationColumns.initialize(e,t),this.wpTableAdditionalElements.initialize(e,t),this.wpTableOrder.initialize(e,t),this.wpDisplayRepresentation.initialize(e,t),this.querySpace.additionalRequiredWorkPackages.values$().pipe(Object(o.a)(1)).subscribe(()=>this.querySpace.initialized.putValue(null))}updateChecksum(e,t){this.wpListChecksumService.updateIfDifferent(this.querySpace.query.value,this.wpTablePagination.current),this.authorisationService.initModelAuth("work_packages",t.$links)}initializeFromQuery(e,t){this.querySpace.query.putValue(e),this.wpTableSum.initialize(e),this.wpTableColumns.initialize(e,t),this.wpTableSortBy.initialize(e,t),this.wpTableGroupBy.initialize(e,t),this.wpTableGroupFold.initialize(e,t),this.wpTableTimeline.initialize(e,t),this.wpTableHierarchies.initialize(e,t),this.wpTableHighlighting.initialize(e,t),this.wpDisplayRepresentation.initialize(e,t),this.authorisationService.initModelAuth("query",e.$links),this.authorisationService.initModelAuth("work_packages",t.$links)}applyToQuery(e){this.wpTableFilters.applyToQuery(e),this.wpTableSum.applyToQuery(e),this.wpTableColumns.applyToQuery(e),this.wpTableSortBy.applyToQuery(e),this.wpTableGroupBy.applyToQuery(e),this.wpTableGroupFold.applyToQuery(e),this.wpTableTimeline.applyToQuery(e),this.wpTableHighlighting.applyToQuery(e),this.wpTableHierarchies.applyToQuery(e),this.wpTableOrder.applyToQuery(e),this.wpDisplayRepresentation.applyToQuery(e)}clearStates(){const e="Clearing states before re-initialization.";this.querySpace.initialized.clear(e),this.querySpace.query.clear(e),this.querySpace.results.clear(e),this.querySpace.groups.clear(e),this.querySpace.additionalRequiredWorkPackages.clear(e),this.wpTableFilters.clear(e),this.wpTableColumns.clear(e),this.wpTableSortBy.clear(e),this.wpTableGroupBy.clear(e),this.wpTableGroupFold.clear(e),this.wpDisplayRepresentation.clear(e),this.wpTableSum.clear(e),this.querySpace.tableRendered.clear(e)}}P.\u0275fac=function(e){return new(e||P)(j.lc(n.a),j.lc(a.a),j.lc(h.a),j.lc(w.a),j.lc(C.a),j.lc(p.a),j.lc(v.a),j.lc(u.a),j.lc(m.a),j.lc(f.a),j.lc(c.a),j.lc(y.a),j.lc(b.a),j.lc(l.a),j.lc(g.a),j.lc(k.a),j.lc(s.a),j.lc(r.a),j.lc(d.a))},P.\u0275prov=j.Xb({token:P,factory:P.\u0275fac})},"+pCT":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));i("y2Tr");var n=i("wZYP"),s=i("fXoL"),r=i("ofXK");function a(e,t){if(1&e&&s.cc(0,"a",2),2&e){const e=s.rc();s.wc("textContent",e.name),s.Qb("href",e.href,s.Oc)("title",e.label)}}function c(e,t){if(1&e&&(s.fc(0),s.Vc(1),s.dc(2),s.ec()),2&e){const e=s.rc();s.Pb(1),s.Xc(" ",e.name," ")}}class o{constructor(e){this.I18n=e}get href(){return this.user&&this.user.showUserPath}get name(){return this.user&&this.user.name}get label(){return this.I18n.t("js.label_author",{user:this.name})}}o.\u0275fac=function(e){return new(e||o)(s.bc(n.a))},o.\u0275cmp=s.Vb({type:o,selectors:[["user-link"]],inputs:{user:"user"},decls:2,vars:2,consts:[[3,"textContent",4,"ngIf"],[4,"ngIf"],[3,"textContent"]],template:function(e,t){1&e&&(s.Tc(0,a,1,3,"a",0),s.Tc(1,c,3,1,"ng-container",1)),2&e&&(s.wc("ngIf",t.href),s.Pb(1),s.wc("ngIf",!t.href))},directives:[r.q],encapsulation:2,changeDetection:0})},"+ytV":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("711n"),s=i("fXoL");class r{constructor(e,t){this.wpeditForm=e,this.elementRef=t}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement)}activate(e){if(jQuery(e.target).closest(".help-text--entry").length)return!0;const t=this.wpeditForm.fields[this.fieldName];return t&&t.handleUserActivate(null),!1}}r.\u0275fac=function(e){return new(e||r)(s.bc(n.a),s.bc(s.q))},r.\u0275cmp=s.Vb({type:r,selectors:[["wp-replacement-label"]],inputs:{fieldName:"fieldName"},ngContentSelectors:["*"],decls:2,vars:0,consts:[["tabindex","-1",1,"wp-replacement-label",3,"click"]],template:function(e,t){1&e&&(s.vc(),s.hc(0,"span",0),s.pc("click",(function(e){return t.activate(e)})),s.uc(1),s.gc())},encapsulation:2})},"/8SZ":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("hxxE");class s extends n.a{$initialize(e){super.$initialize(e),this.elements=this.elements||[]}}},"/C7M":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("XNiG"),s=i("pLZG"),r=i("p9/F"),a=i("Kj3r"),c=i("fXoL");class o{constructor(){this._events=new n.a,this.events$=this._events.asObservable()}aggregated$(e,t=500){return this.events$.pipe(Object(s.a)(t=>t.resourceType===e),Object(r.a)(this.events$.pipe(Object(a.a)(t))))}push(e,t){t.id=e.id,t.resourceType=e._type,this._events.next(t)}}o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=c.Xb({token:o,factory:o.\u0275fac,providedIn:"root"})},"/Rze":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("fXoL"),s=i("ofXK"),r=i("kor4");class a{constructor(){this.execute=new n.s}handleClick(e){return this.isDisabled||this.execute.emit(e),!1}}a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=n.Vb({type:a,selectors:[["accessible-by-keyboard"]],inputs:{isDisabled:"isDisabled",linkClass:"linkClass",linkTitle:"linkTitle",spanClass:"spanClass",linkAriaLabel:"linkAriaLabel"},outputs:{execute:"execute"},ngContentSelectors:["*"],decls:3,vars:5,consts:[["role","link","href","",3,"ngClass","accessibleClick"],[3,"ngClass"]],template:function(e,t){1&e&&(n.vc(),n.hc(0,"a",0),n.pc("accessibleClick",(function(e){return t.handleClick(e)})),n.hc(1,"span",1),n.uc(2),n.gc(),n.gc()),2&e&&(n.wc("ngClass",t.linkClass),n.Qb("disabled",t.isDisabled||void 0)("title",t.linkTitle)("aria-label",t.linkAriaLabel),n.Pb(1),n.wc("ngClass",t.spanClass))},directives:[s.n,r.a],encapsulation:2})},"/cHX":function(e,t,i){"use strict";i.d(t,"e",(function(){return a})),i.d(t,"d",(function(){return c})),i.d(t,"c",(function(){return o})),i.d(t,"b",(function(){return l})),i.d(t,"a",(function(){return d}));var n=i("mrSG"),s=i("wZYP"),r=i("r0MM");const a="wp-table--context-menu-td",c="wp-table--context-menu-span",o="wp-table-context-menu-link",l="wp-table-context-menu-icon";class d{constructor(e,t){this.injector=e,this.workPackage=t}}Object(n.c)([Object(r.a)(),Object(n.e)("design:type",s.a)],d.prototype,"I18n",void 0)},"/nP/":function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return s}));const n=100;class s{constructor(e){this.menuContainer=e,this.hover=!1,this.menuIsOpen=!1,this.withHeadingFoldOutAtBorder(),this.setupDropdownClick(),this.registerEventHandlers(),this.closeOnBodyClick(),this.accessibility(),this.skipContentClickListener()}skipContentClickListener(){jQuery("#skip-navigation--content").on("click",()=>{const e=jQuery(".first-breadcrumb-element a, .toolbar-container a:first-of-type, #content a:first-of-type").not(":hidden").first();e.length&&e.trigger("focus")})}accessibility(){jQuery(".drop-down > ul").attr("aria-expanded","false")}toggleClick(e){this.menuIsOpen?this.isOpen(e)?this.closing():this.open(e):(this.opening(),this.open(e))}opening(){this.startHover(),this.menuIsOpen=!0,this.menuContainer.trigger("openedMenu",this.menuContainer)}closing(){this.stopHover(),this.closeAllItems(),this.menuIsOpen=!1,this.menuContainer.trigger("closedMenu",this.menuContainer)}stopHover(){this.hover=!1,this.menuContainer.removeClass("hover")}startHover(){this.hover=!0,this.menuContainer.addClass("hover")}closeAllItems(){this.openDropdowns().each((e,t)=>{this.close(jQuery(t))})}closeOnBodyClick(){let e=this,t=document.getElementById("wrapper");t&&t.addEventListener("click",(function(t){e.menuIsOpen&&!e.openDropdowns()[0].contains(t.target)&&e.closing()}),!0)}openDropdowns(){return this.dropdowns().filter(".open")}dropdowns(){return this.menuContainer.find("li.drop-down")}withHeadingFoldOutAtBorder(){var e;if(void 0!==this.menuContainer.next().get(0)&&"H2"===this.menuContainer.next().get(0).tagName)e=this.menuContainer.next().innerHeight()+this.menuContainer.next().position().top,this.menuContainer.find("ul.menu-drop-down-container").css({top:e});else if(this.menuContainer.next().hasClass("wiki-content")&&void 0!==this.menuContainer.next().children().next().first().get(0)&&"H1"===this.menuContainer.next().children().next().first().get(0).tagName){var t=this.menuContainer.next().children().next().first();e=t.innerHeight()+t.position().top,this.menuContainer.find("ul.menu-drop-down-container").css({top:e})}}setupDropdownClick(){var e=this;this.dropdowns().each((function(t,i){jQuery(i).click((function(){return e.toggleClick(jQuery(this)),!1})),jQuery(i).on("touchstart",(function(e){return!!jQuery(e.target).closest(".menu-drop-down-container").length||(e.preventDefault(),jQuery(this).click(),!1)}))}))}isOpen(e){return 1===e.filter(".open").length}isClosed(e){return!this.isOpen(e)}open(e){this.dontCloseWhenUsing(e),this.closeOtherItems(e),this.slideAndFocus(e,(function(){e.trigger("opened",e)}))}close(e,t){this.slideUp(e,t),e.trigger("closed",e)}closeOtherItems(e){var t=this;this.openDropdowns().each((function(i,n){jQuery(n)!==jQuery(e)&&t.close(jQuery(n),!0)}))}dontCloseWhenUsing(e){jQuery(e).find("li").click((function(e){e.stopPropagation()})),jQuery(e).bind("mousedown mouseup click",(function(e){e.stopPropagation()}))}slideAndFocus(e,t){this.slideDown(e,t),this.focusFirstInputOrLink(e)}slideDown(e,t){var i=e.find("> ul");e.addClass("open"),i.slideDown(n,t).attr("aria-expanded","true")}slideUp(e,t){var i=jQuery(e).find("> ul");e.removeClass("open"),t?i.hide():i.slideUp(n),i.attr("aria-expanded","false")}focusFirstInputOrLink(e){var t=e.find("ul :input:visible:first");0===t.length&&(t=e.find("ul a:visible:first")),t.blur(),setTimeout((function(){t.focus()}),10)}registerEventHandlers(){const e=jQuery("#main-menu-toggle");this.menuContainer.on("closeDropDown",e=>{this.close(jQuery(e.target))}).on("openDropDown",e=>{this.open(jQuery(e.target))}).on("closeMenu",()=>{this.closing()}).on("openMenu",()=>{this.open(this.dropdowns().first()),this.opening()}),e.on("click",()=>{this.closing()})}}},"/qfM":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("gvAf"),s=i("ODu2"),r=i("qs3h"),a=i("ylTo"),c=i("ZGxV"),o=i("4fM7");function l(e,t,i,l=c.a,d,u=e){return[{name:u+".details",url:"/details/{workPackageId:[0-9]+}",redirectTo:u+".details.overview",reloadOnSearch:!1,data:{bodyClasses:"router--work-packages-partitioned-split-view-details",menuItem:t,baseRoute:e,newRoute:u+".new",partition:d?"-left-only":"-split"},views:d?{"content-left@^.^":{component:i}}:{"content-right@^.^":{component:i}}},{name:u+".details.overview",url:"/overview",component:n.a,data:{baseRoute:e,menuItem:t,parent:u+".details"}},{name:u+".details.activity",url:"/activity",component:s.a,data:{baseRoute:e,menuItem:t,parent:u+".details"}},{name:u+".details.relations",url:"/relations",component:r.a,data:{baseRoute:e,menuItem:t,parent:u+".details"}},{name:u+".details.watchers",url:"/watchers",component:a.a,data:{baseRoute:e,menuItem:t,parent:u+".details"}},{name:u+".new",url:"/create_new?{type:[0-9]+}&{parent_id:[0-9]+}",reloadOnSearch:!1,data:{partition:"-split",allowMovingInEditMode:!0,bodyClasses:"router--work-packages-partitioned-split-view-new",baseRoute:e,parent:e},views:{"content-right@^.^":{component:l}}},{name:u+".copy",url:"/details/{copiedFromWorkPackageId:[0-9]+}/copy",views:{"content-right@^.^":{component:o.a}},reloadOnSearch:!1,data:{baseRoute:e,parent:e,allowMovingInEditMode:!0,bodyClasses:"router--work-packages-partitioned-split-view",menuItem:t,partition:"-split"}}]}},0:function(e,t,i){e.exports=i("zUnb")},"07mJ":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Jui0"),s=i("fXoL");class r{constructor(e){this.pathHelper=e}projectImportIssuePath(e){return this.pathHelper.projectPath(e)+"/issues/upload"}projectExportIssuesPath(e,t){return t?this.pathHelper.projectPath(e)+"/work_packages.bcf?filters="+t:this.pathHelper.projectPath(e)+"/work_packages.bcf"}snapshotPath(e){return e.href+"/snapshot"}}r.\u0275fac=function(e){return new(e||r)(s.lc(n.a))},r.\u0275prov=s.Xb({token:r,factory:r.\u0275fac})},"0Int":function(e,t,i){var n={"./af.js":["NTxu",142],"./ar.js":["sz2f",143],"./az.js":["cJhg",144],"./be.js":["ytP5",145],"./bg.js":["wq8R",146],"./bn.js":["xax0",147],"./bs.js":["Mn6t",148],"./ca.js":["bFR9",149],"./cs.js":["uT64",150],"./cy.js":["XBH+",151],"./da.js":["oqPE",152],"./de-AT.js":["WrCB",153],"./de-CH.js":["oai4",154],"./de-DE.js":["tJ4f",155],"./de.js":["iFlR",156],"./el-CY.js":["TPLK",157],"./el.js":["k48E",158],"./en-AU.js":["M4sl",159],"./en-CA.js":["xfKs",160],"./en-CY.js":["ufn/",161],"./en-GB.js":["r3/2",162],"./en-IE.js":["u1k6",163],"./en-IN.js":["8VPa",164],"./en-NZ.js":["THql",165],"./en-US.js":["KW4L",166],"./en-ZA.js":["Wc4I",167],"./en.js":["CQue",168],"./eo.js":["zj11",169],"./es-419.js":["AuO9",170],"./es-AR.js":["kEy0",171],"./es-CL.js":["ft4/",172],"./es-CO.js":["s2os",173],"./es-CR.js":["2jQJ",174],"./es-EC.js":["U6Bt",175],"./es-ES.js":["ZPhd",176],"./es-MX.js":["06FW",177],"./es-NI.js":["a+FD",178],"./es-PA.js":["QXC7",179],"./es-PE.js":["I5eF",180],"./es-US.js":["pDd2",181],"./es-VE.js":["feyl",182],"./es.js":["0MJg",183],"./et.js":["Cagy",184],"./eu.js":["J9ic",185],"./fa.js":["eWY+",186],"./fi.js":["/z4B",187],"./fil.js":["PQTg",188],"./fr-CA.js":["kmLF",189],"./fr-CH.js":["bJRw",190],"./fr-FR.js":["O+Vq",191],"./fr.js":["S399",192],"./gl.js":["GRki",193],"./he.js":["R/Q/",194],"./hi-IN.js":["zRlf",195],"./hi.js":["TOBP",196],"./hr.js":["ED+y",197],"./hu.js":["a/eb",198],"./id.js":["u8bJ",199],"./is.js":["pUlV",200],"./it-CH.js":["M295",201],"./it.js":["VfVk",202],"./ja.js":["EQXh",203],"./ka.js":["+Ljo",204],"./km.js":["WMQS",205],"./kn.js":["8qXJ",206],"./ko.js":["QfUy",207],"./lb.js":["9q38",208],"./lo.js":["AGs6",209],"./lt.js":["D+E8",210],"./lv.js":["TGF+",211],"./mg.js":["4VZG",212],"./mk.js":["VzW1",213],"./ml.js":["Nm61",214],"./mn.js":["aew7",215],"./mr-IN.js":["Ivdp",216],"./ms.js":["PIEu",217],"./nb.js":["NgvQ",218],"./ne.js":["2RGT",219],"./nl.js":["Vw9A",220],"./nn.js":["3tCn",221],"./no.js":["i6Wc",222],"./oc.js":["Peea",223],"./or.js":["7kX+",224],"./pa.js":["OB7H",225],"./pl.js":["023k",226],"./pt-BR.js":["GZMl",227],"./pt.js":["03fs",228],"./rm.js":["1n3U",229],"./ro.js":["1Oix",230],"./ru.js":["ue6V",231],"./sk.js":["QBQ5",232],"./sl.js":["0ek5",233],"./sq.js":["GouJ",234],"./sr.js":["iiJJ",235],"./sv-SE.js":["w/km",236],"./sv.js":["rcLn",237],"./sw.js":["ci3q",238],"./ta.js":["HgV+",239],"./te.js":["icKA",240],"./th.js":["Uvgq",241],"./tl.js":["VyBs",242],"./tr.js":["5nPu",243],"./tt.js":["hEsF",244],"./ug.js":["JCdo",245],"./uk.js":["4ZxZ",246],"./ur.js":["IzNn",247],"./uz.js":["2yAK",248],"./vi.js":["mhGZ",249],"./wo.js":["JViR",250],"./zh-CN.js":["L27e",251],"./zh-HK.js":["J9h6",252],"./zh-TW.js":["FEz5",253],"./zh-YUE.js":["tZgQ",254]};function s(e){if(!i.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],s=t[0];return i.e(t[1]).then((function(){return i.t(s,7)}))}s.keys=function(){return Object.keys(n)},s.id="0Int",e.exports=s},"0Usb":function(e,t,i){"use strict";i.d(t,"c",(function(){return l})),i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return u}));var n=i("mrSG"),s=i("iMRi"),r=i("pXZk"),a=i("uSJ+"),c=i("FB4C"),o=i("r0MM");const l="wp-table--relation-cell-td",d="wp-table--relation-indicator";class u{constructor(e){this.injector=e}build(e,t){const i=document.createElement("td");i.classList.add(r.c,l,t.id),i.dataset.columnId=t.id;const n=this.wpTableRelationColumns.getExpandFor(e.id)===t.id,s=this.wpRelations.state(e.id).value,a=this.wpTableRelationColumns.relationsForColumn(e,s,t),c=this.renderIndicator(),o=this.renderBadge(a);return n&&i.classList.add("-expanded"),a.length>0&&(i.appendChild(o),i.appendChild(c)),i}renderIndicator(){const e=document.createElement("span");return e.classList.add(d),e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex","0"),e}renderBadge(e){const t=document.createElement("span");return t.classList.add("wp-table--relation-count"),t.textContent=""+e.length,t.classList.add("badge","-border-only"),t}}Object(n.c)([Object(o.a)(),Object(n.e)("design:type",s.a)],u.prototype,"states",void 0),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",a.a)],u.prototype,"wpRelations",void 0),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",c.a)],u.prototype,"wpTableRelationColumns",void 0)},"0XIV":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));i("ii2/");var n=i("fXoL"),s=i("0loS");const r=function(e,t){return{workPackageId:e,"#":t}};class a{ngOnInit(){this.activityHtmlId="activity-"+this.activityNo,this.activityLabel="#"+this.activityNo}}a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=n.Vb({type:a,selectors:[["activity-link"]],inputs:{workPackage:"workPackage",activityNo:"activityNo"},decls:1,vars:6,consts:[["uiSref","work-packages.show.activity",3,"id","textContent","uiParams"]],template:function(e,t){1&e&&n.cc(0,"a",0),2&e&&(n.yc("id","",t.activityHtmlId,"-link"),n.wc("textContent",t.activityLabel)("uiParams",n.Cc(3,r,t.workPackage.id,t.activityHtmlId)))},directives:[s.AnchorUISref,s.UISref],encapsulation:2})},"0lDN":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=new(i("fXoL").z)("CONTEXT_MENU_LOCALS")},"0zio":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("wZYP"),s=i("tN7n"),r=i("ho3E"),a=i("fXoL");class c extends s.a{constructor(e,t){super(t),this.locals=e,this.I18n=t}get tabs(){const e=this.locals.disabledTabs||{};return this._tabs.map(t=>{const i=e[t.name];return null!=i&&(t.disableBecause=i),t})}}c.\u0275fac=function(e){return new(e||c)(a.lc(r.a),a.lc(n.a))},c.\u0275prov=a.Xb({token:c,factory:c.\u0275fac})},"13ri":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.isClickedWithModifier=function(e){const t=e.ctrlKey||e.shiftKey||e.metaKey,i=1===e.button;return t||i}}(n||(n={}))},"1EAr":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.stopEventPropagation=!0,this.eventHandler=new n.s}handleClick(e){return"dblclick"!==e.type&&2!==e.tapCount||(this.eventHandler.emit(e),this.eventStopReturnCode(e))}eventStopReturnCode(e){return!this.stopEventPropagation||(e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1)}}s.\u0275fac=function(e){return new(e||s)},s.\u0275dir=n.Wb({type:s,selectors:[["","doubleClickOrTap",""]],hostBindings:function(e,t){1&e&&n.pc("dblclick",(function(e){return t.handleClick(e)}))("tap",(function(e){return t.handleClick(e)}))},inputs:{stopEventPropagation:["doubleClickOrTapStopEvent","stopEventPropagation"]},outputs:{eventHandler:"doubleClickOrTap"}})},"1RU0":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("zqrF"),s=i("AeZM"),r=i("E2tj"),a=i("IzEk"),c=i("dMmB"),o=i("fXoL");class l extends n.b{constructor(e,t,i){super(e),this.querySpace=e,this.workPackageViewGroupByService=t,this.schemaCacheService=i,this.groupTypesWithHeaderCellsWhenCollapsed=["project"],this.isMilestone=e=>{var t;return null===(t=this.schemaCacheService.of(e))||void 0===t?void 0:t.isMilestone},this.wpTypesToShowInCollapsedGroupHeaders=[this.isMilestone]}get config(){return this.updatesState.getValueOr(this.getDefaultState())}get currentGroups(){return this.querySpace.groups.value}get allGroupsAreCollapsed(){return this.config.allGroupsAreCollapsed}get allGroupsAreExpanded(){return this.config.allGroupsAreExpanded}get currentGroupedBy(){return this.workPackageViewGroupByService.current}getDefaultState(){var e;return Object.assign({state:this.querySpace.collapsedGroups.value||{},allGroupsChanged:!1,lastChangedGroup:null,groupedBy:(null===(e=this.currentGroupedBy)||void 0===e?void 0:e.id)||null},this.getAllGroupsCollapsedState(this.currentGroups,this.querySpace.collapsedGroups.value))}toggleGroupCollapseState(e){const t=!this.config.state[e],i=Object.assign(Object.assign({},this.config.state),{[e]:t}),n=Object.assign(Object.assign(Object.assign({},this.config),{state:i,lastChangedGroup:e}),this.getAllGroupsCollapsedState(this.currentGroups,i));this.update(n)}setAllGroupsCollapseStateTo(e){const t=this.currentGroups.reduce((t,i)=>Object.assign(Object.assign({},t),{[i.identifier]:e}),{}),i=Object.assign(Object.assign({},this.config),{state:Object.assign(Object.assign({},this.config.state),t),lastChangedGroup:null,allGroupsAreCollapsed:e,allGroupsAreExpanded:!e,allGroupsChanged:!0});this.update(i)}getAllGroupsCollapsedState(e,t){let i=!1,n=!0;if(t&&(null==e?void 0:e.length)){const s=e[0].identifier,r=t[s],a=e.every(e=>null!=t[e.identifier]&&t[e.identifier]===t[s]);i=a&&r,n=a&&!r}return{allGroupsAreCollapsed:i,allGroupsAreExpanded:n}}initialize(e,t,i){this.querySpace.tableRendered.values$().pipe(Object(a.a)(1)).subscribe(()=>this.update(Object.assign(Object.assign({},this.config),{allGroupsChanged:!0})))}valueFromQuery(e,t){return this.getDefaultState()}applyToQuery(e){}}l.\u0275fac=function(e){return new(e||l)(o.lc(r.a),o.lc(s.a),o.lc(c.a))},l.\u0275prov=o.Xb({token:l,factory:l.\u0275fac})},"1SJX":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));i("GURL");var n=i("dMmB"),s=i("fXoL");class r{constructor(e){this.schemaCache=e}getFilterSchema(e,t){const i=t.$embedded.schema.filtersSchemas.elements;return _.find(i,t=>t.allowedFilterValue.href===e.filter.href)}mapSchemasIntoFilters(e,t){e.filters.forEach(e=>{let i=this.getFilterSchema(e,t);e.$links.schema=i.$links.self,this.schemaCache.update(e,i)})}setSchemas(e){e.elements.forEach(e=>{this.schemaCache.updateValue(e.$links.self.href,e)})}}r.\u0275fac=function(e){return new(e||r)(s.lc(n.a))},r.\u0275prov=s.Xb({token:r,factory:r.\u0275fac})},"1zMF":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("4lR/"),s=i("PUHT"),r=i("SKFm"),a=i("iMRi"),c=i("fXoL");class o extends s.a{constructor(e,t,i,n){super(e,t),this.elementRef=e,this.opContextMenu=t,this.states=i,this.halEditing=n}open(e){const t=this.states.workPackages.get("new").value;if(t){this.halEditing.changeFor(t).getForm().then(t=>{this.buildItems(t),this.opContextMenu.show(this,e)})}}positionArgs(e){let t=super.positionArgs(e);return _.assign(t,{my:"right top",at:"right bottom"}),t}buildItems(e){this.items=[];const t=e.configureForm,i=e.customFields;i&&this.items.push({href:i.href,icon:"icon-custom-fields",linkText:i.name,onClick:()=>!1}),t&&this.items.push({href:t.href,icon:"icon-settings3",linkText:t.name,onClick:()=>!1})}}o.\u0275fac=function(e){return new(e||o)(c.bc(c.q),c.bc(n.a),c.bc(a.a),c.bc(r.a))},o.\u0275dir=c.Wb({type:o,selectors:[["","wpCreateSettingsMenu",""]],features:[c.Mb]})},"2G+H":function(e,t,i){"use strict";function n(e){return(e.current.data.baseRoute||"")+".details"}i.d(t,"a",(function(){return n}))},"2Qcm":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("zqrF"),s=i("E2tj"),r=i("iMRi"),a=i("fbLK"),c=i("fXoL");class o extends n.a{constructor(e,t,i){super(i),this.states=e,this.Banners=t,this.querySpace=i}initialize(e,t,i){super.initialize(e,t,i)}shouldHighlightInline(e){return!(!this.isInline||this.Banners.eeShowBanners)&&(void 0===this.current.selectedAttributes||this.current.selectedAttributes===[]||!!_.find(this.current.selectedAttributes,t=>t.id===e))}get current(){let e=this.lastUpdatedState.getValueOr({mode:"inline"});return this.filteredValue(e)}get isInline(){return"inline"===this.current.mode}get isDisabled(){return"none"===this.current.mode}update(e){super.update(this.filteredValue(e))}valueFromQuery(e){const t={mode:e.highlightingMode||"inline",selectedAttributes:e.highlightedAttributes};return this.filteredValue(t)}hasChanged(e){return e.highlightingMode!==this.current.mode||!_.isEqual(e.highlightedAttributes,this.current.selectedAttributes)}applyToQuery(e){const t=this.current;return e.highlightingMode=t.mode,e.highlightedAttributes=t.selectedAttributes,!1}filteredValue(e){return _.isEmpty(e.selectedAttributes)&&(e.selectedAttributes=void 0),this.Banners.conditional(()=>{e.mode="none",e.selectedAttributes=void 0}),e}}o.\u0275fac=function(e){return new(e||o)(c.lc(r.a),c.lc(a.a),c.lc(s.a))},o.\u0275prov=c.Xb({token:o,factory:o.\u0275fac})},"2TbE":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("iB+3"),s=i("wZYP"),r=i("sjKJ"),a=i("Kg8T"),c=i("AEvm"),o=i("Hg4z"),l=i("fXoL"),d=i("8YXA"),u=i("N5AO"),h=i("ofXK");class p extends c.a{constructor(e,t,i,n,s,r){super(),this.$state=e,this.currentProject=t,this.authorisationService=i,this.transition=n,this.I18n=s,this.cdRef=r,this.text={createWithDropdown:this.I18n.t("js.work_packages.create.button"),createButton:this.I18n.t("js.label_work_package"),explanation:this.I18n.t("js.label_create_work_package")}}ngOnInit(){this.projectIdentifier=this.currentProject.identifier,this.authorisationService.observeUntil(Object(o.b)(this)).subscribe(()=>{this.allowed=!!this.allowedWhen.find(e=>{let[t,i]=e.split(".");return this.authorisationService.can(t,i)}),this.updateDisabledState()}),this.transitionUnregisterFn=this.transition.onSuccess({},this.updateDisabledState.bind(this))}ngOnDestroy(){super.ngOnDestroy(),this.transitionUnregisterFn()}updateDisabledState(){this.disabled=!this.allowed||this.$state.includes("**.new"),this.cdRef.detectChanges()}}p.\u0275fac=function(e){return new(e||p)(l.bc(n.StateService),l.bc(r.a),l.bc(a.a),l.bc(n.TransitionService),l.bc(s.a),l.bc(l.i))},p.\u0275cmp=l.Vb({type:p,selectors:[["wp-create-button"]],inputs:{allowedWhen:["allowed","allowedWhen"],stateName$:"stateName$"},features:[l.Mb],decls:6,vars:8,consts:[[1,"wp-create-button"],["opTypesCreateDropdown","",1,"button","-alt-highlight","add-work-package",3,"disabled","projectIdentifier","stateName","dropdownActive"],["icon-classes","button--icon icon-add"],["aria-hidden","true",1,"button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown hidden-for-mobile"]],template:function(e,t){1&e&&(l.hc(0,"div",0),l.hc(1,"button",1),l.sc(2,"async"),l.cc(3,"op-icon",2),l.cc(4,"span",3),l.cc(5,"op-icon",4),l.gc(),l.gc()),2&e&&(l.Pb(1),l.wc("disabled",t.disabled)("projectIdentifier",t.projectIdentifier)("stateName",l.tc(2,6,t.stateName$))("dropdownActive",t.allowed),l.Qb("aria-label",t.text.explanation),l.Pb(3),l.wc("textContent",t.text.createWithDropdown))},directives:[d.a,u.a],pipes:[h.a],encapsulation:2,changeDetection:0})},"2Uhg":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("kgyZ"),s=i("XNiG"),r=i("+NA0"),a=i("fXoL");class c extends n.a{constructor(e,t){super(),this.elementRef=e,this.injector=t,this.fieldName="comment",this.handler=this,this.active=!1,this.inEditMode=!1,this.inFlight=!1,this.onDestroy=new s.a}ngOnInit(){this.change=new r.a(this.workPackage)}reset(e=""){e.length>0&&(e+="\n"),this.change.setValue("comment",{raw:e})}get schema(){return{name:I18n.t("js.label_comment"),writable:!0,required:!1,type:"_comment",hasDefault:!1}}get rawComment(){return _.get(this.commentValue,"raw","")}get commentValue(){return this.change.value("comment")}handleUserCancel(){this.deactivate(!0)}activate(e){this.active=!0,this.reset(e)}deactivate(e){this.active=!1,this.onDestroy.next(),this.onDestroy.complete()}focus(){const e=this.elementRef.nativeElement.querySelector(".inplace-editing--trigger-container");e&&e.focus()}onFocusOut(){}handleUserKeydown(e,t){}isChanged(){return!1}stopPropagation(e){return!1}}c.\u0275fac=function(e){return new(e||c)(a.bc(a.q),a.bc(a.A))},c.\u0275dir=a.Wb({type:c,features:[a.Mb]})},"2bW2":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("fXoL"),s=i("wZYP"),r=i("711n"),a=i("N5AO");class c{constructor(e,t,i){this.I18n=e,this.editForm=t,this.cdRef=i,this.onSave=new n.s,this.onCancel=new n.s,this._saving=!1,this.text={save:this.I18n.t("js.button_save"),cancel:this.I18n.t("js.button_cancel")}}set saving(e){this._saving=e,this.cdRef.detectChanges()}get saving(){return this._saving}save(){this.saving||(this.saving=!0,this.editForm.submit().then(()=>{this.saving=!1,this.onSave.emit()}).catch(()=>{this.saving=!1}))}cancel(){this.editForm.cancel(),this.onCancel.emit()}}c.\u0275fac=function(e){return new(e||c)(n.bc(s.a),n.bc(r.a),n.bc(n.i))},c.\u0275cmp=n.Vb({type:c,selectors:[["wp-edit-actions-bar"]],outputs:{onSave:"onSave",onCancel:"onCancel"},decls:7,vars:3,consts:[[1,"work-packages--edit-actions"],["id","work-packages--edit-actions-save","accesskey","3",1,"button","-highlight",3,"disabled","click"],["icon-classes","button--icon icon-checkmark"],[1,"button--text",3,"textContent"],["id","work-packages--edit-actions-cancel","accesskey","7",1,"button",3,"click"],["icon-classes","button--icon icon-close"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"button",1),n.pc("click",(function(){return t.save()})),n.cc(2,"op-icon",2),n.cc(3,"span",3),n.gc(),n.hc(4,"button",4),n.pc("click",(function(){return t.cancel()})),n.cc(5,"op-icon",5),n.cc(6,"span",3),n.gc(),n.gc()),2&e&&(n.Pb(1),n.wc("disabled",t.saving),n.Pb(2),n.wc("textContent",t.text.save),n.Pb(3),n.wc("textContent",t.text.cancel))},directives:[a.a],encapsulation:2,changeDetection:0})},"2hMx":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("wZYP"),s=i("Jui0"),r=(i("Mo6U"),i("juWA")),a=i("fXoL"),c=i("ofXK");function o(e,t){if(1&e&&a.cc(0,"span",4),2&e){const e=a.rc();a.wc("textContent",e.author.name)}}function l(e,t){if(1&e&&a.cc(0,"a",4),2&e){const e=a.rc();a.wc("textContent",e.author.name),a.Qb("href",e.userLink,a.Oc)}}function d(e,t){if(1&e&&(a.hc(0,"span",5),a.cc(1,"a",4),a.gc()),2&e){const e=a.rc();a.Pb(1),a.wc("textContent",e.timeago),a.Qb("title",e.time)("href",e.activityFromPath(e.createdOnTime.format("YYYY-MM-DD")),a.Oc)}}function u(e,t){if(1&e&&a.cc(0,"span",6),2&e){const e=a.rc();a.wc("textContent",e.timeago),a.Qb("title",e.time)}}class h{constructor(e,t,i){this.PathHelper=e,this.I18n=t,this.timezoneService=i}ngOnInit(){this.createdOnTime=this.timezoneService.parseDatetime(this.createdOn),this.timeago=this.createdOnTime.fromNow(),this.time=this.createdOnTime.format("LLL"),this.userLink=this.PathHelper.userPath(this.author.idFromLink)}activityFromPath(e){var t=this.PathHelper.projectActivityPath(this.project);return e&&(t+="?from="+e),t}}h.\u0275fac=function(e){return new(e||h)(a.bc(s.a),a.bc(n.a),a.bc(r.a))},h.\u0275cmp=a.Vb({type:h,selectors:[["authoring"]],inputs:{createdOn:"createdOn",author:"author",showAuthorAsLink:"showAuthorAsLink",project:"project",activity:"activity"},decls:5,vars:4,consts:[[1,"authoring-entry"],[3,"textContent",4,"ngIf"],["class","timestamp",4,"ngIf"],["class","timestamp",3,"textContent",4,"ngIf"],[3,"textContent"],[1,"timestamp"],[1,"timestamp",3,"textContent"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.Tc(1,o,1,1,"span",1),a.Tc(2,l,1,2,"a",1),a.Tc(3,d,2,3,"span",2),a.Tc(4,u,1,2,"span",3),a.gc()),2&e&&(a.Pb(1),a.wc("ngIf",t.showAuthorAsLink),a.Pb(1),a.wc("ngIf",!t.showAuthorAsLink),a.Pb(1),a.wc("ngIf",t.activity),a.Pb(1),a.wc("ngIf",!t.activity))},directives:[c.q],styles:['.timestamp[_ngcontent-%COMP%]:before{content:" ";white-space:pre}']})},"2orT":function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));i("ii2/");var n=i("wZYP"),s=i("fXoL"),r=i("ofXK"),a=i("Eofd"),c=i("0loS");const o=function(e){return{"icon4 icon-small icon-arrow-right5":e}},l=function(e){return{workPackageId:e}};function d(e,t){if(1&e&&(s.hc(0,"li",8),s.cc(1,"a",9),s.gc()),2&e){const e=s.rc(),t=e.first,i=e.$implicit;s.wc("ngClass",s.Bc(4,o,!t)),s.Pb(1),s.wc("textContent",i.name)("uiParams",s.Bc(6,l,i.id)),s.Qb("title",i.name)}}function u(e,t){if(1&e&&(s.fc(0),s.Tc(1,d,2,8,"li",7),s.ec()),2&e){const e=t.last;s.Pb(1),s.wc("ngIf",!e)}}function h(e,t){if(1&e&&(s.fc(0),s.hc(1,"li"),s.hc(2,"span"),s.Vc(3),s.gc(),s.gc(),s.Tc(4,u,2,1,"ng-container",6),s.ec()),2&e){const e=s.rc(2);s.Pb(3),s.Xc("",e.hierarchyLabel,": "),s.Pb(1),s.wc("ngForOf",e.workPackage.ancestors)}}const p=function(e,t){return{"active-parent-select":e,"icon4 icon-small icon-arrow-right5":t}};function g(e,t){if(1&e){const e=s.ic();s.hc(0,"div",1),s.hc(1,"ul",2),s.Tc(2,h,5,2,"ng-container",3),s.hc(3,"li",4),s.hc(4,"wp-breadcrumb-parent",5),s.pc("onSwitch",(function(t){s.Lc(e);return s.rc().updateActiveInput(t)})),s.gc(),s.gc(),s.gc(),s.gc()}if(2&e){const e=s.rc();s.Pb(2),s.wc("ngIf",!e.inputActive&&e.hierarchyCount>0),s.Pb(1),s.wc("ngClass",s.Cc(3,p,e.inputActive,!e.inputActive&&e.hierarchyCount>1)),s.Pb(1),s.wc("workPackage",e.workPackage)}}class f{constructor(e){this.I18n=e,this.text={parent:this.I18n.t("js.relations_hierarchy.parent_headline"),hierarchy:this.I18n.t("js.relations_hierarchy.hierarchy_headline")},this.inputActive=!1}get hierarchyCount(){return this.workPackage.ancestors.length}get hierarchyLabel(){return 1===this.hierarchyCount?this.text.parent:this.text.hierarchy}updateActiveInput(e){this.inputActive=e}}f.\u0275fac=function(e){return new(e||f)(s.bc(n.a))},f.\u0275cmp=s.Vb({type:f,selectors:[["wp-breadcrumb"]],inputs:{workPackage:"workPackage"},decls:1,vars:1,consts:[["class","wp-breadcrumb -show",4,"ngIf"],[1,"wp-breadcrumb","-show"],[1,"breadcrumb"],[4,"ngIf"],[3,"ngClass"],[3,"workPackage","onSwitch"],[4,"ngFor","ngForOf"],["class","wp-breadcrumb--ellipsed",3,"ngClass",4,"ngIf"],[1,"wp-breadcrumb--ellipsed",3,"ngClass"],["uiSref","work-packages.show.activity",1,"breadcrumb-project-title","nocut",3,"textContent","uiParams"]],template:function(e,t){1&e&&s.Tc(0,g,5,6,"div",0),2&e&&s.wc("ngIf",t.workPackage)},directives:[r.q,r.n,a.a,r.p,c.AnchorUISref,c.UISref],styles:[".active-parent-select[_ngcontent-%COMP%]{min-width:320px}"]})},"2yvi":function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("8zkO"),s=i("wZYP"),r=(i("Mo6U"),i("kTsZ")),a=i("d/TE"),c=i("fXoL"),o=i("ofXK"),l=i("kor4"),d=i("N5AO");const u=["hiddenFileInput"],h=function(e){return{"-dragging":e}};function p(e,t){if(1&e){const e=c.ic();c.hc(0,"div",1),c.pc("drop",(function(t){c.Lc(e);return c.rc().onDropFiles(t)}))("dragover",(function(t){c.Lc(e);return c.rc().onDragOver(t)}))("dragleave",(function(t){c.Lc(e);return c.rc().onDragLeave(t)})),c.hc(1,"input",2,3),c.pc("change",(function(){c.Lc(e);return c.rc().onFilePickerChanged()})),c.gc(),c.hc(3,"div",4),c.pc("accessibleClick",(function(t){c.Lc(e);return c.rc().triggerFileInput(t)})),c.hc(4,"div",5),c.cc(5,"op-icon",6),c.hc(6,"label",7),c.Vc(7),c.cc(8,"br"),c.Vc(9),c.gc(),c.gc(),c.gc(),c.gc()}if(2&e){const e=c.rc();c.Qb("aria-label",e.text.uploadLabel),c.Pb(3),c.wc("ngClass",c.Bc(4,h,e.draggingOver)),c.Pb(4),c.Xc(" ",e.text.dropFiles," "),c.Pb(2),c.Xc(" ",e.text.dropFilesHint," ")}}class g{constructor(e,t,i,n,s){this.I18n=e,this.ConfigurationService=t,this.notificationsService=i,this.elementRef=n,this.halResourceService=s,this.draggingOver=!1,this.text={uploadLabel:e.t("js.label_add_attachments"),dropFiles:e.t("js.label_drop_files"),dropFilesHint:e.t("js.label_drop_files_hint"),foldersWarning:e.t("js.label_drop_folders_hint")}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.ConfigurationService.initialized.then(()=>this.maxFileSize=this.ConfigurationService.maximumAttachmentFileSize)}triggerFileInput(e){return this.filePicker.nativeElement.click(),e.preventDefault(),e.stopPropagation(),!1}onDropFiles(e){e.dataTransfer.dropEffect="copy",e.preventDefault(),e.stopPropagation();let t=e.dataTransfer.files,i=t?t.length:0,n=[];for(let s=0;s<i;s++)n.push(t[s]);this.uploadFiles(n),this.draggingOver=!1}onDragOver(e){this.containsFiles(e.dataTransfer)&&(e.dataTransfer.dropEffect="copy",this.draggingOver=!0),e.preventDefault(),e.stopPropagation()}onDragLeave(e){this.draggingOver=!1,e.preventDefault(),e.stopPropagation()}onFilePickerChanged(){const e=Array.from(this.filePicker.nativeElement.files);this.uploadFiles(e)}containsFiles(e){return e.types.contains?e.types.contains("Files"):e.types.indexOf("Files")>=0}uploadFiles(e){const t=(e=e||[]).length;0!==(e=this.filterFolders(e)).length?this.resource.uploadAttachments(e):t>0&&this.notificationsService.addNotice(this.text.foldersWarning)}filterFolders(e){return e.filter(e=>""!==e.type||(0!==e.size&&4096!==e.size||(console.warn(`Skipping file because of file size (${e.size}) %O`,e),!1)))}}g.\u0275fac=function(e){return new(e||g)(c.bc(s.a),c.bc(n.a),c.bc(a.a),c.bc(c.q),c.bc(r.a))},g.\u0275cmp=c.Vb({type:g,selectors:[["attachments-upload"]],viewQuery:function(e,t){var i;(1&e&&c.ad(u,!0),2&e)&&(c.Ic(i=c.qc())&&(t.filePicker=i.first))},inputs:{resource:"resource"},decls:1,vars:1,consts:[["class","wp-attachment-upload hide-when-print",3,"drop","dragover","dragleave",4,"ngIf"],[1,"wp-attachment-upload","hide-when-print",3,"drop","dragover","dragleave"],["type","file","id","attachment_files","name","attachment_files","hidden","","multiple","",3,"change"],["hiddenFileInput",""],["tabindex","0",1,"work-package--attachments--drop-box",3,"ngClass","accessibleClick"],[1,"work-package--attachments--label"],["icon-classes","icon-attachment"],["for","attachment_files"]],template:function(e,t){1&e&&c.Tc(0,p,10,6,"div",0),2&e&&c.wc("ngIf",t.resource.canAddAttachments)},directives:[o.q,o.n,l.a,d.a],encapsulation:2})},"32V0":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("fXoL"),s=(i("V4eP"),i("ofXK")),r=i("/Rze"),a=i("N5AO");function c(e,t){if(1&e){const e=n.ic();n.hc(0,"div",2),n.hc(1,"accessible-by-keyboard",3),n.pc("execute",(function(){n.Lc(e);return n.rc().save()})),n.cc(2,"op-icon",4),n.gc(),n.hc(3,"accessible-by-keyboard",5),n.pc("execute",(function(){n.Lc(e);return n.rc().cancel()})),n.cc(4,"op-icon",6),n.gc(),n.gc()}if(2&e){const e=n.rc();n.Pb(1),n.wc("linkTitle",e.saveTitle),n.Qb("disabled",e.field.required&&e.field.isEmpty()||void 0),n.Pb(1),n.wc("icon-title",e.saveTitle),n.Pb(1),n.wc("linkTitle",e.cancelTitle),n.Pb(1),n.wc("icon-title",e.cancelTitle)}}class o{constructor(){this.onSave=new n.s,this.onCancel=new n.s}save(){this.onSave.emit()}cancel(){this.onCancel.emit()}}o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=n.Vb({type:o,selectors:[["edit-field-controls"]],inputs:{cancelTitle:"cancelTitle",saveTitle:"saveTitle",field:["fieldController","field"]},outputs:{onSave:"onSave",onCancel:"onCancel"},decls:2,vars:1,consts:[[1,"inplace-edit--dashboard"],["class","inplace-edit--controls",4,"ngIf"],[1,"inplace-edit--controls"],[1,"inplace-edit--control","inplace-edit--control--save",3,"linkTitle","execute"],["icon-classes","icon-checkmark",3,"icon-title"],[1,"inplace-edit--control","inplace-edit--control--cancel",3,"linkTitle","execute"],["icon-classes","icon-close",3,"icon-title"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.Tc(1,c,5,5,"div",1),n.gc()),2&e&&(n.Pb(1),n.wc("ngIf",t.field.handler.active))},directives:[s.q,r.a,a.a],encapsulation:2})},"3VS2":function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var n=i("j93F");class s extends n.a{constructor(e,t,i){super(t,i),this.injector=e,this.id=i}}class r extends n.b{constructor(e,t,i,n){super(t,i,n),this.injector=e,this.basePath=t,this.resource=n}id(e){return new(this.resource||s)(this.injector,this.path,e)}}var a=i("mrSG"),c=i("tk/3"),o=i("6HfZ"),l=i("z6cu"),d=i("Ng29"),u=i("lJxs"),h=i("JIr8"),p=i("r0MM");class g{constructor(e,t){this.injector=e,this.resourceClass=t}get(e,t,i={}){const n={headers:i,params:new c.f({encoder:new d.a,fromObject:t}),withCredentials:!0,responseType:"json"};return this._request("get",e,n)}request(e,t,i={},n={}){if("get"===e)return this.get(t,i,n);const s={body:i||{},headers:n,withCredentials:!0,responseType:"json"};return this._request(e,t,s)}_request(e,t,i){return this.http.request(e,t,i).pipe(Object(u.a)(e=>this.deserialize(e)),Object(h.a)(i=>(console.error(`Failed to ${e} ${t}: ${i.name}`),Object(l.a)(i))))}deserialize(e){if(this.resourceClass){return new o.TypedJSON(this.resourceClass).parse(e)}return e}}Object(a.c)([Object(p.a)(),Object(a.e)("design:type",c.b)],g.prototype,"http",void 0);let f=class{};Object(a.c)([o.jsonMember,Object(a.e)("design:type",Number)],f.prototype,"project_id",void 0),Object(a.c)([o.jsonMember,Object(a.e)("design:type",String)],f.prototype,"name",void 0),f=Object(a.c)([o.jsonObject],f);var b=i("wd/R");let m=class{};Object(a.c)([Object(o.jsonArrayMember)(String),Object(a.e)("design:type",Array)],m.prototype,"topic_actions",void 0),Object(a.c)([Object(o.jsonArrayMember)(String),Object(a.e)("design:type",Array)],m.prototype,"topic_status",void 0),m=Object(a.c)([o.jsonObject],m);let w=class{};Object(a.c)([o.jsonMember,Object(a.e)("design:type",String)],w.prototype,"guid",void 0),Object(a.c)([o.jsonMember,Object(a.e)("design:type",String)],w.prototype,"topic_type",void 0),Object(a.c)([o.jsonMember,Object(a.e)("design:type",String)],w.prototype,"topic_status",void 0),Object(a.c)([o.jsonMember,Object(a.e)("design:type",String)],w.prototype,"priority",void 0),Object(a.c)([Object(o.jsonArrayMember)(String),Object(a.e)("design:type",Array)],w.prototype,"reference_links",void 0),Object(a.c)([o.jsonMember,Object(a.e)("design:type",String)],w.prototype,"title",void 0),Object(a.c)([Object(o.jsonMember)({preserveNull:!0}),Object(a.e)("design:type",Object)],w.prototype,"index",void 0),Object(a.c)([Object(o.jsonArrayMember)(String),Object(a.e)("design:type",Array)],w.prototype,"labels",void 0),Object(a.c)([Object(o.jsonMember)({deserializer:e=>b(e),serializer:e=>e.toISOString()}),Object(a.e)("design:type",Object)],w.prototype,"creation_date",void 0),Object(a.c)([o.jsonMember,Object(a.e)("design:type",String)],w.prototype,"creation_author",void 0),Object(a.c)([Object(o.jsonMember)({deserializer:e=>b(e),serializer:e=>e.toISOString()}),Object(a.e)("design:type",Object)],w.prototype,"modified_date",void 0),Object(a.c)([Object(o.jsonMember)({preserveNull:!0}),Object(a.e)("design:type",Object)],w.prototype,"modified_author",void 0),Object(a.c)([o.jsonMember,Object(a.e)("design:type",String)],w.prototype,"assigned_to",void 0),Object(a.c)([Object(o.jsonMember)({preserveNull:!0}),Object(a.e)("design:type",Object)],w.prototype,"stage",void 0),Object(a.c)([o.jsonMember,Object(a.e)("design:type",String)],w.prototype,"description",void 0),Object(a.c)([Object(o.jsonMember)({deserializer:e=>b(e),serializer:e=>e.format("YYYY-MM-DD")}),Object(a.e)("design:type",Object)],w.prototype,"due_date",void 0),Object(a.c)([o.jsonMember,Object(a.e)("design:type",m)],w.prototype,"authorization",void 0),w=Object(a.c)([o.jsonObject],w);class v extends s{constructor(){super(...arguments),this.bcfTopicService=new g(this.injector)}get(e={},t={}){return this.bcfTopicService.get(this.toPath(),e,t)}delete(e={}){return this.bcfTopicService.request("delete",this.toPath(),{},e)}}class y extends r{constructor(){super(...arguments),this.bcfTopicService=new g(this.injector)}get(e={},t={}){throw new Error("Not implemented")}post(e){return this.bcfTopicService.request("post",this.toPath(),e)}}class k extends s{constructor(){super(...arguments),this.bcfTopicService=new g(this.injector,w),this.comments=new r(this.injector,this.path,"comments"),this.viewpoints=new y(this.injector,this.path,"viewpoints",v)}get(e={},t={}){return this.bcfTopicService.get(this.toPath(),e,t)}}class C extends r{constructor(e,t,i){super(e,t,i,k),this.injector=e,this.basePath=t,this.bcfTopicService=new g(this.injector,w)}get(e={},t={}){throw new Error("Not implemented")}post(e){return this.bcfTopicService.request("post",this.toPath(),e)}}let j=class{};Object(a.c)([Object(o.jsonArrayMember)(String),Object(a.e)("design:type",Array)],j.prototype,"topic_actions",void 0),Object(a.c)([Object(o.jsonArrayMember)(String),Object(a.e)("design:type",Array)],j.prototype,"project_actions",void 0),Object(a.c)([Object(o.jsonArrayMember)(String),Object(a.e)("design:type",Array)],j.prototype,"comment_actions",void 0),j=Object(a.c)([o.jsonObject],j);class P extends s{constructor(){super(...arguments),this.bcfExtensionService=new g(this.injector,j)}get(e={},t={}){return this.bcfExtensionService.get(this.toPath(),e,t)}}class x extends s{constructor(){super(...arguments),this.bcfProjectService=new g(this.injector,f),this.topics=new C(this.injector,this.path,"topics"),this.extensions=new P(this.injector,this.path,"extensions")}get(e={},t={}){return this.bcfProjectService.get(this.toPath(),e,t)}}var S=i("fXoL");class _{constructor(e){this.injector=e,this.bcfApiVersion="2.1",this.appBasePath=window.appBasePath||"",this.bcfApiBase=`${this.appBasePath}/api/bcf/${this.bcfApiVersion}`,this.projects=new r(this.injector,this.bcfApiBase,"projects",x)}parse(e){if(!e.startsWith(this.bcfApiBase))throw new Error(`Cannot parse ${e} into BCF resource.`);const t=e.replace(this.bcfApiBase+"/","").split("/");let i=this;for(let n=0;n<t.length;n++){let e=t[n];if(e in i)i=i[e];else{if(!(i instanceof r))break;i=i.id(e)}}return i===this?void 0:i}}_.\u0275fac=function(e){return new(e||_)(S.lc(S.A))},_.\u0275prov=S.Xb({token:_,factory:_.\u0275fac,providedIn:"root"})},"3uR5":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("Jui0"),s=i("PvNn"),r=i("CNq7"),a=i("fXoL");class c{constructor(e,t,i){this.pathHelper=e,this.apiV3Service=t,this.colors=i}renderMultiple(e,t,i=!0,n=!1){const s=document.createElement("span");for(let r=0;r<t.length;r++){const e=document.createElement("span");if(n&&e.classList.add("user-avatar--multi-line"),this.render(e,t[r],i),!n&&r<t.length-1){const t=document.createElement("span");t.textContent=", ",e.appendChild(t)}s.appendChild(e)}e.appendChild(s)}render(e,t,i=!0,n="avatar-medium"){const s=this.getInitials(t.name),r=this.colors.toHsl(t.name);let a=document.createElement("div");if(a.className=n,a.classList.add("avatar-default"),a.textContent=s,a.style.background=r,e.appendChild(a),i){const i=document.createElement("span");i.textContent=t.name,e.appendChild(i)}if(!t.id)return;const c=new Image;c.className=n,c.classList.add("avatar--fallback"),c.src=this.apiV3Service.users.id(t.id).avatar.toString(),c.title=t.name,c.alt=t.name,c.onload=function(){a.replaceWith(c),a=void 0}}getInitials(e){var t,i;let n=[...e],s=e.lastIndexOf(" ");return[null===(t=n[0])||void 0===t?void 0:t.toUpperCase(),null===(i=e[s+1])||void 0===i?void 0:i.toUpperCase()].join("")}}c.\u0275fac=function(e){return new(e||c)(a.lc(n.a),a.lc(r.a),a.lc(s.a))},c.\u0275prov=a.Xb({token:c,factory:c.\u0275fac,providedIn:"root"})},"4EDS":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n,s=i("Mo6U");!function(e){function t(e){return(t,i)=>!t&&!i||!!t&&!!i&&t[e]===i[e]}function i(e,t){return!e&&!t||!!e&&!!t&&e.$href===t.$href}e.halHref=function(e,t){return t.$href},e.compareByName=function(e,i){return t("name")(e,i)},e.compareByAttribute=t,e.trackByName=function(e,t){return _.get(t,"name")},e.trackByHref=function(e,t){return _.get(t,"href")},e.trackByProperty=function(e){return(t,i)=>_.get(i,e)},e.trackByHrefAndProperty=function(e){return(t,i)=>{let n=_.get(i,"href"),s=_.get(i,e,"none");return`${n}#${e}=${s}`}},e.trackByTrackingIdentifier=function(e,t){return _.get(t,"trackingIdentifier",t&&t.href)},e.compareByHref=i,e.compareByHrefOrString=function(e,t){return e instanceof s.a&&t instanceof s.a?i(e,t):!e&&!t||e===t}}(n||(n={}))},"4Obc":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));i("ii2/");var n=i("4zHP"),s=i("4EDS"),r=i("fXoL"),a=i("vd15"),c=i("ofXK"),o=i("Tcty");function l(e,t){if(1&e&&(r.hc(0,"div",3),r.cc(1,"activity-entry",4),r.gc()),2&e){const e=t.$implicit,i=r.rc(2);r.Pb(1),r.wc("workPackage",i.workPackage)("activity",e.activity)("activityNo",e.number(e.isReversed))("isInitial",e.isInitial())}}function d(e,t){if(1&e&&(r.hc(0,"div",1),r.Tc(1,l,2,4,"div",2),r.gc()),2&e){const e=r.rc();r.Pb(1),r.wc("ngForOf",e.latestActivityInfo)("ngForTrackBy",e.trackByHref)}}class u extends n.a{constructor(){super(...arguments),this.latestActivityInfo=[],this.trackByHref=s.a.trackByProperty("identifier")}ngOnInit(){this.workPackageId=this.workPackage.id,super.ngOnInit()}shouldShowToggler(){return!1}updateActivities(e){super.updateActivities(e),this.latestActivityInfo=this.latestActivities()}latestActivities(e=3){if(this.reverse){return this.unfilteredActivities.slice(0,e).map((e,t)=>this.info(e,t))}{let t=this.unfilteredActivities.slice(-e),i=this.unfilteredActivities.length-t.length;return t.map((e,t)=>this.info(e,i+t))}}}u.\u0275fac=function(e){return h(e||u)},u.\u0275cmp=r.Vb({type:u,selectors:[["newest-activity-on-overview"]],inputs:{workPackage:"workPackage"},features:[r.Mb],decls:2,vars:1,consts:[[3,"workPackage"],[1,"work-package-details-activities-list"],["class","work-package-details-activities-activity",4,"ngFor","ngForOf","ngForTrackBy"],[1,"work-package-details-activities-activity"],[3,"workPackage","activity","activityNo","isInitial"]],template:function(e,t){1&e&&(r.hc(0,"work-package-comment",0),r.Tc(1,d,2,2,"ng-template"),r.gc()),2&e&&r.wc("workPackage",t.workPackage)},directives:[a.a,c.p,o.a],encapsulation:2,changeDetection:0});const h=r.jc(u)},"4fM7":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("Nolp"),s=i("fXoL"),r=i("ofXK"),a=i("711n"),c=i("XZlt"),o=i("aveh"),l=i("2bW2"),d=i("f24R");const u=function(){return["status","type"]};function h(e,t){if(1&e){const e=s.ic();s.hc(0,"div",1),s.hc(1,"edit-form",2),s.pc("onSaved",(function(t){s.Lc(e);return s.rc().onSaved(t)})),s.hc(2,"div",3),s.hc(3,"div",4),s.cc(4,"wp-type-status",5),s.hc(5,"div",6),s.hc(6,"a",7),s.pc("click",(function(){s.Lc(e);return s.rc().switchToFullscreen()})),s.cc(7,"span",8),s.gc(),s.gc(),s.gc(),s.cc(8,"wp-single-view",9),s.gc(),s.hc(9,"div",10),s.hc(10,"wp-edit-actions-bar",11),s.pc("onCancel",(function(){s.Lc(e);return s.rc().cancelAndBackToList()})),s.gc(),s.gc(),s.hc(11,"div",12),s.cc(12,"wp-resizer",13),s.gc(),s.gc(),s.gc()}if(2&e){const e=s.rc();s.Pb(1),s.wc("resource",e.newWorkPackage)("skippedFields",s.Ac(8,u))("inEditMode",!0),s.Pb(3),s.wc("workPackage",e.newWorkPackage),s.Pb(4),s.wc("workPackage",e.newWorkPackage)("showProject",e.copying),s.Pb(4),s.wc("elementClass","work-packages-partitioned-page--content-right")("localStorageKey","openProject-splitViewFlexBasis")}}class p extends n.a{}p.\u0275fac=function(e){return g(e||p)},p.\u0275cmp=s.Vb({type:p,selectors:[["wp-copy-split-view"]],features:[s.Mb],decls:1,vars:1,consts:[["class","work-packages--details work-packages--new",4,"ngIf"],[1,"work-packages--details","work-packages--new"],[3,"resource","skippedFields","inEditMode","onSaved"],[1,"work-packages--details-content","-create-mode"],[1,"work-packages--new-details-header"],[3,"workPackage"],[1,"wp--details--switch-fullscreen-wrapper"],[1,"work-packages-show-view-button","wp--details--switch-fullscreen",3,"click"],[1,"icon-context","icon-to-fullscreen"],[3,"workPackage","showProject"],[1,"work-packages--details-toolbar-container"],[3,"onCancel"],[1,"work-packages--details--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"]],template:function(e,t){1&e&&s.Tc(0,h,13,9,"div",0),2&e&&s.wc("ngIf",t.newWorkPackage)},directives:[r.q,a.a,c.a,o.a,l.a,d.a],encapsulation:2,changeDetection:0});const g=s.jc(p)},"4fzr":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("wZYP"),s=(i("ii2/"),i("Jui0")),r=i("VgZ9"),a=i("IzEk"),c=i("AEvm"),o=i("CNq7"),l=i("fXoL"),d=i("HEQ6"),u=i("t+3x");class h extends c.a{constructor(e,t,i,n){super(),this.wpRelationsHierarchyService=e,this.apiV3Service=t,this.PathHelper=i,this.I18n=n,this.showEditForm=!1,this.text={parentHeadline:this.I18n.t("js.relations_hierarchy.parent_headline"),childrenHeadline:this.I18n.t("js.relations_hierarchy.children_headline")}}ngOnInit(){this.workPackagePath=this.PathHelper.workPackagePath(this.workPackage.id),this.canModifyHierarchy=!!this.workPackage.changeParent,this.canAddRelation=!!this.workPackage.addRelation,this.childrenQueryProps={filters:JSON.stringify([{parent:{operator:"=",values:[this.workPackage.id]}}]),"columns[]":["id","type","subject","status"],showHierarchies:!1},this.apiV3Service.work_packages.id(this.workPackage).requireAndStream().pipe(this.untilDestroyed()).subscribe(e=>{var t,i;this.workPackage=e;let n=null===(i=null===(t=this.workPackage.parent)||void 0===t?void 0:t.id)||void 0===i?void 0:i.toString();n&&this.apiV3Service.work_packages.id(n).get().pipe(Object(a.a)(1)).subscribe(e=>{this.workPackage.parent=e})})}}h.\u0275fac=function(e){return new(e||h)(l.bc(r.a),l.bc(o.a),l.bc(s.a),l.bc(n.a))},h.\u0275cmp=l.Vb({type:h,selectors:[["wp-relations-hierarchy"]],inputs:{workPackage:"workPackage",relationType:"relationType"},features:[l.Mb],decls:6,vars:4,consts:[[1,"wp-relations-hierarchy-section","wp-relations--children"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],["wp-isolated-query-space",""],[3,"workPackage","addExistingChildEnabled","query"]],template:function(e,t){1&e&&(l.hc(0,"div",0),l.hc(1,"div",1),l.hc(2,"div",2),l.cc(3,"h3",3),l.gc(),l.gc(),l.fc(4,4),l.cc(5,"wp-children-query",5),l.ec(),l.gc()),2&e&&(l.Pb(3),l.wc("textContent",t.text.childrenHeadline),l.Pb(2),l.wc("workPackage",t.workPackage)("addExistingChildEnabled",!0)("query",t.childrenQueryProps))},directives:[d.a,u.a],encapsulation:2})},"4jc8":function(e,t,i){"use strict";i.d(t,"i",(function(){return s})),i.d(t,"h",(function(){return r})),i.d(t,"j",(function(){return a})),i.d(t,"m",(function(){return c})),i.d(t,"k",(function(){return o})),i.d(t,"l",(function(){return l})),i.d(t,"n",(function(){return u})),i.d(t,"e",(function(){return h})),i.d(t,"g",(function(){return p})),i.d(t,"a",(function(){return g})),i.d(t,"d",(function(){return f})),i.d(t,"c",(function(){return b})),i.d(t,"f",(function(){return m})),i.d(t,"b",(function(){return w}));var n=i("wd/R");const s="timeline-element",r="timeline-element--bg",a="wp-timeline--grid-element",c="selection-start",o="wp-timeline--header-element",l="wp-timeline-header";class d{constructor(){this.zoomLevel="days"}}const u=["days","weeks","months","quarters","years"];function h(e){switch(e){case"days":return 30;case"weeks":return 15;case"months":return 6;case"quarters":return 2;case"years":return.5}throw new Error("invalid zoom level: "+e)}const p=120;class g{constructor(){this.now=n({hour:0,minute:0,seconds:0}),this.dateDisplayStart=n({hour:0,minute:0,seconds:0}),this.dateDisplayEnd=this.dateDisplayStart.clone().add(1,"day"),this.settings=new d,this.activeSelectionMode=null,this.selectionModeStart=null}get pixelPerDay(){return h(this.settings.zoomLevel)}get maxWidthInPx(){return this.maxSteps*this.pixelPerDay}get maxSteps(){return this.dateDisplayEnd.diff(this.dateDisplayStart,"days")}get dayCountForMarginLeft(){return Math.ceil(p/this.pixelPerDay)}}function f(e,t){return t*e.pixelPerDay}function b(e,t){return f(e,t)+"px"}function m(e,t,i,s){const r=[],a=[],c=i.clone().startOf(t),o=s.clone().endOf(t);for(;c.isBefore(o);){const o=n.max(c,i).clone(),l=n.min(c.clone().endOf(t),s).clone();c.add(1,t);const d=e.visibleViewportAtCalculationTime;o.isSameOrAfter(d[0])&&o.isSameOrBefore(d[1])||l.isSameOrAfter(d[0])&&l.isSameOrBefore(d[1])?r.push([o,l]):a.push([o,l])}const l=a.splice(0,1)[0],d=a.pop();return{inViewportAndBoundaries:_.concat([l].filter(e=>!_.isNil(e)),r,[d].filter(e=>!_.isNil(e))),rest:a}}function w(e,t,i){let s=n(),r=n();e.forEach(e=>{const i=e.workPackageId;if(!i)return;const a=t.get(i).value;if(!a)return;const c=a.startDate?a.startDate:a.date;c&&n(c).isBefore(s)&&(s=n(c));const o=a.dueDate?a.dueDate:a.date;o&&n(o).isAfter(r)&&(r=n(o))});return r.diff(s,"days")+1}},"4lR/":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("+rOU"),s=i("iB+3"),r=i("0lDN"),a=i("lfQJ"),c=i("E5Dd"),o=i("7ond"),l=i("fXoL");class d{constructor(e,t,i,s,r){this.componentFactoryResolver=e,this.FocusHelper=t,this.appRef=i,this.$transitions=s,this.injector=r,this.active=null,this.isOpening=!1;const a=this.portalHostElement=document.createElement("div");a.classList.add("op-context-menu--overlay"),document.body.appendChild(a),this.bodyPortalHost=new n.d(a,this.componentFactoryResolver,this.appRef,this.injector),s.onStart({},()=>this.close()),jQuery(window).on("keydown",e=>(this.active&&e.which===c.a.ESCAPE&&this.close(),!0));const o=this;document.getElementById("wrapper").addEventListener("click",(function(e){o.active&&!o.portalHostElement.contains(e.target)&&o.close()}),!0)}show(e,t,i=a.a){this.close(),this.isOpening=!0;const s=new n.c(i,null,this.injectorFor(e.locals));this.bodyPortalHost.attach(s),this.portalHostElement.style.display="block",this.active=e,setTimeout(()=>{this.reposition(t),this.active&&this.active.onOpen(this.activeMenu),this.isOpening=!1})}isActive(e){return this.active&&this.active===e}close(){this.isOpening||(this.bodyPortalHost.detach(),this.portalHostElement.style.display="none",this.active&&this.active.onClose(),this.active=null)}reposition(e){this.active&&this.activeMenu.position(this.active.positionArgs(e)).css("visibility","visible")}get activeMenu(){return jQuery(this.portalHostElement).find(".dropdown")}injectorFor(e){const t=new WeakMap;return e.service=this,t.set(r.a,e),new n.f(this.injector,t)}}d.\u0275fac=function(e){return new(e||d)(l.lc(l.l),l.lc(o.a),l.lc(l.f),l.lc(s.TransitionService),l.lc(l.A))},d.\u0275prov=l.Xb({token:d,factory:d.\u0275fac,providedIn:"root"})},"4n9w":function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("XNiG"),s=i("kTsZ"),r=i("g1AQ"),a=i("fMMW"),c=i("SKFm"),o=i("pLZG"),l=i("E2tj"),d=i("/C7M"),u=i("Kg8T"),h=i("AEvm"),p=i("dMmB"),g=i("CNq7"),f=i("Mo6U"),b=i("fXoL");const m="/api/v3/work_packages/new";class w extends h.a{constructor(e,t,i,s,r,a,c,l,d){super(),this.injector=e,this.hooks=t,this.apiV3Service=i,this.halResourceService=s,this.querySpace=r,this.authorisationService=a,this.halEditing=c,this.schemaCache=l,this.halEvents=d,this.newWorkPackageCreatedSubject=new n.a,this.halEditing.committedChanges.pipe(this.untilDestroyed(),Object(o.a)(e=>"WorkPackage"===e.resource._type&&e.wasNew)).subscribe(e=>{this.newWorkPackageCreated(e.resource)}),this.halEditing.changes$(m).pipe(this.untilDestroyed(),Object(o.a)(e=>!e)).subscribe(()=>{this.reset()})}newWorkPackageCreated(e){this.reset(),this.newWorkPackageCreatedSubject.next(e)}onNewWorkPackage(){return this.newWorkPackageCreatedSubject.asObservable()}createNewWorkPackage(e,t){return this.apiV3Service.withOptionalProject(e).work_packages.form.forPayload(t).toPromise().then(e=>this.fromCreateForm(e))}fromCreateForm(e){let t=this.initializeNewResource(e);const i=this.halEditing.edit(t,e);return this.hooks.call("workPackageNewInitialization",i),i}copyWorkPackage(e){let t=e.pristineResource.$source;return this.apiV3Service.work_packages.form.post(t).toPromise().then(e=>this.fromCreateForm(e))}copyFrom(e){let t=this.initializeNewResource(e);return this.halEditing.edit(t,e)}getEmptyForm(e){return this.form||(this.form=this.apiV3Service.withOptionalProject(e).work_packages.form.post({}).toPromise()),this.form}cancelCreation(){this.halEditing.stopEditing({href:m}),this.reset()}changesetUpdates$(){return this.halEditing.state(m).values$()}createOrContinueWorkPackage(e,t,i){let n=this.continueExistingEdit(t);return n||(n=this.createNewWithDefaults(e,i)),n.then(e=>(this.authorisationService.initModelAuth("work_package",e.pristineResource),this.halEditing.updateValue(m,e),this.apiV3Service.work_packages.cache.updateWorkPackage(e.pristineResource,!0),e))}reset(){this.apiV3Service.work_packages.cache.clearSome("new"),this.form=void 0}continueExistingEdit(e){const t=this.halEditing.state(m).value;if(void 0!==t){const i=t.projectedResource.type,n=!t.isEmpty(),s=!i&&!e,r=e&&i&&i.idFromLink===e.toString();if(n&&(s||r))return Promise.resolve(t)}return null}createNewWithDefaults(e,t){return this.withFiltersPayload(e,t).then(i=>{const n=_.merge({_links:{}},i,t);return this.createNewWorkPackage(e,n).then(e=>{if(!e)throw"No new work package was created";return this.defaultsFromFilters(e,t),e})})}defaultsFromFilters(e,t){let i=this.querySpace.query.value;if(i){const n=(null==t?void 0:t._links)&&t._links.type?["type"]:[];new a.a(this.injector,i.filters,n).applyDefaultsFromFilters(e)}}withFiltersPayload(e,t){const i={_links:{}};this.defaultsFromFilters(i,t);return Object.keys(i).length>1||Object.keys(i._links).length>0?this.apiV3Service.withOptionalProject(e).work_packages.form.forTypePayload(t||{_links:{}}).toPromise().then(e=>(this.toApiPayload(i,e.schema),i)):Promise.resolve(i)}toApiPayload(e,t){let i=[];Object.keys(t.$source).forEach(e=>{["Integer","Float","Date","DateTime","Duration","Formattable","Boolean","String","Text",void 0].includes(t.$source[e].type)||i.push(e)}),i.forEach(t=>{const i=e[t];void 0===i||(i instanceof f.a?e._links[t]={href:i.$links.self.href}:e._links[t]=i||{href:null}),delete e[t]})}initializeNewResource(e){let t=e.payload.$plain();t._links.schema={href:"new"};let i=this.halResourceService.createHalResourceOfType("WorkPackage",t);return i.$source.id="new",i._type="WorkPackage",i.__initialized_at=Date.now(),i.update=i.$links.update=e.$links.self,i.updateImmediately=i.$links.updateImmediately=e=>this.apiV3Service.work_packages.post(e).toPromise(),this.schemaCache.update(i,e.schema),i}}w.\u0275fac=function(e){return new(e||w)(b.lc(b.A),b.lc(r.a),b.lc(g.a),b.lc(s.a),b.lc(l.a),b.lc(u.a),b.lc(c.a),b.lc(p.a),b.lc(d.a))},w.\u0275prov=b.Xb({token:w,factory:w.\u0275fac})},"4rda":function(e,t,i){"use strict";i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return o}));var n=i("mrSG"),s=i("M0J3"),r=i("wZYP"),a=i("r0MM");const c="custom-option";class o extends s.a{constructor(e,t){super(),this.name=e,this.context=t,this.mode=null,this.activeChange=null,this.texts={empty:this.I18n.t("js.label_no_value"),placeholder:this.I18n.t("js.placeholders.default")}}apply(e,t){this.resource=e,this.schema=t}get isFormattable(){return!1}get injector(){return this.context.injector}get value(){return this.schema?this.activeChange?this.activeChange.projectedResource[this.name]:this.attribute:null}get attribute(){return this.resource[this.name]}get type(){return this.constructor.type}get valueString(){return this.value}get placeholder(){return"-"}get label(){return this.schema.name||this.name}get title(){return this.isFormattable?null:this.valueString}render(e,t,i={}){e.textContent=t}renderEmpty(e){const t=document.createElement("div");t.setAttribute("title",this.texts.empty),t.textContent=this.texts.placeholder,t.classList.add(c,"-empty"),e.appendChild(t)}}Object(n.c)([Object(a.a)(),Object(n.e)("design:type",r.a)],o.prototype,"I18n",void 0)},"4zHP":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("mMv8"),s=i("wZYP"),r=i("iB+3"),a=i("AEvm"),c=i("CNq7"),o=i("fXoL");class l extends a.a{constructor(e,t,i,n,s){super(),this.apiV3Service=e,this.I18n=t,this.cdRef=i,this.$transition=n,this.wpActivity=s,this.unfilteredActivities=[],this.visibleActivities=[],this.onlyComments=!1,this.text={commentsOnly:this.I18n.t("js.label_activity_show_only_comments"),showAll:this.I18n.t("js.label_activity_show_all")},this.reverse=s.isReversed,this.togglerText=this.text.commentsOnly}ngOnInit(){this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackage=e,this.wpActivity.require(this.workPackage).then(e=>{this.updateActivities(e),this.cdRef.detectChanges()})})}updateActivities(e){this.unfilteredActivities=e;const t=this.getVisibleActivities();this.visibleActivities=t.map((e,t)=>this.info(e,t)),this.showToggler=this.shouldShowToggler()}shouldShowToggler(){const e=this.unfilteredActivities.length,t=this.getActivitiesWithComments().length;return e>1&&t>0&&t<this.unfilteredActivities.length}getVisibleActivities(){return this.onlyComments?this.getActivitiesWithComments():this.unfilteredActivities}getActivitiesWithComments(){return this.unfilteredActivities.filter(e=>!!_.get(e,"comment.html"))}toggleComments(){this.onlyComments=!this.onlyComments,this.updateActivities(this.unfilteredActivities),this.onlyComments?this.togglerText=this.text.showAll:this.togglerText=this.text.commentsOnly}info(e,t){return this.wpActivity.info(this.unfilteredActivities,e,t)}}l.\u0275fac=function(e){return new(e||l)(o.bc(c.a),o.bc(s.a),o.bc(o.i),o.bc(r.Transition),o.bc(n.a))},l.\u0275dir=o.Wb({type:l,features:[o.Mb]})},"5+Sy":function(e,t,i){"use strict";i.d(t,"f",(function(){return s})),i.d(t,"e",(function(){return r})),i.d(t,"c",(function(){return a})),i.d(t,"d",(function(){return c})),i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return l})),i.d(t,"g",(function(){return d}));var n=i("CBsm");function s(e){return`wp-row-${e}-table`}function r(){return"wp-table--relations-aditional-row"}function a(e){return jQuery("."+s(e))}function c(e){return jQuery(`.${e}-table`)}function o(e){return!!e&&null!=Array.from(e.classList).find(e=>e.includes(Object(n.b)()))}function l(e,t){let i=e.previousElementSibling;for(;i;){if(i.matches(t))return i;i=i.previousElementSibling}return null}function d(e){try{const t=a(e),i=t.scrollParent(),n=i.scrollTop(),s=n+i.height(),r=t[0].offsetTop,c=r+t.height();r<n?i[0].scrollTop=r:c>s&&(i[0].scrollTop=c-i.height())}catch(t){console.warn("Can't scroll row element into view: "+t)}}},"57Du":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("V4eP"),s=i("+rOU");function r(e,t,i,r){const a=new WeakMap;return a.set(n.b,t),a.set(n.c,i),a.set(n.d,r),new s.f(e,a)}},"59tY":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("juWA"),s=i("wZYP"),r=i("AEvm"),a=i("fXoL");class c extends r.a{constructor(e,t){super(),this.I18n=e,this.timezoneService=t}ngOnInit(){_.remove(this.filter.values,e=>!this.timezoneService.isValidISODateTime(e))}isoDateParser(e){if(!this.timezoneService.isValidISODate(e))return"";var t=this.timezoneService.parseISODatetime(e);return this.timezoneService.formattedISODateTime(t)}isoDateFormatter(e){if(!this.timezoneService.isValidISODateTime(e))return"";var t=this.timezoneService.parseISODatetime(e);return this.timezoneService.formattedISODate(t)}get isTimeZoneDifferent(){let e=this.lowerBoundary||this.upperBoundary;return!!e&&(0!==e.hours()||0!==e.minutes())}get timeZoneText(){return this.lowerBoundary&&this.upperBoundary?this.I18n.t("js.filter.time_zone_converted.two_values",{from:this.lowerBoundary.format("YYYY-MM-DD HH:mm"),to:this.upperBoundary.format("YYYY-MM-DD HH:mm")}):this.upperBoundary?this.I18n.t("js.filter.time_zone_converted.only_end",{to:this.upperBoundary.format("YYYY-MM-DD HH:mm")}):this.lowerBoundary?this.I18n.t("js.filter.time_zone_converted.only_start",{from:this.lowerBoundary.format("YYYY-MM-DD HH:mm")}):""}}c.\u0275fac=function(e){return new(e||c)(a.bc(s.a),a.bc(n.a))},c.\u0275dir=a.Wb({type:c,features:[a.Mb]})},"5HGI":function(e,t,i){"use strict";i.d(t,"a",(function(){return te}));var n=i("mrSG"),s=i("wZYP"),r=i("E2tj"),a=i("qHU1"),c=i("iMRi"),o=i("6XbZ"),l=i("r0MM");class d{constructor(e,t){this.injector=e,this.workPackageTable=t}isApplicable(e){return!0}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.a)],d.prototype,"states",void 0);var u=i("T9ri"),h=i("nbRO");function p(e){return"group-"+e.identifier}class g{constructor(e){this.injector=e,this.text={collapse:this.I18n.t("js.label_collapse"),expand:this.I18n.t("js.label_expand")}}buildGroupRow(e,t){let i,n,s=document.createElement("tr");return e.collapsed?(n=this.text.expand,i="icon-plus"):(n=this.text.collapse,i="icon-minus2"),s.classList.add(h.b,p(e)),s.id="wp-table-rowgroup-"+e.index,s.dataset.groupIndex=e.index.toString(),s.dataset.groupIdentifier=e.identifier,s.innerHTML=`\n      <td colspan="${t}" class="-no-highlighting">\n        <div class="expander icon-context ${i}">\n          <span class="hidden-for-sighted">${_.escape(n)}</span>\n        </div>\n        <div class="group--value">\n          ${_.escape(Object(u.d)(e))}\n          <span class="count">\n            (${e.count})\n          </span>\n        </div>\n      </td>\n    `,s}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",s.a)],g.prototype,"I18n",void 0);var f=i("SKFm"),b=i("QOiP"),m=i("pXZk");function w(e){return"__relations-expanded-from-"+e}const v="wp-table--relation-cell-td";class y extends o.a{constructor(e,t){super(e,t),this.injector=e,this.workPackageTable=t}buildCell(e,t){return Object(b.a)(t)?this.emptyRelationCell(t):super.buildCell(e,t)}buildEmptyRelationRow(e,t,i){const n=t.denormalized(e),s=this.states.workPackages.get(n.targetId).value,r=this.createEmptyRelationRow(e,s),[a,c]=super.buildEmptyRow(s,r);return[a,s]}createEmptyRelationRow(e,t){const i=this.relationClassIdentifier(e,t);let n=document.createElement("tr");return n.dataset.workPackageId=t.id,n.dataset.classIdentifier=i,n.classList.add(o.b,o.c,"issue","wp-table--relations-aditional-row",i,i+"-table",w(e.id)),n}relationClassIdentifier(e,t){return i=t.id,`wp-relation-row-${e.id}-to-${i}`;var i}appendRelationLabel(e,t,i,n,s){const r=i.denormalized(t);let a="";if("toType"===s&&(a=this.I18n.t("js.relation_labels."+r.reverseRelationType)),"ofType"===s){a=this.states.workPackages.get(r.target.id).value.type.name}const c=document.createElement("span");c.classList.add("relation-row--type-label"),c.textContent=a;document.createTextNode(r.target.name);e.find("."+v).empty(),e.find(`.${v}.${n}`).append(c)}emptyRelationCell(e){const t=document.createElement("td");return t.classList.add(v,m.c,e.id),t}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.a)],y.prototype,"states",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",s.a)],y.prototype,"I18n",void 0);var k=i("uSJ+"),C=i("JY8V"),j=i("FB4C");class P{constructor(e,t,i){this.injector=e,this.table=t,this.tablePass=i,this.relationRowBuilder=new y(e,t)}render(){if(!this.isApplicable)return;_.clone(this.tablePass.renderedOrder).forEach((e,t)=>{if(!e.workPackage)return;const i=e.workPackage,n=i.id,s=this.wpRelations.state(n);s.hasValue()&&0!==_.size(s.value)&&this.wpTableRelationColumns.relationsToExtendFor(i,s.value,(t,s,r)=>{const[a,c]=this.relationRowBuilder.buildEmptyRelationRow(i,t,r);a.classList.add(...e.additionalClasses),this.relationRowBuilder.appendRelationLabel(jQuery(a),i,t,s.id,r),this.tablePass.spliceRow(a,`.${this.relationRowBuilder.classIdentifier(i)},.${w(n)}`,{classIdentifier:this.relationRowBuilder.relationClassIdentifier(i,c),additionalClasses:e.additionalClasses.concat(["wp-table--relations-aditional-row"]),workPackage:c,belongsTo:i,renderType:"relations",hidden:e.hidden,data:{relation:t,columnId:s.id,relationType:r}})})})}refreshRelationRow(e,t,i){const n=this.relationRowBuilder.refreshRow(t,i);return this.relationRowBuilder.appendRelationLabel(n,e.belongsTo,e.data.relation,e.data.columnId,e.data.relationType),n}get isApplicable(){return this.wpTableColumns.hasRelationColumns()}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",k.a)],P.prototype,"wpRelations",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",C.a)],P.prototype,"wpTableColumns",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",j.a)],P.prototype,"wpTableRelationColumns",void 0);var x=i("9nXh");class S{constructor(e,t,i){this.injector=e,this.table=t,this.tablePass=i}render(){this.timelineBody=document.createDocumentFragment(),this.timelineBuilder=new x.a(this.injector,this.table),this.tablePass.renderedOrder.forEach(e=>{const t=e.workPackage?e.workPackage.id:null,i=this.timelineBuilder.build(t);i.classList.add(e.classIdentifier,e.classIdentifier+"-timeline",...e.additionalClasses),this.timelineBody.appendChild(i)})}}var O=i("2Qcm"),I=i("RGDJ");class T{constructor(e,t,i){this.injector=e,this.table=t,this.tablePass=i}render(){if(!this.isApplicable)return;const e=this.wpTableHighlighting.current.mode;window.getComputedStyle(document.body);this.tablePass.renderedOrder.forEach((t,i)=>{if(!t.workPackage)return;const n=t.workPackage[e];if(!n)return;const s=n.id;this.tablePass.tableBody.children[i].classList.add(I.a.backgroundClass(e,s))})}get isApplicable(){return!(this.wpTableHighlighting.isInline||this.wpTableHighlighting.isDisabled)}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",O.a)],T.prototype,"wpTableHighlighting",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",r.a)],T.prototype,"querySpace",void 0);var R=i("pSHE"),E=i("FlxY");class M{constructor(e){this.injector=e;const t=this.injector.get(R.a);this.actionService=t.get(e)}build(e,t){let i=document.createElement("td");if(!this.actionService.canPickup(e))return i;i.classList.add(m.c,"wp-table--sort-td",E.b.id,"hide-when-print");let n=document.createElement("span");return n.classList.add("wp-table--drag-and-drop-handle","icon-drag-handle"),i.appendChild(n),i}}var F=i("Uyc6");class A{constructor(e,t,i){this.injector=e,this.table=t,this.tablePass=i,this.dragDropHandleBuilder=new M(this.injector)}render(){this.table.configuration.dragAndDropEnabled&&this.wpTableOrder.withLoadedPositions().then(e=>{this.tablePass.renderedOrder.forEach((t,i)=>{if(!t.workPackage||"relations"===t.renderType)return;const n=this.dragDropHandleBuilder.build(t.workPackage,e[t.workPackage.id]);n&&t.element.replaceChild(n,t.element.firstElementChild)})})}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",C.a)],A.prototype,"wpTableColumns",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",F.a)],A.prototype,"wpTableOrder",void 0);class L{constructor(e,t,i){this.injector=e,this.workPackageTable=t,this.rowBuilder=i}render(){return Object(a.b)("Primary render pass",()=>{this.prepare(),this.doRender(),this.postRender()}),this.highlighting.render(),Object(a.b)("Relations render pass",()=>{this.relations.render()}),Object(a.b)("Drag handle render pass",()=>{this.dragDropHandle.render()}),Object(a.b)("Timelines render pass",()=>{this.timeline.render()}),this}refresh(e,t,i){let n=jQuery(i).find("."+e.classIdentifier),s=null;switch(e.renderType){case"primary":s=this.rowBuilder.refreshRow(t,n);break;case"relations":s=this.relations.refreshRelationRow(e,t,n)}null!==s&&n.length&&n.replaceWith(s)}get result(){return this.renderedOrder.map(e=>({classIdentifier:e.classIdentifier,workPackageId:e.workPackage?e.workPackage.id:null,hidden:e.hidden}))}spliceRow(e,t,i){const n=jQuery(this.tableBody).find(t).last();n.after(e);const s=n.index();this.renderedOrder.splice(s+1,0,i)}prepare(){this.timeline=new S(this.injector,this.workPackageTable,this),this.relations=new P(this.injector,this.workPackageTable,this),this.dragDropHandle=new A(this.injector,this.workPackageTable,this),this.highlighting=new T(this.injector,this.workPackageTable,this),this.tableBody=document.createDocumentFragment(),this.renderedOrder=[]}postRender(){0===this.renderedOrder.length&&this.workPackageTable.renderPlaceholderRow&&this.tableBody.appendChild(this.rowBuilder.placeholderRow)}appendRow(e,t,i=[],n=!1){this.tableBody.appendChild(t),this.renderedOrder.push({classIdentifier:this.rowBuilder.classIdentifier(e),additionalClasses:i,workPackage:e,renderType:"primary",element:t,hidden:n})}appendNonWorkPackageRow(e,t,i=[],n=!1){e.classList.add(t),this.tableBody.appendChild(e),this.renderedOrder.push({element:e,classIdentifier:t,additionalClasses:i,workPackage:null,renderType:"primary",hidden:n})}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",f.a)],L.prototype,"halEditing",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.a)],L.prototype,"states",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",s.a)],L.prototype,"I18n",void 0);class D extends L{constructor(e,t,i){super(e,t,i),this.injector=e,this.workPackageTable=t,this.rowBuilder=i}doRender(){this.workPackageTable.originalRows.forEach(e=>{let t=this.workPackageTable.originalRowIndex[e],[i]=this.rowBuilder.buildEmpty(t.object);t.element=i,this.appendRow(t.object,i),this.tableBody.appendChild(i)})}}var V=i("VknD");class q extends D{constructor(e,t,i,n,s){super(e,t,new o.a(e,t)),this.injector=e,this.workPackageTable=t,this.groups=i,this.headerBuilder=n,this.colspan=s,this.sumsBuilder=new V.a(this.injector,this.workPackageTable)}doRender(){let e=null;this.workPackageTable.originalRows.length;this.workPackageTable.originalRows.forEach((t,i)=>{let n=this.workPackageTable.originalRowIndex[t],s=this.matchingGroup(n.object),r=e!==s;if(e&&r&&this.renderSumsRow(e),s&&r){const t=p(s);let i=this.headerBuilder.buildGroupRow(s,this.colspan);this.appendNonWorkPackageRow(i,t,["-group-row"]),e=s}n.group=e,this.buildSingleRow(n)}),e&&this.renderSumsRow(e)}matchingGroup(e){return _.find(this.groups,t=>{let i=e[Object(u.a)(t)];if(void 0===i&&(i=null),_.isArray(i))return this.matchesMultiValue(i,t);if(i&&i.$href)return!!_.find(t._links.valueLink,e=>i.$href===e.href);let n=""===t.value?null:t.value;return n&&(n=n.replace("%","")),n==i})}matchesMultiValue(e,t){if(e.length!==t.href.length)return!1;let i=e=>_.map(e,e=>e.href).sort().join(", ");return _.isEqualWith(e,t.href,(e,t)=>i(e)===i(t))}buildSingleRow(e){const t=e.group;t||console.warn("All rows should have a group, but this one doesn't %O",e);let i=!1,n=[],[s,r]=this.rowBuilder.buildEmpty(e.object);t&&(n.push(Object(u.f)(t.index)),i=!!t.collapsed,i&&n.push(h.a)),e.element=s,s.classList.add(...n),this.appendRow(e.object,s,n,i)}renderSumsRow(e){if(!e.sums)return;const t=p(e);let i=this.sumsBuilder.buildSumsRow(e);this.appendNonWorkPackageRow(i,t)}}class $ extends d{constructor(e,t){super(e,t),this.injector=e}isApplicable(e){return!_.isEmpty(this.groups)}get groups(){return this.querySpace.groups.value||[]}get collapsedGroups(){return this.querySpace.collapsedGroups.value||{}}get colspan(){return this.wpTableColumns.columnCount+2}buildRows(){const e=new g(this.injector);return new q(this.injector,this.workPackageTable,this.getGroupData(),e,this.colspan).render()}refreshExpansionState(){const e=this.getGroupData(),t=this.querySpace.tableRendered.value,i=new g(this.injector);jQuery(this.workPackageTable.tableAndTimelineContainer).find("."+h.b).each((n,s)=>{let r=jQuery(s).data("groupIndex"),a=e[r],c=i.buildGroupRow(a,this.colspan);s.parentNode&&s.parentNode.replaceChild(c,s);const l=jQuery(this.workPackageTable.tableAndTimelineContainer).find("."+Object(u.f)(r));l.toggleClass(h.a,!!a.collapsed),l.filter("."+o.c).each((e,i)=>{const n=jQuery(i).index();t[n].hidden=!!a.collapsed})}),this.querySpace.tableRendered.putValue(t,"Updated hidden state of rows after group change.")}getGroupData(){return this.groups.map((e,t)=>(e.index=t,e._links&&e._links.valueLink&&(e.href=e._links.valueLink),e.identifier=Object(u.c)(e),e.collapsed=this.collapsedGroups[e.identifier],e))}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",r.a)],$.prototype,"querySpace",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.a)],$.prototype,"states",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",C.a)],$.prototype,"wpTableColumns",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",s.a)],$.prototype,"I18n",void 0);var N=i("xV+i"),B=i("CBsm"),z=i("wyKs"),H=i("CNq7");class Q extends L{constructor(e,t,i){super(e,t,i),this.injector=e,this.workPackageTable=t,this.rowBuilder=i,this.rendered={},this.additionalParents={},this.deferred={},this.parentsWithVisibleChildren={}}prepare(){super.prepare(),this.hierarchies=this.wpTableHierarchies.current,_.each(this.workPackageTable.originalRowIndex,e=>{e.object.ancestors.forEach(e=>{this.parentsWithVisibleChildren[e.id]=!0})}),this.rowBuilder.parentsWithVisibleChildren=this.parentsWithVisibleChildren}doRender(){this.workPackageTable.originalRows.forEach(e=>{const t=this.workPackageTable.originalRowIndex[e],i=t.object;if(!this.deferInsertion(i)){if(i.ancestors.length)this.buildWithHierarchy(t);else{let[e,n]=this.rowBuilder.buildEmpty(i);t.element=e,this.tableBody.appendChild(e),this.markRendered(e,i,n)}this.renderAllDeferredChildren(i)}})}deferInsertion(e){const t=e.ancestors;if(0===t.length)return!1;let i=t.concat([e]);for(let n=i.length-2;n>=0;--n){const e=i[n],t=this.workPackageTable.originalRowIndex[e.id];if(this.rendered[e.id])return!1;if(t){let t=this.deferred[e.id]||[],s=i.slice(n+1,i.length);return s=s.map(e=>this.apiV3Service.work_packages.cache.state(e.id).value),t=t.concat(s),this.deferred[e.id]=_.uniqBy(t,e=>e.id),!0}}return!1}renderAllDeferredChildren(e){const t=e.id;(this.deferred[t]||[]).forEach(t=>{this.insertUnderParent(this.getOrBuildRow(t),t.parent||e),this.renderAllDeferredChildren(t)})}getOrBuildRow(e){let t=this.workPackageTable.originalRowIndex[e.id];return t||(t={object:e}),t}buildWithHierarchy(e){const t=e.object.ancestors,i=[];t.forEach((e,n)=>{const s=this.states.workPackages.get(e.id).getValueOr(e);if(!this.rendered[s.id]){let[e,r]=this.rowBuilder.buildAncestorRow(s,i,n);if(0===n)this.tableBody.appendChild(e),this.markRendered(e,s,r,!0);else{const i=t[n-1];this.insertAtExistingHierarchy(s,e,i,r,!0)}this.additionalParents[s.id]=s}i.push(Object(B.c)(s.id)),t.slice(0,n).forEach(e=>{i.push(Object(B.c)(e.id))})});const n=_.last(t);this.insertUnderParent(e,n)}insertUnderParent(e,t){const[i,n]=this.rowBuilder.buildEmpty(e.object);e.element=i,this.insertAtExistingHierarchy(e.object,i,t,n,!1)}markRendered(e,t,i=!1,n=!1){this.rendered[t.id]=!0,this.renderedOrder.push(this.buildRenderInfo(e,t,i,n))}insertAtExistingHierarchy(e,t,i,n,s){const r=".__hierarchy-root-"+i.id,a=".__hierarchy-group-"+i.id;this.spliceRow(t,`${r},${a}`,this.buildRenderInfo(t,e,n,s)),this.rendered[e.id]=!0}buildRenderInfo(e,t,i,n){let s={element:e,classIdentifier:"",additionalClasses:[],workPackage:t,renderType:"primary",hidden:i},[r,a]=this.rowBuilder.ancestorRowData(t);return n?(s.additionalClasses=[N.b].concat(r),s.classIdentifier=Object(B.a)(t.id)):(s.additionalClasses=r,s.classIdentifier=this.rowBuilder.classIdentifier(t)),s}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",r.a)],Q.prototype,"querySpace",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.a)],Q.prototype,"states",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",H.a)],Q.prototype,"apiV3Service",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",z.a)],Q.prototype,"wpTableHierarchies",void 0);class W extends d{constructor(e,t){super(e,t),this.injector=e,this.workPackageTable=t}isApplicable(e){return this.wpTableHierarchies.isEnabled}buildRows(){const e=new N.a(this.injector,this.workPackageTable);return new Q(this.injector,this.workPackageTable,e).render()}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.a)],W.prototype,"states",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",C.a)],W.prototype,"wpTableColumns",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",z.a)],W.prototype,"wpTableHierarchies",void 0);class X extends d{constructor(e,t){super(e,t),this.injector=e}buildRows(){const e=new o.a(this.injector,this.workPackageTable);return new D(this.injector,this.workPackageTable,e).render()}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",s.a)],X.prototype,"I18n",void 0);var U=i("7ond"),G=i("Ie+Q"),Y=i("e6KS"),K=i("V4eP");class Z extends Y.a{constructor(e,t,i,n){super(e),this.injector=e,this.table=t,this.workPackageId=i,this.classIdentifier=n,this.cellBuilder=new m.a(this.injector),this.resourceSubscription=this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().subscribe(e=>this.resource=e)}destroy(){this.resourceSubscription.unsubscribe()}findContainer(e){return this.rowContainer.find(`.${m.c}.${e} .${m.b}`).first()}findCell(e){return this.rowContainer.find(`.${m.c}.${e}`).first()}activateField(e,t,i,n){return this.waitForContainer(i).then(s=>{const r=this.findCell(i);r.addClass(K.e);let a=parseInt(r.css("width"));return a=a>150?a-10:150,r.css("max-width",a+"px"),r.css("width",a+"px"),this.editingPortalService.create(s,this.injector,e,t,i,n)})}reset(e,t){const i=this.findContainer(e),n=this.findCell(e);i.length&&(this.findCell(e).css("width",""),this.findCell(e).css("max-width",""),this.cellBuilder.refresh(i[0],this.resource,e),n.removeClass(K.e),t&&this.FocusHelper.focusElement(i))}requireVisible(e){return this.wpTableColumns.addColumn(e),this.waitForContainer(e)}focusOnFirstError(){jQuery(this.table.tableAndTimelineContainer).find(".inline-edit--active-field.-error .inline-edit--field").first().trigger("focus")}loadFieldSchema(e,t=!1){return["startDate","dueDate","date"].includes(e)&&(e="combinedDate"),super.loadFieldSchema(e,t)}waitForContainer(e){return new Promise((t,i)=>{const n=setInterval(()=>{const i=this.findContainer(e);i.length>0&&(clearInterval(n),t(i[0]))},100)})}get rowContainer(){return jQuery(this.table.tableAndTimelineContainer).find(`.${this.classIdentifier}-table`)}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",C.a)],Z.prototype,"wpTableColumns",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",H.a)],Z.prototype,"apiV3Service",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.a)],Z.prototype,"states",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",U.a)],Z.prototype,"FocusHelper",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",G.a)],Z.prototype,"editingPortalService",void 0);class J{constructor(e,t){this.table=e,this.injector=t,this.forms={}}reset(){_.each(this.forms,e=>e.destroy()),this.forms={}}change(e){return this.halEditing.typedState(e).value}stopEditing(e){this.halEditing.stopEditing(e);const t=this.forms[e.id];t&&(t.destroy(),delete this.forms[e.id])}startEditing(e,t){const i=e.id,n=this.forms[i];return n||(this.forms[i]=new Z(this.injector,this.table,i,t))}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",f.a)],J.prototype,"halEditing",void 0);var ee=i("1RU0");class te{constructor(e,t,i,n,s,r,a){this.injector=e,this.tableAndTimelineContainer=t,this.scrollContainer=i,this.tbody=n,this.timelineBody=s,this.timelineController=r,this.configuration=a,this.originalRows=[],this.originalRowIndex={},this.hierarchyRowsBuilder=new W(this.injector,this),this.groupedRowsBuilder=new $(this.injector,this),this.plainRowsBuilder=new X(this.injector,this),this.builders=[this.hierarchyRowsBuilder,this.groupedRowsBuilder,this.plainRowsBuilder],this.lastRenderPass=null,this.editing=new J(this,this.injector)}get renderedRows(){return this.querySpace.tableRendered.getValueOr([])}findRenderedRow(e){const t=_.findIndex(this.renderedRows,t=>t.classIdentifier===e);return[t,this.renderedRows[t]]}get rowBuilder(){return _.find(this.builders,e=>e.isApplicable(this))}buildIndex(e){this.originalRowIndex={},this.originalRows=e.map((e,t)=>{let i=e.id;return e=this.apiV3Service.work_packages.cache.current(i,e),this.originalRowIndex[i]={object:e,workPackageId:i,position:t},i})}initialSetup(e){this.buildIndex(e),this.redrawTableAndTimeline()}redrawTableAndTimeline(){const e=this.performRenderPass(!1);requestAnimationFrame(()=>{this.tbody.innerHTML="",this.timelineBody.innerHTML="",this.tbody.appendChild(e.tableBody),this.timelineBody.appendChild(e.timeline.timelineBody),setTimeout(()=>this.querySpace.tableRendered.putValue(e.result))})}redrawTable(){const e=this.performRenderPass();this.querySpace.tableRendered.putValue(e.result)}refreshRows(e){const t=this.lastRenderPass;t?_.each(t.renderedOrder,i=>{i.workPackage&&i.workPackage.id===e.id&&(Object(a.a)("Refreshing rendered row "+i.classIdentifier),i.workPackage=e,t.refresh(i,e,this.tbody))}):Object(a.a)("Trying to refresh a singular row without a previous render pass.")}get renderPlaceholderRow(){return this.configuration.dragAndDropEnabled}performRenderPass(e=!0){this.editing.reset();const t=this.lastRenderPass=this.rowBuilder.buildRows();return e&&requestAnimationFrame(()=>{this.tbody.innerHTML="",this.tbody.appendChild(t.tableBody)}),t}setGroupsCollapseState(e){this.querySpace.collapsedGroups.putValue(e);const t=performance.now();this.groupedRowsBuilder.refreshExpansionState();const i=performance.now();Object(a.a)("Group redraw took "+(i-t)+" milliseconds.")}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",r.a)],te.prototype,"querySpace",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",H.a)],te.prototype,"apiV3Service",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.a)],te.prototype,"states",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",s.a)],te.prototype,"I18n",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",ee.a)],te.prototype,"workPackageViewCollapsedGroupsService",void 0)},"5Mgc":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("mrSG"),s=i("Jui0"),r=i("fXoL");class a{constructor(e){this.PathHelper=e}create(e,t,i,s=null){return Object(n.b)(this,void 0,void 0,(function*(){yield this.load();const n="constrained"===e?window.OPConstrainedEditor:window.OPClassicEditor;t.classList.add("ckeditor-type-"+e);const r=t.querySelector(".document-editor__toolbar"),a=t.querySelector(".document-editor__editable");var c=i.options&&i.options.rtl?"ar":"en";const o=yield n.createCustomized(a,{openProject:this.createConfig(i),initialData:s,language:{content:c}});return r.appendChild(o.ui.view.toolbar.element),jQuery(t).on("op:ckeditor:setData",(e,t)=>o.setData(t)).on("op:ckeditor:clear",e=>o.setData(" ")).on("op:ckeditor:getData",(e,t)=>t(o.getData({trim:!1}))),o}))}load(){return i.e(26).then(i.t.bind(null,"lEcI",7))}createConfig(e){return"none"===e.macros?e.macros=!1:"wp"===e.macros?e.macros=["OPMacroToc","OPMacroEmbeddedTable","OPMacroWpButton"]:e.macros=e.macros,{context:e,helpURL:this.PathHelper.textFormattingHelp(),pluginContext:window.OpenProject.pluginContext.value}}}a.\u0275fac=function(e){return new(e||a)(r.lc(s.a))},a.\u0275prov=r.Xb({token:a,factory:a.\u0275fac})},"5btT":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("8ocD"),s=i("fXoL");class r extends n.a{}r.\u0275fac=function(e){return a(e||r)},r.\u0275prov=s.Xb({token:r,factory:r.\u0275fac,providedIn:"root"});const a=s.jc(r)},"5gqY":function(e,t,i){"use strict";i.d(t,"b",(function(){return k})),i.d(t,"a",(function(){return C}));var n=i("iMRi"),s=i("iB+3"),r=i("Y0Nk"),a=i("wZYP"),c=i("Jui0"),o=i("kTg4"),l=i("13ri"),d=i("sjKJ"),u=i("E5Dd"),h=i("Sulb"),p=i("K018"),g=i("AEvm"),f=i("CNq7"),b=i("fXoL"),m=i("ofXK");const w=["wpQueryMenuSearchInput"],v=["queryResultsContainer"];function y(e,t){1&e&&(b.hc(0,"div",11),b.cc(1,"div",12),b.cc(2,"div",13),b.cc(3,"div",14),b.cc(4,"div",15),b.cc(5,"div",16),b.gc())}const k="wp-query-select";class C extends g.a{constructor(e,t,i,n,s,r,a,c,o,l,d,u,h,p){super(),this.ref=e,this.element=t,this.apiV3Service=i,this.$state=n,this.$transitions=s,this.I18n=r,this.states=a,this.CurrentProject=c,this.loadingIndicator=o,this.pathHelper=l,this.wpStaticQueries=d,this.mainMenuService=u,this.toggleService=h,this.cdRef=p,this.loading=!1,this.noResults=!1,this.text={search:this.I18n.t("js.toolbar.search_query_label"),label:this.I18n.t("js.toolbar.search_query_label"),scope_default:this.I18n.t("js.label_default_queries"),scope_starred:this.I18n.t("js.label_starred_queries"),scope_global:this.I18n.t("js.label_global_queries"),scope_private:this.I18n.t("js.label_custom_queries"),no_results:this.I18n.t("js.work_packages.query.text_no_results")},this.hiddenCategories=[],this.reportsBodySelector=".controller-work_packages\\/reports",this.initialized=!1}ngOnInit(){this.queryResultsContainer=jQuery(this._queryResultsContainerElement.nativeElement),this.projectIdentifier=this.element.nativeElement.getAttribute("data-project-identifier"),this.mainMenuService.onActivate("work_packages","work_packages_query_select").subscribe(()=>this.initializeAutocomplete()),this.addClickHandler(),this.cdRef.detach()}ngOnDestroy(){super.ngOnDestroy(),this.unregisterTransitionListener()}initializeAutocomplete(){this.initialized||(this.searchInput=jQuery(this._wpQueryMenuSearchInput.nativeElement),this.buttonArrowLeft=jQuery(".main-menu--arrow-left-to-project",jQuery("#main-menu-work-packages-wrapper").parent()),this.initialized=!0,this.buttonArrowLeft.focus(),this.setupAutoCompletion(this.searchInput),this.updateMenuOnChanges(),this.loadQueries())}transformQueries(e){const t=e.elements.map(e=>({label:e.name,query:e,query_props:null})).concat(this.wpStaticQueries.all);return this.sortQueries(t)}sortQueries(e){let t={starred:[],default:[],public:[],private:[]},i=0;return e.forEach(e=>(e.auto_id=i++,e.query?e.query.starred?(e.category="starred",t.starred.push(e)):!e.query.starred&&e.query.public?(e.category="public",t.public.push(e)):e.query.starred||e.query.public?void 0:(e.category="private",t.private.push(e)):(e.category="default",t.default.push(e)))),_.flatten([t.starred,t.default,t.public,t.private].map(e=>this.sortByLabel(e)))}sortByLabel(e){return e.sort((e,t)=>e.label.toLowerCase().localeCompare(t.label.toLowerCase()))}loadQueries(){return this.loadingPromise=this.apiV3Service.queries.filterNonHidden(this.CurrentProject.identifier).toPromise().then(e=>{this.searchInput.querycomplete("option",{source:this.transformQueries(e)}),this.searchInput.querycomplete("search",this.searchInput.val()),_.each(this.hiddenCategories,e=>{let t=jQuery(e).attr("category");this.expandCollapseCategory(t)}),this.ref.detectChanges()})}set loadingPromise(e){this.loading=!0,e.then(()=>{this.loading=!1,this.cdRef.detectChanges()}).catch(()=>{this.loading=!1,this.cdRef.detectChanges()})}setupAutoCompletion(e){this.defineJQueryQueryComplete(),e.querycomplete({delay:100,source:[],select:(e,t)=>!1,response:(e,t)=>{this.noResults=0===t.content.length},close:(e,t)=>{const i=this.queryResultsContainer.find("ul.ui-autocomplete");i.is(":visible")||this.noResults||i.show()},focus:(e,t)=>{let i=e;for(;i&&i.originalEvent;)i=i.originalEvent;return i&&"keydown"===i.type&&this.queryResultsContainer.find(`#wp-query-menu-item-${t.item.auto_id} .wp-query-menu--item-link`).focus(),!1},appendTo:".wp-query-menu--results-container",classes:{"ui-autocomplete":"wp-query-menu--search-ul -inplace","ui-menu-divider":"wp-query-menu--category-icon"},autoFocus:!1,minLength:0})}defineJQueryQueryComplete(){let e=this;jQuery.widget("custom.querycomplete",jQuery.ui.autocomplete,{_create:function(){this._super(),this.widget().menu("option","items",".wp-query-menu--item"),this._search("")},_renderItem:function(t,i){const n=jQuery("<a>").addClass("wp-query-menu--item-link").attr("href",e.buildQueryItemUrl(i)).text(i.label),s=jQuery("<li>").addClass("ui-menu-item wp-query-menu--item").attr("id","wp-query-menu-item-"+i.auto_id).attr("data-category",i.category||"").data("ui-autocomplete-item",i).append(n).appendTo(t);return e.setInitialHighlighting(s,i),s},_renderMenu:function(t,i){let n;if(_.each(i,i=>{if(i.category!==n){n=i.category;let s=e.labelFunction(n);t.append(`<a tabindex="0" class="wp-query-menu--category-icon wp-query-menu--category-toggle" data-category="${n}" aria-hidden="true"></a>`),jQuery("<li>").addClass("ui-autocomplete--category wp-query-menu--category-toggle ellipsis").attr("title",s).attr("data-category",n).text(s).appendTo(t)}this._renderItemData(t,i)}),""===e.searchInput.val()){let t=e.queryResultsContainer.find(".wp-query-menu--item.selected");t.length>0&&setTimeout(()=>t[0].scrollIntoView({behavior:"auto",block:"center"}),20)}}})}setInitialHighlighting(e,t){const i=this.getQueryParams(t),n=this.$state.params.query_id,s=this.$state.params.query_props;let r=this.$state.includes("work-packages"),a=jQuery("body").hasClass("controller-work_packages/reports");const c=i.query_id&&(n||"").toString()===i.query_id.toString(),o=!t.query&&t.query_props&&t.query_props===s,l=r&&!n&&!s&&"all_open"===t.identifier,d=a&&"summary"===t.identifier;(c||o||l||d)&&e.addClass("selected")}labelFunction(e){switch(e){case"starred":return this.text.scope_starred;case"public":return this.text.scope_global;case"private":return this.text.scope_private;case"default":return this.text.scope_default;default:return""}}updateMenuOnChanges(){this.states.changes.queries.pipe(this.untilDestroyed()).subscribe(()=>this.loadQueries())}expandCollapseCategory(e){jQuery(`[data-category="${e}"]`).not(".ui-autocomplete--category").toggleClass("-hidden"),jQuery(`.wp-query-menu--category-icon[data-category="${e}"]`).toggleClass("-collapsed")}loadQuery(e){const t=this.getQueryParams(e);this.$state.go("work-packages.partitioned.list",t,{reload:!0}),this.toggleService.closeWhenOnMobile()}getQueryParams(e){let t={query_id:e.query?_.toString(e.query.id):null,query_props:e.query?null:e.query_props};return this.projectIdentifier&&(t.projects="projects",t.projectPath=this.projectIdentifier),t}buildQueryItemUrl(e){if(e.static_link)return e.static_link;const t=this.getQueryParams(e);return this.$state.href("work-packages.partitioned.list",t)}highlightSelected(e){this.highlightBySelector("#wp-query-menu-item-"+e.auto_id)}highlightBySelector(e){this.queryResultsContainer.find(".ui-menu-item").removeClass("selected"),this.queryResultsContainer.find(e).addClass("selected")}addClickHandler(){this.queryResultsContainer.on("click keydown",".ui-menu-item a",e=>{if("keydown"===e.type&&e.which!==u.a.ENTER)return!0;const t=jQuery(e.target),i=t.closest(".wp-query-menu--item").data("ui-autocomplete-item"),n="click"===e.type&&l.a.isClickedWithModifier(e),s=!!i.static_link;return n||s?(e.stopImmediatePropagation(),"keydown"===e.type&&(window.location.href=t.attr("href")),!0):(e.preventDefault(),this.loadQuery(i),this.highlightSelected(i),!1)}).on("click keydown",".wp-query-menu--category-toggle",e=>{if("keydown"===e.type&&e.which!==u.a.ENTER)return!0;const t=jQuery(e.target).data("category");return t&&this.expandCollapseCategory(t),this.hiddenCategories=this.queryResultsContainer.find(".ui-autocomplete--category.hidden"),e.preventDefault(),!1})}}C.\u0275fac=function(e){return new(e||C)(b.bc(b.i),b.bc(b.q),b.bc(f.a),b.bc(s.StateService),b.bc(s.TransitionService),b.bc(a.a),b.bc(n.a),b.bc(d.a),b.bc(r.a),b.bc(c.a),b.bc(o.a),b.bc(p.a),b.bc(h.a),b.bc(b.i))},C.\u0275cmp=b.Vb({type:C,selectors:[["wp-query-select"]],viewQuery:function(e,t){var i;(1&e&&(b.Rc(w,!0),b.Rc(v,!0)),2&e)&&(b.Ic(i=b.qc())&&(t._wpQueryMenuSearchInput=i.first),b.Ic(i=b.qc())&&(t._queryResultsContainerElement=i.first))},features:[b.Mb],decls:11,vars:5,consts:[["id","querySelectDropdown",1,"wp-query-menu--container"],[1,"wp-query-menu--search-container"],[1,"wp-query-menu--search-bar"],["for","query-title-filter",1,"hidden-for-sighted",3,"textContent"],["type","text","name","query-title-filter","id","query-title-filter",1,"wp-query-menu--search-input","ui-autocomplete--input","ellipsis"],["wpQueryMenuSearchInput",""],[1,"icon-search","wp-query-menu--search-icon"],[1,"wp-query-menu--results-container"],["queryResultsContainer",""],[1,"wp-query-menu--no-results-container",3,"hidden","textContent"],["class","loading-indicator -compact",4,"ngIf"],[1,"loading-indicator","-compact"],[1,"block-1"],[1,"block-2"],[1,"block-3"],[1,"block-4"],[1,"block-5"]],template:function(e,t){1&e&&(b.hc(0,"div",0),b.hc(1,"div",1),b.hc(2,"div",2),b.cc(3,"label",3),b.cc(4,"input",4,5),b.cc(6,"i",6),b.gc(),b.hc(7,"div",7,8),b.cc(9,"p",9),b.Tc(10,y,6,0,"div",10),b.gc(),b.gc(),b.gc()),2&e&&(b.Pb(3),b.wc("textContent",t.text.label),b.Pb(1),b.Qb("placeholder",t.text.search),b.Pb(5),b.wc("hidden",!t.noResults||t.loading)("textContent",t.text.no_results),b.Pb(1),b.wc("ngIf",t.loading))},directives:[m.q],encapsulation:2,changeDetection:0})},"5iud":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return c}));const n=".work-packages-tabletimeline--timeline-side",s=".scroll-sync";function r(e){if(0===e)return e;let t=15;return e<0&&(t*=-1),t}function a(e,t,i){const n=e.target,s=e.originalEvent;let[a,c]=function(e){let t=e.deltaX,i=e.deltaY;return e.shiftKey&&(t=i,i=0),[t,i]}(s);0!==c&&(a=r(a),c=r(c),window.requestAnimationFrame((function(){t[0].scrollTop=t[0].scrollTop+c,i[0].scrollTop=i[0].scrollTop+c,n.scrollLeft=n.scrollLeft+a})))}function c(e){var t=jQuery(e).find(".work-packages-tabletimeline--table-side"),i=jQuery(e).find(n);return e=>{var n=!1,r=!1;e?(t.on("wheel.scroll-sync",e=>{a(e,t,i)}),t.on("scroll.scroll-sync",e=>{n=!0,r||(i[0].scrollTop=e.target.scrollTop),n&&r&&(n=!1,r=!1)}),i.on("wheel.scroll-sync",e=>{a(e,t,i)}),i.on("scroll.scroll-sync",e=>{r=!0,n||(t[0].scrollTop=e.target.scrollTop),n&&r&&(n=!1,r=!1)})):t.off(s)}}},"5mBr":function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));i("Mo6U");var n=i("kTsZ"),s=i("pLZG"),r=i("iMRi"),a=i("4EDS"),c=i("AEvm"),o=i("fXoL"),l=i("ofXK"),d=i("wZYP"),u=i("Jui0"),h=i("POAS"),p=i("th4C"),g=i("N5AO"),f=i("2hMx");const b=function(e){return{fileName:e}};function m(e,t){if(1&e){const e=o.ic();o.hc(0,"a",7),o.pc("click",(function(t){o.Lc(e);return o.rc().confirmRemoveAttachment(t)})),o.cc(1,"op-icon",8),o.gc()}if(2&e){const e=o.rc();o.Pb(1),o.wc("icon-title",e.text.removeFile(o.Bc(1,b,e.attachment.fileName)))}}class w{constructor(e,t,i,n){this.halNotification=e,this.I18n=t,this.states=i,this.pathHelper=n,this.destroyImmediately=!0,this.removeAttachment=new o.s,this.text={dragHint:this.I18n.t("js.attachments.draggable_hint"),destroyConfirmation:this.I18n.t("js.text_attachment_destroy_confirmation"),removeFile:e=>this.I18n.t("js.label_remove_file",e)}}setDragData(e){const t=this.downloadPath,i=this.draggableHTML(t);e.dataTransfer.setData("text/plain",t),e.dataTransfer.setData("text/html",i.outerHTML),e.dataTransfer.setData("text/uri-list",t),e.dataTransfer.setDragImage(i,0,0)}draggableHTML(e){let t;return this.isImage?(t=document.createElement("img"),t.src=e,t.textContent=this.fileName):(t=document.createElement("a"),t.href=e,t.textContent=this.fileName),t}get downloadPath(){return this.pathHelper.attachmentDownloadPath(this.attachment.id,this.fileName)}get isImage(){const e=this.fileName.split(".").pop()||"";return w.imageFileExtensions.indexOf(e.toLowerCase())>-1}get fileName(){const e=this.attachment;return e.fileName||e.customName||e.name}confirmRemoveAttachment(e){return window.confirm(this.text.destroyConfirmation)?(this.removeAttachment.emit(),this.destroyImmediately&&this.resource.removeAttachment(this.attachment),!1):(e.stopImmediatePropagation(),e.preventDefault(),!1)}}function v(e,t){if(1&e){const e=o.ic();o.hc(0,"ul",3),o.hc(1,"attachment-list-item",4),o.pc("removeAttachment",(function(){o.Lc(e);const i=t.$implicit;return o.rc(2).removeAttachment(i)})),o.gc(),o.gc()}if(2&e){const e=t.$implicit,i=t.index,n=o.rc(2);o.Pb(1),o.wc("attachment",e)("resource",n.resource)("index",i)("destroyImmediately",n.destroyImmediately)}}function y(e,t){if(1&e&&(o.hc(0,"div",1),o.Tc(1,v,2,4,"ul",2),o.gc()),2&e){const e=o.rc();o.Pb(1),o.wc("ngForOf",e.attachments)("ngForTrackBy",e.trackByHref)}}w.imageFileExtensions=["jpeg","jpg","gif","bmp","png"],w.\u0275fac=function(e){return new(e||w)(o.bc(h.a),o.bc(d.a),o.bc(r.a),o.bc(u.a))},w.\u0275cmp=o.Vb({type:w,selectors:[["attachment-list-item"]],inputs:{resource:"resource",attachment:"attachment",index:"index",destroyImmediately:"destroyImmediately"},outputs:{removeAttachment:"removeAttachment"},decls:8,vars:9,consts:[["focus-within","","draggable","true","focusWithinSelector",".inplace-editing--trigger-icon",1,"form--selected-value--container","work-package--attachments--draggable-item",3,"title","dragstart"],[1,"form--selected-value"],["icon-classes","icon-context icon-attachment"],["target","_blank","rel","noopener",1,"work-package--attachments--filename"],[1,"work-package--attachments--info",3,"createdOn","author","showAuthorAsLink"],["href","","class","form--selected-value--remover work-package--atachments--delete-button",3,"click",4,"ngIf"],["type","hidden",3,"name","value"],["href","",1,"form--selected-value--remover","work-package--atachments--delete-button",3,"click"],["icon-classes","icon-delete",3,"icon-title"]],template:function(e,t){1&e&&(o.hc(0,"li",0),o.pc("dragstart",(function(e){return t.setDragData(e)})),o.hc(1,"span",1),o.cc(2,"op-icon",2),o.hc(3,"a",3),o.Vc(4),o.cc(5,"authoring",4),o.gc(),o.gc(),o.Tc(6,m,2,3,"a",5),o.cc(7,"input",6),o.gc()),2&e&&(o.wc("title",t.text.dragHint),o.Pb(3),o.Qb("href",t.downloadPath||"#",o.Oc),o.Pb(1),o.Xc(" ",t.attachment.fileName||t.attachment.customName||t.attachment.name," "),o.Pb(1),o.wc("createdOn",t.attachment.createdAt)("author",t.attachment.author)("showAuthorAsLink",!1),o.Pb(1),o.wc("ngIf",!!t.attachment.$links.delete),o.Pb(1),o.yc("name","attachments[",t.index,"][id]"),o.xc("value",t.attachment.id))},directives:[p.a,g.a,f.a,l.q],encapsulation:2});class k extends c.a{constructor(e,t,i,n){super(),this.elementRef=e,this.states=t,this.cdRef=i,this.halResourceService=n,this.destroyImmediately=!0,this.trackByHref=a.a.trackByHref,this.attachments=[],this.deletedAttachments=[]}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.updateAttachments(),this.setupResourceUpdateListener(),this.destroyImmediately||this.setupAttachmentDeletionCallback()}setupResourceUpdateListener(){this.states.forResource(this.resource).values$().pipe(this.untilDestroyed(),Object(s.a)(e=>!!e)).subscribe(e=>{this.resource=e||this.resource,this.updateAttachments(),this.cdRef.detectChanges()})}ngOnDestroy(){super.ngOnDestroy(),this.destroyImmediately||this.$formElement.off("submit.attachment-component")}removeAttachment(e){this.deletedAttachments.push(e);let t=this.attachments.filter(t=>t!==e);this.attachments.length=0,this.attachments.push(...t),this.cdRef.detectChanges()}get attachmentsUpdatable(){return this.resource.attachments&&this.resource.attachmentsBackend}setupAttachmentDeletionCallback(){this.$formElement=this.$element.closest("form"),this.$formElement.on("submit.attachment-component",()=>{this.destroyRemovedAttachments()})}destroyRemovedAttachments(){this.deletedAttachments.forEach(e=>{this.resource.removeAttachment(e)})}updateAttachments(){this.attachmentsUpdatable?this.resource.attachments.updateElements().then(()=>{this.attachments=this.resource.attachments.elements,this.cdRef.detectChanges()}):this.attachments=this.resource.attachments.elements}}k.\u0275fac=function(e){return new(e||k)(o.bc(o.q),o.bc(r.a),o.bc(o.i),o.bc(n.a))},k.\u0275cmp=o.Vb({type:k,selectors:[["attachment-list"]],inputs:{resource:"resource",destroyImmediately:"destroyImmediately"},features:[o.Mb],decls:1,vars:1,consts:[["class","work-package--attachments--files",4,"ngIf"],[1,"work-package--attachments--files"],["class","form--selected-value--list",4,"ngFor","ngForOf","ngForTrackBy"],[1,"form--selected-value--list"],[3,"attachment","resource","index","destroyImmediately","removeAttachment"]],template:function(e,t){1&e&&o.Tc(0,y,2,2,"div",0),2&e&&o.wc("ngIf",t.resource)},directives:[l.q,l.p,w],encapsulation:2})},"5qbd":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("mrSG"),s=i("4rda"),r=i("2Qcm"),a=i("r0MM");class c extends s.a{get shouldHighlight(){if(!1===this.context.options.colorize)return!1;const e=!!this.viewHighlighting&&this.viewHighlighting.shouldHighlightInline(this.name);return"table"!==this.context.container||e}}Object(n.c)([Object(a.a)(r.a,null),Object(n.e)("design:type",r.a)],c.prototype,"viewHighlighting",void 0)},"60np":function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("NawS"),s=(i("ii2/"),i("uSJ+")),r=i("wZYP"),a=i("/C7M"),c=i("qc15"),o=i("fXoL"),l=i("ofXK"),d=i("RN/J"),u=i("kor4"),h=i("N5AO"),p=i("3Pt+"),g=i("oUDv"),f=i("MIK2"),b=i("/Rze");function m(e,t){if(1&e){const e=o.ic();o.hc(0,"div",4),o.hc(1,"div",5),o.hc(2,"div",6),o.hc(3,"a",7),o.pc("accessibleClick",(function(){o.Lc(e);return o.rc().toggleRelationsCreateForm()})),o.cc(4,"op-icon",8),o.cc(5,"span",9),o.gc(),o.gc(),o.gc(),o.gc()}if(2&e){const e=o.rc();o.Pb(5),o.wc("textContent",e.text.addNewRelation)}}function w(e,t){if(1&e&&o.cc(0,"option",20),2&e){const e=t.$implicit;o.wc("textContent",e.label)("value",e.name)}}function v(e,t){if(1&e){const e=o.ic();o.hc(0,"div",10),o.hc(1,"div",11),o.cc(2,"label",12),o.hc(3,"select",13),o.pc("ngModelChange",(function(t){o.Lc(e);return o.rc().selectedRelationType=t})),o.Tc(4,w,1,2,"option",14),o.gc(),o.gc(),o.hc(5,"div",15),o.hc(6,"wp-relations-autocomplete",16),o.pc("onSelected",(function(t){o.Lc(e);return o.rc().onSelected(t)}))("onCancel",(function(){o.Lc(e);return o.rc().toggleRelationsCreateForm()})),o.gc(),o.gc(),o.hc(7,"div",17),o.hc(8,"accessible-by-keyboard",18),o.pc("execute",(function(){o.Lc(e);return o.rc().toggleRelationsCreateForm()})),o.cc(9,"op-icon",19),o.gc(),o.gc(),o.gc()}if(2&e){const e=o.rc();o.Pb(2),o.wc("textContent",e.text.relationType),o.Pb(1),o.wc("ngModel",e.selectedRelationType),o.Pb(1),o.wc("ngForOf",e.relationTypes),o.Pb(2),o.wc("workPackage",e.workPackage)("hiddenOverflowContainer",".work-packages-tab-view--overflow")("selectedRelationType",e.selectedRelationType),o.Pb(3),o.wc("icon-title",e.text.abort)}}class y{constructor(e,t,i,s){this.I18n=e,this.wpRelations=t,this.notificationService=i,this.halEvents=s,this.showRelationsCreateForm=!1,this.selectedRelationType=n.a.DEFAULT(),this.relationTypes=n.a.LOCALIZED_RELATION_TYPES(!1),this.isDisabled=!1,this.text={abort:this.I18n.t("js.relation_buttons.abort"),relationType:this.I18n.t("js.relation_buttons.relation_type"),addNewRelation:this.I18n.t("js.relation_buttons.add_new_relation")}}createRelation(){this.selectedRelationType&&this.selectedWpId&&(this.isDisabled=!0,this.createCommonRelation().catch(()=>this.isDisabled=!1).then(()=>this.isDisabled=!1))}onSelected(e){e&&(this.selectedWpId=e.id,this.createCommonRelation())}createCommonRelation(){return this.wpRelations.addCommonRelation(this.workPackage.id,this.selectedRelationType,this.selectedWpId).then(e=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:e.id,relationType:this.selectedRelationType}),this.notificationService.showSave(this.workPackage),this.toggleRelationsCreateForm()}).catch(e=>{this.notificationService.handleRawError(e,this.workPackage),this.toggleRelationsCreateForm()})}toggleRelationsCreateForm(){this.showRelationsCreateForm=!this.showRelationsCreateForm,this.selectedWpId=""}}y.\u0275fac=function(e){return new(e||y)(o.bc(r.a),o.bc(s.a),o.bc(c.a),o.bc(a.a))},y.\u0275cmp=o.Vb({type:y,selectors:[["wp-relations-create"]],inputs:{workPackage:"workPackage"},decls:4,vars:2,consts:[[1,"wp-relations-create"],["class","wp-relations-create-button hide-when-print",4,"ngIf"],["data-indicator-name","relationAddDynamic",1,"loading-indicator--location"],["class","v-align wp-relations-create--form",4,"ngIf"],[1,"wp-relations-create-button","hide-when-print"],[1,"grid-block"],[1,"grid-content","collapse","wp-inline-create-button"],["autoFocus","","href","","id","relation--add-relation",1,"wp-inline-create--add-link","relation-create",3,"accessibleClick"],["icon-classes","icon icon-add"],[3,"textContent"],[1,"v-align","wp-relations-create--form"],[1,"grid-content","collapse","medium-3"],["for","relation-type--select",1,"hidden-for-sighted",3,"textContent"],["id","relation-type--select","role","listbox","focus","",1,"form--select","relationTypeSelect",3,"ngModel","ngModelChange"],[3,"textContent","value",4,"ngFor","ngForOf"],[1,"grid-content","medium-8"],[3,"workPackage","hiddenOverflowContainer","selectedRelationType","onSelected","onCancel"],[1,"grid-content","medium-1","collapse","wp-relations-controls-section","relation-row"],["linkClass","wp-create-relation--cancel","aria-hidden","false",3,"execute"],["icon-classes","icon-remove -padded",3,"icon-title"],[3,"textContent","value"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.Tc(1,m,6,1,"div",1),o.hc(2,"div",2),o.Tc(3,v,10,7,"div",3),o.gc(),o.gc()),2&e&&(o.Pb(1),o.wc("ngIf",!t.showRelationsCreateForm),o.Pb(2),o.wc("ngIf",t.showRelationsCreateForm))},directives:[l.q,d.a,u.a,h.a,p.y,g.a,p.m,p.p,l.p,f.a,b.a,p.r,p.B],encapsulation:2})},"67Ga":function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("wZYP"),s=(i("AA01"),i("Y41n")),r=i("juWA"),a=i("59tY"),c=i("Hg4z"),o=i("fXoL"),l=i("ecJW"),d=i("oUDv"),u=i("ofXK"),h=i("N5AO");function p(e,t){if(1&e&&(o.hc(0,"span",3),o.cc(1,"op-icon",4),o.gc()),2&e){const e=o.rc();o.Qb("data-tooltip",e.timeZoneText)}}class g extends a.a{constructor(e,t){super(e,t),this.I18n=e,this.timezoneService=t,this.shouldFocus=!1,this.filterChanged=new s.a(Object(c.b)(this))}get value(){return this.filter.values[0]}get valueString(){return this.filter.values[0].toString()}set value(e){this.filter.values=[e],this.filterChanged.emit(this.filter)}get lowerBoundary(){return this.value&&this.timezoneService.isValidISODateTime(this.valueString)?this.timezoneService.parseDatetime(this.valueString):null}get upperBoundary(){return this.value&&this.timezoneService.isValidISODateTime(this.valueString)?this.timezoneService.parseDatetime(this.valueString).add(24,"hours"):null}}g.\u0275fac=function(e){return new(e||g)(o.bc(n.a),o.bc(r.a))},g.\u0275cmp=o.Vb({type:g,selectors:[["filter-date-time-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[o.Mb],decls:3,vars:6,consts:[[1,"inline-label",3,"id"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","focus","id","name","onChange"],["class","advanced-filters--tooltip-trigger -multiline",4,"ngIf"],[1,"advanced-filters--tooltip-trigger","-multiline"],["icon-classes","icon icon-warning"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"op-date-picker",1),o.pc("onChange",(function(e){return t.value=t.isoDateParser(e)})),o.gc(),o.Tc(2,p,2,1,"span",2),o.gc()),2&e&&(o.yc("id","div-values-",t.filter.id,""),o.Pb(1),o.wc("initialDate",t.isoDateFormatter(t.value))("focus",t.shouldFocus)("id","values-"+t.filter.id)("name","v["+t.filter.id+"]"),o.Pb(1),o.wc("ngIf",t.isTimeZoneDifferent))},directives:[l.a,d.a,u.q,h.a],encapsulation:2})},"6XbZ":function(e,t,i){"use strict";i.d(t,"c",(function(){return w})),i.d(t,"b",(function(){return v})),i.d(t,"a",(function(){return y}));var n=i("mrSG"),s=i("wZYP"),r=i("5+Sy"),a=i("qHU1"),c=i("QOiP"),o=i("JY8V"),l=i("pXZk"),d=i("0Usb"),u=i("cd/7"),h=i("ooSb"),p=i("/cHX"),g=i("FlxY"),f=i("r0MM");class b{constructor(e){this.injector=e}build(e){let t=document.createElement("td");t.classList.add(l.c,p.e,g.a.id,"hide-when-print");let i=document.createElement("span");return i.classList.add(p.d),this.tableActionsService.render(e).forEach(e=>{i.appendChild(e)}),t.appendChild(i),t}}Object(n.c)([Object(f.a)(),Object(n.e)("design:type",h.a)],b.prototype,"tableActionsService",void 0);var m=i("eyhC");const w="wp-table--row",v="wp--row";class y{constructor(e,t){this.injector=e,this.workPackageTable=t,this.cellBuilder=new l.a(this.injector),this.relationCellBuilder=new d.a(this.injector),this.contextLinkBuilder=new b(this.injector),this.augmentedColumns=this.buildAugmentedColumns()}get columns(){return this.wpTableColumns.getColumns()}buildAugmentedColumns(){let e=[...this.columns,g.a];return this.workPackageTable.configuration.dragAndDropEnabled&&e.unshift(g.b),e}buildCell(e,t){if(Object(c.a)(t))return this.relationCellBuilder.build(e,t);switch(t.id){case g.a.id:if(this.workPackageTable.configuration.actionsColumnEnabled)return this.contextLinkBuilder.build(e);if(this.workPackageTable.configuration.columnMenuEnabled){let e=document.createElement("td");return e.classList.add("hide-when-print"),e}return null;default:return this.cellBuilder.build(e,t)}}buildEmpty(e){let t=this.createEmptyRow(e);return this.buildEmptyRow(e,t)}createEmptyRow(e){const t=this.classIdentifier(e);let i=document.createElement("tr");return i.setAttribute("tabindex","0"),i.dataset.workPackageId=e.id,i.dataset.classIdentifier=t,i.classList.add(w,v,t,t+"-table","issue"),i}get placeholderRow(){const e=document.createElement("tr"),t=document.createElement("td");return e.classList.add("wp--placeholder-row"),t.colSpan=this.augmentedColumns.length,e.appendChild(t),e}classIdentifier(e){return"wp-row-"+e.id}refreshRow(e,t){const i=t.find("."+l.c).detach(),n=[];return this.augmentedColumns.forEach(t=>{const s=i.filter("td."+t.id);if(t.id.startsWith("__internal")||this.isColumnBeingEdited(e,t))return void n.push(s[0]);const r=this.buildCell(e,t);r&&n.push(r)}),t.prepend(n),t}isColumnBeingEdited(e,t){const i=this.workPackageTable.editing.forms[e.id];return i&&i.activeFields[t.id]}buildEmptyRow(e,t){const i=this.workPackageTable.editing.change(e);let n={};if(i&&!i.isEmpty()){const t=Object(r.d)(this.classIdentifier(e));i.changedAttributes.forEach(e=>{n[e]=t.find(`.${l.c}.${e}`)})}return this.augmentedColumns.forEach(i=>{let s,r=n[i.id];r&&r.length?(Object(a.a)(`Rendering previous open column ${i.id} on ${e.id}`),jQuery(t).append(r)):(s=this.buildCell(e,i),s&&t.appendChild(s))}),this.wpTableSelection.isSelected(e.id)&&t.classList.add(u.b),[t,!1]}}Object(n.c)([Object(f.a)(),Object(n.e)("design:type",m.a)],y.prototype,"wpTableSelection",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",o.a)],y.prototype,"wpTableColumns",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",s.a)],y.prototype,"I18n",void 0)},"6p3c":function(e,t,i){"use strict";i.d(t,"a",(function(){return V}));var n=i("Kg8T"),s=i("Y/CA"),r=i("pLZG"),a=i("Yg+W"),c=(i("5HGI"),i("4n9w")),o=i("mrSG"),l=i("wZYP"),d=i("iMRi"),u=i("6XbZ"),h=i("5+Sy"),p=i("eyhC"),g=i("JY8V"),f=i("pXZk"),b=i("FlxY"),m=i("r0MM");const w="wp-inline-create-row";class v extends u.a{constructor(e,t){super(e,t),this.injector=e,this.text={cancelButton:this.I18n.t("js.button_cancel")}}buildCell(e,t){switch(t.id){case b.a.id:return this.buildCancelButton();default:return super.buildCell(e,t)}}buildNew(e,t){const[i,n]=this.buildEmpty(e);return[i,n]}createEmptyRow(e){const t=this.classIdentifier(e),i=document.createElement("tr");return i.id=Object(h.f)(e.id),i.dataset.workPackageId=e.id,i.dataset.classIdentifier=t,i.classList.add(w,u.b,u.c,"issue",t,t+"-table"),i}buildCancelButton(){const e=document.createElement("td");return e.classList.add(f.c,"wp-table--cancel-create-td"),e.innerHTML=`\n    <a\n       href="#"\n       class="wp-table--cancel-create-link icon icon-cancel"\n       aria-label="${this.text.cancelButton}">\n    </a>\n   `,e}}Object(o.c)([Object(m.a)(),Object(o.e)("design:type",d.a)],v.prototype,"states",void 0),Object(o.c)([Object(m.a)(),Object(o.e)("design:type",p.a)],v.prototype,"wpTableSelection",void 0),Object(o.c)([Object(m.a)(),Object(o.e)("design:type",g.a)],v.prototype,"wpTableColumns",void 0),Object(o.c)([Object(m.a)(),Object(o.e)("design:type",l.a)],v.prototype,"I18n",void 0);var y=i("E2tj"),k=i("FDFi"),C=i("AEvm"),j=i("Hg4z"),P=i("dMmB"),x=i("fXoL"),S=i("ofXK"),_=i("oUDv"),O=i("kor4"),I=i("N5AO"),T=i("CS/5");const R=function(e){return{"wp-inline-create--split-link":e}};function E(e,t){if(1&e){const e=x.ic();x.hc(0,"a",6),x.pc("accessibleClick",(function(){x.Lc(e);return x.rc(3).handleAddRowClick()})),x.cc(1,"op-icon",7),x.cc(2,"span",8),x.gc()}if(2&e){const e=x.rc(3);x.wc("focus",e.focus)("ngClass",x.Bc(5,R,e.hasReferenceClass)),x.Qb("disabled",!e.isAllowed||void 0)("aria-label",e.text.create),x.Pb(2),x.wc("textContent",e.text.create)}}function M(e,t){if(1&e){const e=x.ic();x.fc(0),x.hc(1,"a",9),x.pc("accessibleClick",(function(){x.Lc(e);return x.rc(3).handleReferenceClick()})),x.cc(2,"op-icon",10),x.cc(3,"span",8),x.gc(),x.ec()}if(2&e){const e=x.rc(3);x.Pb(1),x.Qb("disabled",!e.isAllowed||void 0)("aria-label",e.text.create),x.Pb(2),x.wc("textContent",e.text.reference)}}function F(e,t){if(1&e&&(x.hc(0,"tr",2),x.hc(1,"td",3),x.hc(2,"div",4),x.Tc(3,E,3,7,"a",5),x.Tc(4,M,4,3,"ng-container",0),x.gc(),x.gc(),x.gc()),2&e){const e=x.rc(2);x.Pb(1),x.Qb("colspan",e.colspan),x.Pb(2),x.wc("ngIf",e.canAdd),x.Pb(1),x.wc("ngIf",e.canReference)}}function A(e,t){1&e&&x.dc(0)}function L(e,t){if(1&e&&(x.hc(0,"tr",2),x.hc(1,"td",11),x.Tc(2,A,1,0,"ng-container",12),x.gc(),x.gc()),2&e){const e=x.rc(2);x.Pb(1),x.Qb("colspan",e.colspan),x.Pb(1),x.wc("ngComponentOutlet",e.referenceClass)("ngComponentOutletInjector",e.injector)}}function D(e,t){if(1&e&&(x.fc(0),x.Tc(1,F,5,3,"tr",1),x.Tc(2,L,3,3,"tr",1),x.ec()),2&e){const e=x.rc();x.Pb(1),x.wc("ngIf","inactive"===e.mode),x.Pb(1),x.wc("ngIf",e.hasReferenceClass&&"reference"===e.mode)}}class V extends C.a{constructor(e,t,i,n,s,r,a,c,o,l,d){super(),this.injector=e,this.elementRef=t,this.schemaCache=i,this.I18n=n,this.querySpace=s,this.cdRef=r,this.wpCreate=a,this.wpInlineCreate=c,this.wpTableColumns=o,this.wpTableFocus=l,this.authorisationService=d,this.canAdd=!1,this.canReference=!1,this.mode="inactive",this.focus=!1,this.text=this.wpInlineCreate.buttonTexts}get isActive(){return"inactive"!==this.mode}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement)}ngAfterViewInit(){this.authorisationService.observeUntil(Object(j.b)(this)).subscribe(()=>{if(this.canReference=this.hasReferenceClass&&this.wpInlineCreate.canReference,this.canAdd=this.wpInlineCreate.canAdd,this.cdRef.detectChanges(),this.canAdd||this.canReference){jQuery(this.table.timelineBody).addClass("-inline-create-mirror")}}),this.registerCreationCallback(),this.refreshOnColumnChanges(),this.registerCancelHandler()}registerCancelHandler(){this.$element.on("click keydown",".wp-table--cancel-create-link",e=>(Object(a.b)(e,()=>{this.resetRow()}),e.stopImmediatePropagation(),!1))}refreshOnColumnChanges(){this.wpTableColumns.updates$().pipe(Object(r.a)(()=>this.isActive),this.untilDestroyed()).subscribe(()=>this.refreshRow())}registerCreationCallback(){this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed()).subscribe(e=>{this.currentWorkPackage&&this.currentWorkPackage.__initialized_at===e.__initialized_at?(this.resetRow(),this.table.configuration.isEmbedded||this.wpTableFocus.updateFocus(e.id),this.wpInlineCreate.newInlineWorkPackageCreated.next(e.id)):(this.wpCreate.cancelCreation(),this.removeWorkPackageRow(),this.showRow()),this.cdRef.detectChanges()})}handleAddRowClick(){return this.addWorkPackageRow(),!1}handleReferenceClick(){return this.mode="reference",!1}get referenceClass(){return this.wpInlineCreate.referenceComponentClass}get hasReferenceClass(){return!!this.referenceClass}addWorkPackageRow(){this.wpCreate.createOrContinueWorkPackage(this.projectIdentifier).then(e=>{const t=this.currentWorkPackage=e.projectedResource;this.editingSubscription=this.wpCreate.changesetUpdates$().pipe(Object(r.a)(()=>!!this.currentWorkPackage)).subscribe(e=>{this.isActive?(this.schemaCache.update(this.currentWorkPackage,e.schema),this.refreshRow()):this.insertRow(t)})})}insertRow(e){const t=this.workPackageEditForm=this.renderInlineCreateRow(e);setTimeout(()=>{t.activateMissingFields(),this.hideRow()})}refreshRow(){const e=new v(this.injector,this.table),t=this.$element.find(".wp-inline-create-row");t.length&&this.currentWorkPackage&&e.refreshRow(this.currentWorkPackage,t)}renderInlineCreateRow(e){const t=new v(this.injector,this.table),i=this.table.editing.startEditing(e,t.classIdentifier(e)),[n]=t.buildNew(e,i);return this.$element.append(n),i}resetRow(){this.focus=!0,this.removeWorkPackageRow(),setTimeout(()=>{this.showRow(),this.cdRef.detectChanges()},50)}removeWorkPackageRow(){this.wpCreate.cancelCreation(),this.currentWorkPackage=null,this.$element.find(".wp-row-new").remove(),this.editingSubscription&&this.editingSubscription.unsubscribe()}showRow(){this.mode="inactive",this.cdRef.detectChanges()}hideRow(){this.mode="create",this.cdRef.detectChanges()}get colspan(){return this.wpTableColumns.columnCount+1}}V.\u0275fac=function(e){return new(e||V)(x.bc(x.A),x.bc(x.q),x.bc(P.a),x.bc(l.a),x.bc(y.a),x.bc(x.i),x.bc(c.a),x.bc(k.a),x.bc(g.a),x.bc(s.a),x.bc(n.a))},V.\u0275cmp=x.Vb({type:V,selectors:[["","wpInlineCreate",""]],hostBindings:function(e,t){1&e&&x.pc("keydown.escape",(function(){return t.resetRow()}))},inputs:{table:["wp-inline-create--table","table"],projectIdentifier:["wp-inline-create--project-identifier","projectIdentifier"]},features:[x.Mb],attrs:["wpInlineCreate",""],decls:1,vars:1,consts:[[4,"ngIf"],["class","wp-inline-create-button-row hide-when-print",4,"ngIf"],[1,"wp-inline-create-button-row","hide-when-print"],[1,"wp-inline-create-button-td","-no-highlighting"],[1,"wp-inline-create-button"],["class","wp-inline-create--add-link","href","","role","link","aria-haspopup","true",3,"focus","ngClass","accessibleClick",4,"ngIf"],["href","","role","link","aria-haspopup","true",1,"wp-inline-create--add-link",3,"focus","ngClass","accessibleClick"],["icon-classes","icon icon-add"],[3,"textContent"],["href","","role","link","aria-haspopup","true",1,"wp-inline-create--reference-link","wp-inline-create--split-link",3,"accessibleClick"],["icon-classes","icon icon-link"],[1,"wp-inline-reference-row-td","-no-highlighting"],[4,"ngComponentOutlet","ngComponentOutletInjector"]],template:function(e,t){1&e&&x.Tc(0,D,3,2,"ng-container",0),2&e&&x.wc("ngIf",t.canAdd||t.canReference)},directives:[S.q,_.a,S.n,O.a,I.a,S.o,T.a],encapsulation:2})},"6yP5":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("iMRi"),s=i("FnNU"),r=i("CqXF"),a=i("E2tj"),c=i("zqrF"),o=i("Jui0"),l=i("fXoL");class d extends c.a{constructor(e,t,i){super(t),this.states=e,this.querySpace=t,this.pathHelper=i}valueFromQuery(e){return[...e.sortBy]}onReadyWithAvailable(){return Object(s.c)(this.pristineState,this.states.queries.sortBy).values$().pipe(Object(r.a)(null))}hasChanged(e){const t=e=>e.map(e=>e.href);return!_.isEqual(t(e.sortBy),t(this.current))}applyToQuery(e){const t=this.isManuallySorted(e.sortBy);return e.sortBy=[...this.current],!(t&&this.isManualSortingMode)}isSortable(e){return!!_.find(this.available,t=>t.column.$href===e.$href)}addSortCriteria(e,t){let i=this.findAvailableDirection(e,t);i&&this.add(i)}setAsSingleSortCriteria(e,t){let i=this.findAvailableDirection(e,t);i&&this.update([i])}findAvailableDirection(e,t){return _.find(this.available,i=>i.column.$href===e.$href&&i.direction.$href===t)}add(e){let t=_.uniqBy([e,...this.current],e=>e.column.$href).slice(0,3);this.update(t)}get isManualSortingMode(){return this.isManuallySorted(this.current)}switchToManualSorting(e){let t=this.manualSortObject;if(t&&!this.isManualSortingMode){if(e&&e.persisted)return e.sortBy=[t],!0;this.update([t])}return!1}get current(){return this.lastUpdatedState.getValueOr([])}get availableState(){return this.states.queries.sortBy}get available(){return this.availableState.getValueOr([])}isManuallySorted(e){return!!(e&&e.length>0)&&e[0].column.href.endsWith("/manualSorting")}get manualSortObject(){return _.find(this.available,e=>e.column.$href.endsWith("/manualSorting"))}}d.\u0275fac=function(e){return new(e||d)(l.lc(n.a),l.lc(a.a),l.lc(o.a))},d.\u0275prov=l.Xb({token:d,factory:d.\u0275fac})},"70hh":function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var n=i("wZYP"),s=i("Y41n"),r=i("4EDS"),a=i("fbLK"),c=i("ZOsW"),o=i("F5Dh"),l=i("l08T"),d=i("AEvm"),u=i("Hg4z"),h=i("fXoL"),p=i("ofXK"),g=i("Q2ix"),f=i("N5AO"),b=i("Ndcw"),m=i("xFOf");function w(e,t){if(1&e){const e=h.ic();h.hc(0,"a",20),h.pc("click",(function(){h.Lc(e);return h.rc(2).closeFilter()})),h.gc()}if(2&e){const e=h.rc(2);h.Qb("title",e.text.close_form)}}function v(e,t){if(1&e){const e=h.ic();h.hc(0,"li",22),h.pc("deactivateFilter",(function(t){h.Lc(e);return h.rc(3).deactivateFilter(t)}))("filterChanged",(function(){h.Lc(e);const t=h.rc(3);return t.filtersChanged.emit(t.filters)})),h.gc()}if(2&e){const e=h.rc(),t=e.$implicit,i=e.index,n=h.rc(2);h.yc("id","filter_",t.id,""),h.wc("shouldFocus",i==n.focusElementIndex)("filter",t)("hidden",n.isHiddenFilter(t))}}function y(e,t){if(1&e&&(h.fc(0),h.Tc(1,v,1,4,"li",21),h.ec()),2&e){const e=t.$implicit,i=h.rc(2);h.Pb(1),h.wc("ngIf",i.isFilterAvailable(e.id))}}function k(e,t){1&e&&h.cc(0,"li",9)}function C(e,t){if(1&e&&h.cc(0,"enterprise-banner",23),2&e){const e=h.rc(2);h.wc("linkMessage",e.text.upsale_link)("textMessage",e.text.upsale_for_more)}}function j(e,t){if(1&e){const e=h.ic();h.hc(0,"fieldset",1),h.cc(1,"legend",2),h.Tc(2,w,1,1,"a",3),h.hc(3,"ul",4),h.hc(4,"li",5),h.cc(5,"label",6),h.hc(6,"div",7),h.hc(7,"wp-filter-by-text-input",8),h.pc("deactivateFilter",(function(t){h.Lc(e);return h.rc().deactivateFilter(t)})),h.gc(),h.gc(),h.gc(),h.cc(8,"li",9),h.Tc(9,y,2,1,"ng-container",10),h.Tc(10,k,1,0,"li",11),h.hc(11,"li",12),h.hc(12,"label",13),h.cc(13,"op-icon",14),h.Vc(14),h.gc(),h.hc(15,"label",15),h.Vc(16),h.gc(),h.hc(17,"div",16),h.hc(18,"ng-select",17,18),h.pc("open",(function(){h.Lc(e);return h.rc().onOpen()}))("change",(function(t){h.Lc(e);return h.rc().onFilterAdded(t)})),h.gc(),h.gc(),h.gc(),h.gc(),h.Tc(20,C,1,2,"enterprise-banner",19),h.gc()}if(2&e){const e=h.rc();h.Pb(1),h.wc("textContent",e.text.selected_filter_list),h.Pb(1),h.wc("ngIf",e.showCloseFilter),h.Pb(3),h.wc("textContent",e.text.filter_by_text),h.Qb("title",e.text.filter_by_text),h.Pb(4),h.wc("ngForOf",e.filters)("ngForTrackBy",e.trackByName),h.Pb(1),h.wc("ngIf",e.isSecondSpacerVisible),h.Pb(4),h.Xc(" ",e.text.label_filter_add,": "),h.Pb(2),h.Zc(" ",e.text.label_filter_add," ",e.text.open_filter," ",e.text.close_filter," "),h.Pb(2),h.wc("items",e.remainingFilters)("clearSearchOnAdd",!0)("multiple",!1)("clearable",!0)("clearOnBackspace",!0)("closeOnSelect",!0)("virtualScroll",!0)("placeholder",e.text.please_select),h.Pb(2),h.wc("ngIf",e.eeShowBanners)}}class P extends d.a{constructor(e,t,i,n){super(),this.wpTableFilters=e,this.wpFiltersService=t,this.I18n=i,this.bannerService=n,this.showCloseFilter=!1,this.filtersChanged=new s.a(Object(u.b)(this)),this.remainingFilters=[],this.eeShowBanners=!1,this.focusElementIndex=0,this.trackByName=r.a.trackByName,this.text={open_filter:this.I18n.t("js.filter.description.text_open_filter"),label_filter_add:this.I18n.t("js.work_packages.label_filter_add"),close_filter:this.I18n.t("js.filter.description.text_close_filter"),upsale_for_more:this.I18n.t("js.filter.upsale_for_more"),upsale_link:this.I18n.t("js.filter.upsale_link"),close_form:this.I18n.t("js.close_form_title"),selected_filter_list:this.I18n.t("js.label_selected_filter_list"),button_delete:this.I18n.t("js.button_delete"),please_select:this.I18n.t("js.placeholders.selection"),filter_by_text:this.I18n.t("js.work_packages.label_filter_by_text")}}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners}ngOnChanges(){this.updateRemainingFilters()}onFilterAdded(e){if(e){let t=this.wpTableFilters.instantiate(e);this.filters.push(t);const i=this.currentFilterLength();this.updateFilterFocus(i),this.updateRemainingFilters(),this.filtersChanged.emit(this.filters),this.ngSelectComponent.clearItem(e)}}closeFilter(){this.wpFiltersService.toggleVisibility()}isHiddenFilter(e){return _.includes(this.wpTableFilters.hidden,e.id)}deactivateFilter(e){let t=this.filters.indexOf(e);_.remove(this.filters,t=>t.id===e.id),this.filtersChanged.emit(this.filters),this.updateFilterFocus(t),this.updateRemainingFilters()}get isSecondSpacerVisible(){const e=!!_.find(this.filters,e=>"search"===e.id),t=!!_.find(this.filters,e=>"search"!==e.id&&this.isFilterAvailable(e.id));return e&&t}updateRemainingFilters(){this.remainingFilters=_.sortBy(this.wpTableFilters.remainingVisibleFilters(this.filters),"name")}updateFilterFocus(e){let t=this.currentFilterLength();if(0===t)this.focusElementIndex=-1;else{const i=e<t?e:t-1,n=this.currentFilterAt(i);this.focusElementIndex=this.filters.indexOf(n)}}currentFilterLength(){return this.filters.length}currentFilterAt(e){return this.filters[e]}isFilterAvailable(e){return this.wpTableFilters.availableFilters.some(t=>t.id===e)}onOpen(){setTimeout(()=>{const e=this.ngSelectComponent;e&&e.dropdownPanel&&e.dropdownPanel._updatePosition()},25)}}P.\u0275fac=function(e){return new(e||P)(h.bc(o.a),h.bc(l.a),h.bc(n.a),h.bc(a.a))},P.\u0275cmp=h.Vb({type:P,selectors:[["query-filters"]],viewQuery:function(e,t){var i;(1&e&&h.ad(c.a,!0),2&e)&&(h.Ic(i=h.qc())&&(t.ngSelectComponent=i.first))},inputs:{filters:"filters",showCloseFilter:"showCloseFilter"},outputs:{filtersChanged:"filtersChanged"},features:[h.Mb,h.Nb],decls:1,vars:1,consts:[["id","filters","class","advanced-filters--container",4,"ngIf"],["id","filters",1,"advanced-filters--container"],[3,"textContent"],["class","advanced-filters--close icon-context icon-close",3,"click",4,"ngIf"],[1,"advanced-filters--filters"],["id","filter_search",1,"advanced-filters--filter","--without-operator"],["for","filter-by-text-input",1,"advanced-filters--filter-name",3,"textContent"],[1,"advanced-filters--filter-value"],[3,"deactivateFilter"],[1,"advanced-filters--spacer"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","advanced-filters--spacer",4,"ngIf"],[1,"advanced-filters--add-filter"],["for","add_filter_select","aria-hidden","true",1,"advanced-filters--add-filter-label"],["icon-classes","icon-add icon4"],["for","add_filter_select",1,"hidden-for-sighted"],[1,"advanced-filters--add-filter-value"],["id","add_filter_select","bindLabel","name","appendTo","body",3,"items","clearSearchOnAdd","multiple","clearable","clearOnBackspace","closeOnSelect","virtualScroll","placeholder","open","change"],["ngSelectComponent",""],["class","advanced-filters--add-filter-info","opReferrer","wp-filter#filters",3,"linkMessage","textMessage",4,"ngIf"],[1,"advanced-filters--close","icon-context","icon-close",3,"click"],["query-filter","","class","advanced-filters--filter",3,"id","shouldFocus","filter","hidden","deactivateFilter","filterChanged",4,"ngIf"],["query-filter","",1,"advanced-filters--filter",3,"id","shouldFocus","filter","hidden","deactivateFilter","filterChanged"],["opReferrer","wp-filter#filters",1,"advanced-filters--add-filter-info",3,"linkMessage","textMessage"]],template:function(e,t){1&e&&h.Tc(0,j,21,20,"fieldset",0),2&e&&h.wc("ngIf",t.filters)},directives:[p.q,g.a,p.p,f.a,c.a,b.a,m.a],encapsulation:2,changeDetection:0})},"711n":function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("mrSG"),s=i("fXoL"),r=i("iB+3"),a=i("8zkO"),c=i("FnNU"),o=i("pLZG"),l=i("IzEk"),d=i("lJxs"),u=i("wZYP"),h=i("e6KS"),p=(i("Mo6U"),i("Ie+Q")),g=i("A0F/");class f{constructor(e){this.i18nService=e,this.activeForms=new Map,window.addEventListener("beforeunload",e=>{this.thereAreFormsWithUnsavedChanges&&(e.preventDefault(),e.returnValue=this.i18nService.t("js.work_packages.confirm_edit_cancel"))})}get thereAreFormsWithUnsavedChanges(){return Array.from(this.activeForms.keys()).some(e=>!e.change.isEmpty())}addToActiveForms(e){this.activeForms.set(e,!0)}removeFromActiveForms(e){this.activeForms.delete(e)}}f.\u0275fac=function(e){return new(e||f)(s.lc(u.a))},f.\u0275prov=s.Xb({token:f,factory:f.\u0275fac,providedIn:"root"});class b extends h.a{constructor(e,t,i,n,r,a,o,l,d){super(e),this.injector=e,this.elementRef=t,this.$transitions=i,this.ConfigurationService=n,this.editingPortalService=r,this.$state=a,this.I18n=o,this.editFormRouting=l,this.globalEditFormChangesTrackerService=d,this.initializeEditMode=!1,this.skippedFields=[],this.onSavedEmitter=new s.s,this.fields={},this.registeredFields=Object(c.g)();const u=o.t("js.work_packages.confirm_edit_cancel"),h=n.warnOnLeavingUnsaved();this.unregisterListener=i.onBefore({},e=>{if(this.editing){if(!this.editFormRouting||this.editFormRouting.blockedTransition(e)){if(h&&!window.confirm(u))return!1;this.cancel(!1)}return!0}})}ngOnInit(){this.editMode=this.initializeEditMode,this.globalEditFormChangesTrackerService.addToActiveForms(this),this.initializeEditMode&&this.start()}ngOnDestroy(){this.unregisterListener(),this.globalEditFormChangesTrackerService.removeFromActiveForms(this)}activateField(e,t,i,s){return Object(n.b)(this,void 0,void 0,(function*(){return this.waitForField(i).then(n=>{n.setActive(!0);const r=n.editContainer.nativeElement;return this.editingPortalService.create(r,this.injector,e,t,i,s)})}))}reset(e,t=!1){return Object(n.b)(this,void 0,void 0,(function*(){const i=yield this.waitForField(e);i.reset(),i.deactivate(t)}))}onSaved(e){this.cancel(!1),this.onSavedEmitter.emit({savedResource:e.resource,isInitial:e.wasNew})}cancel(e=!1){this.editMode=!1,this.closeEditFields("all",e),e&&this.halEditing.reset(this.change)}requireVisible(e){return new Promise((t,i)=>{const n=setInterval(()=>{void 0!==this.fields[e]&&(clearInterval(n),t())},50)})}get editing(){return this.editMode||this.hasActiveFields()}register(e){this.fields[e.fieldName]=e,this.registeredFields.putValue(_.keys(this.fields));(this.editMode&&!this.skipField(e)||this.activeFields[e.fieldName])&&e.activateOnForm(!0)}waitForField(e){return this.registeredFields.values$().pipe(Object(o.a)(t=>t.indexOf(e)>=0),Object(l.a)(1),Object(d.a)(()=>this.fields[e])).toPromise()}start(){_.each(this.fields,e=>this.activate(e.fieldName))}focusOnFirstError(){jQuery(this.elementRef.nativeElement).find(`.${h.c}.-error .${h.b}`).first().trigger("focus")}skipField(e){const t=e.fieldName;if(!(-1!==this.skippedFields.indexOf(t)))return!1;const i=this.resource[t],n=this.change.changes[t];return i&&!n}}b.\u0275fac=function(e){return new(e||b)(s.bc(s.A),s.bc(s.q),s.bc(r.TransitionService),s.bc(a.a),s.bc(p.a),s.bc(r.StateService),s.bc(u.a),s.bc(g.a,8),s.bc(f))},b.\u0275cmp=s.Vb({type:b,selectors:[["edit-form"],["","edit-form",""]],inputs:{resource:"resource",initializeEditMode:["inEditMode","initializeEditMode"],skippedFields:"skippedFields"},outputs:{onSavedEmitter:"onSaved"},features:[s.Mb],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,t){1&e&&(s.vc(),s.uc(0))},encapsulation:2})},"72I8":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("wZYP"),s=(i("AA01"),i("Y41n")),r=i("juWA"),a=i("AEvm"),c=i("Hg4z"),o=i("fXoL"),l=i("ecJW"),d=i("oUDv");class u extends a.a{constructor(e,t){super(),this.timezoneService=e,this.I18n=t,this.shouldFocus=!1,this.filterChanged=new s.a(Object(c.b)(this))}get value(){return this.filter.values[0]}set value(e){this.filter.values=[e],this.filterChanged.emit(this.filter)}parser(e){return moment(e,"YYYY-MM-DD",!0).isValid()?e:null}formatter(e){if(moment(e,"YYYY-MM-DD",!0).isValid()){var t=this.timezoneService.parseDate(e);return this.timezoneService.formattedISODate(t)}return null}}u.\u0275fac=function(e){return new(e||u)(o.bc(r.a),o.bc(n.a))},u.\u0275cmp=o.Vb({type:u,selectors:[["filter-date-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[o.Mb],decls:2,vars:5,consts:[[3,"id"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","focus","id","name","onChange"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"op-date-picker",1),o.pc("onChange",(function(e){return t.value=t.parser(e)})),o.gc(),o.gc()),2&e&&(o.yc("id","div-values-",t.filter.id,""),o.Pb(1),o.wc("initialDate",t.formatter(t.value))("focus",t.shouldFocus)("id","values-"+t.filter.id)("name","v["+t.filter.id+"]"))},directives:[l.a,d.a],encapsulation:2})},"72oW":function(e,t,i){"use strict";i.d(t,"a",(function(){return $}));var n=i("mrSG"),s=i("fXoL"),r=i("PtkW"),a=i("Zq3F"),c=i("ooSb"),o=i("sngl"),l=i("IaZ+"),d=i("sjKJ"),u=i("+oAL"),h=i("U1xf"),p=i("Y0Nk"),g=i("pL6k"),f=i("wZYP"),b=i("E2tj"),m=i("Dp3K"),w=i("r0MM"),v=i("CNq7");class y extends m.a{constructor(){super(...arguments),this.uniqueEmbeddedTableName="embedded-table-"+Date.now(),this.initialLoadingIndicator=!0,this.renderTable=!1,this.showTablePagination=!1,this.error=null,this.initialized=!1}ngOnInit(){this.configuration=new h.a(this.providedConfiguration),this.configuration.isEmbedded=!0,this.initialized=!0,super.ngOnInit()}ngAfterViewInit(){this.loadQuery(!0,!1)}ngOnChanges(e){this.initialized&&(e.queryId||e.queryProps)&&this.loadQuery(this.initialLoadingIndicator,!1)}get projectIdentifier(){return this.configuration.projectContext?this.currentProject.identifier||void 0:this.configuration.projectIdentifier||void 0}buildQueryProps(){const e=this.querySpace.query.value;return this.wpStatesInitialization.applyToQuery(e),this.urlParamsHelper.buildV3GetQueryFromQueryResource(e)}buildUrlParams(){const e=this.querySpace.query.value;return this.wpStatesInitialization.applyToQuery(e),this.urlParamsHelper.encodeQueryJsonParams(e)}setLoaded(){this.renderTable=this.configuration.tableVisible,this.cdRef.detectChanges()}refresh(e=!0,t=!1){const i=this.querySpace.query.value,n=this.wpTablePagination.paginationObject;t&&(n.offset=1);const s=this.urlParamsHelper.buildV3GetQueryFromQueryResource(i,n),r=this.wpListService.loadQueryFromExisting(i,s,this.queryProjectScope).toPromise().then(e=>this.wpStatesInitialization.updateQuerySpace(e,e.results));return e&&(this.loadingIndicator=r),r}get isInitialized(){return!!this.configuration}set loadingIndicator(e){this.configuration.tableVisible&&(this.loadingIndicatorService.indicator(this.uniqueEmbeddedTableName).promise=e)}get queryProjectScope(){return this.configuration.projectContext?this.projectIdentifier:void 0}initializeStates(e){this.wpStatesInitialization.clearStates(),this.wpStatesInitialization.initializeFromQuery(e,e.results),this.wpStatesInitialization.updateQuerySpace(e,e.results)}}y.\u0275fac=function(e){return k(e||y)},y.\u0275dir=s.Wb({type:y,inputs:{providedConfiguration:["configuration","providedConfiguration"],uniqueEmbeddedTableName:"uniqueEmbeddedTableName",initialLoadingIndicator:"initialLoadingIndicator"},features:[s.Mb,s.Nb]}),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",v.a)],y.prototype,"apiV3Service",void 0),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",b.a)],y.prototype,"querySpace",void 0),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",f.a)],y.prototype,"I18n",void 0),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",g.a)],y.prototype,"urlParamsHelper",void 0),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",p.a)],y.prototype,"loadingIndicatorService",void 0),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",u.a)],y.prototype,"wpStatesInitialization",void 0),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",d.a)],y.prototype,"currentProject",void 0),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",s.i)],y.prototype,"cdRef",void 0);const k=s.jc(y);var C=i("lJxs"),j=i("/uUt"),P=i("zp1y"),x=i("IzEk"),S=i("PkGb"),O=i("ofXK"),I=i("lmDM"),T=i("eaMR"),R=i("V0Il"),E=i("eJFM");function M(e,t){if(1&e&&s.cc(0,"filter-container",10),2&e){const e=s.rc(3);s.wc("showFilterButton",e.configuration.showFilterButton)("filterButtonText",e.configuration.filterButtonText)}}function F(e,t){if(1&e){const e=s.ic();s.hc(0,"wp-table",11),s.pc("itemClicked",(function(t){s.Lc(e);return s.rc(3).handleWorkPackageClicked(t)}))("stateLinkClicked",(function(t){s.Lc(e);return s.rc(3).openStateLink(t)})),s.gc()}if(2&e){const e=s.rc(3);s.wc("projectIdentifier",e.projectIdentifier)("configuration",e.configuration)}}function A(e,t){if(1&e){const e=s.ic();s.hc(0,"wp-grid",12),s.pc("itemClicked",(function(t){s.Lc(e);return s.rc(3).handleWorkPackageClicked(t)}))("stateLinkClicked",(function(t){s.Lc(e);return s.rc(3).openStateLink(t)})),s.gc()}if(2&e){const e=s.rc(3);s.wc("configuration",e.configuration)}}function L(e,t){if(1&e&&(s.fc(0),s.Tc(1,M,1,2,"filter-container",4),s.Tc(2,F,1,2,"wp-table",5),s.hc(3,"div",6),s.Tc(4,A,1,1,"wp-grid",7),s.gc(),s.hc(5,"div",8),s.cc(6,"wp-table-pagination",9),s.gc(),s.ec()),2&e){const e=s.rc(2);s.Pb(1),s.wc("ngIf",e.configuration.withFilters),s.Pb(1),s.wc("ngIf",!e.configuration.isCardView),s.Pb(2),s.wc("ngIf",e.configuration.isCardView),s.Pb(2),s.wc("hideForSinglePageResults",!0)}}function D(e,t){if(1&e&&(s.hc(0,"div",13),s.cc(1,"span",14),s.gc()),2&e){const e=s.rc(2);s.Pb(1),s.wc("textContent",e.error.message||e.error)}}const V=function(e,t,i){return{"-hierarchy-disabled":e,"-compact-tables":t,"-external-height":i}};function q(e,t){if(1&e&&(s.hc(0,"div",1),s.Tc(1,L,7,4,"ng-container",2),s.Tc(2,D,2,1,"div",3),s.gc()),2&e){const e=s.rc();s.wc("ngClass",s.Dc(4,V,!e.configuration.hierarchyToggleEnabled,e.configuration.compactTableStyle,e.externalHeight)),s.Qb("data-indicator-name",e.uniqueEmbeddedTableName),s.Pb(1),s.wc("ngIf",e.renderTable),s.Pb(1),s.wc("ngIf",e.error)}}class $ extends y{constructor(){super(...arguments),this.queryProps={},this.tableActions=[],this.externalHeight=!1,this.onError=new s.s,this.onQueryLoaded=new s.s}ngOnInit(){super.ngOnInit(),this.loadedQuery=this.querySpace.query.value}ngAfterViewInit(){super.ngAfterViewInit(),this.tableActions&&this.tableActionsService.setActions(...this.tableActions),this.wpTablePagination.updates$().pipe(Object(C.a)(e=>[e.page,e.perPage]),Object(j.a)(),this.untilDestroyed(),Object(P.a)(this.querySpace.query.values$())).subscribe(([e,t])=>{const i=this.wpTablePagination.paginationObject,n=this.urlParamsHelper.buildV3GetQueryFromQueryResource(t,i);this.loadingIndicator=this.wpListService.loadQueryFromExisting(t,n,this.queryProjectScope).toPromise().then(e=>this.initializeStates(e))})}openConfigurationModal(e){this.querySpace.query.valuesPromise().then(()=>{this.opModalService.show(o.a,this.injector).onDataUpdated.subscribe(e)})}initializeStates(e){this.configuration.withFilters&&this.loadForm(e),super.initializeStates(e),this.querySpace.initialized.values$().pipe(Object(x.a)(1)).subscribe(()=>{this.showTablePagination=e.results.total>e.results.count,this.setLoaded(),this.wpTableTimeline.isVisible&&(this.configuration=Object.assign(Object.assign({},this.configuration),{compactTableStyle:!1}))})}loadForm(e){return this.formPromise?this.formPromise:this.formPromise=this.apiv3Service.withOptionalProject(this.projectIdentifier).queries.form.load(e).toPromise().then(([t,i])=>(this.wpStatesInitialization.updateStatesFromForm(e,t),t)).catch(()=>this.formPromise=void 0)}loadQuery(e=!0,t=!1){if(this.formPromise=void 0,this.loadedQuery){const e=this.loadedQuery;return this.loadedQuery=void 0,this.initializeStates(e),Promise.resolve(this.loadedQuery)}this.configuration.tableVisible||(this.queryProps.pageSize=1),t&&(this.queryProps.page=1),this.error=null;const i=this.apiv3Service.queries.find(this.queryProps,this.queryId,this.queryProjectScope).toPromise().then(e=>(this.initializeStates(e),this.onQueryLoaded.emit(e),e)).catch(e=>{this.error=this.I18n.t("js.error.embedded_table_loading",{message:_.get(e,"message",e)}),this.onError.emit(e)});return e&&(this.loadingIndicator=i),i}handleWorkPackageClicked(e){e.double&&this.$state.go("work-packages.show",{workPackageId:e.workPackageId})}openStateLink(e){this.$state.go(this.keepTab[e.requestedState]||e.requestedState,{workPackageId:e.workPackageId,focus:!0})}}$.\u0275fac=function(e){return N(e||$)},$.\u0275cmp=s.Vb({type:$,selectors:[["wp-embedded-table"]],inputs:{queryId:"queryId",queryProps:"queryProps",tableActions:"tableActions",externalHeight:"externalHeight"},outputs:{onError:"onError",onQueryLoaded:"onQueryLoaded"},features:[s.Mb],decls:1,vars:1,consts:[["class","work-packages-embedded-view--container loading-indicator--location",3,"ngClass",4,"ngIf"],[1,"work-packages-embedded-view--container","loading-indicator--location",3,"ngClass"],[4,"ngIf"],["class","notification-box -error",4,"ngIf"],[3,"showFilterButton","filterButtonText",4,"ngIf"],["class","work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration","itemClicked","stateLinkClicked",4,"ngIf"],[1,"work-packages-embedded-view--grid-view"],[3,"configuration","itemClicked","stateLinkClicked",4,"ngIf"],[1,"work-packages-split-view--tabletimeline-footer","hide-when-print"],[3,"hideForSinglePageResults"],[3,"showFilterButton","filterButtonText"],[1,"work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration","itemClicked","stateLinkClicked"],[3,"configuration","itemClicked","stateLinkClicked"],[1,"notification-box","-error"],[3,"textContent"]],template:function(e,t){1&e&&s.Tc(0,q,3,8,"div",0),2&e&&s.wc("ngIf",t.configuration)},directives:[O.q,O.n,I.a,T.a,R.a,E.a],encapsulation:2}),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",v.a)],$.prototype,"apiv3Service",void 0),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",l.b)],$.prototype,"opModalService",void 0),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",c.a)],$.prototype,"tableActionsService",void 0),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",r.a)],$.prototype,"wpTableTimeline",void 0),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",a.a)],$.prototype,"wpTablePagination",void 0),Object(n.c)([Object(w.a)(),Object(n.e)("design:type",S.a)],$.prototype,"keepTab",void 0);const N=s.jc($)},"7MH/":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("fXoL"),s=(i("kgyZ"),i("V4eP")),r=i("57Du"),a=i("5btT"),c=(i("GntA"),i("ofXK")),o=i("3Pt+"),l=i("CS/5");function d(e,t){1&e&&n.dc(0)}const u=function(e){return{"-error":e}};function h(e,t){if(1&e){const e=n.ic();n.hc(0,"div",1),n.hc(1,"form",2),n.pc("submit",(function(){n.Lc(e);return n.rc().handler.handleUserSubmit()})),n.hc(2,"label",3),n.Vc(3),n.gc(),n.Tc(4,d,1,0,"ng-container",4),n.gc(),n.gc()}if(2&e){const e=n.rc();n.Rb("inline-edit--active-field inplace-edit ",e.handler.fieldName,""),n.wc("ngClass",n.Bc(9,u,e.handler.isErrorenous)),n.Pb(2),n.wc("for",e.handler.htmlId),n.Pb(1),n.Yc(" ",e.handler.fieldLabel," ",e.handler.errorMessageOnLabel," "),n.Pb(1),n.wc("ngComponentOutlet",e.componentClass)("ngComponentOutletInjector",e.fieldInjector)}}class p{constructor(e,t,i){this.injector=e,this.editField=t,this.elementRef=i,this.onEditFieldReady=new n.s}ngOnInit(){this.editFieldHandler&&this.schemaInput?(this.handler=this.editFieldHandler,this.schema=this.schemaInput,this.change=this.changeInput):(this.handler=this.injector.get(s.c),this.schema=this.injector.get(s.d),this.change=this.injector.get(s.b)),this.componentClass=this.editField.getSpecificClassFor(this.change.pristineResource._type,this.handler.fieldName,this.schema.type),this.fieldInjector=Object(r.a)(this.injector,this.change,this.handler,this.schema)}ngOnDestroy(){this.onEditFieldReady.complete()}ngAfterViewInit(){setTimeout(()=>{this.onEditFieldReady.emit()})}}p.\u0275fac=function(e){return new(e||p)(n.bc(n.A),n.bc(a.a),n.bc(n.q))},p.\u0275cmp=n.Vb({type:p,selectors:[["edit-form-portal"]],inputs:{schemaInput:"schemaInput",changeInput:"changeInput",editFieldHandler:"editFieldHandler"},outputs:{onEditFieldReady:"onEditFieldReady"},decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["role","form","tabindex","-1",3,"submit"],[1,"hidden-for-sighted",3,"for"],[4,"ngComponentOutlet","ngComponentOutletInjector"]],template:function(e,t){1&e&&n.Tc(0,h,5,11,"div",0),2&e&&n.wc("ngIf",t.handler)},directives:[c.q,c.n,o.C,o.n,o.o,c.o,l.a],encapsulation:2})},"7bpi":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("vZpQ");class s extends n.a{get(e,t,i){switch(t){case"isMilestone":return this.isMilestone;case"isReadonly":return this.isReadonly;default:return super.get(e,t,i)}}ofProperty(e){if("combinedDate"===e){let e=super.ofProperty("startDate");return e?(e.writable=e.writable||this.isAttributeEditable("dueDate")||this.isAttributeEditable("scheduleManually"),e):null}return super.ofProperty(e)}get isReadonly(){var e;return null===(e=this.resource.status)||void 0===e?void 0:e.isReadonly}isAttributeEditable(e){return(!this.isReadonly||"status"===e)&&(["startDate","dueDate","date"].includes(e)&&this.resource.scheduleManually?super.isAttributeEditable("scheduleManually"):super.isAttributeEditable(e))}get isMilestone(){return this.schema.hasOwnProperty("date")}mappedName(e){return!this.isMilestone||"startDate"!==e&&"dueDate"!==e?e:"date"}}},"7ond":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.minimumOffsetForNewSwitchInMs=100,this.lastFocusSwitch=-this.minimumOffsetForNewSwitchInMs,this.lastPriority=-1}throttleAndCheckIfAllowedFocusChangeBasedOnTimeout(){var e=Date.now()-this.lastFocusSwitch>=this.minimumOffsetForNewSwitchInMs;return this.lastFocusSwitch=Date.now(),e}checkIfAllowedFocusChange(e){var t=this.throttleAndCheckIfAllowedFocusChangeBasedOnTimeout();if(t)this.lastPriority=-1;else if(e>this.lastPriority)return this.lastPriority=e,!0;return t}getFocusableElement(e){var t=e.find("input.ui-select-focusser");if(t.length>0)return t[0];var i=e;return e.is(s.FOCUSABLE_SELECTORS)||(i=e.find(s.FOCUSABLE_SELECTORS)),i[0]}focus(e){var t=jQuery(this.getFocusableElement(e)),i=jQuery(t),n=i.is("[disabled]");n&&!i.attr("ng-disabled")&&i.prop("disabled",!1),t.focus(),n&&!i.attr("ng-disabled")&&i.prop("disabled",!0)}focusElement(e,t){this.checkIfAllowedFocusChange(t)&&setTimeout(()=>{this.focus(e)},10)}}s.FOCUSABLE_SELECTORS="a, button, :input, [tabindex], select",s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac,providedIn:"root"})},"7xci":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("mrSG"),s=i("wyKs"),r=i("E2tj"),a=i("VgZ9"),c=i("iMRi"),o=i("Va5K"),l=i("CNq7"),d=i("fXoL");class u{constructor(e,t,i,n,s,r){this.wpViewHierarchies=e,this.wpDisplayRepresentation=t,this.states=i,this.wpRelationHierarchy=n,this.apiV3Service=s,this.querySpace=r}get applicable(){return this.wpViewHierarchies.isEnabled&&this.wpDisplayRepresentation.isList}canIndent(e){if(!e.changeParent||!this.applicable)return!1;const t=this.renderedWorkPackageIds,i=t.indexOf(e.id);if(0===i)return!1;const n=e.ancestorIds,s=n.length;if(0===s)return!0;const r=n[s-1];return t[i-1]!==r}canOutdent(e){return!(!e.changeParent||!this.applicable)&&!!e.parent}indent(e){return Object(n.b)(this,void 0,void 0,(function*(){if(!this.canIndent(e))return Promise.reject();const t=this.renderedWorkPackageIds,i=t.indexOf(e.id),n=t[i-1];let s=n;const r=yield this.apiV3Service.work_packages.id(n).get().toPromise(),a=_.difference(r.ancestorIds,e.ancestorIds);return a&&a.length>0&&(s=a[0]),this.wpRelationHierarchy.changeParent(e,s)}))}outdent(e){if(!this.canOutdent(e))return Promise.reject();let t=null;const i=e.ancestorIds,n=i.length;return n>1&&(t=i[n-2]),this.wpRelationHierarchy.changeParent(e,t)}get renderedWorkPackageIds(){return this.querySpace.renderedWorkPackageIds.getValueOr([])}}u.\u0275fac=function(e){return new(e||u)(d.lc(s.a),d.lc(o.a),d.lc(c.a),d.lc(a.a),d.lc(l.a),d.lc(r.a))},u.\u0275prov=d.Xb({token:u,factory:u.\u0275fac})},"8+xT":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));i("ii2/");var n=i("wZYP"),s=i("VFHb"),r=i("AEvm"),a=i("CNq7"),c=i("fXoL"),o=i("ofXK"),l=i("N5AO");function d(e,t){if(1&e&&c.cc(0,"span",4),2&e){const e=c.rc(2);c.wc("textContent",e.buttonText)}}function u(e,t){if(1&e){const e=c.ic();c.hc(0,"button",1),c.pc("click",(function(){c.Lc(e);return c.rc().toggleWatch()})),c.cc(1,"op-icon",2),c.Tc(2,d,1,1,"span",3),c.gc()}if(2&e){const e=c.rc();c.wc("disabled",e.disabled)("ngClass",e.buttonClass)("id",e.buttonId),c.Qb("title",e.buttonTitle),c.Pb(1),c.yc("icon-classes","button--icon ",e.watchIconClass,""),c.Pb(1),c.wc("ngIf",e.showText)}}class h extends r.a{constructor(e,t,i,n){super(),this.I18n=e,this.wpWatchersService=t,this.apiV3Service=i,this.cdRef=n,this.showText=!1,this.disabled=!1}ngOnInit(){this.apiV3Service.work_packages.id(this.workPackage).requireAndStream().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackage=e,this.setWatchStatus(),this.cdRef.detectChanges()})}get isWatched(){return this.workPackage.hasOwnProperty("unwatch")}get displayWatchButton(){return this.isWatched||this.workPackage.hasOwnProperty("watch")}toggleWatch(){const e=this.nextStateLink();e(e.$link.payload).then(()=>{this.wpWatchersService.clear(this.workPackage.id),this.apiV3Service.work_packages.id(this.workPackage).refresh()})}nextStateLink(){const e=this.isWatched?"unwatch":"watch";return this.workPackage[e]}setWatchStatus(){this.isWatched?(this.buttonTitle=this.I18n.t("js.label_unwatch_work_package"),this.buttonText=this.I18n.t("js.label_unwatch"),this.buttonClass="-active",this.buttonId="unwatch-button",this.watchIconClass="icon-watched"):(this.buttonTitle=this.I18n.t("js.label_watch_work_package"),this.buttonText=this.I18n.t("js.label_watch"),this.buttonClass="",this.buttonId="watch-button",this.watchIconClass="icon-unwatched")}}h.\u0275fac=function(e){return new(e||h)(c.bc(n.a),c.bc(s.a),c.bc(a.a),c.bc(c.i))},h.\u0275cmp=c.Vb({type:h,selectors:[["wp-watcher-button"]],inputs:{workPackage:"workPackage",showText:"showText",disabled:"disabled"},features:[c.Mb],decls:1,vars:1,consts:[["class","button toolbar-icon",3,"disabled","ngClass","id","click",4,"ngIf"],[1,"button","toolbar-icon",3,"disabled","ngClass","id","click"],[3,"icon-classes"],["class","button--text",3,"textContent",4,"ngIf"],[1,"button--text",3,"textContent"]],template:function(e,t){1&e&&c.Tc(0,u,3,6,"button",0),2&e&&c.wc("ngIf",t.displayWatchButton)},directives:[o.q,o.n,l.a],encapsulation:2,changeDetection:0})},"80WE":function(e,t,i){"use strict";i.d(t,"a",(function(){return C}));var n,s=i("iMRi"),r=i("SKFm");!function(e){e.hasSelectionWithin=function(e){try{const t=window.getSelection(),i=t.toString().length>0,n=e.contains(t.anchorNode);return i&&n}catch(t){return console.error("Failed to test whether in selection ",t),!1}}}(n||(n={}));var a=i("qHU1"),c=i("8zkO"),o=i("4lR/"),l=i("d/TE"),d=i("wZYP"),u=i("GjwL"),h=i("711n"),p=(i("Mo6U"),i("AEvm")),g=i("dMmB"),f=i("KEdw"),b=i("fXoL"),m=i("ofXK"),w=i("kor4");const v=["displayContainer"],y=["editContainer"],k=function(e,t,i,n){return[e,t,i,n]};class C extends p.a{constructor(e,t,i,n,s,r,a,c,o,l,d){super(),this.states=e,this.injector=t,this.elementRef=i,this.ConfigurationService=n,this.opContextMenu=s,this.halEditing=r,this.schemaCache=a,this.editForm=c,this.NotificationsService=o,this.cdRef=l,this.I18n=d,this.displayFieldOptions={},this.isDropTarget=!1,this.editFieldContainerClass=f.c,this.active=!1,this.destroyed=!1}setActive(e=!0){this.active=e,this.componentDestroyed||this.cdRef.detectChanges()}ngOnInit(){var e;this.fieldRenderer=new f.a(this.injector,"single-view",this.displayFieldOptions),this.$element=jQuery(this.elementRef.nativeElement),null===(e=this.editForm)||void 0===e||e.register(this),this.halEditing.temporaryEditResource(this.resource).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.resource=e,this.render()})}startDragOverActivation(e){return!(this.isDropTarget&&this.isEditable&&!this.active)||(this.handleUserActivate(null),e.preventDefault(),!1)}render(){const e=this.fieldRenderer.render(this.resource,this.fieldName,null,this.displayPlaceholder);this.displayContainer.nativeElement.innerHTML="",this.displayContainer.nativeElement.appendChild(e)}deactivate(e=!1){this.editContainer.nativeElement.innerHTML="",this.editContainer.nativeElement.hidden=!0,this.setActive(!1),e&&setTimeout(()=>this.$element.find("."+f.b).focus(),20)}get isEditable(){return this.editForm&&this.schema.isAttributeEditable(this.fieldName)}activateIfEditable(e){if(n.hasSelectionWithin(e.target))return Object(a.a)(`Not activating ${this.fieldName} because of active selection within`),!0;return jQuery(e.target).closest("a,macro",this.displayContainer.nativeElement).length>0||(this.isEditable&&this.handleUserActivate(e),this.opContextMenu.close(),e.preventDefault(),e.stopImmediatePropagation(),!1)}activateOnForm(e=!1){return this.setActive(!0),this.editForm.activate(this.fieldName,e).catch(()=>this.deactivate(!0))}handleUserActivate(e){let t=0;return e&&(t=u.a.getPosition(e)),this.activateOnForm().then(e=>{e&&(e.$onUserActivate.next(),e.focus(t))}),!1}reset(){this.render(),this.deactivate()}get schema(){return this.halEditing.typedState(this.resource).hasValue()?this.halEditing.typedState(this.resource).value.schema:this.schemaCache.of(this.resource)}}C.\u0275fac=function(e){return new(e||C)(b.bc(s.a),b.bc(b.A),b.bc(b.q),b.bc(c.a),b.bc(o.a),b.bc(r.a),b.bc(g.a),b.bc(h.a,8),b.bc(l.a),b.bc(b.i),b.bc(d.a))},C.\u0275cmp=b.Vb({type:C,selectors:[["editable-attribute-field"]],viewQuery:function(e,t){var i;(1&e&&(b.Rc(v,!0),b.Rc(y,!0)),2&e)&&(b.Ic(i=b.qc())&&(t.displayContainer=i.first),b.Ic(i=b.qc())&&(t.editContainer=i.first))},inputs:{fieldName:"fieldName",resource:"resource",wrapperClasses:"wrapperClasses",displayFieldOptions:"displayFieldOptions",displayPlaceholder:"displayPlaceholder",isDropTarget:"isDropTarget"},features:[b.Mb],decls:5,vars:9,consts:[[3,"ngClass","dragover"],[3,"hidden"],["editContainer",""],["tabindex","-1",3,"accessibleClickStopEvent","hidden","accessibleClick"],["displayContainer",""]],template:function(e,t){1&e&&(b.hc(0,"div",0),b.pc("dragover",(function(e){return t.startDragOverActivation(e)})),b.cc(1,"div",1,2),b.hc(3,"div",3,4),b.pc("accessibleClick",(function(e){return t.activateIfEditable(e)})),b.gc(),b.gc()),2&e&&(b.wc("ngClass",b.Ec(4,k,t.editFieldContainerClass,t.fieldName,t.active?"-active":"",t.wrapperClasses||"-small")),b.Pb(1),b.wc("hidden",!t.active),b.Pb(2),b.wc("accessibleClickStopEvent",!1)("hidden",t.active))},directives:[m.n,w.a],encapsulation:2,changeDetection:0})},"82q4":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("fXoL"),s=i("nv3t"),r=i("N5AO");class a{}a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=n.Vb({type:a,selectors:[["wp-fold-toggle-view-button"]],decls:4,vars:0,consts:[["id","wp-fold-toggle-button","wpGroupToggleDropdown","",1,"button"],["icon-classes","button--icon icon-outline"],[1,"button--text"],["icon-classes","button--icon icon-small icon-pulldown"]],template:function(e,t){1&e&&(n.hc(0,"button",0),n.cc(1,"op-icon",1),n.cc(2,"span",2),n.cc(3,"op-icon",3),n.gc())},directives:[s.a,r.a],encapsulation:2,changeDetection:0})},"87fy":function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("mrSG"),s=i("Uyc6"),r=i("iMRi"),a=i("4n9w"),c=i("sjKJ"),o=i("FDFi"),l=i("tmNb"),d=i("99YG"),u=i("qc15"),h=i("CNq7"),p=i("fXoL");class g{constructor(e,t,i,n,s,r,a,c,o){this.states=e,this.injector=t,this.reorderService=i,this.wpCreate=n,this.notificationService=s,this.apiV3Service=r,this.currentProject=a,this.dragService=c,this.wpInlineCreate=o}init(e){this.cardView=e}destroy(){null!==this.dragService&&this.dragService.remove(this.cardView.container.nativeElement)}registerDragAndDrop(){null!==this.dragService&&this.dragService.register({dragContainer:this.cardView.container.nativeElement,scrollContainers:[this.cardView.container.nativeElement],moves:e=>{const t=e.dataset.workPackageId,i=this.states.workPackages.get(t).value;return!!i&&this.cardView.canDragOutOf(i)&&!e.dataset.isNew},accepts:()=>this.cardView.dragInto,onMoved:e=>Object(n.b)(this,void 0,void 0,(function*(){const t=e.dataset.workPackageId,i=d.a.findIndex(e),n=yield this.reorderService.move(this.currentOrder,t,i);this.updateOrder(n),this.cardView.onMoved.emit()})),onRemoved:e=>{const t=e.dataset.workPackageId,i=this.reorderService.remove(this.currentOrder,t);this.updateOrder(i)},onAdded:e=>Object(n.b)(this,void 0,void 0,(function*(){const t=e.dataset.workPackageId,i=d.a.findIndex(e),n=yield this.apiV3Service.work_packages.id(t).get().toPromise(),s=yield this.addWorkPackageToQuery(n,i);return e.parentElement&&e.parentElement.removeChild(e),s}))})}get workPackages(){return this._workPackages}set workPackages(e){if(this.activeInlineCreateWp){let t=this._workPackages.find(e=>e.isNew);if(t){let e=this._workPackages.indexOf(t);this._workPackages[e]=this.activeInlineCreateWp}else this._workPackages=[this.activeInlineCreateWp,...e]}else this._workPackages=[...e]}get currentOrder(){return this.workPackages.filter(e=>e&&!e.isNew).map(e=>e.id)}updateOrder(e){e=_.uniq(e),Promise.all(e.map(e=>this.apiV3Service.work_packages.id(e).get().toPromise())).then(e=>{this.workPackages=e,this.cardView.cdRef.detectChanges()})}addNewCard(){this.wpCreate.createOrContinueWorkPackage(this.currentProject.identifier).then(e=>{this.activeInlineCreateWp=e.projectedResource,this.workPackages=this.workPackages,this.cardView.cdRef.detectChanges()})}addWorkPackageToQuery(e,t=-1){return Object(n.b)(this,void 0,void 0,(function*(){try{yield this.cardView.workPackageAddedHandler(e);const i=yield this.reorderService.add(this.currentOrder,e.id,t);return this.updateOrder(i),!0}catch(i){this.notificationService.handleRawError(i,e)}return!1}))}removeReferenceWorkPackageForm(){this.activeInlineCreateWp&&this.removeCard(this.activeInlineCreateWp)}removeCard(e){const t=this.workPackages.indexOf(e);if(this.workPackages.splice(t,1),this.activeInlineCreateWp=void 0,!e.isNew){const t=this.reorderService.remove(this.currentOrder,e.id);this.updateOrder(t)}}onCardSaved(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=this.workPackages.findIndex(e=>"new"===e.id);if(-1!==t){this.activeInlineCreateWp=void 0;const i=yield this.reorderService.add(this.currentOrder,e.id,t);this.updateOrder(i),this.wpInlineCreate.newInlineWorkPackageCreated.next(e.id)}}))}}g.\u0275fac=function(e){return new(e||g)(p.lc(r.a),p.lc(p.A),p.lc(s.a),p.lc(a.a),p.lc(u.a),p.lc(h.a),p.lc(c.a),p.lc(l.a,8),p.lc(o.a))},g.\u0275prov=p.Xb({token:g,factory:g.\u0275fac})},"8OyR":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.setBodyCursor=function(e,t=""){document.body.style.setProperty("cursor",e,t)}}(n||(n={}))},"8VVp":function(e,t,i){"use strict";i.d(t,"a",(function(){return K}));var n=i("fXoL"),s=i("tk/3"),r=i("ii2/"),a=i("NawS"),c=i("DYFc"),o=i("Mo6U");class l extends o.a{get state(){return this.states.types.get(this.href)}}var d=i("oa+u"),u=i("XZsv"),h=i("y2Tr"),p=i("hxxE");class g extends p.a{}var f=i("B4Ei");class b extends o.a{getErrors(){const e=_.values(this.validationErrors),t=e.length;if(0===t)return null;let i;return 1===t?i=new u.a(this.injector,e[0],!0,this.halInitializer,"Error"):(i=new u.a(this.injector,{},!0,this.halInitializer,"Error"),i.errorIdentifier=u.b,i.errors=e),i.isValidationError=!0,i}}var m=i("AA01"),w=i("GURL"),v=i("d4d5");class y extends o.a{}class k extends o.a{get id(){return this.$source.id||this.idFromLink}get idFromLink(){if(this.$href){const e=o.a.idFromLink(this.$href);return decodeURIComponent(e)}return""}set id(e){this.$source.id=e}}var C=i("LrpJ");class j extends o.a{}const P=Object(C.a)(j);var x=i("RWlv");class S extends o.a{constructor(){super(...arguments),this.attachmentsBackend=!1}}const O=Object(C.a)(S);class I extends o.a{constructor(){super(...arguments),this.attachmentsBackend=!1}}const T=Object(C.a)(I);class R extends o.a{constructor(){super(...arguments),this.attachmentsBackend=!1}}const E=Object(C.a)(R);var M=i("ev9f"),F=i("/8SZ"),A=i("PHo6"),L=i("uhGA");class D extends o.a{get state(){return this.states.timeEntries.get(this.id)}$linkableKeys(){return _.without(super.$linkableKeys(),"schema")}}class V extends o.a{}var q=i("Nnhs");class $ extends o.a{}class N extends o.a{}class B extends o.a{get state(){return this.states.projects.get(this.id)}getEditorTypeFor(e){return-1!==["statusExplanation","description"].indexOf(e)?"full":"constrained"}$linkableKeys(){return _.without(super.$linkableKeys(),"schema")}}class z extends o.a{}const H={WorkPackage:{cls:r.a,attrTypes:{parent:"WorkPackage",ancestors:"WorkPackage",children:"WorkPackage",relations:"Relation",schema:"Schema",status:"Status",type:"Type"}},Activity:{cls:o.a,attrTypes:{user:"User"}},"Activity::Comment":{cls:o.a,attrTypes:{user:"User"}},"Activity::Revision":{cls:o.a,attrTypes:{user:"User"}},Relation:{cls:a.a,attrTypes:{from:"WorkPackage",to:"WorkPackage"}},Schema:{cls:c.a},Type:{cls:l},Status:{cls:M.a},SchemaDependency:{cls:d.a},Error:{cls:u.a},User:{cls:h.a},Group:{cls:z},Collection:{cls:p.a},WorkPackageCollection:{cls:g},AttachmentCollection:{cls:F.a},Query:{cls:f.a,attrTypes:{filters:"QueryFilterInstance"}},Form:{cls:b,attrTypes:{payload:"FormPayload"}},FormPayload:{cls:o.a,attrTypes:{attachments:"AttachmentsCollection"}},QueryFilterInstance:{cls:m.a,attrTypes:{schema:"QueryFilterInstanceSchema",filter:"QueryFilter",operator:"QueryOperator"}},QueryFilterInstanceSchema:{cls:w.a},QueryFilter:{cls:v.a},Root:{cls:y},QueryOperator:{cls:k},HelpText:{cls:P},CustomAction:{cls:x.a},WikiPage:{cls:O},MeetingContent:{cls:T},Post:{cls:E},Project:{cls:B},Role:{cls:N},Grid:{cls:L.a},GridWidget:{cls:A.a},TimeEntry:{cls:D},Membership:{cls:$},News:{cls:V},Version:{cls:q.a}};var Q=i("kTsZ"),W=i("HGdY"),X=i("ofXK"),U=i("POAS"),G=i("wZYP");class Y extends n.r{constructor(e){super(),this.I18n=e,this.text={internal_error:this.I18n.t("js.error.internal")}}handleError(e){let t=this.text.internal_error;e instanceof u.a?(console.error("Returned error resource %O",e),t+=" "+e.errorMessages.join("\n")):e instanceof o.a?(console.error("Returned hal resource %O",e),t+="Resource returned "+e.name):e instanceof Error?window.ErrorReporter.captureException(e):"string"==typeof e&&(window.ErrorReporter.captureMessage(e),t=e),super.handleError(t)}}Y.\u0275fac=function(e){return new(e||Y)(n.lc(G.a))},Y.\u0275prov=n.Xb({token:Y,factory:Y.\u0275fac});class K{}K.\u0275mod=n.Zb({type:K}),K.\u0275inj=n.Yb({factory:function(e){return new(e||K)},providers:[{provide:n.r,useClass:Y},{provide:s.a,useClass:W.a,multi:!0},{provide:n.c,useFactory:function(e){return()=>{_.each(H,(t,i)=>e.registerResource(i,t))}},deps:[Q.a],multi:!0},U.a],imports:[[X.b,s.c]]})},"8YXA":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("iB+3"),s=i("4lR/"),r=i("13ri"),a=i("PUHT"),c=i("RGDJ"),o=i("buwf"),l=i("4n9w"),d=i("fXoL");class u extends a.a{constructor(e,t,i,n,s){super(e,t),this.elementRef=e,this.opContextMenu=t,this.browserDetector=i,this.wpCreate=n,this.$state=s}ngAfterViewInit(){super.ngAfterViewInit(),this.active&&this.browserDetector.isMobile&&(this.stateName="work-packages.new")}open(e){this.wpCreate.getEmptyForm(this.projectIdentifier).then(t=>{this.buildItems(t.schema.type.allowedValues),this.opContextMenu.show(this,e)})}get locals(){return{items:this.items,contextMenuId:"types-context-menu"}}buildItems(e){this.items=e.map(e=>({disabled:!1,linkText:e.name,href:this.$state.href(this.stateName,{type:e.id}),ariaLabel:e.name,class:c.a.inlineClass("type",e.id),onClick:t=>!r.a.isClickedWithModifier(t)&&(this.$state.go(this.stateName,{type:e.id}),!0)}))}}u.\u0275fac=function(e){return new(e||u)(d.bc(d.q),d.bc(s.a),d.bc(o.a),d.bc(l.a),d.bc(n.StateService))},u.\u0275dir=d.Wb({type:u,selectors:[["","opTypesCreateDropdown",""]],inputs:{projectIdentifier:"projectIdentifier",stateName:"stateName",active:["dropdownActive","active"]},features:[d.Mb]})},"8aTQ":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("SqdZ"),s=i("IaZ+"),r=i("wZYP"),a=i("fXoL"),c=i("ofXK");function o(e,t){if(1&e){const e=a.ic();a.hc(0,"a",11),a.hc(1,"i",12),a.pc("click",(function(t){a.Lc(e);return a.rc().closeMe(t)})),a.gc(),a.gc()}if(2&e){const e=a.rc();a.Pb(1),a.Qb("title",e.text.close_popup)}}function l(e,t){if(1&e&&(a.hc(0,"span"),a.cc(1,"br"),a.hc(2,"strong"),a.Vc(3),a.gc(),a.gc()),2&e){const e=t.$implicit;a.Pb(3),a.Wc(e)}}const d=function(e){return{"-highlight -danger-zone":e}};class u extends n.a{constructor(e,t,i,n){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.I18n=n,this.confirmed=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text"),button_continue:this.I18n.t("js.button_continue"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.options=t.options||{},this.dangerHighlighting=_.defaultTo(this.options.dangerHighlighting,!1),this.passedData=_.defaultTo(this.options.passedData,[]),this.closeOnEscape=_.defaultTo(this.options.closeByEscape,!0),this.closeOnOutsideClick=_.defaultTo(this.options.closeByDocument,!0),this.showClose=_.defaultTo(this.options.showClose,!0),this.text=_.defaults(this.options.text,this.text)}confirmAndClose(e){this.confirmed=!0,this.closeMe(e)}}u.\u0275fac=function(e){return new(e||u)(a.bc(a.q),a.bc(s.a),a.bc(a.i),a.bc(r.a))},u.\u0275cmp=a.Vb({type:u,selectors:[["ng-component"]],features:[a.Mb],decls:13,vars:12,consts:[[1,"op-modal--portal","confirm-form-submit--modal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","confirm-dialog--modal","loading-indicator--location",3,"ngClass"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-attention",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[3,"textContent"],[4,"ngFor","ngForOf"],[1,"op-modal--modal-footer"],[1,"confirm-form-submit--continue","button",3,"ngClass","textContent","click"],[1,"confirm-form-submit--cancel","button",3,"textContent","click"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.Tc(3,o,2,1,"a",3),a.cc(4,"h3",4),a.gc(),a.hc(5,"div",5),a.hc(6,"p"),a.cc(7,"span",6),a.cc(8,"br"),a.Tc(9,l,4,1,"span",7),a.gc(),a.gc(),a.hc(10,"div",8),a.hc(11,"button",9),a.pc("click",(function(e){return t.confirmAndClose(e)})),a.gc(),a.hc(12,"button",10),a.pc("click",(function(e){return t.closeMe(e)})),a.gc(),a.gc(),a.gc(),a.gc()),2&e&&(a.Pb(1),a.wc("ngClass",a.Bc(10,d,t.dangerHighlighting)),a.Pb(2),a.wc("ngIf",t.showClose),a.Pb(1),a.wc("textContent",t.text.title),a.Pb(3),a.wc("textContent",t.text.text),a.Pb(2),a.wc("ngForOf",t.passedData),a.Pb(2),a.wc("ngClass",t.dangerHighlighting?"-danger":"-highlight")("textContent",t.text.button_continue),a.Qb("title",t.text.button_continue),a.Pb(1),a.wc("textContent",t.text.button_cancel),a.Qb("title",t.text.button_cancel))},directives:[c.n,c.q,c.p],encapsulation:2})},"8ggW":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("3Pt+"),s=i("ofXK"),r=i("fXoL");class a{}a.\u0275mod=r.Zb({type:a}),a.\u0275inj=r.Yb({factory:function(e){return new(e||a)},imports:[[n.i,s.b]]})},"8h6p":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("fXoL"),s=i("ofXK");function r(e,t){if(1&e&&n.cc(0,"span",3),2&e){const e=n.rc();n.wc("textContent",e.description)}}class a{constructor(){this.setHostClass=!0}}a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=n.Vb({type:a,selectors:[["no-results"]],hostVars:2,hostBindings:function(e,t){2&e&&n.Tb("generic-table--no-results-container",t.setHostClass)},inputs:{title:"title",description:"description"},decls:4,vars:2,consts:[["aria-hidden","true",1,"icon-info1"],[1,"generic-table--no-results-title"],[3,"textContent",4,"ngIf"],[3,"textContent"]],template:function(e,t){1&e&&(n.cc(0,"i",0),n.hc(1,"span",1),n.Vc(2),n.Tc(3,r,1,1,"span",2),n.gc()),2&e&&(n.Pb(2),n.Xc(" ",t.title," "),n.Pb(1),n.wc("ngIf",t.description))},directives:[s.q],encapsulation:2})},"8ocD":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(){this.fields={},this.classes={}}fieldType(e){return this.fields[e]}getClassFor(e,t="unknown"){let i=this.fieldType(e)||this.fieldType(t)||this.defaultFieldType;return this.classes[i]}getSpecificClassFor(e,t,i="unknown"){let n=this.fieldType(`${e}-${t}`)||this.fieldType(`${e}-${i}`);return n?this.classes[n]:this.getClassFor(t,i)}addFieldType(e,t,i){return e.fieldType=t,this.register(e,i),this}addSpecificFieldType(e,t,i,n){return t.fieldType=`${e}-${i}`,n=n.map(t=>`${e}-${t}`),this.register(t,n),this}extendFieldType(e,t){let i=this.classes[e]||this.getClassFor(e);return this.addFieldType(i,e,t)}register(e,t=[]){const i=e.fieldType;t.forEach(e=>this.fields[e]=i),this.classes[i]=e}}},"8zkO":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("wZYP"),s=i("wd/R"),r=i("CNq7"),a=i("fXoL");class c{constructor(e,t){this.I18n=e,this.apiV3Service=t,this.initialized=this.loadConfiguration().then(()=>!0).catch(()=>!1)}commentsSortedInDescendingOrder(){return this.userPreference("commentSortDescending")}warnOnLeavingUnsaved(){return this.userPreference("warnOnLeavingUnsaved")}autoHidePopups(){return this.userPreference("autoHidePopups")}isTimezoneSet(){return!!this.timezone()}timezone(){return this.userPreference("timeZone")}isDirectUploads(){return!!this.prepareAttachmentURL}get prepareAttachmentURL(){return _.get(this.configuration,["prepareAttachment","href"])}get maximumAttachmentFileSize(){return this.systemPreference("maximumAttachmentFileSize")}get perPageOptions(){return this.systemPreference("perPageOptions")}dateFormatPresent(){return!!this.systemPreference("dateFormat")}dateFormat(){return this.systemPreference("dateFormat")}timeFormatPresent(){return!!this.systemPreference("timeFormat")}timeFormat(){return this.systemPreference("timeFormat")}startOfWeekPresent(){return!!this.systemPreference("startOfWeek")}startOfWeek(){return this.startOfWeekPresent()?this.systemPreference("startOfWeek"):s.localeData(I18n.locale).firstDayOfWeek()}loadConfiguration(){return this.apiV3Service.configuration.get().toPromise().then(e=>{this.configuration=e})}userPreference(e){return _.get(this.configuration,["userPreferences",e])}systemPreference(e){return _.get(this.configuration,e)}}c.\u0275fac=function(e){return new(e||c)(a.lc(n.a),a.lc(r.a))},c.\u0275prov=a.Xb({token:c,factory:c.\u0275fac,providedIn:"root"})},"9+6k":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("AEvm");class s extends n.a{constructor(e){super(),this.opContextMenu=e,this.items=[]}onClose(){this.afterFocusOn.focus()}onOpen(e){e.find(".menu-item").first().focus()}positionArgs(e){return{my:"left top",at:"right bottom",of:e,collision:"flipfit"}}get locals(){return{items:this.items}}open(e){this.opContextMenu.show(this,e)}get afterFocusOn(){return this.$element}}},"99YG":function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.findIndex=function(e){return e.parentElement?Array.from(e.parentElement.children).indexOf(e):-1},e.reinsert=function(e,t,i){t="string"==typeof t?parseInt(t,10):t;const n=e.parentNode&&Array.from(e.parentNode.children).indexOf(e)||null,s=Array.from(i.children);let r;if(null!=n){r=n>t?s[t]:s[t+1]}else r=s[t];r?i.insertBefore(e,r):i.appendChild(e)}}(n||(n={}))},"9nXh":function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return l}));var n=i("mrSG"),s=i("iMRi"),r=i("6XbZ"),a=i("PtkW"),c=i("r0MM");const o="wp-timeline-cell";class l{constructor(e,t){this.injector=e,this.workPackageTable=t}build(e){const t=document.createElement("div");return t.classList.add(o,r.b),e&&(t.dataset.workPackageId=e),t}insert(e,t,i=[]){const n=this.build(e);n.classList.add(...i),t.appendChild(n)}}Object(n.c)([Object(c.a)(),Object(n.e)("design:type",s.a)],l.prototype,"states",void 0),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",a.a)],l.prototype,"wpTableTimeline",void 0)},"9oW/":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("mrSG"),s=i("8zkO"),r=i("VNOR"),a=i("r0MM"),c=i("fXoL"),o=i("k8lp"),l=i("ofXK"),d=i("32V0");function u(e,t){if(1&e){const e=c.ic();c.hc(0,"edit-field-controls",4),c.pc("onSave",(function(){c.Lc(e);return c.rc().handleUserSubmit()}))("onCancel",(function(){c.Lc(e);return c.rc().handler.handleUserCancel()})),c.gc()}if(2&e){const e=c.rc();c.wc("fieldController",e.field)("saveTitle",e.text.save)("cancelTitle",e.text.cancel)}}class h extends r.a{constructor(){super(...arguments),this.isBusy=!1}get name(){return"comment"}get required(){return!0}ngOnInit(){super.ngOnInit(),this.rawValue=this.rawValue||""}}h.\u0275fac=function(e){return p(e||h)},h.\u0275cmp=c.Vb({type:h,selectors:[["ng-component"]],features:[c.Mb],decls:4,vars:4,consts:[[1,"textarea-wrapper"],[1,"op-ckeditor--wrapper","op-ckeditor-element"],[3,"context","content","ckEditorType","onContentChange","onInitializationFailed","onInitialized"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel",4,"ngIf"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel"]],template:function(e,t){1&e&&(c.hc(0,"div",0),c.hc(1,"div",1),c.hc(2,"op-ckeditor",2),c.pc("onContentChange",(function(e){return t.onContentChange(e)}))("onInitializationFailed",(function(){return t.initializationError=!0}))("onInitialized",(function(e){return t.onCkeditorSetup(e)})),c.gc(),c.gc(),c.Tc(3,u,1,3,"edit-field-controls",3),c.gc()),2&e&&(c.Pb(2),c.wc("context",t.ckEditorContext)("content",t.rawValue)("ckEditorType",t.editorType),c.Pb(1),c.wc("ngIf",!(t.handler.inEditMode||t.initializationError)))},directives:[o.a,l.q,d.a],encapsulation:2}),Object(n.c)([Object(a.a)(),Object(n.e)("design:type",s.a)],h.prototype,"ConfigurationService",void 0);const p=c.jc(h)},"9pt+":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("AEvm"),s=i("VFHb"),r=i("CNq7"),a=i("fXoL"),c=i("ofXK");function o(e,t){if(1&e&&a.cc(0,"span",1),2&e){const e=a.rc();a.wc("textContent",e.count)}}class l extends n.a{constructor(e,t,i){super(),this.apiV3Service=e,this.wpWatcherService=t,this.cdRef=i,this.count=0}ngOnInit(){this.apiV3Service.work_packages.id(this.wpId).requireAndStream().pipe(this.untilDestroyed()).subscribe(e=>{this.wpWatcherService.require(e).then(e=>{this.count=e.length,this.cdRef.detectChanges()})})}}l.\u0275fac=function(e){return new(e||l)(a.bc(r.a),a.bc(s.a),a.bc(a.i))},l.\u0275cmp=a.Vb({type:l,selectors:[["wp-watchers-count"]],inputs:{wpId:"wpId"},features:[a.Mb],decls:1,vars:1,consts:[["class","wp-tabs-count",3,"textContent",4,"ngIf"],[1,"wp-tabs-count",3,"textContent"]],template:function(e,t){1&e&&a.Tc(0,o,1,1,"span",0),2&e&&a.wc("ngIf",t.count>0)},directives:[c.q],encapsulation:2,changeDetection:0})},"A0F/":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{blockedTransition(e){return!0}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac})},AA01:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("mrSG"),s=i("Mo6U"),r=i("r0MM"),a=i("dMmB"),c=i("Jui0");class o extends s.a{constructor(){super(...arguments),this.memoizedCurrentSchemas={}}$initialize(e){super.$initialize(e),this.$links.schema={href:this.pathHelper.api.v3.apiV3Base+"/queries/filter_instance_schemas/"+this.filter.idFromLink}}get id(){return this.filter.id}get name(){return this.filter.name}get currentSchema(){if(!this.operator)return null;let e=this.operator.href.toString();if(void 0===this.memoizedCurrentSchemas[e])try{this.memoizedCurrentSchemas[e]=this.schemaCache.of(this).resultingSchema(this.operator)}catch(t){console.error("Failed to access filter schema"+t)}return this.memoizedCurrentSchemas[e]}isCompletelyDefined(){return this.values.length||this.currentSchema&&!this.currentSchema.isValueRequired()}findOperator(e){return _.find(this.schemaCache.of(this).availableOperators,t=>t.id===e)}}Object(n.c)([Object(r.a)(a.a),Object(n.e)("design:type",a.a)],o.prototype,"schemaCache",void 0),Object(n.c)([Object(r.a)(c.a),Object(n.e)("design:type",c.a)],o.prototype,"pathHelper",void 0)},AAic:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.mapping={}}add(e,t){this.mapping[e]=t}available(){return _.map(this.mapping,(e,t)=>({attribute:t,text:e.localizedName,icon:"",description:"",image:""}))}get(e){if(this.mapping[e])return this.mapping[e];throw"No action service exists for "+e}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac,providedIn:"root"})},ABwi:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("iB+3"),s=i("Jui0"),r=i("pL6k"),a=i("d/TE"),c=i("wZYP"),o=i("/C7M"),l=i("fXoL"),d=i("tk/3");class u{constructor(e,t,i,n,s,r,a){this.http=e,this.$state=t,this.PathHelper=i,this.UrlParamsHelper=n,this.NotificationsService=s,this.I18n=r,this.halEvents=a,this.text={successful_delete:this.I18n.t("js.work_packages.message_successful_bulk_delete")}}performBulkDelete(e,t){const i={"ids[]":e},n=this.http.delete(this.PathHelper.workPackagesBulkDeletePath(),{params:i,withCredentials:!0}).toPromise();return t&&n.then(()=>{this.NotificationsService.addSuccess(this.text.successful_delete),e.forEach(e=>this.halEvents.push({_type:"WorkPackage",id:e},{eventType:"deleted"})),this.$state.includes("**.list.details.**")&&e.indexOf(this.$state.params.workPackageId)>-1&&this.$state.go("work-packages.partitioned.list",this.$state.params)}).catch(()=>{const e=this.UrlParamsHelper.buildQueryString(i);window.location.href=this.PathHelper.workPackagesBulkDeletePath()+"?"+e}),n}}u.\u0275fac=function(e){return new(e||u)(l.lc(d.b),l.lc(n.StateService),l.lc(s.a),l.lc(r.a),l.lc(a.a),l.lc(c.a),l.lc(o.a))},u.\u0275prov=l.Xb({token:u,factory:u.\u0275fac})},AEvm:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Hg4z"),s=i("fXoL");class r extends n.a{constructor(){super(...arguments),this.componentDestroyed=!1}ngOnDestroy(){this.componentDestroyed=!0,super.ngOnDestroy()}untilDestroyed(){return Object(n.c)(this)}}r.\u0275fac=function(e){return a(e||r)},r.\u0275dir=s.Wb({type:r,features:[s.Mb]});const a=s.jc(r)},AcWF:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("8zkO"),s=i("wZYP"),r=i("F5Dh"),a=i("dMmB"),c=i("fXoL"),o=i("3Pt+"),l=i("ofXK");function d(e,t){if(1&e&&c.cc(0,"option",4),2&e){const e=t.$implicit,i=c.rc();c.wc("textContent",i.text[e.id])("ngValue",e)}}class u{constructor(e,t,i,n,s){this.injector=e,this.I18n=t,this.wpTableFilters=i,this.ConfigurationService=n,this.schemaCache=s,this.relationFilterIds=["parent","precedes","follows","relates","duplicates","duplicated","blocks","blocked","partof","includes","requires","required"],this.availableRelationFilters=[],this.selectedRelationFilter=void 0,this.text={filter_work_packages_by_relation_type:this.I18n.t("js.work_packages.table_configuration.relation_filters.filter_work_packages_by_relation_type"),please_select:this.I18n.t("js.placeholders.selection"),parent:this.I18n.t("js.relation_labels.children"),precedes:this.I18n.t("js.relation_labels.follows"),follows:this.I18n.t("js.relation_labels.precedes"),relates:this.I18n.t("js.relation_labels.relates"),duplicates:this.I18n.t("js.relation_labels.duplicated"),duplicated:this.I18n.t("js.relation_labels.duplicates"),blocks:this.I18n.t("js.relation_labels.blocked"),blocked:this.I18n.t("js.relation_labels.blocks"),requires:this.I18n.t("js.relation_labels.required"),required:this.I18n.t("js.relation_labels.requires"),partof:this.I18n.t("js.relation_labels.includes"),includes:this.I18n.t("js.relation_labels.partof")}}ngOnInit(){let e=this;this.wpTableFilters.onReady().then(()=>{e.availableRelationFilters=e.relationFiltersOf(e.wpTableFilters.availableFilters),e.setSelectedRelationFilter()})}setSelectedRelationFilter(){let e=this.relationFiltersOf(this.wpTableFilters.current);e.length>0?this.selectedRelationFilter=_.find(this.availableRelationFilters,{id:e[0].id}):this.selectedRelationFilter=this.availableRelationFilters[0],this.onRelationFilterSelected()}onRelationFilterSelected(){this.selectedRelationFilter&&(this.removeRelationFiltersFromCurrentState(),this.addFilterToCurrentState(this.selectedRelationFilter))}removeRelationFiltersFromCurrentState(){let e=this.relationFiltersOf(this.wpTableFilters.current);this.wpTableFilters.remove(...e)}relationFiltersOf(e){return _.filter(e,e=>_.includes(this.relationFilterIds,e.id))}addFilterToCurrentState(e){let t=this.wpTableFilters.instantiate(e),i=this.getOperatorForId(t,"=");t.operator=i,t.values=[{href:"/api/v3/work_packages/{id}"}],this.wpTableFilters.add(t)}getOperatorForId(e,t){return _.find(this.schemaCache.of(e).availableOperators,{id:t})}compareRelationFilters(e,t){return e&&t?e.id===t.id:e===t}}u.\u0275fac=function(e){return new(e||u)(c.bc(c.A),c.bc(s.a),c.bc(r.a),c.bc(n.a),c.bc(a.a))},u.\u0275cmp=c.Vb({type:u,selectors:[["wp-table-configuration-relation-selector"]],decls:6,vars:4,consts:[[1,"relation-filter-selector"],[3,"textContent"],["id","",1,"form--select","form--inline-select",3,"ngModel","compareWith","ngModelChange"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],[3,"textContent","ngValue"]],template:function(e,t){1&e&&(c.hc(0,"div",0),c.hc(1,"h5"),c.cc(2,"span",1),c.Vc(3," "),c.hc(4,"select",2),c.pc("ngModelChange",(function(e){return t.selectedRelationFilter=e}))("ngModelChange",(function(){return t.onRelationFilterSelected()})),c.Tc(5,d,1,2,"option",3),c.gc(),c.gc(),c.gc()),2&e&&(c.Pb(2),c.wc("textContent",t.text.filter_work_packages_by_relation_type),c.Pb(2),c.wc("ngModel",t.selectedRelationFilter)("compareWith",t.compareRelationFilters),c.Pb(1),c.wc("ngForOf",t.availableRelationFilters))},directives:[o.y,o.m,o.p,l.p,o.r,o.B],encapsulation:2})},AdL0:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("mrSG"),s=i("wZYP"),r=i("PUHT"),a=i("4lR/"),c=i("IaZ+"),o=i("fXoL"),l=i("N5AO");class d extends r.a{constructor(e,t,i,n,s,r){super(e,t),this.elementRef=e,this.opContextMenu=t,this.opModalService=i,this.injector=n,this.cdRef=s,this.I18n=r}open(e){return Object(n.b)(this,void 0,void 0,(function*(){this.items=yield this.buildItems(),this.opContextMenu.show(this,e)}))}positionArgs(e){let t=super.positionArgs(e);return _.assign(t,{my:"right top",at:"right bottom"}),t}buildItems(){return Object(n.b)(this,void 0,void 0,(function*(){let e=[];if(this.menuItems){const t=yield this.menuItems();return e.concat(t)}return e}))}}d.\u0275fac=function(e){return new(e||d)(o.bc(o.q),o.bc(a.a),o.bc(c.b),o.bc(o.A),o.bc(o.i),o.bc(s.a))},d.\u0275cmp=o.Vb({type:d,selectors:[["icon-triggered-context-menu"]],inputs:{menuItems:["menu-items","menuItems"]},features:[o.Mb],decls:2,vars:0,consts:[["href","#"],["icon-classes","icon-show-more-horizontal"]],template:function(e,t){1&e&&(o.hc(0,"a",0),o.cc(1,"op-icon",1),o.gc())},directives:[l.a],styles:["a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:hover{color:var(--light-gray);text-decoration:none}"]})},AeZM:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("zqrF"),s=i("iMRi"),r=i("E2tj"),a=i("fXoL");class c extends n.a{constructor(e,t){super(t),this.states=e,this.querySpace=t}valueFromQuery(e){return e.groupBy||null}hasChanged(e){const t=e=>e?e.href:null;return!_.isEqual(t(e.groupBy),t(this.current))}applyToQuery(e){const t=this.current;return e.groupBy=null===t?void 0:t,!0}isGroupable(e){return!!_.find(this.available,t=>t.id===e.id)}disable(){this.update(null)}setBy(e){let t=_.find(this.available,t=>t.id===e.id);t&&this.update(t)}get current(){return this.lastUpdatedState.getValueOr(null)}get availableState(){return this.states.queries.groupBy}get isEnabled(){return!!this.current}get available(){return this.availableState.getValueOr([])}isCurrentlyGroupedBy(e){let t=this.current;return!(!t||t.id!==e.id)}}c.\u0275fac=function(e){return new(e||c)(a.lc(s.a),a.lc(r.a))},c.\u0275prov=a.Xb({token:c,factory:c.\u0275fac})},AytR:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n={production:!0}},B4Ei:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("AA01"),s=i("Mo6U");class r extends s.a{$initialize(e){super.$initialize(e),this.filters=this.filters.map(e=>new n.a(this.injector,e,!0,this.halInitializer,"QueryFilterInstance"))}}},BV52:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));i("ii2/");var n=i("fXoL"),s=i("wZYP"),r=i("ofXK"),a=i("/Rze"),c=i("s/U8");const o=["wpRelationGroupByToggler"];function l(e,t){if(1&e){const e=n.ic();n.hc(0,"div",6),n.hc(1,"accessible-by-keyboard",7,8),n.pc("execute",(function(){n.Lc(e);return n.rc().toggleButton()})),n.cc(3,"span",9),n.gc(),n.gc()}if(2&e){const e=n.rc();n.Pb(1),n.wc("linkAriaLabel",e.togglerText),n.Pb(2),n.wc("textContent",e.togglerText)}}function d(e,t){if(1&e&&n.cc(0,"wp-relation-row",12),2&e){const e=t.$implicit,i=n.rc(2);n.wc("workPackage",i.workPackage)("groupByWorkPackageType",i.groupByWorkPackageType)("relatedWorkPackage",e)}}function u(e,t){if(1&e&&(n.hc(0,"div",10),n.Tc(1,d,1,3,"wp-relation-row",11),n.gc()),2&e){const e=n.rc();n.Pb(1),n.wc("ngForOf",e.relatedWorkPackages)}}class h{constructor(e){this.I18n=e,this.onToggleGroupBy=new n.s,this.text={groupByType:this.I18n.t("js.relation_buttons.group_by_wp_type"),groupByRelation:this.I18n.t("js.relation_buttons.group_by_relation_type")}}get togglerText(){return this.groupByWorkPackageType?this.text.groupByRelation:this.text.groupByType}toggleButton(){this.onToggleGroupBy.emit(),setTimeout(()=>{this.toggleElement.nativeElement.focus()},20)}}h.\u0275fac=function(e){return new(e||h)(n.bc(s.a))},h.\u0275cmp=n.Vb({type:h,selectors:[["wp-relations-group"]],viewQuery:function(e,t){var i;(1&e&&n.ad(o,!0),2&e)&&(n.Ic(i=n.qc())&&(t.toggleElement=i.first))},inputs:{relatedWorkPackages:"relatedWorkPackages",workPackage:"workPackage",header:"header",firstGroup:"firstGroup",groupByWorkPackageType:"groupByWorkPackageType"},outputs:{onToggleGroupBy:"onToggleGroupBy"},decls:6,vars:3,consts:[[1,"attributes-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text","relation-group--header",3,"textContent"],["class","attributes-group--header-toggle",4,"ngIf"],["class","content",4,"ngIf"],[1,"attributes-group--header-toggle"],["id","wp-relation-group-by-toggle","linkClass","button -small -transparent -with-icon icon-group-by icon-small hide-when-print",3,"linkAriaLabel","execute"],["wpRelationGroupByToggler",""],[3,"textContent"],[1,"content"],[3,"workPackage","groupByWorkPackageType","relatedWorkPackage",4,"ngFor","ngForOf"],[3,"workPackage","groupByWorkPackageType","relatedWorkPackage"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.cc(3,"h3",3),n.gc(),n.Tc(4,l,4,2,"div",4),n.gc(),n.Tc(5,u,2,1,"div",5),n.gc()),2&e&&(n.Pb(3),n.wc("textContent",t.header),n.Pb(1),n.wc("ngIf",t.firstGroup),n.Pb(1),n.wc("ngIf",t.relatedWorkPackages))},directives:[r.q,a.a,r.p,c.a],encapsulation:2})},BjK6:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("PkGb"),s=i("iMRi"),r=i("Y/CA"),a=i("iB+3"),c=i("xLNn"),o=i("wZYP"),l=i("fXoL"),d=i("ofXK"),u=i("kor4"),h=i("N5AO");const p=function(e){return{"-active":e}};class g extends c.a{constructor(e,t,i,n,s,r,a){super(t),this.$state=e,this.I18n=t,this.transitions=i,this.cdRef=n,this.states=s,this.wpTableFocus=r,this.keepTab=a,this.accessKey=8,this.activeState="work-packages.partitioned.list.details",this.listState="work-packages.partitioned.list",this.buttonId="work-packages-details-view-button",this.buttonClass="toolbar-icon",this.iconClass="icon-info2",this.activateLabel=t.t("js.button_open_details"),this.deactivateLabel=t.t("js.button_close_details"),this.transitionListener=this.transitions.onSuccess({},()=>{this.isActive=this.$state.includes(this.activeState),this.cdRef.detectChanges()})}ngOnDestroy(){super.ngOnDestroy(),this.transitionListener()}get label(){return this.isActive?this.deactivateLabel:this.activateLabel}isToggle(){return!0}performAction(e){this.isActive?this.openListView():this.openDetailsView()}openListView(){var e={projectPath:this.projectIdentifier};_.extend(e,this.$state.params),this.$state.go(this.listState,e)}openDetailsView(){var e={workPackageId:this.wpTableFocus.focusedWorkPackage,projectPath:this.projectIdentifier};_.extend(e,this.$state.params),this.$state.go(this.keepTab.currentDetailsState,e)}}g.\u0275fac=function(e){return new(e||g)(l.bc(a.StateService),l.bc(o.a),l.bc(a.TransitionService),l.bc(l.i),l.bc(s.a),l.bc(r.a),l.bc(n.a))},g.\u0275cmp=l.Vb({type:g,selectors:[["wp-details-view-button"]],features:[l.Mb],decls:2,vars:11,consts:[["type","button",3,"ngClass","disabled","accessibleClick"],[3,"icon-classes"]],template:function(e,t){1&e&&(l.hc(0,"button",0),l.pc("accessibleClick",(function(e){return t.performAction(e)})),l.cc(1,"op-icon",1),l.gc()),2&e&&(l.Rb("button ",t.buttonClass,""),l.wc("ngClass",l.Bc(9,p,t.isActive))("disabled",t.disabled||!t.isToggle()&&t.isActive),l.Qb("id",t.buttonId)("title",t.label)("accesskey",t.accessKey),l.Pb(1),l.yc("icon-classes","",t.iconClass," button--icon"))},directives:[d.n,u.a,h.a],encapsulation:2,changeDetection:0})},BtrP:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t=null,i="",n="get",s=!1,r,a="application/json",c){this.requestMethod=e,this.href=t,this.title=i,this.method=n,this.templated=s,this.payload=r,this.type=a,this.identifier=c}static fromObject(e,t){return new n((t,i,n,s)=>e.request(t,i,n,s).toPromise(),t.href,t.title,t.method,t.templated,t.payload,t.type,t.identifier)}$fetch(...e){const[t,i]=e;return this.requestMethod(this.method,this.href,t,i)}$prepare(e){if(!this.templated)throw"The link "+this.href+" is not templated.";let t=_.clone(this.href)||"";return _.each(e,(e,i)=>{let n=new RegExp("{"+i+"}");t=t.replace(n,e)}),new n(this.requestMethod,t,this.title,this.method,!1,this.payload,this.type,this.identifier).$callable()}$callable(){const e=(...e)=>this.$fetch(...e);return _.extend(e,{$link:this,href:this.href,title:this.title,method:this.method,templated:this.templated,payload:this.payload,type:this.type,identifier:this.identifier}),e}}},Bz7v:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e){this.grid=e}get id(){return this.grid.id}get name(){return this.grid.name}get editable(){return!!this.grid.updateImmediately}get isFree(){return!this.isAction}get isAction(){return"action"===this.grid.options.type}get actionAttribute(){if(!this.isFree)return this.grid.options.attribute}set highlightingMode(e){this.grid.options.highlightingMode=e}get highlightingMode(){return this.grid.options.highlightingMode||"none"}set name(e){this.grid.name=e}addQuery(e){e.isNewWidget=!0,this.grid.widgets.push(e)}removeQuery(e){this.grid.widgets=this.grid.widgets.filter(t=>t.options.queryId!==e.options.queryId)}get queries(){return this.grid.widgets}get createdAt(){return this.grid.createdAt}get filters(){return this.grid.options.filters||[]}set filters(e){this.grid.options.filters=e}sortWidgets(){this.grid.widgets=this.grid.widgets.sort((e,t)=>e.startColumn-t.startColumn)}showStatusButton(){return"status"!==this.actionAttribute}}},C21z:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){function t(e,t){return e===t||e.contains(t)}e.whenOutside=function(e,i){setTimeout(()=>{t(e,document.activeElement)||i()},20)},e.insideOrSelf=t}(n||(n={}))},CBsm:function(e,t,i){"use strict";function n(e=""){return"__collapsed-group-"+e}function s(e){return"__hierarchy-group-"+e}function r(e){return"__hierarchy-root-"+e}function a(e){return"wp-ancestor-row-"+e}i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return s})),i.d(t,"d",(function(){return r})),i.d(t,"a",(function(){return a}))},CK39:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("oJ+N"),s=i("Ioun"),r=i("fXoL");class a extends n.a{externalQueryConfigurationComponent(){return s.a}}a.\u0275fac=function(e){return c(e||a)},a.\u0275prov=r.Xb({token:a,factory:a.\u0275fac});const c=r.jc(a)},CNq7:function(e,t,i){"use strict";i.d(t,"a",(function(){return we}));var n=i("o0hg"),s=i("uIAU");class r extends n.a{constructor(){super(...arguments),this.form=this.subResource("form",s.a)}patch(e,t=null){let i=this.form.extractPayload(e,t);return this.halResourceService.patch(this.path,i)}delete(){return this.halResourceService.delete(this.path)}}var a=i("RhL0");function c(e){let t=[];if(e&&e.sortBy&&t.push("sortBy="+JSON.stringify(e.sortBy)),e&&void 0!==e.pageSize&&t.push("pageSize="+e.pageSize),e&&e.filters){let i=new a.a;e.filters.forEach(e=>{i.add(...e)}),t.push(i.toParams())}let i="";return t.length&&(i="?"+t.join("&")),i}class o extends n.b{constructor(e,t){super(e,t,"grids",r),this.apiRoot=e,this.basePath=t,this.form=this.subResource("form",s.a)}list(e){return this.halResourceService.get(this.path+c(e))}post(e,t=null){return this.halResourceService.post(this.path,this.form.extractPayload(e,t))}}var l=i("mrSG"),d=i("r0MM"),u=i("iMRi"),h=i("GyhO"),p=i("LRne"),g=i("IzEk"),f=i("UXun"),b=i("eIep"),m=i("CqXF"),w=i("vkgz"),v=i("dMmB");class y extends n.a{constructor(){super(...arguments),this.cache=this.createCache()}requireAndStream(e=!1){const t=this.id.toString();if(this.cache.stale(t)||e){const e=this.load().pipe(Object(g.a)(1),Object(f.a)(1));return this.cache.clearAndLoad(t,e),Object(h.a)(e,this.cache.state(t).values$())}return this.cache.state(t).values$()}observe(){return this.cache.observe(this.id.toString())}get(){return this.requireAndStream(!1).pipe(Object(g.a)(1))}refresh(){return this.requireAndStream(!0).pipe(Object(g.a)(1)).toPromise()}load(){return this.halResourceService.get(this.path).pipe(Object(b.a)(e=>e.$links.schema?this.schemaCache.requireAndStream(e.$links.schema.href).pipe(Object(g.a)(1),Object(m.a)(e)):Object(p.a)(e)))}touch(e){this.cache.updateFor(e)}cacheResponse(){return e=>e.pipe(Object(w.a)(e=>this.touch(e)))}}Object(l.c)([Object(d.a)(),Object(l.e)("design:type",u.a)],y.prototype,"states",void 0),Object(l.c)([Object(d.a)(),Object(l.e)("design:type",v.a)],y.prototype,"schemaCache",void 0);var k=i("bXa3"),C=i("Mo6U"),j=i("GwdO");class P extends y{constructor(){super(...arguments),this.form=this.subResource("form",k.a)}patch(e,t=null){return this.halResourceService.patch(this.path,this.extractPayload(e,t)).pipe(Object(w.a)(e=>this.touch(e)))}delete(){return this.halResourceService.delete(this.path).pipe(Object(w.a)(()=>this.cache.clearSome(this.id.toString())))}createCache(){return this.parent.cache}extractPayload(e,t=null){return e instanceof C.a&&t?j.a.extractPayloadFromSchema(e,t):e instanceof C.a?{}:e}}var x=i("hxxE");class S extends n.b{constructor(){super(...arguments),this.cache=this.createCache()}observeAll(){return this.cache.observeAll()}cacheResponse(){return e=>e.pipe(Object(w.a)(e=>{e instanceof x.a?e.elements.forEach(this.touch.bind(this)):e instanceof C.a&&this.touch(e)}))}touch(e){this.cache.updateFor(e)}}Object(l.c)([Object(d.a)(),Object(l.e)("design:type",u.a)],S.prototype,"states",void 0);var O=i("HKNX");class I extends O.a{constructor(e,t){super(t),this.injector=e}updateValue(e,t){return this.schemaCache.ensureLoaded(t).then(()=>(this.putValue(e,t),t))}}Object(l.c)([Object(d.a)(),Object(l.e)("design:type",u.a)],I.prototype,"states",void 0),Object(l.c)([Object(d.a)(),Object(l.e)("design:type",v.a)],I.prototype,"schemaCache",void 0);class T extends S{constructor(e,t){super(e,t,"time_entries",P),this.apiRoot=e,this.basePath=t,this.form=this.subResource("form",k.a)}list(e){return this.halResourceService.get(this.path+c(e)).pipe(this.cacheResponse())}post(e){return this.halResourceService.post(this.path,e).pipe(this.cacheResponse())}createCache(){return new I(this.injector,this.states.timeEntries)}}var R=i("lJxs");class E extends n.a{list(e){return this.halResourceService.get(this.path+c(e))}exists(e){return this.halResourceService.get(this.path,{filters:Object(a.b)("id","=",[e]).toJson()}).pipe(Object(R.a)(e=>e.count>0))}}class M extends n.b{constructor(e,t){super(e,t,"memberships"),this.apiRoot=e,this.basePath=t,this.available_projects=this.subResource("available_projects",E)}list(e){return this.halResourceService.get(this.path+c(e))}}class F extends y{constructor(){super(...arguments),this.avatar=this.subResource("avatar")}createCache(){return new O.a(this.states.users)}}class A extends n.b{constructor(e,t){super(e,t,"users",F),this.apiRoot=e,this.basePath=t,this.me=this.path+"/me"}}class L extends y{createCache(){return this.parent.cache}}class D extends S{constructor(e,t){super(e,t,"types",L),this.apiRoot=e,this.basePath=t}createCache(){return new O.a(this.states.types)}}var V=i("B4Ei"),q=i("tk/3"),$=i("j93F");class N extends $.a{constructor(e,t,i){super(t,i),this.injector=e,this.basePath=t,this.id=i}get(){return this.http.get(this.path).toPromise().then(e=>e||{})}update(e){return this.http.patch(this.path,{delta:e},{withCredentials:!0}).toPromise().then(e=>e.t)}delete(e,...t){let i={};return t.forEach(e=>i[e]=-1),this.update(i)}}Object(l.c)([Object(d.a)(),Object(l.e)("design:type",q.b)],N.prototype,"http",void 0);var B=i("yQm5"),z=i("1SJX");class H extends k.a{load(e){let t={name:e.name||"!!!__O__o__O__!!!"};e.project&&(t._links={project:{href:e.project.$href}});let i=this.apiRoot.queries.withOptionalId(e.id).form.path;return this.halResourceService.post(i,t).pipe(Object(w.a)(e=>this.queryFilters.setSchemas(e.$embedded.schema.$embedded.filtersSchemas)),Object(R.a)(e=>[e,this.buildQueryResource(e)]))}loadWithParams(e,t,i,n={}){t||n.name||(n.name="!!!__O__o__O__!!!"),i&&(n._links=n._links||{},n._links.project={href:this.apiRoot.projects.id(i).toString()});let s=this.apiRoot.queries.withOptionalId(t).form.path;const r=B(s).search(e).toString();return this.halResourceService.post(r,n).pipe(Object(w.a)(e=>this.queryFilters.setSchemas(e.$embedded.schema.$embedded.filtersSchemas)),Object(R.a)(e=>[e,this.buildQueryResource(e)]))}buildQueryResource(e){return this.halResourceService.createHalResourceOfType("Query",e.payload)}}Object(l.c)([Object(d.a)(),Object(l.e)("design:type",z.a)],H.prototype,"queryFilters",void 0);class Q extends n.a{constructor(){super(...arguments),this.form=this.subResource("form",H),this.order=new N(this.injector,this.path,"order")}parameterised(e){return this.halResourceService.get(this.path,e)}patch(e,t){return e instanceof V.a&&t&&(this.queryFilters.mapSchemasIntoFilters(e,t),e=j.a.extractPayloadFromSchema(e,t.schema)),this.halResourceService.patch(this.path,e)}delete(){return this.halResourceService.delete(this.path)}paginated(e){return this.parameterised(e)}}Object(l.c)([Object(d.a)(),Object(l.e)("design:type",z.a)],Q.prototype,"queryFilters",void 0);class W extends n.b{constructor(e,t){super(e,t,"queries",Q),this.apiRoot=e,this.basePath=t,this.form=this.subResource("form",H),this.default=this.subResource("default"),this.filter_instance_schemas=new n.b(this.apiRoot,this.path,"filter_instance_schemas")}list(e){return this.halResourceService.get(this.path+c(e))}find(e,t,i){let n;return n=t?this.apiRoot.queries.id(t).toString():this.apiRoot.withOptionalProject(i).queries.default.toString(),this.halResourceService.get(n,e)}parameterised(e){return this.halResourceService.get(this.default.path,e)}post(e,t){return e instanceof V.a&&t&&(this.queryFilters.mapSchemasIntoFilters(e,t),e=j.a.extractPayloadFromSchema(e,t.schema)),this.halResourceService.post(this.apiRoot.queries.path,e)}toggleStarred(e){return e.starred?e.unstar():e.star()}filterNonHidden(e){let t={filters:[["hidden","=",["f"]]]};return e?t.filters.push(["project_identifier","=",[e]]):t.filters.push(["project","!*",[]]),this.list(t)}}Object(l.c)([Object(d.a)(),Object(l.e)("design:type",z.a)],W.prototype,"queryFilters",void 0);var X=i("Cfvw");class U extends n.b{constructor(e,t){super(e,t,"relations"),this.apiRoot=e,this.basePath=t}get(){return this.halResourceService.get(this.path)}loadInvolved(e){let t=_.filter(e,e=>/\d+/.test(e));return 0===t.length?Object(X.a)([]):this.filtered(Object(a.b)("involved","=",t)).get().pipe(Object(R.a)(e=>e.elements))}}class G extends y{constructor(){super(...arguments),this.relations=this.subResource("relations",U),this.revisions=this.subResource("revisions"),this.activities=this.subResource("activities"),this.available_watchers=this.subResource("available_watchers"),this.available_projects=this.subResource("available_projects")}createCache(){return this.parent.cache}}class Y extends k.a{forTypePayload(e){e._links.type&&e._links.type;return this.post(e)}forPayload(e){return this.post(e)}}var K=i("FnNU"),Z=i("qHU1"),J=i("fXoL");class ee extends O.a{constructor(e,t){super(t),this.injector=e}updateValue(e,t){return this.schemaCacheService.ensureLoaded(t).then(()=>(this.putValue(e,t),t))}updateWorkPackage(e,t=!1){return t||e.isNew?super.updateValue(e.id,e):this.updateValue(e.id,e)}updateWorkPackageList(e,t=!0){for(var i of e){const e=i,n=e.id,s=this.multiState.get(n);e.isNew?s.putValue(e):this.schemaCacheService.ensureLoaded(e).then(()=>{t&&s.hasValue()&&_.isEqual(s.value.$source,e.$source)?Object(Z.a)("Skipping identical work package from updating"):s.putValue(e)})}}}ee.\u0275fac=function(e){return new(e||ee)(J.lc(J.A),J.lc(K.a))},ee.\u0275prov=J.Xb({token:ee,factory:ee.\u0275fac}),Object(l.c)([Object(d.a)(),Object(l.e)("design:type",v.a)],ee.prototype,"schemaCacheService",void 0);class te extends n.a{get(){return this.halResourceService.get(this.path).pipe(Object(w.a)(e=>this.cache.updateWorkPackageList(e.elements)),Object(g.a)(1))}get cache(){return this.parent.cache}}class ie extends S{constructor(e,t){super(e,t,"work_packages",G),this.apiRoot=e,this.basePath=t,this.form=this.subResource("form",Y)}requireAll(e){return new Promise((t,i)=>{this.loadCollectionsFor(_.uniq(e)).then(e=>{_.each(e,e=>{e.schemas&&_.each(e.schemas.elements,e=>{this.states.schemas.get(e.href).putValue(e)}),e.elements&&this.cache.updateWorkPackageList(e.elements)}),t(void 0)},i)})}post(e){return this.halResourceService.post(this.path,e).pipe(this.cacheResponse())}filtered(e,t={}){return super.filtered(e,t,te)}filterBySubjectOrId(e,t=!1,i={}){let n=new a.a;t?n.add("id","=",[e]):n.add("subjectOrId","**",[e]);let s=Object.assign({sortBy:'[["updatedAt","desc"]]',offset:"1",pageSize:"10"},i);return this.filtered(n,s)}filterUpdatedSince(e,t){let i=(new a.a).add("id","=",e.filter(e=>e)).add("updatedAt","<>d",[t,""]);return this.filtered(i,{offset:"1",pageSize:"10"})}loadCollectionsFor(e){return this.halResourceService.getAllPaginated(this.path,e.length,{filters:Object(a.b)("id","=",e).toJson()})}createCache(){return new ee(this.injector,this.states.workPackages)}}class ne extends y{patch(e){return this.halResourceService.patch(this.path,e).pipe(Object(w.a)(e=>this.touch(e)))}createCache(){return new O.a(this.states.versions)}}class se extends n.b{constructor(e,t){super(e,t,"versions",ne),this.apiRoot=e,this.basePath=t,this.form=this.subResource("form",k.a),this.available_projects=this.subResource("available_projects",E)}get(){return this.halResourceService.get(this.path)}post(e){return this.halResourceService.post(this.path,e)}}class re extends y{constructor(){super(...arguments),this.available_assignees=this.subResource("available_assignees"),this.queries=new W(this.apiRoot,this.path),this.types=new D(this.apiRoot,this.path),this.work_packages=new ie(this.apiRoot,this.path),this.versions=new se(this.apiRoot,this.path)}createCache(){return this.parent.cache}}class ae extends O.a{constructor(e,t){super(t),this.injector=e}updateValue(e,t){return this.schemaCacheService.ensureLoaded(t).then(()=>(this.putValue(e,t),t))}}ae.\u0275fac=function(e){return new(e||ae)(J.lc(J.A),J.lc(K.a))},ae.\u0275prov=J.Xb({token:ae,factory:ae.\u0275fac}),Object(l.c)([Object(d.a)(),Object(l.e)("design:type",v.a)],ae.prototype,"schemaCacheService",void 0);class ce extends S{constructor(e,t){super(e,t,"projects",re),this.apiRoot=e,this.basePath=t,this.schema=this.subResource("schema")}list(e){return this.halResourceService.get(this.path+c(e)).pipe(this.cacheResponse())}createCache(){return new ae(this.injector,this.states.projects)}}var oe=i("Jui0");class le extends y{createCache(){return new O.a(this.states.statuses)}}class de extends n.b{constructor(e,t){super(e,t,"statuses",le),this.apiRoot=e,this.basePath=t}get(){return this.halResourceService.get(this.path).pipe(Object(w.a)(e=>{e.elements.forEach((e,t)=>{this.id(e.id).cache.updateValue(e.id,e)})}))}}class ue extends n.b{constructor(e,t){super(e,t,"news"),this.apiRoot=e,this.basePath=t}list(e){return this.halResourceService.get(this.path+c(e))}}class he extends n.b{constructor(e,t){super(e,t,"help_texts"),this.apiRoot=e,this.basePath=t}get(){return this.halResourceService.get(this.path)}}class pe extends n.a{constructor(e,t){super(e,t,"configuration"),this.apiRoot=e,this.basePath=t}get(){return this.$configuration?this.$configuration:this.$configuration=this.halResourceService.get(this.path).pipe(Object(f.a)())}}var ge=i("Bz7v"),fe=i("Kg8T");class be extends y{load(){return this.apiRoot.grids.id(this.id).get().pipe(Object(R.a)(e=>{const t=new ge.a(e);return t.sortWidgets(),t}))}save(e){return this.fetchSchema(e).pipe(Object(b.a)(t=>this.apiRoot.grids.id(e.grid).patch(e.grid,t)),Object(R.a)(t=>(e.grid=t,e.sortWidgets(),e)),this.cacheResponse())}delete(){return this.apiRoot.grids.id(this.id).delete().pipe(Object(w.a)(()=>this.cache.clearSome(this.id.toString())))}fetchSchema(e){return this.apiRoot.grids.id(e.grid).form.post({}).pipe(Object(R.a)(e=>e.schema))}createCache(){return this.parent.cache}}class me extends S{constructor(e,t){super(e,t,"grids",be),this.apiRoot=e,this.basePath=t}list(e){return this.halResourceService.get(this.path+c(e)).pipe(Object(w.a)(e=>this.authorisationService.initModelAuth("boards",e.$links)),Object(R.a)(e=>e.elements.map(e=>{let t=new ge.a(e);return t.sortWidgets(),this.touch(t),t})))}allInScope(e){const t=this.boardPath(e);return this.list({filters:[["scope","=",[t]]]})}create(e,t,i,n){const s=this.boardPath(i);return this.createGrid(e,t,s,n).pipe(Object(R.a)(e=>new ge.a(e)))}boardPath(e){return this.PathHelper.projectBoardsPath(e)}createCache(){let e=this.states.forType("boards");return new O.a(e)}createGrid(e,t,i,n){let s=_.set({name:t},"_links.scope.href",i);return s.options={type:e},n&&(s.options.attribute=n),this.apiRoot.grids.form.post(s).pipe(Object(b.a)(e=>this.apiRoot.grids.post(e.payload.$source)))}}Object(l.c)([Object(d.a)(),Object(l.e)("design:type",fe.a)],me.prototype,"authorisationService",void 0),Object(l.c)([Object(d.a)(),Object(l.e)("design:type",oe.a)],me.prototype,"PathHelper",void 0);class we{constructor(e,t){this.injector=e,this.pathHelper=t,this.attachments=this.apiV3CollectionEndpoint("attachments"),this.configuration=this.apiV3CustomEndpoint(pe),this.documents=this.apiV3CollectionEndpoint("documents"),this.grids=this.apiV3CustomEndpoint(o),this.groups=this.apiV3CollectionEndpoint("groups"),this.root=this.apiV3SingularEndpoint(""),this.statuses=this.apiV3CustomEndpoint(de),this.relations=this.apiV3CustomEndpoint(U),this.priorities=this.apiV3CollectionEndpoint("priorities"),this.time_entries=this.apiV3CustomEndpoint(T),this.memberships=this.apiV3CustomEndpoint(M),this.news=this.apiV3CustomEndpoint(ue),this.types=this.apiV3CustomEndpoint(D),this.versions=this.apiV3CustomEndpoint(se),this.work_packages=this.apiV3CustomEndpoint(ie),this.queries=this.apiV3CustomEndpoint(W),this.projects=this.apiV3CustomEndpoint(ce),this.users=this.apiV3CustomEndpoint(A),this.help_texts=this.apiV3CustomEndpoint(he),this.job_statuses=this.apiV3CollectionEndpoint("job_statuses"),this.boards=this.apiV3CustomEndpoint(me)}withOptionalProject(e){return _.isNil(e)?this:this.projects.id(e)}apiV3CollectionEndpoint(e,t){return new n.b(this,this.pathHelper.api.v3.apiV3Base,e,t)}apiV3CustomEndpoint(e){return new e(this,this.pathHelper.api.v3.apiV3Base)}apiV3SingularEndpoint(e){return new n.a(this,this.pathHelper.api.v3.apiV3Base,e)}}we.\u0275fac=function(e){return new(e||we)(J.lc(J.A),J.lc(oe.a))},we.\u0275prov=J.Xb({token:we,factory:we.\u0275fac,providedIn:"root"})},CV67:function(e,t,i){"use strict";i.d(t,"c",(function(){return w})),i.d(t,"b",(function(){return v})),i.d(t,"a",(function(){return y}));var n=i("mrSG"),s=i("fXoL"),r=i("wZYP"),a=i("C21z"),c=i("r0MM"),o=i("ofXK"),l=i("3Pt+"),d=i("oUDv"),u=i("kor4");const h=["editableTitleInput"];function p(e,t){if(1&e){const e=s.ic();s.hc(0,"a",7),s.pc("accessibleClick",(function(t){s.Lc(e);return s.rc(2).save(t,!0)})),s.cc(1,"span",8),s.gc()}if(2&e){const e=s.rc(2);s.Qb("aria-label",e.text.query_has_changed_click_to_save)("title",e.text.query_has_changed_click_to_save)}}const g=function(e,t){return{"-error":e,"-changed":t}};function f(e,t){if(1&e){const e=s.ic();s.hc(0,"div",2),s.pc("focusout",(function(t){s.Lc(e);return s.rc().saveWhenFocusOutside(t)})),s.Tc(1,p,2,2,"a",3),s.hc(2,"input",4,5),s.pc("focus",(function(t){s.Lc(e);return s.rc().onFocus(t)}))("blur",(function(){s.Lc(e);return s.rc().onBlur()}))("keydown.escape",(function(t){s.Lc(e);return s.rc().reset(t)}))("keydown.enter",(function(t){s.Lc(e);return s.rc().save(t)}))("ngModelChange",(function(t){s.Lc(e);return s.rc().selectedTitle=t})),s.gc(),s.hc(4,"input-shim",6),s.Vc(5),s.gc(),s.gc()}if(2&e){const e=s.rc();s.Pb(1),s.wc("ngIf",e.showSave),s.Pb(1),s.wc("focus",e.initialFocus||void 0)("ngModel",e.selectedTitle)("disabled",e.inFlight)("ngClass",s.Cc(10,g,e.isEmpty,e.showSave)),s.Qb("name",e.selectableTitleIdentifier)("placeholder",e.text.input_placeholder)("title",e.text.input_title),s.Pb(3),s.Yc("",e.selectedTitle||e.text.input_placeholder,"",e.selectedTitle?"\xa0\xa0":"","")}}const b=function(e,t){return{"-disabled":e,"-small":t}};function m(e,t){if(1&e&&(s.hc(0,"h2",9),s.Vc(1),s.gc()),2&e){const e=s.rc();s.wc("ngClass",s.Cc(3,b,e.disabled,e.smallHeader)),s.Qb("title",e.selectedTitle),s.Pb(1),s.Xc("",e.selectedTitle,"\n")}}const w="op:selectableTitle:trigger",v="editable-toolbar-title";class y{constructor(e){this.injector=e,this.editable=!0,this.inFlight=!1,this.showSaveCondition=!1,this.initialFocus=!1,this.smallHeader=!1,this.onSave=new s.s,this.onEmptySubmit=new s.s,this.selectableTitleIdentifier=v,this.text={click_to_edit:this.I18n.t("js.work_packages.query.click_to_edit_query_name"),press_enter_to_save:this.I18n.t("js.label_press_enter_to_save"),query_has_changed_click_to_save:this.I18n.t("js.label_view_has_changed"),input_title:"",input_placeholder:this.I18n.t("js.work_packages.query.rename_query_placeholder"),search_query_title:this.I18n.t("js.toolbar.search_query_title"),confirm_edit_cancel:this.I18n.t("js.work_packages.query.confirm_edit_cancel"),duplicate_query_title:this.I18n.t("js.work_packages.query.errors.duplicate_query_title")}}ngOnInit(){this.text.input_title=`${this.text.click_to_edit} ${this.text.press_enter_to_save}`,jQuery(this.elementRef.nativeElement).on(w,(e,t="")=>{this.inputField&&(this.selectedTitle=t,setTimeout(()=>{this.inputField.nativeElement.focus()},20),e.stopPropagation())})}ngOnChanges(e){if(e.inputTitle&&(this.selectedTitle=e.inputTitle.currentValue),e.initialFocus&&e.initialFocus.firstChange&&this.inputField){const e=this.inputField.nativeElement;this.selectInputOnInitalFocus(e)}}onFocus(e){this.toggleToolbarButtonVisibility(!0),this.selectInputOnInitalFocus(e.target)}onBlur(){this.toggleToolbarButtonVisibility(!1)}selectInputOnInitalFocus(e){this.initialFocus&&(e.select(),this.initialFocus=!1)}saveWhenFocusOutside(e){a.a.whenOutside(this.elementRef.nativeElement,()=>this.save(e))}reset(){this.resetInputField(),this.selectedTitle=this.inputTitle}get showSave(){return this.editable&&this.showSaveCondition}save(e,t=!1){e.preventDefault(),this.resetInputField(),this.selectedTitle=this.selectedTitle.trim(),this.isEmpty?this.onEmptyError():(t||this.inputTitle!==this.selectedTitle)&&(this.inputField&&this.inputField.nativeElement.blur(),this.inFlight||(this.inFlight=!0,this.emitSave(this.selectedTitle),setTimeout(()=>this.inFlight=!1,100)))}get isEmpty(){return""===this.selectedTitle}emitSave(e){this.onSave.emit(e)}onEmptyError(){this.onEmptySubmit.emit(),this.focusInputOnError()}focusInputOnError(){if(this.inputField){const e=this.inputField.nativeElement;e.classList.add("-error"),e.focus()}}resetInputField(){if(this.inputField){this.inputField.nativeElement.classList.remove("-error")}}toggleToolbarButtonVisibility(e){jQuery(".toolbar-items").toggleClass("hidden-for-mobile",e)}}y.\u0275fac=function(e){return new(e||y)(s.bc(s.A))},y.\u0275cmp=s.Vb({type:y,selectors:[["editable-toolbar-title"]],viewQuery:function(e,t){var i;(1&e&&s.ad(h,!0),2&e)&&(s.Ic(i=s.qc())&&(t.inputField=i.first))},hostAttrs:[1,"title-container"],inputs:{inputTitle:["title","inputTitle"],editable:"editable",inFlight:"inFlight",showSaveCondition:"showSaveCondition",initialFocus:"initialFocus",smallHeader:"smallHeader"},outputs:{onSave:"onSave",onEmptySubmit:"onEmptySubmit"},features:[s.Nb],decls:2,vars:2,consts:[["class","editable-toolbar-title--container",3,"focusout",4,"ngIf"],["class","editable-toolbar-title--fixed",3,"ngClass",4,"ngIf"],[1,"editable-toolbar-title--container",3,"focusout"],["role","link","class","editable-toolbar-title--save",3,"accessibleClick",4,"ngIf"],["size","1","type","text","aria-required","true",1,"editable-toolbar-title--input","-border-on-hover-only","toolbar--editable-toolbar","ellipsis",3,"focus","ngModel","disabled","ngClass","blur","keydown.escape","keydown.enter","ngModelChange"],["editableTitleInput",""],[1,"editable-toolbar-title--input","editable-toolbar-title--input-shim","toolbar--editable-toolbar"],["role","link",1,"editable-toolbar-title--save",3,"accessibleClick"],["aria-hidden","true",1,"icon","icon-save"],[1,"editable-toolbar-title--fixed",3,"ngClass"]],template:function(e,t){1&e&&(s.Tc(0,f,6,13,"div",0),s.Tc(1,m,2,6,"h2",1)),2&e&&(s.wc("ngIf",t.editable),s.Pb(1),s.wc("ngIf",!t.editable))},directives:[o.q,l.c,d.a,l.m,l.p,o.n,u.a],styles:['.editable-toolbar-title--container[_ngcontent-%COMP%]{display:grid;align-items:center;grid-template-columns:auto auto 1fr}.editable-toolbar-title--container[_ngcontent-%COMP%]:after{display:block;content:""}.editable-toolbar-title--container[_ngcontent-%COMP%]:before{grid-area:1/1}.editable-toolbar-title--container[_ngcontent-%COMP%]:after{grid-area:1/3}.editable-toolbar-title--fixed[_ngcontent-%COMP%]{padding:0;cursor:default}.editable-toolbar-title--save[_ngcontent-%COMP%]{grid-area:1/1}.editable-toolbar-title--save[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{color:#5f5f5f}.editable-toolbar-title--save[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]:before{color:#2c2c2c}.editable-toolbar-title--input[_ngcontent-%COMP%]{color:#5f5f5f}.editable-toolbar-title--input[_ngcontent-%COMP%]:focus{border-color:#999;box-shadow:0 0 0 1px #999}.editable-toolbar-title--input.-changed[_ngcontent-%COMP%]{font-style:italic}.editable-toolbar-title--input[_ngcontent-%COMP%]{display:block;grid-area:1/2;padding-left:5px;width:auto;min-width:1em}.editable-toolbar-title--input-shim[_ngcontent-%COMP%]{visibility:hidden;white-space:pre}input-shim[_ngcontent-%COMP%]{border:1px solid transparent;padding:.375rem;margin:0}']}),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",s.q)],y.prototype,"elementRef",void 0),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",r.a)],y.prototype,"I18n",void 0)},CVKj:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("fXoL"),s=i("HEQ6"),r=i("72oW");class a{constructor(e){this.elementRef=e,this.initialLoadingIndicator=!0}ngOnInit(){const e=this.elementRef.nativeElement;e.getAttribute("query-props")&&this.getInputsFromData(e)}getInputsFromData(e){this.queryProps=JSON.parse(e.getAttribute("query-props")),this.configuration=JSON.parse(e.getAttribute("configuration"))}}a.\u0275fac=function(e){return new(e||a)(n.bc(n.q))},a.\u0275cmp=n.Vb({type:a,selectors:[["wp-embedded-table-entry"]],inputs:{queryProps:"queryProps",configuration:"configuration",initialLoadingIndicator:"initialLoadingIndicator"},decls:2,vars:3,consts:[["wp-isolated-query-space",""],[3,"queryProps","initialLoadingIndicator","configuration"]],template:function(e,t){1&e&&(n.fc(0,0),n.cc(1,"wp-embedded-table",1),n.ec()),2&e&&(n.Pb(1),n.wc("queryProps",t.queryProps)("initialLoadingIndicator",t.initialLoadingIndicator)("configuration",t.configuration))},directives:[s.a,r.a],encapsulation:2})},CejQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("fXoL"),s=(i("PHo6"),i("wZYP")),r=i("GntA");class a extends r.a{}var c=i("AEvm");class o extends c.a{constructor(e,t){super(),this.i18n=e,this.injector=t,this.resourceChanged=new n.s}get widgetName(){var e,t;let i=null===(e=this.resource)||void 0===e?void 0:e.options.name,n=null===(t=this.resource)||void 0===t?void 0:t.identifier;return this.isEditable?i:this.i18n.t(`js.grid.widgets.${n}.title`,{defaultValue:i})}renameWidget(e){let t=this.setChangesetOptions({name:e});this.resourceChanged.emit(t)}get isEditable(){return!0}setChangesetOptions(e){let t=new a(this.resource);return t.setValue("options",Object.assign({},this.resource.options,e)),t}}o.\u0275fac=function(e){return new(e||o)(n.bc(s.a),n.bc(n.A))},o.\u0275dir=n.Wb({type:o,hostVars:8,hostBindings:function(e,t){2&e&&n.Sc("grid-column-start",t.gridColumnStart)("grid-column-end",t.gridColumnEnd)("grid-row-start",t.gridRowStart)("grid-row-end",t.gridRowEnd)},inputs:{resource:"resource"},outputs:{resourceChanged:"resourceChanged"},features:[n.Mb]})},DHgU:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{get(...e){return _.get(window.gon,e,null)}get gon(){return window.gon}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac,providedIn:"root"})},DLfB:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("pQre"),s=i("wZYP"),r=i("fXoL"),a=i("/Rze"),c=i("N5AO");class o{constructor(e,t){this.backRoutingService=e,this.I18n=t,this.text={goBack:this.I18n.t("js.button_back")}}goBack(){this.customBackMethod?this.customBackMethod():this.backRoutingService.goBack()}classes(){let e="button ";return e+=this.linkClass?this.linkClass:"",e}}o.\u0275fac=function(e){return new(e||o)(r.bc(n.a),r.bc(s.a))},o.\u0275cmp=r.Vb({type:o,selectors:[["back-button"]],inputs:{linkClass:"linkClass",customBackMethod:"customBackMethod"},decls:3,vars:3,consts:[[1,"wp-show--back-button","hide-when-print"],[3,"linkClass","linkAriaLabel","linkTitle","execute"],["icon-classes","button--icon icon-back-up"]],template:function(e,t){1&e&&(r.hc(0,"div",0),r.hc(1,"accessible-by-keyboard",1),r.pc("execute",(function(){return t.goBack()})),r.cc(2,"op-icon",2),r.gc(),r.gc()),2&e&&(r.Pb(1),r.wc("linkClass",t.classes())("linkAriaLabel",t.text.goBack)("linkTitle",t.text.goBack))},directives:[a.a,c.a],encapsulation:2,changeDetection:0})},DYFc:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{get state(){return this.states.schemas.get(this.href)}get availableAttributes(){return _.keys(this.$source).filter(e=>0!==e.indexOf("_"))}attributeFromLocalizedName(e){let t=null;for(let i of this.availableAttributes){let n=this[i];if((null==n?void 0:n.name)===e){t=i;break}}return t}}},DhiE:function(e,t,i){"use strict";i.d(t,"a",(function(){return S}));var n=i("mrSG"),s=i("iMRi"),r=i("l4W+"),a=i("+oAL"),c=i("Kg8T"),o=i("iB+3"),l=i("E2tj"),d=i("pL6k"),u=i("d/TE"),h=i("wZYP"),p=i("Cfvw"),g=i("LRne"),f=i("FnNU"),b=i("eIep"),m=i("5+tZ"),w=i("w1tV"),v=i("JIr8"),y=i("IzEk"),k=i("Zq3F"),C=i("8zkO"),j=i("kt6C"),P=i("CNq7"),x=i("fXoL");class S{constructor(e,t,i,n,s,r,a,c,o,l,d,u,h){this.NotificationsService=e,this.I18n=t,this.UrlParamsHelper=i,this.authorisationService=n,this.$state=s,this.apiV3Service=r,this.states=a,this.querySpace=c,this.pagination=o,this.configuration=l,this.wpTablePagination=d,this.wpStatesInitialization=u,this.wpListInvalidQueryService=h,this.queryRequests=Object(f.g)(),this.queryLoading=this.queryRequests.values$().pipe(Object(b.a)(e=>Object(p.a)(this.ensurePerPageKnown().then(()=>e))),Object(b.a)(e=>this.streamQueryRequest(e.queryParams,e.projectIdentifier)),Object(m.a)(e=>(this.conditionallyLoadForm(e),this.wpStatesInitialization.initialize(e,e.results),Object(g.a)(e))),Object(w.a)())}streamQueryRequest(e,t){const i=this.getCurrentQueryProps(e),n=this.UrlParamsHelper.buildV3GetQueryFromJsonParams(i);return this.apiV3Service.queries.find(n,e.query_id,t).pipe(Object(v.a)(n=>{const s=this.UrlParamsHelper.buildV3GetQueryFromJsonParams(i);return Object(p.a)(this.handleQueryLoadingError(n,s,e.query_id,t))}))}fromQueryParams(e,t){return this.queryRequests.clear(),this.queryRequests.putValue({queryParams:e,projectIdentifier:t}),this.queryLoading.pipe(Object(y.a)(1))}getCurrentQueryProps(e){return e.query_props?decodeURIComponent(e.query_props):null}loadDefaultQuery(e){return this.fromQueryParams({},e).toPromise()}reloadQuery(e,t){const i=Object.assign(Object.assign({},this.wpTablePagination.current),{page:1}),n=this.UrlParamsHelper.encodeQueryJsonParams(e,i);return this.queryRequests.clear(),this.queryRequests.putValue({queryParams:{query_id:e.id||void 0,query_props:n},projectIdentifier:t}),this.queryLoading.pipe(Object(y.a)(1))}loadQueryFromExisting(e,t,i){const n=this.UrlParamsHelper.buildV3GetQueryFromQueryResource(e,t);let s;return s=e.id?this.apiV3Service.queries.id(e.id):this.apiV3Service.withOptionalProject(i).queries,s.parameterised(n)}loadCurrentQueryFromParams(e){return this.fromQueryParams(this.$state.params,e).toPromise()}loadForm(e){return this.apiV3Service.queries.form.load(e).toPromise().then(([t,i])=>(this.wpStatesInitialization.updateStatesFromForm(e,t),t))}create(e,t){let i=this.querySpace.queryForm.value;e.name=t;let n=this.apiV3Service.queries.post(e,i).toPromise();return n.then(e=>(this.NotificationsService.addSuccess(this.I18n.t("js.notice_successful_create")),this.reloadQuery(e).subscribe(()=>{this.states.changes.queries.next(e.id)}),e)),n}delete(){let e=this.currentQuery,t=this.apiV3Service.queries.id(e).delete().toPromise();return t.then(()=>{let t;this.NotificationsService.addSuccess(this.I18n.t("js.notice_successful_delete")),e.project&&(t=e.project.$href.split("/").pop()),this.loadDefaultQuery(t),this.states.changes.queries.next(e.id)}),t}save(e){e=e||this.currentQuery;let t=this.querySpace.queryForm.value,i=this.apiV3Service.queries.id(e).patch(e,t).toPromise();return i.then(()=>{this.NotificationsService.addSuccess(this.I18n.t("js.notice_successful_update")),this.$state.go(".",{query_id:e.id,query_props:null},{reload:!0}),this.states.changes.queries.next(e.id)}).catch(e=>{this.NotificationsService.addError(e.message)}),i}toggleStarred(e){let t=this.apiV3Service.queries.toggleStarred(e);return t.then(e=>{this.querySpace.query.putValue(e),this.NotificationsService.addSuccess(this.I18n.t("js.notice_successful_update")),this.states.changes.queries.next(e.id)}),t}getPaginationInfo(){return this.wpTablePagination.paginationObject}conditionallyLoadForm(e){let t=this.querySpace.queryForm.value;t&&e.$links.update.$href===t.$href||setTimeout(()=>this.loadForm(e),0)}updateStatesFromQueryOnPromise(e){return e.then(e=>(this.wpStatesInitialization.initialize(e,e.results),e)),e}get currentQuery(){return this.querySpace.query.value}handleQueryLoadingError(e,t,i,n){return this.NotificationsService.addError(this.I18n.t("js.work_packages.faulty_query.description"),e.message),new Promise((e,s)=>{this.apiV3Service.queries.form.loadWithParams(t,i,n).toPromise().then(([r,a])=>{this.apiV3Service.queries.find({pageSize:0},void 0,n).toPromise().then(n=>{this.wpListInvalidQueryService.restoreQuery(n,r),n.results.pageSize=t.pageSize,n.results.total=0,i&&(n.id=i),this.wpStatesInitialization.initialize(n,n.results),this.wpStatesInitialization.updateStatesFromForm(n,r),e(n)}).catch(s)}).catch(s)})}ensurePerPageKnown(){return Object(n.b)(this,void 0,void 0,(function*(){return!!this.pagination.isPerPageKnown||this.configuration.initialized}))}}S.\u0275fac=function(e){return new(e||S)(x.lc(u.a),x.lc(h.a),x.lc(d.a),x.lc(c.a),x.lc(o.StateService),x.lc(P.a),x.lc(s.a),x.lc(l.a),x.lc(j.a),x.lc(C.a),x.lc(k.a),x.lc(a.a),x.lc(r.a))},S.\u0275prov=x.Xb({token:S,factory:S.\u0275fac})},DiYd:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));i("AA01");var n=i("wZYP"),s=i("Y41n"),r=i("juWA"),a=i("wd/R"),c=i("AEvm"),o=i("Hg4z"),l=i("fXoL"),d=i("ecJW"),u=i("oUDv");class h extends c.a{constructor(e,t){super(),this.timezoneService=e,this.I18n=t,this.shouldFocus=!1,this.filterChanged=new s.a(Object(o.b)(this)),this.text={spacer:this.I18n.t("js.filter.value_spacer")}}get begin(){return this.filter.values[0]}set begin(e){this.filter.values[0]=e||"",this.filterChanged.emit(this.filter)}get end(){return this.filter.values[1]}set end(e){this.filter.values[1]=e||"",this.filterChanged.emit(this.filter)}parser(e){return a(e,"YYYY-MM-DD",!0).isValid()?e:null}formatter(e){if(a(e,"YYYY-MM-DD",!0).isValid()){var t=this.timezoneService.parseDate(e);return this.timezoneService.formattedISODate(t)}return null}}h.\u0275fac=function(e){return new(e||h)(l.bc(r.a),l.bc(n.a))},h.\u0275cmp=l.Vb({type:h,selectors:[["filter-dates-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[l.Mb],decls:4,vars:9,consts:[[1,"inline-label",3,"id"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","focus","id","name","onChange"],[1,"advanced-filters--affix",3,"textContent"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","id","name","onChange"]],template:function(e,t){1&e&&(l.hc(0,"div",0),l.hc(1,"op-date-picker",1),l.pc("onChange",(function(e){return t.begin=t.parser(e)})),l.gc(),l.cc(2,"span",2),l.hc(3,"op-date-picker",3),l.pc("onChange",(function(e){return t.end=t.parser(e)})),l.gc(),l.gc()),2&e&&(l.yc("id","div-values-",t.filter.id,""),l.Pb(1),l.wc("initialDate",t.formatter(t.begin))("focus",t.shouldFocus)("id","values-"+t.filter.id+"-begin")("name","v["+t.filter.id+"]-begin"),l.Pb(1),l.wc("textContent",t.text.spacer),l.Pb(1),l.wc("initialDate",t.formatter(t.end))("id","values-"+t.filter.id+"-end")("name","v["+t.filter.id+"]-end"))},directives:[d.a,u.a],encapsulation:2})},Dp3K:function(e,t,i){"use strict";i.d(t,"a",(function(){return F}));var n=i("mrSG"),s=i("fXoL"),r=i("iB+3"),a=i("Kg8T"),c=i("E2tj"),o=i("zp1y"),l=i("pLZG"),d=i("IzEk"),u=i("Y0Nk"),h=i("wZYP"),p=i("kTg4"),g=i("2Qcm"),f=i("iMRi"),b=i("JY8V"),m=i("6yP5"),w=i("AeZM"),v=i("F5Dh"),y=i("EnRq"),k=i("PtkW"),C=i("wyKs"),j=i("Zq3F"),P=i("DhiE"),x=i("W6hW"),S=i("+oAL"),_=i("Uyc6"),O=i("Va5K"),I=i("/C7M"),T=i("K247"),R=i("r0MM"),E=i("sjKJ"),M=i("AEvm");class F extends M.a{constructor(e){super(),this.injector=e,this.queryLoaded=!1,this.destroyed=!1}ngOnInit(){this.setupQueryObservers(),this.setupRefreshObserver(),this.setupQueryLoadedListener()}setupQueryObservers(){this.wpTablePagination.updates$().pipe(this.untilDestroyed(),Object(o.a)(this.querySpace.query.values$())).subscribe(([e,t])=>{this.wpListChecksumService.isQueryOutdated(t,e)&&(this.wpListChecksumService.update(t,e),this.refresh(!0,!1))}),this.setupChangeObserver(this.wpTableFilters,!0),this.setupChangeObserver(this.wpTableGroupBy),this.setupChangeObserver(this.wpTableSortBy),this.setupChangeObserver(this.wpTableSum),this.setupChangeObserver(this.wpTableTimeline),this.setupChangeObserver(this.wpTableHierarchies),this.setupChangeObserver(this.wpTableColumns),this.setupChangeObserver(this.wpTableHighlighting),this.setupChangeObserver(this.wpTableOrder),this.setupChangeObserver(this.wpDisplayRepresentation)}setupChangeObserver(e,t=!1){const i=this.querySpace.query;e.updates$().pipe(this.untilDestroyed(),Object(l.a)(()=>i.hasValue()&&e.hasChanged(i.value))).subscribe(()=>{const n=i.value,s=e.applyToQuery(n);this.querySpace.query.putValue(n),this.wpListChecksumService.updateIfDifferent(n,this.wpTablePagination.current).then(()=>{s&&this.refresh(!0,t)})})}get projectIdentifier(){return this.currentProject.identifier||void 0}setupRefreshObserver(){this.halEvents.aggregated$("WorkPackage").pipe(this.untilDestroyed(),Object(l.a)(e=>this.filterRefreshEvents(e))).subscribe(e=>{this.refresh(!1,!1)})}filterRefreshEvents(e){let t=new Set(this.querySpace.renderedWorkPackageIds.getValueOr([]));for(let i=0;i<e.length;i++){const n=e[i];if(t.has(n.id)||"created"===n.eventType)return!0}return!1}setupQueryLoadedListener(){this.querySpace.initialized.values$().pipe(Object(d.a)(1),Object(l.a)(()=>!this.componentDestroyed)).subscribe(()=>{this.queryLoaded=!0,this.cdRef.detectChanges()})}}F.\u0275fac=function(e){return new(e||F)(s.bc(s.A))},F.\u0275dir=s.Wb({type:F,features:[s.Mb]}),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",r.StateService)],F.prototype,"$state",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",f.a)],F.prototype,"states",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",c.a)],F.prototype,"querySpace",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",a.a)],F.prototype,"authorisationService",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",b.a)],F.prototype,"wpTableColumns",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",g.a)],F.prototype,"wpTableHighlighting",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",m.a)],F.prototype,"wpTableSortBy",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",w.a)],F.prototype,"wpTableGroupBy",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",v.a)],F.prototype,"wpTableFilters",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",y.a)],F.prototype,"wpTableSum",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",k.a)],F.prototype,"wpTableTimeline",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",C.a)],F.prototype,"wpTableHierarchies",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",j.a)],F.prototype,"wpTablePagination",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",_.a)],F.prototype,"wpTableOrder",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",P.a)],F.prototype,"wpListService",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",x.a)],F.prototype,"wpListChecksumService",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",u.a)],F.prototype,"loadingIndicatorService",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",r.TransitionService)],F.prototype,"$transitions",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",h.a)],F.prototype,"I18n",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",p.a)],F.prototype,"wpStaticQueries",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",S.a)],F.prototype,"wpStatesInitialization",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",s.i)],F.prototype,"cdRef",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",O.a)],F.prototype,"wpDisplayRepresentation",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",I.a)],F.prototype,"halEvents",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",T.a)],F.prototype,"deviceService",void 0),Object(n.c)([Object(R.a)(),Object(n.e)("design:type",E.a)],F.prototype,"currentProject",void 0)},DvFC:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("8aTQ"),s=i("IaZ+"),r=i("fXoL");class a{constructor(e,t){this.opModalService=e,this.injector=t}confirm(e){return new Promise((t,i)=>{this.opModalService.show(n.a,this.injector,{options:e}).closingEvent.subscribe(e=>{e.confirmed?t():i()})})}}a.\u0275fac=function(e){return new(e||a)(r.lc(s.b),r.lc(r.A))},a.\u0275prov=r.Xb({token:a,factory:a.\u0275fac})},"E+lO":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{static register(...e){this.optionalBoostrapComponents.push(...e)}static bootstrapOptionalDocument(e,t,i=this.optionalBoostrapComponents){this.performBootstrap(e,t,!1,i)}static bootstrapOptionalEmbeddable(e,t,i=this.optionalBoostrapComponents){Promise.resolve().then(()=>this.performBootstrap(e,t,!0,i))}static getEmbeddable(){return this.optionalBoostrapComponents.filter(e=>e.embeddable)}static performBootstrap(e,t,i,n){n.forEach(n=>{if(i&&!n.embeddable)return;const s=t.querySelectorAll(n.selector);for(let t=0;t<s.length;t++)e.bootstrap(n.cls,s[t])})}}n.optionalBoostrapComponents=[]},E05v:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("W6hW"),s=i("DhiE"),r=i("iB+3"),a=i("XNiG"),c=i("fXoL");class o{constructor(e){this.injector=e,this.wpListChecksumService=this.injector.get(n.a),this.wpListService=this.injector.get(s.a),this.$transitions=this.injector.get(r.TransitionService),this.observe$=new a.a,this.listenForQueryParamsChanged()}listenForQueryParamsChanged(){return this.queryChangeListener=this.$transitions.onSuccess({},e=>{let t=e.options();const i=e.params("to");let n=this.wpListService.getCurrentQueryProps(i),s=i.query_id?i.query_id.toString():null;return!!(t.reload||t.custom&&!1===t.custom.notify)||this.wpListChecksumService.executeIfOutdated(s,n,()=>{this.observe$.next(n)})})}removeQueryChangeListener(){this.queryChangeListener()}}o.\u0275fac=function(e){return new(e||o)(c.lc(c.A))},o.\u0275prov=c.Xb({token:o,factory:o.\u0275fac})},E2tj:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("FnNU"),s=i("XNiG"),r=i("lJxs"),a=i("fXoL");class c extends n.b{constructor(){super(),this.name="IsolatedQuerySpace",this.query=Object(n.g)(),this.queryForm=Object(n.g)(),this.results=Object(n.g)(),this.groups=Object(n.g)(),this.columns=Object(n.g)(),this.collapsedGroups=Object(n.g)(),this.tableRendered=Object(n.g)(),this.timelineRendered=new s.a,this.renderedWorkPackages=Object(n.d)(this.tableRendered,e=>e.pipe(Object(r.a)(e=>e.filter(e=>!!e.workPackageId)))),this.renderedWorkPackageIds=Object(n.d)(this.renderedWorkPackages,e=>e.pipe(Object(r.a)(e=>e.map(e=>e.workPackageId.toString())))),this.stopAllSubscriptions=new s.a,this.additionalRequiredWorkPackages=Object(n.g)(),this.initialized=Object(n.g)()}}c.\u0275fac=function(e){return new(e||c)},c.\u0275prov=a.Xb({token:c,factory:c.\u0275fac})},E5Dd:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT_ARROW=37]="LEFT_ARROW",e[e.UP_ARROW=38]="UP_ARROW",e[e.RIGHT_ARROW=39]="RIGHT_ARROW",e[e.DOWN_ARROW=40]="DOWN_ARROW",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.KEY_0=48]="KEY_0",e[e.KEY_1=49]="KEY_1",e[e.KEY_2=50]="KEY_2",e[e.KEY_3=51]="KEY_3",e[e.KEY_4=52]="KEY_4",e[e.KEY_5=53]="KEY_5",e[e.KEY_6=54]="KEY_6",e[e.KEY_7=55]="KEY_7",e[e.KEY_8=56]="KEY_8",e[e.KEY_9=57]="KEY_9",e[e.KEY_A=65]="KEY_A",e[e.KEY_B=66]="KEY_B",e[e.KEY_C=67]="KEY_C",e[e.KEY_D=68]="KEY_D",e[e.KEY_E=69]="KEY_E",e[e.KEY_F=70]="KEY_F",e[e.KEY_G=71]="KEY_G",e[e.KEY_H=72]="KEY_H",e[e.KEY_I=73]="KEY_I",e[e.KEY_J=74]="KEY_J",e[e.KEY_K=75]="KEY_K",e[e.KEY_L=76]="KEY_L",e[e.KEY_M=77]="KEY_M",e[e.KEY_N=78]="KEY_N",e[e.KEY_O=79]="KEY_O",e[e.KEY_P=80]="KEY_P",e[e.KEY_Q=81]="KEY_Q",e[e.KEY_R=82]="KEY_R",e[e.KEY_S=83]="KEY_S",e[e.KEY_T=84]="KEY_T",e[e.KEY_U=85]="KEY_U",e[e.KEY_V=86]="KEY_V",e[e.KEY_W=87]="KEY_W",e[e.KEY_X=88]="KEY_X",e[e.KEY_Y=89]="KEY_Y",e[e.KEY_Z=90]="KEY_Z",e[e.LEFT_META=91]="LEFT_META",e[e.RIGHT_META=92]="RIGHT_META",e[e.SELECT=93]="SELECT",e[e.NUMPAD_0=96]="NUMPAD_0",e[e.NUMPAD_1=97]="NUMPAD_1",e[e.NUMPAD_2=98]="NUMPAD_2",e[e.NUMPAD_3=99]="NUMPAD_3",e[e.NUMPAD_4=100]="NUMPAD_4",e[e.NUMPAD_5=101]="NUMPAD_5",e[e.NUMPAD_6=102]="NUMPAD_6",e[e.NUMPAD_7=103]="NUMPAD_7",e[e.NUMPAD_8=104]="NUMPAD_8",e[e.NUMPAD_9=105]="NUMPAD_9",e[e.MULTIPLY=106]="MULTIPLY",e[e.ADD=107]="ADD",e[e.SUBTRACT=109]="SUBTRACT",e[e.DECIMAL=110]="DECIMAL",e[e.DIVIDE=111]="DIVIDE",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUM_LOCK=144]="NUM_LOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.SEMICOLON=186]="SEMICOLON",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.DASH=189]="DASH",e[e.PERIOD=190]="PERIOD",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.GRAVE_ACCENT=192]="GRAVE_ACCENT",e[e.OPEN_BRACKET=219]="OPEN_BRACKET",e[e.BACK_SLASH=220]="BACK_SLASH",e[e.CLOSE_BRACKET=221]="CLOSE_BRACKET",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE"}(n||(n={}))},EnRq:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("zqrF"),s=i("E2tj"),r=i("fXoL");class a extends n.a{constructor(e){super(e)}valueFromQuery(e){return!!e.sums}initialize(e){this.pristineState.putValue(!!e.sums)}hasChanged(e){return e.sums!==this.isEnabled}applyToQuery(e){return e.sums=this.isEnabled,!0}toggle(){this.updatesState.putValue(!this.current)}setEnabled(e){this.updatesState.putValue(e)}get isEnabled(){return this.current}get current(){return this.lastUpdatedState.getValueOr(!1)}}a.\u0275fac=function(e){return new(e||a)(r.lc(s.a))},a.\u0275prov=r.Xb({token:a,factory:a.\u0275fac})},Eofd:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("fXoL"),s=(i("ii2/"),i("VgZ9")),r=i("wZYP"),a=i("qc15"),c=i("ofXK"),o=i("0loS"),l=i("/Rze"),d=i("MIK2");const u=function(e){return{workPackageId:e}};function h(e,t){if(1&e&&(n.hc(0,"a",5),n.cc(1,"span",6),n.gc()),2&e){const e=n.rc(2);n.wc("uiParams",n.Bc(3,u,e.parent.id)),n.Qb("title",e.parent.name),n.Pb(1),n.wc("textContent",e.parent.name)}}function p(e,t){if(1&e&&n.cc(0,"span",6),2&e){const e=n.rc(3);n.wc("textContent",e.text.set_parent)}}function g(e,t){if(1&e){const e=n.ic();n.hc(0,"accessible-by-keyboard",7),n.pc("execute",(function(){n.Lc(e);return n.rc(2).open()})),n.Tc(1,p,1,1,"span",8),n.gc()}if(2&e){const e=n.rc(2);n.yc("linkClass","wp-relation--parent-change -no-decoration hide-when-print icon-small ",e.parent?"icon-edit icon5":"icon-add icon4",""),n.wc("linkTitle",e.parent?e.text.edit_parent:e.text.set_parent),n.Pb(1),n.wc("ngIf",!e.parent)}}function f(e,t){if(1&e){const e=n.ic();n.hc(0,"accessible-by-keyboard",9),n.pc("execute",(function(){n.Lc(e);return n.rc(2).updateParent(null)})),n.gc()}if(2&e){const e=n.rc(2);n.wc("linkTitle",e.text.remove_parent)}}function b(e,t){if(1&e&&(n.fc(0),n.Tc(1,h,2,5,"a",2),n.Tc(2,g,2,3,"accessible-by-keyboard",3),n.Tc(3,f,1,1,"accessible-by-keyboard",4),n.ec()),2&e){const e=n.rc();n.Pb(1),n.wc("ngIf",e.parent),n.Pb(1),n.wc("ngIf",e.canModifyParent()),n.Pb(1),n.wc("ngIf",e.canModifyParent()&&e.parent)}}function m(e,t){if(1&e){const e=n.ic();n.hc(0,"wp-relations-autocomplete",10),n.pc("onCancel",(function(){n.Lc(e);return n.rc().close()}))("onSelected",(function(t){n.Lc(e);return n.rc().updateParent(t)})),n.gc()}if(2&e){const e=n.rc();n.wc("inputPlaceholder",e.text.set_or_remove_parent)("workPackage",e.workPackage)}}class w{constructor(e,t,i){this.I18n=e,this.wpRelationsHierarchy=t,this.notificationService=i,this.onSwitch=new n.s,this.isSaving=!1,this.text={edit_parent:this.I18n.t("js.relation_buttons.change_parent"),set_or_remove_parent:this.I18n.t("js.relations_autocomplete.parent_placeholder"),remove_parent:this.I18n.t("js.relation_buttons.remove_parent"),set_parent:this.I18n.t("js.relation_buttons.set_parent")}}canModifyParent(){return!!this.workPackage.changeParent}get parent(){return this.workPackage&&this.workPackage.parent}get active(){return this.editing}close(){this.toggle(!1)}open(){this.toggle(!0)}updateParent(e){this.close();let t=e?e.id:null;_.get(this.parent,"id",null)!==t&&(this.isSaving=!0,this.wpRelationsHierarchy.changeParent(this.workPackage,t).catch(e=>{this.notificationService.handleRawError(e,this.workPackage)}).then(()=>this.isSaving=!1))}toggle(e){this.editing!==e&&(this.editing=e,this.onSwitch.emit(this.editing))}}w.\u0275fac=function(e){return new(e||w)(n.bc(r.a),n.bc(s.a),n.bc(a.a))},w.\u0275cmp=n.Vb({type:w,selectors:[["wp-breadcrumb-parent"]],inputs:{workPackage:"workPackage"},outputs:{onSwitch:"onSwitch"},decls:2,vars:2,consts:[[4,"ngIf"],["filterCandidatesFor","parent",3,"inputPlaceholder","workPackage","onCancel","onSelected",4,"ngIf"],["uiSref","work-packages.show.activity","class","wp-breadcrumb-parent breadcrumb-project-title nocut",3,"uiParams",4,"ngIf"],[3,"linkTitle","linkClass","execute",4,"ngIf"],["linkClass","wp-relation--parent-remove hide-when-print -no-decoration icon-small icon-remove icon4",3,"linkTitle","execute",4,"ngIf"],["uiSref","work-packages.show.activity",1,"wp-breadcrumb-parent","breadcrumb-project-title","nocut",3,"uiParams"],[3,"textContent"],[3,"linkTitle","linkClass","execute"],[3,"textContent",4,"ngIf"],["linkClass","wp-relation--parent-remove hide-when-print -no-decoration icon-small icon-remove icon4",3,"linkTitle","execute"],["filterCandidatesFor","parent",3,"inputPlaceholder","workPackage","onCancel","onSelected"]],template:function(e,t){1&e&&(n.Tc(0,b,4,3,"ng-container",0),n.Tc(1,m,1,2,"wp-relations-autocomplete",1)),2&e&&(n.wc("ngIf",!t.active),n.Pb(1),n.wc("ngIf",t.active))},directives:[c.q,o.AnchorUISref,o.UISref,l.a,d.a],encapsulation:2})},EzE4:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("wZYP"),s=i("fXoL"),r=i("FDKb"),a=i("N5AO");class c{constructor(e){this.I18n=e,this.text={button_settings:this.I18n.t("js.button_settings")}}}c.\u0275fac=function(e){return new(e||c)(s.bc(n.a))},c.\u0275cmp=s.Vb({type:c,selectors:[["ng-component"]],decls:2,vars:1,consts:[["id","work-packages-settings-button","opSettingsContextMenu","","opSettingsContextMenu-query","query",1,"button","last","work-packages-settings-button","toolbar-icon",3,"title"],["icon-classes","button--icon icon-show-more"]],template:function(e,t){1&e&&(s.hc(0,"button",0),s.cc(1,"op-icon",1),s.gc()),2&e&&s.xc("title",t.text.button_settings)},directives:[r.a,a.a],encapsulation:2,changeDetection:0})},F3Jm:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("JY8V"),s=i("SqdZ"),r=i("E2tj"),a=i("wZYP"),c=i("IaZ+"),o=i("yQm5"),l=i("Y0Nk"),d=i("d/TE"),u=i("ZVvT"),h=i("fXoL"),p=i("tk/3"),g=i("ofXK"),f=i("N5AO");function b(e,t){if(1&e){const e=h.ic();h.hc(0,"li"),h.hc(1,"a",9),h.pc("click",(function(i){h.Lc(e);const n=t.$implicit;return h.rc(2).triggerByLink(n.url,i)})),h.cc(2,"op-icon",10),h.cc(3,"span",11),h.gc(),h.gc()}if(2&e){const e=t.$implicit;h.Pb(1),h.yc("id","export-",e.identifier,""),h.Qb("href",e.url,h.Oc),h.Pb(1),h.yc("icon-classes","icon-export-",e.identifier," icon-big"),h.Pb(1),h.wc("textContent",e.label)}}const m=function(e){return{"-hidden":e}};function w(e,t){if(1&e&&(h.hc(0,"ul",7),h.Tc(1,b,4,4,"li",8),h.gc()),2&e){const e=h.rc();h.wc("ngClass",h.Bc(2,m,e.isLoading)),h.Pb(1),h.wc("ngForOf",e.exportOptions)}}class v extends s.a{constructor(e,t,i,n,s,r,a,c,o){super(e,s,i),this.locals=e,this.I18n=t,this.elementRef=i,this.querySpace=n,this.cdRef=s,this.httpClient=r,this.wpTableColumns=a,this.loadingIndicator=c,this.notifications=o,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.text={title:this.I18n.t("js.label_export"),closePopup:this.I18n.t("js.close_popup_title"),exportPreparing:this.I18n.t("js.label_export_preparing")}}ngOnInit(){super.ngOnInit(),this.locals.link?this.requestExport(this.locals.link):this.querySpace.results.valuesPromise().then(e=>this.exportOptions=this.buildExportOptions(e))}buildExportOptions(e){return e.representations.map(e=>{const t=e.$link;return{identifier:t.identifier,label:t.title,url:this.addColumnsToHref(e.href)}})}triggerByLink(e,t){t.preventDefault(),this.requestExport(e)}requestExport(e){this.httpClient.get(e,{observe:"body",responseType:"json"}).subscribe(e=>this.replaceWithJobModal(e.job_id),e=>this.handleError(e))}replaceWithJobModal(e){this.service.show(u.a,"global",{jobId:e})}handleError(e){200===e.status&&e.url?window.open(e.url):this.showError(e)}showError(e){this.notifications.addError(e.message||this.I18n.t("js.error.internal"))}addColumnsToHref(e){let t=this.wpTableColumns.getColumns().map((function(e){return e.id})),i=o(e);return i.removeSearch("columns[]"),i.addSearch("columns[]",t),i.toString()}get afterFocusOn(){return jQuery("#work-packages-settings-button")}}v.\u0275fac=function(e){return new(e||v)(h.bc(c.a),h.bc(a.a),h.bc(h.q),h.bc(r.a),h.bc(h.i),h.bc(p.b),h.bc(n.a),h.bc(l.a),h.bc(d.a))},v.\u0275cmp=h.Vb({type:v,selectors:[["ng-component"]],features:[h.Mb],decls:7,vars:3,consts:[[1,"op-modal--portal"],["tabindex","0",1,"op-modal--modal-container","wp-table--configuration-modal"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],["class","export-options",3,"ngClass",4,"ngIf"],[1,"export-options",3,"ngClass"],[4,"ngFor","ngForOf"],[3,"id","click"],[3,"icon-classes"],[1,"export-label",3,"textContent"]],template:function(e,t){1&e&&(h.hc(0,"div",0),h.hc(1,"div",1),h.hc(2,"div",2),h.cc(3,"h3",3),h.hc(4,"a",4),h.hc(5,"i",5),h.pc("click",(function(e){return t.closeMe(e)})),h.gc(),h.gc(),h.gc(),h.Tc(6,w,2,4,"ul",6),h.gc(),h.gc()),2&e&&(h.Pb(3),h.wc("textContent",t.text.title),h.Pb(2),h.Qb("title",t.text.closePopup),h.Pb(1),h.wc("ngIf",t.exportOptions))},directives:[g.q,g.n,g.p,f.a],styles:["#download-link[_ngcontent-%COMP%]{display:none}.loading-indicator--location[_ngcontent-%COMP%]{height:220px}.export-options.-hidden[_ngcontent-%COMP%]{display:none}"],changeDetection:0})},F5Dh:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("zqrF"),s=i("AA01"),r=i("E2tj"),a=i("FnNU"),c=i("PZVJ"),o=i("d4d5"),l=i("iMRi"),d=i("IzEk"),u=i("CqXF"),h=i("fXoL");class p extends n.a{constructor(e,t){super(t),this.states=e,this.querySpace=t,this.hidden=["id","parent","datesInterval","precedes","follows","relates","duplicates","duplicated","blocks","blocked","partof","includes","requires","required","search","subjectOrId"],this.incomplete=Object(a.g)(!1)}initializeFilters(e,t){let i=Object(c.a)(e.filters);this.availableState.putValue(t.filtersSchemas.elements),this.pristineState.putValue(i)}get isEmpty(){const e=this.lastUpdatedState.value;return!e||0===e.length}get availableState(){return this.states.queries.filters}get incomplete$(){return this.incomplete.values$()}add(e){this.updatesState.putValue([...this.rawFilters,e])}replace(e,t){let i=this.instantiate(e),n=[...this.rawFilters];t(i);const s=this.findIndex(e);-1===s?n.push(i):n.splice(s,1,i),this.update(n)}modify(e,t){const i=this.findIndex(e);if(-1===i)return!1;let n=[...this.rawFilters];return t(n[i]),this.update(n),!0}instantiate(e){let t=e instanceof o.a?e.id:e;return _.find(this.availableSchemas,e=>e.filter.allowedValues[0].id===t).getFilter()}remove(...e){let t=e=>e instanceof s.a?e.id:e,i=new Set(e.map(t));this.update(this.rawFilters.filter(e=>!i.has(t(e))))}remainingVisibleFilters(e=this.current){return this.remainingFilters(e).filter(e=>-1===this.hidden.indexOf(e.id))}get availableFilters(){return this.availableSchemas.map(e=>e.allowedFilterValue)}get availableSchemas(){return this.availableState.getValueOr([])}isComplete(e){return _.every(e,e=>e.isCompletelyDefined())}hasChanged(e){const t=e=>e.map(e=>e.$source);return!_.isEqual(t(e.filters),t(this.rawFilters))}valueFromQuery(e){}update(e){super.update(e),this.incomplete.putValue(!1)}find(e){const t=this.findIndex(e);if(-1!==t)return this.rawFilters[t]}findIndex(e){return _.findIndex(this.current,t=>t.id===e)}applyToQuery(e){return e.filters=this.cloneFilters(),!0}get current(){return[...this.rawFilters]}cloneFilters(){return Object(c.a)(this.rawFilters)}get rawFilters(){return this.lastUpdatedState.value||[]}get currentlyVisibleFilters(){const e=new Set(this.hidden);return e.delete("search"),_.reject(this.currentFilterResources,t=>e.has(t.id))}replaceIfComplete(e){this.isComplete(e)?this.update(e):this.incomplete.putValue(!0)}onReady(){return Object(a.c)(this.pristineState,this.availableState).values$().pipe(Object(d.a)(1),Object(u.a)(null)).toPromise()}remainingFilters(e=this.rawFilters){return _.differenceBy(this.availableFilters,e,e=>e.id)}get currentFilterResources(){return this.rawFilters.map(e=>e.filter)}isAvailable(e){return!!this.availableFilters.find(t=>t.id===e.id)}}p.\u0275fac=function(e){return new(e||p)(h.lc(l.a),h.lc(r.a))},p.\u0275prov=h.Xb({token:p,factory:p.\u0275fac})},FB4C:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("JY8V"),s=i("zqrF"),r=i("kTsZ"),a=i("E2tj"),c=i("uSJ+"),o=i("QOiP"),l=i("CNq7"),d=i("fXoL");class u extends s.b{constructor(e,t,i,n,s){super(e),this.querySpace=e,this.wpTableColumns=t,this.halResourceService=i,this.apiV3Service=n,this.wpRelations=s}valueFromQuery(e){return this.current}relationsToExtendFor(e,t,i){if(!this.wpTableColumns.hasRelationColumns()||!this.lastUpdatedState.hasValue())return;if(_.isNil(t))return;const n=this.getExpandFor(e.id);if(void 0===n)return;const s=this.wpTableColumns.findById(n),r=this.relationColumnType(s);null!==r&&_.each(this.relationsForColumn(e,t,s),e=>i(e,s,r))}relationsForColumn(e,t,i){if(_.isNil(t))return[];const n=this.relationColumnType(i);if("toType"===n){const n=i.type.href;return _.filter(t,t=>{const i=t.denormalized(e),s=this.apiV3Service.work_packages.cache.state(i.targetId).value;return _.get(s,"type.href")===n})}if("ofType"===n){const n=i.relationType;return _.filter(t,t=>t.denormalized(e).relationType===n)}return[]}relationColumnType(e){switch(e._type){case o.b.RELATION_TO_TYPE:return"toType";case o.b.RELATION_OF_TYPE:return"ofType";default:return null}}getExpandFor(e){return this.current[e]}setExpandFor(e,t){const i=Object.assign({},this.current);i[e]=t,this.update(i)}collapse(e){const t=Object.assign({},this.current);delete t[e],this.update(t)}get current(){return this.lastUpdatedState.getValueOr({})}}u.\u0275fac=function(e){return new(e||u)(d.lc(a.a),d.lc(n.a),d.lc(r.a),d.lc(l.a),d.lc(c.a))},u.\u0275prov=d.Xb({token:u,factory:u.\u0275fac})},FDFi:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("mrSG"),s=i("XNiG"),r=i("wZYP"),a=i("Kg8T"),c=i("r0MM"),o=i("fXoL");class l{constructor(e){this.injector=e,this.referenceComponentClass=null,this.referenceTarget=null,this.buttonTexts={reference:"",create:this.I18n.t("js.label_create_work_package")},this.newInlineWorkPackageCreated=new s.a,this.newInlineWorkPackageReferenced=new s.a}get canAdd(){return this.canCreateWorkPackages||this.authorisationService.can("work_package","addChild")}get canReference(){return!1}get canCreateWorkPackages(){return this.authorisationService.can("work_packages","createWorkPackage")&&this.authorisationService.can("work_packages","editWorkPackage")}ngOnDestroy(){this.newInlineWorkPackageCreated.complete(),this.newInlineWorkPackageReferenced.complete()}}l.\u0275fac=function(e){return new(e||l)(o.lc(o.A))},l.\u0275prov=o.Xb({token:l,factory:l.\u0275fac}),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",r.a)],l.prototype,"I18n",void 0),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",a.a)],l.prototype,"authorisationService",void 0)},FDKb:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("wZYP"),s=i("Kg8T"),r=i("PUHT"),a=i("4lR/"),c=i("iMRi"),o=i("DhiE"),l=(i("B4Ei"),i("IaZ+")),d=i("F3Jm"),u=i("VPzE"),h=i("u/Nd"),p=i("sngl"),g=i("E2tj"),f=i("CV67"),b=i("fXoL");class m extends r.a{constructor(e,t,i,n,s,r,a,c,o){super(e,t),this.elementRef=e,this.opContextMenu=t,this.opModalService=i,this.wpListService=n,this.authorisationService=s,this.states=r,this.injector=a,this.querySpace=c,this.I18n=o,this.focusAfterClose=!0}ngAfterViewInit(){super.ngAfterViewInit(),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.query=e}),this.loadingPromise=this.querySpace.queryForm.valuesPromise(),this.querySpace.queryForm.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.form=e})}open(e){this.loadingPromise.then(()=>{this.buildItems(),this.opContextMenu.show(this,e)})}get locals(){return{contextMenuId:"settingsDropdown",items:this.items}}positionArgs(e){let t=super.positionArgs(e);return _.assign(t,{my:"right top",at:"right bottom"}),t}onClose(){this.focusAfterClose&&this.afterFocusOn.focus()}allowQueryAction(e,t){return this.allowAction(e,"query",t)}allowWorkPackageAction(e,t){return this.allowAction(e,"work_packages",t)}allowFormAction(e,t){return!!this.form.$links[t]||(e.stopPropagation(),!1)}allowAction(e,t,i){return!!this.authorisationService.can(t,i)||(e.stopPropagation(),!1)}buildItems(){this.items=[{disabled:!1,linkText:this.I18n.t("js.toolbar.settings.configure_view"),icon:"icon-settings",onClick:e=>(this.opContextMenu.close(),this.opModalService.show(p.a,this.injector),!0)},{linkText:this.I18n.t("js.work_packages.query.insert_columns"),icon:"icon-columns",class:"hidden-for-mobile",onClick:()=>(this.opModalService.show(p.a,this.injector,{initialTab:"columns"}),!0)},{linkText:this.I18n.t("js.toolbar.settings.sort_by"),icon:"icon-sort-by",onClick:()=>(this.opModalService.show(p.a,this.injector,{initialTab:"sort-by"}),!0)},{linkText:this.I18n.t("js.toolbar.settings.group_by"),icon:"icon-group-by",class:"hidden-for-mobile",onClick:()=>(this.opModalService.show(p.a,this.injector,{initialTab:"display-settings"}),!0)},{disabled:!this.query.id||this.authorisationService.cannot("query","updateImmediately"),linkText:this.I18n.t("js.toolbar.settings.page_settings"),icon:"icon-edit",onClick:e=>(this.allowQueryAction(e,"update")&&(this.focusAfterClose=!1,jQuery(""+f.b).trigger(f.c)),!0)},{disabled:this.authorisationService.cannot("query","updateImmediately"),linkText:this.I18n.t("js.toolbar.settings.save"),icon:"icon-save",onClick:e=>{const t=this.query;return!t.persisted&&this.allowQueryAction(e,"updateImmediately")?this.opModalService.show(u.a,this.injector):t.id&&this.allowQueryAction(e,"updateImmediately")&&this.wpListService.save(t),!0}},{disabled:this.form?!this.form.$links.create_new:this.authorisationService.cannot("query","updateImmediately"),linkText:this.I18n.t("js.toolbar.settings.save_as"),icon:"icon-save",onClick:e=>(this.allowFormAction(e,"create_new")&&this.opModalService.show(u.a,this.injector),!0)},{disabled:this.authorisationService.cannot("query","delete"),linkText:this.I18n.t("js.toolbar.settings.delete"),icon:"icon-delete",onClick:e=>(this.allowQueryAction(e,"delete")&&window.confirm(this.I18n.t("js.text_query_destroy_confirmation"))&&this.wpListService.delete(),!0)},{disabled:this.authorisationService.cannot("work_packages","representations"),linkText:this.I18n.t("js.toolbar.settings.export"),icon:"icon-export",onClick:e=>(this.allowWorkPackageAction(e,"representations")&&this.opModalService.show(d.a,this.injector),!0)},{disabled:this.authorisationService.cannot("query","unstar")&&this.authorisationService.cannot("query","star"),linkText:this.I18n.t("js.toolbar.settings.visibility_settings"),icon:"icon-watched",onClick:e=>((this.allowQueryAction(e,"unstar")||this.allowQueryAction(e,"star"))&&this.opModalService.show(h.a,this.injector),!0)},{divider:!0,hidden:!(this.query.results.customFields&&this.form.configureForm)},{hidden:!this.query.results.customFields,href:this.query.results.customFields&&this.query.results.customFields.href,linkText:this.query.results.customFields&&this.query.results.customFields.name,icon:"icon-custom-fields",onClick:()=>!1}]}}m.\u0275fac=function(e){return new(e||m)(b.bc(b.q),b.bc(a.a),b.bc(l.b),b.bc(o.a),b.bc(s.a),b.bc(c.a),b.bc(b.A),b.bc(g.a),b.bc(n.a))},m.\u0275dir=b.Wb({type:m,selectors:[["","opSettingsContextMenu",""]],inputs:{query:["opSettingsContextMenu-query","query"]},features:[b.Mb]})},FlxY:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));const n={id:"__internal-sorthandle"},s={id:"__internal-contextMenu"}},GDA9:function(e,t,i){i("/ur0"),i("7k/7"),i("z2n6"),i("/Su4"),i("RMHK"),i("brli"),i("0loS"),i("fPeS"),i("Jchv"),i("THJS"),i("NvoQ"),i("9/yf"),i("2nA0"),i("+NVk"),i("O2Hw"),i("Oaa7"),i("tGlX"),i("TiIQ"),i("yFkT"),i("/+cc"),i("+WSP"),i("mKGy"),i("cnmK"),i("cK71"),i("eCE/")},GLdX:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("E+lO"),s=i("fXoL");class r{constructor(e,t,i){this.componentFactoryResolver=e,this.appRef=t,this.injector=i}render(e,t){e.innerHTML=t;let i=[];return n.a.getEmbeddable().forEach(t=>{const n=e.querySelectorAll(t.selector);for(let e=0,s=n.length;e<s;e++){const s=this.componentFactoryResolver.resolveComponentFactory(t.cls).create(this.injector,[],n[e]);i.push(s),this.appRef.attachView(s.hostView),s.changeDetectorRef.detectChanges()}}),()=>{i.forEach(e=>{this.appRef.detachView(e.hostView),e.destroy()}),i.length=0,e.innerHTML=""}}}r.\u0275fac=function(e){return new(e||r)(s.lc(s.l),s.lc(s.f),s.lc(s.A))},r.\u0275prov=s.Xb({token:r,factory:r.\u0275fac})},GURL:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("hxxE"),s=i("DYFc"),r=i("oa+u"),a=i("AA01");class c extends s.a{get _type(){return"QueryFilterInstanceSchema"}get availableOperators(){return this.operator.allowedValues}get allowedFilterValue(){return this.filter.allowedValues instanceof n.a?this.filter.allowedValues.elements[0]:this.filter.allowedValues[0]}$initialize(e){super.$initialize(e),e._dependencies&&(this.dependency=new r.a(this.injector,e._dependencies[0],!0,this.halInitializer,"SchemaDependency"))}getFilter(){let e=this.operator.allowedValues[0],t=this.filter.allowedValues[0],i={name:t.name,_links:{filter:t.$source._links.self,schema:this.$source._links.self,operator:e.$source._links.self}};return this.definesAllowedValues()?i._links.values=[]:i.values=[],new a.a(this.injector,i,!0,this.halInitializer,"QueryFilterInstance")}isValueRequired(){return!!this.values}isResourceValue(){return!(!this.values||!this.values.allowedValues)}resultingSchema(e){let t=this.$source,i=this.dependency.forValue(e.href.toString()),n={};return _.merge(n,t,i),new c(this.injector,n,!0,this.halInitializer,"QueryFilterInstanceSchema")}definesAllowedValues(){return _.some(this._dependencies[0].dependencies,e=>e.values&&e.values._links&&e.values._links.allowedValues)}}},GZlY:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("u4T9"),s=i("oT5z"),r=i("8VVp"),a=i("fXoL");class c{}c.\u0275mod=a.Zb({type:c}),c.\u0275inj=a.Yb({factory:function(e){return new(e||c)},imports:[[n.a,r.a,s.a]]})},GjwL:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var n,s=i("qHU1");!function(e){e.setPosition=function(e,t){try{e.setSelectionRange(t,t)}catch(i){Object(s.a)("Failed to set click position for edit field.",i)}},e.getPosition=function(e){const t=e.originalEvent;try{if(document.caretRangeFromPoint)return document.caretRangeFromPoint(e.clientX,e.clientY).startOffset;if(t.rangeParent){let e=document.createRange();return e.setStart(t.rangeParent,t.rangeOffset),e.startOffset}return 0}catch(i){return Object(s.a)("Failed to get click position for edit field.",i),0}}}(n||(n={}))},GntA:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));class n{constructor(){this.changes={}}contains(e){return this.changes.hasOwnProperty(e)}get changed(){return _.keys(this.changes)}get all(){return this.changes}reset(...e){e.forEach(e=>{delete this.changes[e]})}clear(){this.changes={}}set(e,t,i){this.changes[e]={from:i,to:t}}getItem(e){return this.changes[e]}getValue(e){var t;return null===(t=this.getItem(e))||void 0===t?void 0:t.to}getPristine(e){var t;return null===(t=this.changes[e])||void 0===t?void 0:t.from}}var s=i("FnNU"),r=i("qHU1"),a=i("IzEk"),c=i("dMmB"),o=i("vZpQ");class l{constructor(e,t,i=null){this.state=t,this.changeset=new n,this.form$=Object(s.g)(),this.cache={},this.inFlight=!1,this.updatePristineResource(e),this.schemaCache=e.injector.get(c.a),i&&this.form$.putValue(i)}push(){this.state&&this.state.putValue(this)}buildRequestPayload(){return this.getForm().then(()=>this.buildPayloadFromChanges())}updatePristineResource(e){if(e.__is_changeset_proxy)throw"You're trying to pass proxy object as a pristine resource. This will cause errors";this._pristineResource=e,this.projectedResource=new Proxy(this._pristineResource,{get:(e,t)=>this.proxyGet(t),set:(e,t,i)=>(this.setValue(t,i),!0)})}get pristineResource(){return this._pristineResource}getForm(){return this.form$.isPristine()&&!this.form$.hasActivePromiseRequest()?this.updateForm():this.form$.values$().pipe(Object(a.a)(1)).toPromise()}updateForm(){let e=this.buildPayloadFromChanges();const t=this.pristineResource.$links.update(e).then(e=>(this.cache={},this.form$.putValue(e),this.setNewDefaults(e),this.push(),e));return this.form$.putFromPromiseIfPristine(()=>t),t}isEmpty(){return 0===this.changeset.changed.length}get id(){return this.pristineResource.id.toString()}get href(){return this.pristineResource.href}get changes(){let e={};return _.each(this.changeset.all,(t,i)=>{e[i]=t.to}),e}get changeMap(){return Object.assign({},this.changeset.all)}get changedAttributes(){return this.changeset.changed}isWritable(e){const t=this.schema.ofProperty(e);return!(!t||!t.writable)}humanName(e){return _.get(this.schema,e+".name",e)}contains(e){return this.changeset.contains(e)}proxyGet(e){return"__is_proxy"===e||this.value(e)}value(e){return this.changeset.contains(e)?this.changeset.getValue(e):this.pristineResource[e]}valueExists(e){return this.changeset.contains(e)||this.pristineResource.hasOwnProperty(e)}setValue(e,t){this.changeset.set(e,t,this.pristineResource[e])}clearValue(...e){this.changeset.reset(...e)}clear(){this.state&&this.state.clear(),this.changeset.clear(),this.cache={},this.form$.clear()}reset(e){this.changeset.reset(e)}isOverridden(e){return this.changes.hasOwnProperty(e)}get schema(){return this.form$.hasValue()?o.a.create(this.form$.value.schema,this.projectedResource):this.schemaCache.of(this.pristineResource)}cacheValue(e,t){return this.cache[e]?this.cache[e]:this.cache[e]=t()}get minimalPayload(){return{lockVersion:this.pristineResource.lockVersion,_links:{}}}applyChanges(e){let t=this.pristineResource.$source;return this.form$.value&&(t=this.form$.value.payload.$source),_.each(this.changeset.all,(i,n)=>{if(!this.schema.isAttributeEditable(n))return void Object(r.a)(`Trying to write ${n} but is not writable in schema`);const s=this.schema.ofProperty(n);s&&t._links[n]?e._links[n]=this.getLinkedValue(i.to,s):e[n]=i.to}),e}buildPayloadFromChanges(){let e;return this.pristineResource.isNew?(e=this.form$.value?_.cloneDeep(this.form$.value.payload.$source):_.cloneDeep(this.pristineResource.$source),this.pristineResource.attachments&&(e._links.attachments=this.pristineResource.attachments.elements.map(e=>({href:e.href})))):e=this.minimalPayload,this.applyChanges(e)}getLinkedValue(e,t){if(_.isNil(e))return{href:null};let i=(t.type||"").startsWith("[]"),n=!1;if((e.forEach||e.elements)&&(n=!0),n&&i){let t=[];if(e){(e.forEach&&e||e.elements).forEach(e=>{e.href&&t.push({href:e.href})})}return t}return{href:_.get(e,"href",null)}}setNewDefaults(e){_.each(e.payload,(e,t)=>{const i=this.schema.ofProperty(t);(null==i?void 0:i.writable)&&this.setNewDefaultFor(t,e)})}setNewDefaultFor(e,t){this.valueExists(e)||(Object(r.a)("Taking over default value from form for "+e),this.setValue(e,t))}}},GwdO:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s{static extractPayload(e,t=null){return e instanceof n.a&&t?this.extractPayloadFromSchema(e,t):!e||e instanceof n.a?{}:e}static extractPayloadFromSchema(e,t){let i={_links:{}},s=[];for(let n in t)t.hasOwnProperty(n)&&t[n]&&t[n].writable&&(e.$links[n]?Array.isArray(e[n])?i._links[n]=_.map(e[n],e=>({href:e.$href})):i._links[n]={href:e[n]&&e[n].$href}:s.push(n));return _.each(s,t=>{(e.hasOwnProperty(t)||e[t])&&(Array.isArray(e[t])?i[t]=_.map(e[t],e=>e instanceof n.a?this.extractPayloadFromSchema(e,e.currentSchema||e.schema):e):i[t]=e[t])}),i}}},H3ou:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("+rOU");class s{constructor(e,t,i,n,s){this.availableTabs=e,this.outletElement=t,this.componentFactoryResolver=i,this.appRef=n,this.injector=s,this.activeTabs={},this.currentTab=null}get activeComponents(){return _.values(this.activeTabs).map(e=>e.componentRef.instance)}switchTo(e){const t=_.find(this.availableTabs,t=>t.name===e);if(!t)throw`Trying to switch to unknown tab ${e}.`;if(null!=t.disableBecause)return!1;this.detach();const i=this.activateInstance(t);return this.outletElement.innerHTML="",this.outletElement.appendChild(this._getComponentRootNode(i.componentRef)),this.outletElement.dataset.tabName=t.title,this.currentTab=i,!1}detach(){const e=this.currentTab;null!==e&&(e.portal.setAttachedHost(null),this.currentTab=null)}dispose(){_.each(this.activeTabs,e=>e.dispose()),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}activateInstance(e){return this.activeTabs[e.name]||(this.activeTabs[e.name]=this.createComponent(e)),this.activeTabs[e.name]||null}createComponent(e){const t=this.componentFactoryResolver.resolveComponentFactory(e.componentClass).create(this.injector),i=new n.c(e.componentClass,null,this.injector);return this.appRef.attachView(t.hostView),{name:e.name,portal:i,componentRef:t,dispose:()=>{this.appRef.detachView(t.hostView),t.destroy()}}}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}},HEQ6:function(e,t,i){"use strict";i.d(t,"a",(function(){return B}));var n=i("E2tj"),s=i("ooSb"),r=i("FB4C"),a=i("Zq3F"),c=i("AeZM"),o=i("wyKs"),l=i("6yP5"),d=i("JY8V"),u=i("F5Dh"),h=i("PtkW"),p=i("eyhC"),g=i("EnRq"),f=i("ONn1"),b=i("2Qcm"),m=i("4n9w"),w=i("+oAL"),v=i("Y/CA"),y=i("SKFm"),k=i("DhiE"),C=i("ABwi"),j=i("VgZ9"),P=i("l08T"),x=i("Q6HB"),S=i("FDFi"),_=i("f9kS"),O=i("Yblc"),I=i("W6hW"),T=i("qHU1"),R=i("pSHE"),E=i("Uyc6"),M=i("x5It"),F=i("WW/2"),A=i("Va5K"),L=i("7xci"),D=i("POAS"),V=i("qc15"),q=i("xQCb"),$=i("1RU0"),N=i("fXoL");class B{constructor(e,t,i){this.elementRef=e,this.querySpace=t,this.injector=i,Object(T.a)("Opening isolated query space %O in %O",i,e.nativeElement)}}B.\u0275fac=function(e){return new(e||B)(N.bc(N.q),N.bc(n.a),N.bc(N.A))},B.\u0275dir=N.Wb({type:B,selectors:[["","wp-isolated-query-space",""]],features:[N.Ob([{provide:D.a,useExisting:V.a},n.a,s.a,I.a,k.a,r.a,a.a,c.a,$.a,o.a,l.a,d.a,u.a,h.a,p.a,g.a,f.a,v.a,b.a,A.a,E.a,L.a,M.a,C.a,j.a,P.a,x.a,S.a,_.a,O.a,F.a,y.a,q.a,m.a,w.a,R.a])]})},HGdY:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{intercept(e,t){const i=jQuery("meta[name=csrf-token]").attr("content");if(!1!==e.withCredentials){let n=e.headers.set("X-Authentication-Scheme","Session").set("X-Requested-With","XMLHttpRequest");i&&(n=n.set("X-CSRF-TOKEN",i));const s=e.clone({withCredentials:!0,headers:n});return t.handle(s)}return t.handle(e)}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac})},HKNX:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("IzEk"),s=i("w1tV"),r=i("JX91"),a=i("3UWI"),c=i("lJxs");class o{constructor(e,t=3600){this.multiState=e,this.cacheDurationInMs=1e3*t}state(e){return this.multiState.get(e)}touch(e){const t=this.multiState.get(e);t.putValue(t.value,"Touching the state")}current(e,t){return this.state(e).getValueOr(t)}clearAndLoad(e,t){const i=t.pipe(Object(n.a)(1),Object(s.a)());return this.multiState.get(e).clearAndPutFromPromise(i.toPromise()),i}updateValue(e,t){return this.putValue(e,t),Promise.resolve(t)}updateFor(e){return this.updateValue(e.id,e)}observe(e){return this.state(e).values$()}changes$(e){return this.state(e).changes$()}observeAll(){return this.multiState.observeChange().pipe(Object(r.a)([]),Object(a.a)(250),Object(c.a)(()=>{let e=[];return _.each(this.multiState.getValueOr({}),t=>{t.value&&e.push(t.value)}),e}))}clearSome(...e){e.forEach(e=>this.multiState.get(e).clear())}stale(e){const t=this.multiState.get(e);return!t.hasActivePromiseRequest()&&(t.isPristine()||t.isValueOlderThan(this.cacheDurationInMs))}putValue(e,t){this.multiState.get(e).putValue(t)}}},HN1l:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return r}));var n=i("fXoL");class s{constructor(e){this.elementRef=e}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.thead=this.$element.parent("colgroup").siblings("thead"),this.thead.on("mouseenter","th",e=>{this.$element.index()===jQuery(e.currentTarget).index()&&this.$element.addClass("hover")}),this.thead.on("mouseleave","th",e=>{this.$element.index()===jQuery(e.currentTarget).index()&&this.$element.removeClass("hover")})}ngOnDestroy(){this.thead.off("mouseenter mouseleave")}}s.\u0275fac=function(e){return new(e||s)(n.bc(n.q))},s.\u0275cmp=n.Vb({type:s,selectors:[["col","highlight-col",""]],attrs:["highlight-col",""],decls:0,vars:0,template:function(e,t){},encapsulation:2});const r={selector:"col[highlight-col]",cls:s}},IYP9:function(e,t,i){"use strict";i.d(t,"b",(function(){return v})),i.d(t,"a",(function(){return y}));var n=i("fXoL"),s=i("kTsZ"),r=i("Jui0"),a=i("RhL0"),c=i("wZYP"),o=i("lJxs"),l=i("iuWW"),d=i("POAS"),u=i("ZOsW"),h=i("CNq7"),p=i("3Pt+"),g=i("oUDv"),f=i("ofXK"),b=i("u8Ab");function m(e,t){if(1&e&&n.cc(0,"user-avatar",3),2&e){const e=n.rc().item;n.wc("user",e)}}function w(e,t){if(1&e&&(n.Tc(0,m,1,1,"user-avatar",2),n.Vc(1)),2&e){const e=t.item;n.wc("ngIf",e&&e.href),n.Pb(1),n.Xc(" ",e.name," ")}}const v="user-autocompleter";class y{constructor(e,t,i,s,r,c,o){this.elementRef=e,this.halResourceService=t,this.I18n=i,this.halNotification=s,this.pathHelper=r,this.apiV3Service=c,this.injector=o,this.userTracker=e=>e.href||e.id,this.onChange=new n.s,this.clearAfterSelection=!1,this.url=this.apiV3Service.users.path,this.allowEmpty=!1,this.appendTo="",this.multiple=!1,this.initialSelection=null,this.requests=new l.a(e=>this.getAvailableUsers(this.url,e),Object(l.b)(this.halNotification)),this.inputFilters=new a.a}ngOnInit(){const e=this.elementRef.nativeElement.dataset.updateInput,t=this.elementRef.nativeElement.dataset.allowEmpty,i=this.elementRef.nativeElement.dataset.appendTo,n=this.elementRef.nativeElement.dataset.multiple,s=this.elementRef.nativeElement.dataset.url;e&&(this.updateInputField=document.getElementsByName(e)[0],this.setInitialSelection());let r=this.elementRef.nativeElement.dataset.additionalFilter;r&&JSON.parse(r).forEach(e=>{this.inputFilters.add(e.selector,e.operator,e.values)}),"true"===t&&(this.allowEmpty=!0),i&&(this.appendTo=i),"true"===n&&(this.multiple=!0),s&&(this.url=s)}onFocus(){this.requests.lastRequestedValue||this.requests.input$.next("")}onModelChange(e){e&&(this.onChange.emit(e),this.requests.input$.next(""),this.clearAfterSelection&&this.ngSelectComponent.clearItem(e),this.updateInputField&&(this.multiple?this.updateInputField.value=e.map(e=>e.id):this.updateInputField.value=e.id))}getAvailableUsers(e,t){let i=this.inputFilters.clone();return t&&t.length&&i.add("name","~",[t]),this.halResourceService.get(e,{filters:i.toJson()}).pipe(Object(o.a)(e=>{let t=e.elements.map(e=>({name:e.name,id:e.id,href:e.href,avatar:e.avatar}));return this.allowEmpty&&t.unshift({name:this.I18n.t("js.timelines.filter.noneSelection"),href:null,id:null}),t}))}setInitialSelection(){if(this.updateInputField){const e=parseInt(this.updateInputField.value);this.initialSelection=isNaN(e)?null:e}}}y.\u0275fac=function(e){return new(e||y)(n.bc(n.q),n.bc(s.a),n.bc(c.a),n.bc(d.a),n.bc(r.a),n.bc(h.a),n.bc(n.A))},y.\u0275cmp=n.Vb({type:y,selectors:[["user-autocompleter"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(u.a,!0),2&e)&&(n.Ic(i=n.qc())&&(t.ngSelectComponent=i.first))},inputs:{clearAfterSelection:"clearAfterSelection",url:"url",allowEmpty:"allowEmpty",appendTo:"appendTo",multiple:"multiple",initialSelection:"initialSelection"},outputs:{onChange:"onChange"},decls:4,vars:12,consts:[["bindLabel","name","bindValue","id",3,"items","ngModel","virtualScroll","trackByFn","typeahead","loading","appendTo","multiple","focus","change"],["ng-option-tmp",""],["data-class-list","avatar-mini",3,"user",4,"ngIf"],["data-class-list","avatar-mini",3,"user"]],template:function(e,t){1&e&&(n.hc(0,"ng-select",0),n.pc("focus",(function(){return t.onFocus()}))("change",(function(e){return t.onModelChange(e)})),n.sc(1,"async"),n.sc(2,"async"),n.Tc(3,w,2,2,"ng-template",1),n.gc()),2&e&&n.wc("items",n.tc(1,8,t.requests.output$))("ngModel",t.initialSelection)("virtualScroll",!0)("trackByFn",t.userTracker)("typeahead",t.requests.input$)("loading",n.tc(2,10,t.requests.loading$))("appendTo",t.appendTo)("multiple",t.multiple)},directives:[u.a,p.m,p.p,g.a,u.c,f.q,b.a],pipes:[f.a],encapsulation:2})},"IaZ+":function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return l}));var n=i("fXoL"),s=i("+rOU"),r=i("iB+3"),a=i("E5Dd"),c=i("7ond");const o=new n.z("OP_MODAL_LOCALS");class l{constructor(e,t,i,n,r){this.componentFactoryResolver=e,this.FocusHelper=t,this.appRef=i,this.$transitions=n,this.injector=r,this.active=null,this.opening=!1;const c=this.portalHostElement=document.createElement("div");c.classList.add("op-modals--overlay"),document.body.appendChild(c),jQuery(window).on("keydown",e=>(this.active&&this.active.closeOnEscape&&e.which===a.a.ESCAPE&&this.active.closeOnEscapeFunction(e),!0)),jQuery(window).on("click",e=>{this.active&&!this.opening&&this.active.closeOnOutsideClick&&this.activeModal[0]===e.target&&this.close()}),this.bodyPortalHost=new s.d(c,this.componentFactoryResolver,this.appRef,this.injector)}show(e,t,i={}){this.close(),this.opening=!0,"global"===t&&(t=this.injector);const n=new s.c(e,null,this.injectorFor(t,i)),r=this.bodyPortalHost.attach(n).instance;return this.active=r,this.portalHostElement.style.display="block",setTimeout(()=>{this.active&&this.active.onOpen(this.activeModal),this.opening=!1},20),jQuery(".op-modal--modal-container").focus(),this.active}isActive(e){return this.active&&this.active===e}close(){this.active&&this.active.onClose()&&(this.active.closingEvent.emit(this.active),this.bodyPortalHost.detach(),this.portalHostElement.style.display="none",this.active=null)}get activeModal(){return jQuery(this.portalHostElement).find(".op-modal--portal")}injectorFor(e,t){const i=new WeakMap;return t.service=this,i.set(o,t),new s.f(e,i)}}l.\u0275fac=function(e){return new(e||l)(n.lc(n.l),n.lc(c.a),n.lc(n.f),n.lc(r.TransitionService),n.lc(n.A))},l.\u0275prov=n.Xb({token:l,factory:l.\u0275fac,providedIn:"root"})},"Ie+Q":function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("+rOU"),s=i("7MH/"),r=i("57Du"),a=i("IzEk"),c=i("Jui0"),o=i("mrSG"),l=i("E5Dd"),d=i("wZYP"),u=i("8zkO"),h=i("7ond"),p=i("kgyZ"),g=i("GjwL"),f=i("qHU1"),b=i("XNiG"),m=i("r0MM");class w extends p.a{constructor(e,t,i,n,s,r,a){super(),this.injector=e,this.form=t,this.fieldName=i,this.schema=n,this.element=s,this.pathHelper=r,this.withErrors=a,this.$onUserActivate=new b.a,void 0!==a&&this.setErrors(a)}stopPropagation(e){return e.stopPropagation(),!1}get inEditMode(){return this.form.editMode}get inFlight(){return this.form.change.inFlight}get active(){return!0}focus(e){const t=this.element.querySelector(".inline-edit--field");t?(t.focus(),e&&"INPUT"===t.tagName&&g.a.setPosition(t,e)):Object(f.a)(`Tried to focus on ${this.fieldName}, but element does not (yet) exist.`)}onFocusOut(){this.resource.subject&&this.withErrors&&0===this.withErrors.length&&this.handleUserSubmit()}setErrors(e){this.errors=e,this.element.classList.toggle("-error",this.isErrorenous)}handleUserSubmit(){return this.inFlight||this.form.editMode?Promise.resolve():this.onSubmit().then(()=>this.form.submit())}handleUserKeydown(e,t=!1){return this.inEditMode&&!t?e.which!==l.a.ENTER||(this.form.submit(),!1):e.which!==l.a.ESCAPE||(this.handleUserCancel(),!1)}handleUserCancel(){this.reset()}reset(){this.form.change.reset(this.fieldName),this.deactivate(!0)}deactivate(e=!1){delete this.form.activeFields[this.fieldName],this.onDestroy.next(),this.onDestroy.complete(),this.form.reset(this.fieldName,e)}get isErrorenous(){return this.errors.length>0}isChanged(){return this.form.change.contains(this.fieldName)}get resource(){return this.form.resource}get project(){return this.form.change.projectedResource.project}get htmlId(){return`wp-${this.resource.id}-inline-edit--field-${this.fieldName}`}get fieldLabel(){return this.schema.name||this.fieldName}get errorMessageOnLabel(){return this.isErrorenous?this.I18n.t("js.inplace.errors.messages_on_field",{messages:this.errors.join(" ")}):""}previewContext(e){return e.previewPath()}}Object(o.c)([Object(m.a)(),Object(o.e)("design:type",h.a)],w.prototype,"FocusHelper",void 0),Object(o.c)([Object(m.a)(),Object(o.e)("design:type",u.a)],w.prototype,"ConfigurationService",void 0),Object(o.c)([Object(m.a)(),Object(o.e)("design:type",d.a)],w.prototype,"I18n",void 0);var v=i("fXoL");class y{constructor(e,t,i){this.appRef=e,this.componentFactoryResolver=t,this.pathHelper=i}create(e,t,i,c,o,l){const d=this.createDomOutlet(e,t),u=new w(t,i,o,c,e,this.pathHelper,l);u.onDestroy.pipe(Object(a.a)(1)).subscribe(()=>d.detach());const h=Object(r.a)(t,i.change,u,c),p=new n.c(s.a,null,h);e.innerHTML="";return d.attachComponentPortal(p).instance.onEditFieldReady.pipe(Object(a.a)(1)).toPromise().then(()=>u)}createDomOutlet(e,t){return new n.d(e,this.componentFactoryResolver,this.appRef,t)}}y.\u0275fac=function(e){return new(e||y)(v.lc(v.f),v.lc(v.l),v.lc(c.a))},y.\u0275prov=v.Xb({token:y,factory:y.\u0275fac,providedIn:"root"})},Ioun:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("tN7n"),s=i("0zio"),r=i("AcWF"),a=i("sngl"),c=i("WgCp"),o=i("fXoL"),l=i("HEQ6"),d=i("72oW");const u=function(){return{tableVisible:!1}};class h extends c.a{}h.\u0275fac=function(e){return p(e||h)},h.\u0275cmp=o.Vb({type:h,selectors:[["ng-component"]],features:[o.Ob([[{provide:n.a,useClass:s.a}],{provide:a.b,useValue:r.a}]),o.Mb],decls:3,vars:3,consts:[["wp-isolated-query-space",""],[3,"queryProps","configuration"],["embeddedTableForConfiguration",""]],template:function(e,t){1&e&&(o.fc(0,0),o.cc(1,"wp-embedded-table",1,2),o.ec()),2&e&&(o.Pb(1),o.wc("queryProps",t.queryProps)("configuration",o.Ac(2,u)))},directives:[l.a,d.a],encapsulation:2});const p=o.jc(h)},J30J:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("8ocD"),s=i("fXoL");class r extends n.a{getField(e,t,i,n){let s=new(this.getSpecificClassFor(e._type,t,i.type))(t,n);return s.apply(e,i),s}}r.\u0275fac=function(e){return a(e||r)},r.\u0275prov=s.Xb({token:r,factory:r.\u0275fac,providedIn:"root"});const a=s.jc(r)},JY8V:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("zqrF"),s=i("E2tj"),r=i("iMRi"),a=i("PZVJ"),c=i("QOiP"),o=i("FnNU"),l=i("IzEk"),d=i("CqXF"),u=i("fXoL");class h extends n.a{constructor(e,t){super(t),this.states=e,this.querySpace=t}initialize(e,t,i){super.initialize(e,t,i)}valueFromQuery(e){return[...e.columns]}hasChanged(e){return!this.isCurrentlyEqualTo(e.columns)}isCurrentlyEqualTo(e){const t=e=>e.map(e=>e.href);return _.isEqual(t(e),t(this.getColumns()))}applyToQuery(e){const t=this.getColumns(),i=e.columns.map(e=>e.id),n=t.map(e=>e.id);e.columns=Object(a.a)(t);return!(0===_.difference(n,i).length)&&this.hasRelationColumns()}hasRelationColumns(){const e=[c.b.RELATION_OF_TYPE,c.b.RELATION_TO_TYPE];return!!_.find(this.getColumns(),t=>e.indexOf(t._type)>=0)}getColumns(){return[...this.current]}index(e){return _.findIndex(this.getColumns(),t=>t.id===e)}findById(e){return _.find(this.getColumns(),t=>t.id===e)}previous(e){let t=this.index(e.id);return t<=0?null:this.getColumns()[t-1]}next(e){let t=this.index(e.id);return-1===t||this.isLast(name)?null:this.getColumns()[t+1]}isFirst(e){return 0===this.index(e.id)}isLast(e){return this.index(e.id)===this.columnCount-1}setColumns(e){this.isCurrentlyEqualTo(e)||this.update(e)}setColumnsById(e){const t=e.map(e=>_.find(this.all,t=>t.id===e));this.setColumns(_.compact(t))}moveColumn(e,t){let i=this.getColumns();t>=i.length&&(t=i.length-1),t<0&&(t=0);let n=i[e];i.splice(e,1),i.splice(t,0,n),this.setColumns(i)}shift(e,t){let i=this.index(e.id);-1!==i&&this.moveColumn(i,i+t)}addColumn(e,t){let i=this.getColumns();if(void 0===t&&(t=i.length),-1===this.index(e)){let n=_.find(this.all,t=>t.id===e);if(!n)throw"Column with provided name is not found";i.splice(t,0,n),this.setColumns(i)}}removeColumn(e){let t=this.index(e.id);if(-1!==t){let e=this.getColumns();e.splice(t,1),this.setColumns(e)}}get current(){return this.lastUpdatedState.getValueOr([])}get availableState(){return this.states.queries.columns}get columnCount(){return this.getColumns().length}get all(){return this.availableState.getValueOr([])}get allPropertyColumns(){return this.all.filter(e=>e._type===c.b.PROPERTY)}get unused(){return _.differenceBy(this.all,this.getColumns(),"$href")}onReady(){return Object(o.c)(this.pristineState,this.availableState).values$().pipe(Object(l.a)(1),Object(d.a)(null)).toPromise()}}h.\u0275fac=function(e){return new(e||h)(u.lc(r.a),u.lc(s.a))},h.\u0275prov=u.Xb({token:h,factory:h.\u0275fac})},Jui0:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("RhL0"),s=i("fXoL");class r{constructor(e){this.apiV3Base=e+"/api/v3"}previewMarkup(e){let t=this.apiV3Base+"/render/markdown";return e?`${t}?context=${e}`:t}principals(e,t){let i=new n.a;return i.add("status","!",["3"]),i.add("member","=",[e.toString()]),i.add("type","=",["User","Group"]),i.add("id","!",["me"]),t&&t.length>0&&i.add("name","~",[t]),this.apiV3Base+"/principals?"+i.toParams({sortBy:'[["name","asc"]]',offset:"1",pageSize:"10"})}}class a{constructor(){this.appBasePath=window.appBasePath||"",this.api={v3:new r(this.appBasePath)}}get staticBase(){return this.appBasePath}attachmentDownloadPath(e,t){let i=`${this.staticBase}/attachments/${e}`;return t?`${i}/${t}`:i}attachmentContentPath(e){return`${this.staticBase}/attachments/${e}/content`}ifcModelsPath(e){return`${this.staticBase}/projects/${e}/ifc_models`}bimDetailsPath(e,t,i=null){let n=`${this.projectPath(e)}/bcf/split/details/${t}`;return null!==i&&(n+="?viewpoint="+i),n}highlightingCssPath(){return this.staticBase+"/highlighting/styles"}forumPath(e,t){return`${this.projectForumPath(e)}/${t}`}keyboardShortcutsHelpPath(){return this.staticBase+"/help/keyboard_shortcuts"}messagePath(e){return`${this.staticBase}/topics/${e}`}myPagePath(){return this.staticBase+"/my/page"}newsPath(e){return`${this.staticBase}/news/${e}`}loginPath(){return this.staticBase+"/login"}projectsPath(){return this.staticBase+"/projects"}projectPath(e){return`${this.projectsPath()}/${e}`}projectActivityPath(e){return this.projectPath(e)+"/activity"}projectForumPath(e){return this.projectPath(e)+"/forums"}projectCalendarPath(e){return this.projectPath(e)+"/work_packages/calendar"}projectMembershipsPath(e){return this.projectPath(e)+"/members"}projectNewsPath(e){return this.projectPath(e)+"/news"}projectTimeEntriesPath(e){return this.projectPath(e)+"/cost_reports"}projectWikiPath(e){return this.projectPath(e)+"/wiki"}projectWorkPackagePath(e,t){return`${this.projectWorkPackagesPath(e)}/${t}`}projectWorkPackagesPath(e){return this.projectPath(e)+"/work_packages"}projectWorkPackageNewPath(e){return this.projectWorkPackagesPath(e)+"/new"}projectBoardsPath(e){return e?this.projectPath(e)+"/boards":this.staticBase+"/boards"}projectDashboardsPath(e){return this.projectPath(e)+"/dashboards"}timeEntriesPath(e){let t="/time_entries";return e?this.workPackagePath(e)+t:this.staticBase+t}usersPath(){return this.staticBase+"/users"}userPath(e){return`${this.usersPath()}/${e}`}versionsPath(){return this.staticBase+"/versions"}versionEditPath(e){return`${this.staticBase}/versions/${e}/edit`}versionShowPath(e){return`${this.staticBase}/versions/${e}`}workPackagesPath(){return this.staticBase+"/work_packages"}workPackagePath(e){return`${this.staticBase}/work_packages/${e}`}workPackageCopyPath(e){return this.workPackagePath(e)+"/copy"}workPackageDetailsCopyPath(e,t){return`${this.projectWorkPackagesPath(e)}/details/${t}/copy`}workPackagesBulkDeletePath(){return this.workPackagesPath()+"/bulk"}projectLevelListPath(){return this.projectsPath()+"/level_list.json"}textFormattingHelp(){return this.staticBase+"/help/text_formatting"}}a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=s.Xb({token:a,factory:a.\u0275fac,providedIn:"root"})},K018:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("2Vo4"),s=i("pLZG"),r=i("IzEk"),a=i("fXoL");class c{constructor(){this.navigationEvents$=new n.a("")}onActivate(...e){return this.navigationEvents$.pipe(Object(s.a)(t=>-1!==e.indexOf(t)),Object(r.a)(1))}recreateToggler(){let e=this;jQuery("#main-menu .toggler").remove();var t=jQuery('<a class="toggler" href="#"><i class="icon6 icon-toggler icon-arrow-right3" aria-hidden="true"></i><span class="hidden-for-sighted"></span></a>').on("click",(function(){let t=jQuery(this);if(t.hasClass("toggler")){jQuery("#sidebar").toggleClass("-hidden",!0),jQuery(".menu_root li").removeClass("open"),jQuery(".menu_root").removeClass("open").addClass("closed");let i=t.closest("li");i.addClass("open").find("li > a:first, .tree-menu--title:first").first().focus(),console.log("Activating "+i.data("name")),e.navigationEvents$.next(i.data("name"))}return!1}));return t.attr("title",I18n.t("js.project_menu_details")),t}wrapMainItem(){var e=jQuery("#main-menu li > a").not("ul ul a");e.wrap(t=>{var i=e[t].id,n=jQuery('<div class="main-item-wrapper"/>');return i&&n.attr("id",i+"-wrapper"),n})}register(){this.wrapMainItem();const e=jQuery(".main-item-wrapper a.selected");e.length>0&&e[0].scrollIntoView();const t=this.recreateToggler();let i=jQuery("#main-menu .menu_root > li.open").data("name"),n=jQuery("#main-menu .menu_root.open > li").data("name");function s(e){e.preventDefault();var t=jQuery(this);jQuery(t).parents("li").first().removeClass("open"),jQuery(".menu_root").removeClass("closed").addClass("open"),t.parents("li").first().find(".toggler").first().focus(),jQuery("#sidebar").toggleClass("-hidden",!1)}(i||n)&&this.navigationEvents$.next(i||n),jQuery("#main-menu li:has(ul) .main-item-wrapper > a").not("ul ul a").unbind("click").wrapInner('<span class="ellipsis"/>').after(t),jQuery("#main-menu ul.main-menu--children").each((function(e,t){var i=jQuery(t).parents("li").find(".main-item-wrapper .menu-item--title").contents()[0].textContent,n=jQuery(t).parents("li").find(".main-item-wrapper > a").attr("href"),r=jQuery('<div class="main-menu--children-menu-header"></div>'),a=jQuery('<a class="main-menu--arrow-left-to-project" href="#"><i class="icon-arrow-left1" aria-hidden="true"></i></a>'),c=jQuery('<a href="'+n+'" class="main-menu--parent-node ellipsis">'+i+"</a>");a.attr("title",I18n.t("js.label_up")),a.on("click",s),r.append(a),r.append(c),jQuery(t).before(r)})),jQuery(".menu_root").hasClass("closed")&&jQuery("#sidebar").toggleClass("-hidden",!0)}}c.\u0275fac=function(e){return new(e||c)},c.\u0275prov=a.Xb({token:c,factory:c.\u0275fac,providedIn:"root"})},K247:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.mobileWidthTreshold=680}get isMobile(){return window.innerWidth<this.mobileWidthTreshold}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac,providedIn:"root"})},K8b8:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));i("ii2/");var n=i("SKFm"),s=i("wZYP"),r=i("RGDJ"),a=i("AEvm"),c=i("dMmB"),o=i("fXoL"),l=i("ofXK"),d=i("t7qP"),u=i("N5AO");function h(e,t){1&e&&(o.hc(0,"span",6),o.cc(1,"op-icon",7),o.gc())}function p(e,t){if(1&e&&(o.hc(0,"div",1),o.hc(1,"button",2),o.Tc(2,h,2,0,"span",3),o.cc(3,"span",4),o.cc(4,"op-icon",5),o.gc(),o.gc()),2&e){const e=o.rc();o.wc("ngClass",e.containerClass),o.Qb("title",e.buttonTitle),o.Pb(1),o.wc("ngClass",e.statusHighlightClass)("disabled",!e.allowed)("wpStatusDropdown-workPackage",e.workPackage),o.Qb("aria-label",e.text.explanation),o.Pb(1),o.wc("ngIf",e.isReadonly),o.Pb(1),o.wc("textContent",e.status.name)}}class g extends a.a{constructor(e,t,i,n){super(),this.I18n=e,this.cdRef=t,this.schemaCache=i,this.halEditing=n,this.text={explanation:this.I18n.t("js.label_edit_status"),workPackageReadOnly:this.I18n.t("js.work_packages.message_work_package_read_only"),workPackageStatusBlocked:this.I18n.t("js.work_packages.message_work_package_status_blocked")}}ngOnInit(){this.halEditing.temporaryEditResource(this.workPackage).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackage=e,this.workPackage.status&&this.workPackage.status.$load(),this.cdRef.detectChanges()})}get buttonTitle(){return this.schema.isReadonly?this.text.workPackageReadOnly:this.schema.isEditable&&!this.allowed?this.text.workPackageStatusBlocked:""}get statusHighlightClass(){let e=this.status;if(e)return r.a.backgroundClass("status",e.id)}get status(){return this.workPackage.status}get isReadonly(){return this.schema.isReadonly}get allowed(){return this.schema.isAttributeEditable("status")}get schema(){return this.halEditing.typedState(this.workPackage).hasValue()?this.halEditing.typedState(this.workPackage).value.schema:this.schemaCache.of(this.workPackage)}}g.\u0275fac=function(e){return new(e||g)(o.bc(s.a),o.bc(o.i),o.bc(c.a),o.bc(n.a))},g.\u0275cmp=o.Vb({type:g,selectors:[["wp-status-button"]],inputs:{workPackage:"workPackage",containerClass:"containerClass"},features:[o.Mb],decls:1,vars:1,consts:[["class","wp-status-button",3,"ngClass",4,"ngIf"],[1,"wp-status-button",3,"ngClass"],["wpStatusDropdown","",1,"button",3,"ngClass","disabled","wpStatusDropdown-workPackage"],["class","button--text",4,"ngIf"],["aria-hidden","true",1,"button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown"],[1,"button--text"],["icon-classes","button--icon icon-locked"]],template:function(e,t){1&e&&o.Tc(0,p,5,8,"div",0),2&e&&o.wc("ngIf",t.status)},directives:[l.q,l.n,d.a,u.a],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.wp-status-button[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;padding:5px;margin-bottom:0;background-color:var(--status-selector-bg-color);border:none;color:#fff;max-width:100%}.wp-status-button[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]   .button--text[_ngcontent-%COMP%]{margin:0 5px}.wp-status-button.-small[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{font-size:12px;padding:4px;margin-right:0}"]})},KEdw:function(e,t,i){"use strict";i.d(t,"d",(function(){return m})),i.d(t,"e",(function(){return w})),i.d(t,"b",(function(){return v})),i.d(t,"c",(function(){return y})),i.d(t,"a",(function(){return k}));var n=i("mrSG"),s=i("wZYP"),r=i("J30J"),a=i("Q2x2"),c=i("4rda");class o extends a.a{render(e,t){const i=this.value;e.setAttribute("title",t),e.textContent=t,e.innerHTML="",0===i.length?this.renderEmpty(e):this.renderValues(i,e)}renderValues(e,t){e.forEach(e=>{const i=document.createElement("div");i.classList.add(c.b,"-multiple-lines"),i.setAttribute("title",e),i.textContent=e,t.appendChild(i)})}}var l=i("Nvnm");class d extends l.a{render(e,t){const i=this.percentLabel;e.setAttribute("title",i),e.innerHTML="",e.textContent=i}}var u=i("r0MM"),h=i("3uR5");class p extends a.a{render(e,t){const i=this.attribute;e.setAttribute("title",t),e.textContent=t,e.innerHTML="",0===i.length?this.renderEmpty(e):this.renderValues(i,e)}renderValues(e,t){this.avatarRenderer.renderMultiple(t,e,!0,!0)}}Object(n.c)([Object(u.a)(),Object(n.e)("design:type",h.a)],p.prototype,"avatarRenderer",void 0);var g=i("dMmB"),f=i("SKFm"),b=i("ayqa");const m="-editable",w="-read-only",v="inline-edit--display-field",y="inline-edit--container";class k{constructor(e,t,i={}){this.injector=e,this.container=t,this.options=i,this.fieldCache={}}render(e,t,i,n){const[s,r]=this.renderFieldValue(e,t,i,n);return null===s||this.setSpanAttributes(r,s,t,e,i),r}renderFieldValue(e,t,i,n){const s=document.createElement("span"),r=this.schema(e,i),a=this.attributeName(t,r),c=r.ofProperty(a);if(!c)return[null,s];const o=this.getField(e,c,a,i);o.render(s,this.getText(o,c,n),c.options);const l=o.title;return l&&s.setAttribute("title",l),s.setAttribute("aria-label",this.getAriaLabel(o,r)),[o,s]}getField(e,t,i,n){let s=this.fieldCache[i];return s||(s=this.fieldCache[i]=this.getFieldForCurrentContext(e,i,t)),s.apply(e,t),s.activeChange=n,s}getFieldForCurrentContext(e,t,i){const n={container:this.container,injector:this.injector,options:this.options},s=["[]CustomOption"].indexOf(i.type)>=0;if("single-view"===this.container&&s)return new o(t,n);const r=["[]User"].indexOf(i.type)>=0;return"single-view"===this.container&&r?new p(t,n):"timeline"===this.container&&"percentageDone"===t?new d(t,n):"table"===this.container&&["startDate","dueDate","date"].includes(t)?new b.a(t,n):this.displayFieldService.getField(e,t,i,n)}getText(e,t,i){return e.isEmpty()?i||this.getDefaultPlaceholder(t):e.valueString}setSpanAttributes(e,t,i,n,s){e.classList.add(v,i),e.dataset.fieldName=i,e.setAttribute("tabindex","id"===i?"-1":"0"),t.required&&e.classList.add("-required"),t.isEmpty()&&e.classList.add("-placeholder");const r=this.schema(n,s);this.isAttributeEditable(r,i)?(e.classList.add(m),e.setAttribute("role","button")):e.classList.add(w)}isAttributeEditable(e,t){return["startDate","dueDate","date"].includes(t)&&(t="combinedDate"),e.isAttributeEditable(t)}getAriaLabel(e,t){let i,n=this.getLabelContent(e);if(e.isFormattable&&!e.isEmpty())try{i=_.escape(jQuery(`<div>${n}</div>`).text())}catch(s){console.error("Failed to parse formattable labelContent"),i="Label for "+e.displayName}else i=n;return e.writable&&t.isAttributeEditable(e.name)?this.I18n.t("js.inplace.button_edit",{attribute:`${e.displayName} ${i}`}):`${e.displayName} ${i}`}getLabelContent(e){return e.isEmpty()?this.I18n.t("js.inplace.null_value_label"):e.valueString}attributeName(e,t){return t.mappedName?t.mappedName(e):e}getDefaultPlaceholder(e){return"Formattable"===e.type?this.I18n.t("js.work_packages.placeholders.formattable",{name:e.name}):"-"}schema(e,t){return t?t.schema:this.halEditing.typedState(e).hasValue()?this.halEditing.typedState(e).value.schema:this.schemaCache.of(e)}}Object(n.c)([Object(u.a)(),Object(n.e)("design:type",r.a)],k.prototype,"displayFieldService",void 0),Object(n.c)([Object(u.a)(),Object(n.e)("design:type",g.a)],k.prototype,"schemaCache",void 0),Object(n.c)([Object(u.a)(),Object(n.e)("design:type",f.a)],k.prototype,"halEditing",void 0),Object(n.c)([Object(u.a)(),Object(n.e)("design:type",s.a)],k.prototype,"I18n",void 0)},Kg8T:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("FnNU"),s=i("1G5W"),r=i("fXoL");class a{constructor(){this.links=Object(n.g)({})}initModelAuth(e,t){this.links.doModify(i=>{let n=Object.assign({},i);return n[e]=t,n})}observeUntil(e){return this.links.values$().pipe(Object(s.a)(e))}can(e,t){const i=this.links.getValueOr({});return i[e]&&t in i[e]}cannot(e,t){return!this.can(e,t)}}a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=r.Xb({token:a,factory:a.\u0275fac,providedIn:"root"})},LrpJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("/8SZ"),s=i("ZsX/"),r=i("POAS"),a=i("Jui0"),c=i("d/TE"),o=i("8zkO"),l=i("CNq7"),d=i("fFIw");function u(e){return class extends e{get canAddAttachments(){return!!this.$links.addAttachment||this.isNew}get hasAttachments(){return _.get(this.attachments,"elements.length",0)>0}lookupDownloadLocationByName(e){if(!this.attachments||!this.attachments.elements)return null;const t=_.find(this.attachments.elements,t=>t.name===e);return _.get(t,"staticDownloadLocation.href",null)}removeAttachment(e){return _.pull(this.attachments.elements,e),e.$isHal?e.delete().then(()=>{this.attachmentsBackend?this.updateAttachments():this.attachments.count=Math.max(this.attachments.count-1,0)}).catch(t=>{this.halNotification.handleRawError(t,this),this.attachments.elements.push(e)}):Promise.resolve()}updateAttachments(){return this.attachments.updateElements().then(()=>(this.updateState(),this.attachments))}uploadAttachments(e){const{uploads:t,finished:i}=this.performUpload(e),n=I18n.t("js.label_upload_notification"),s=this.NotificationsService.addAttachmentUpload(n,t);return i.then(e=>(setTimeout(()=>this.NotificationsService.remove(s),700),this.attachments.count+=e.length,e.forEach(e=>{this.attachments.elements.push(e.response)}),this.updateState(),e)).catch(e=>{let t;return console.error("Error while uploading: %O",e),t=e.error instanceof ErrorEvent?this.I18n.t("js.error_attachment_upload",{error:e}):"Error"===_.get(e,"error._type")?e.error.message:e.error,this.halNotification.handleRawError(t),t||I18n.t("js.error.internal")})}performUpload(e){let t=this.directUploadURL||"";return t?this.opDirectFileUpload.uploadAndMapResponse(t,e):(t=!this.isNew&&this.id&&this.attachmentsBackend?this.addAttachment.$link.href:this.apiV3Service.attachments.path,this.opFileUpload.uploadAndMapResponse(t,e))}get directUploadURL(){return this.$links.prepareAttachment?this.$links.prepareAttachment.href:this.isNew?this.config.prepareAttachmentURL:null}updateState(){this.state&&this.state.putValue(this)}$initialize(e){this.NotificationsService||(this.NotificationsService=this.injector.get(c.a)),this.halNotification||(this.halNotification=this.injector.get(r.a)),this.opFileUpload||(this.opFileUpload=this.injector.get(s.a)),this.opDirectFileUpload||(this.opDirectFileUpload=this.injector.get(d.a)),this.config||(this.config=this.injector.get(o.a)),this.pathHelper||(this.pathHelper=this.injector.get(a.a)),this.apiV3Service||(this.apiV3Service=this.injector.get(l.a)),super.$initialize(e);let t=this.attachments||{$source:{},elements:[]};this.attachments=new n.a(this.injector,t,!1,this.halInitializer,"HalResource")}}}},M0J3:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("AEvm");class s extends n.a{get displayName(){return this.schema.name||this.name}get value(){return this.resource[this.name]}get type(){return this.constructor.type}get required(){return!!this.schema.required}get writable(){return this.schema.writable&&!1!==this.context.options.writable}get hasDefault(){return this.schema.hasDefault}get options(){return this.schema.options}isEmpty(){return!this.value}get unknownAttribute(){return this.isEmpty&&!this.schema}}},MIK2:function(e,t,i){"use strict";i.d(t,"a",(function(){return P}));var n=i("fXoL"),s=i("wZYP"),r=(i("ii2/"),i("XNiG")),a=i("LRne"),c=i("Cfvw"),o=i("Kj3r"),l=i("/uUt"),d=i("vkgz"),u=i("eIep"),h=i("lJxs"),p=i("JIr8"),g=i("ZOsW"),f=i("E2tj"),b=i("Jui0"),m=i("sjKJ"),w=i("kTsZ"),v=i("dMmB"),y=i("qc15"),k=i("ofXK");function C(e,t){if(1&e&&n.Vc(0),2&e){const e=t.item;n.Zc(" ",e.type.name," #",e.id," ",e.subject," ")}}function j(e,t){if(1&e&&n.Vc(0),2&e){const e=t.item;n.Zc(" ",e.type.name," #",e.id," ",e.subject," ")}}class P{constructor(e,t,i,s,a,c,h,p){this.querySpace=e,this.pathHelper=t,this.notificationService=i,this.CurrentProject=s,this.halResourceService=a,this.schemaCacheService=c,this.cdRef=h,this.I18n=p,this.text={placeholder:this.I18n.t("js.relations_autocomplete.placeholder")},this.inputPlaceholder=this.text.placeholder,this.additionalFilters=[],this.hiddenOverflowContainer="body",this.onCancel=new n.s,this.onSelected=new n.s,this.onEmptySelected=new n.s,this.isLoading=!1,this.searchInput$=new r.a,this.appendToContainer="body",this.results$=this.searchInput$.pipe(Object(o.a)(250),Object(l.a)(),Object(d.a)(()=>this.isLoading=!0),Object(u.a)(e=>this.autocompleteWorkPackages(e)))}reset(){this.cancel()}ngAfterContentInit(){this.ngSelectComponent&&setTimeout(()=>{this.ngSelectComponent.focus()},25)}cancel(){this.onCancel.emit()}onWorkPackageSelected(e){e&&this.schemaCacheService.ensureLoaded(e).then(()=>{this.onSelected.emit(e),this.ngSelectComponent.close()})}autocompleteWorkPackages(e){return null===e||0===e.length?(this.isLoading=!1,Object(a.a)([])):(e=e.replace(/^#/,""),Object(c.a)(this.workPackage.availableRelationCandidates.$link.$fetch({query:e,filters:JSON.stringify(this.additionalFilters),type:this.filterCandidatesFor||this.selectedRelationType})).pipe(Object(h.a)(e=>e.elements),Object(p.a)(e=>(this.notificationService.handleRawError(e),Object(a.a)([]))),Object(d.a)(()=>this.isLoading=!1)))}onOpen(){setTimeout(()=>{const e=this.ngSelectComponent;e&&e.dropdownPanel&&e.dropdownPanel._updatePosition(),jQuery(this.hiddenOverflowContainer).one("scroll",()=>{this.ngSelectComponent.close()})},25)}}P.\u0275fac=function(e){return new(e||P)(n.bc(f.a),n.bc(b.a),n.bc(y.a),n.bc(m.a),n.bc(w.a),n.bc(v.a),n.bc(n.i),n.bc(s.a))},P.\u0275cmp=n.Vb({type:P,selectors:[["wp-relations-autocomplete"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(g.a,!0),2&e)&&(n.Ic(i=n.qc())&&(t.ngSelectComponent=i.first))},hostBindings:function(e,t){1&e&&n.pc("keydown.escape",(function(){return t.reset()}))},inputs:{inputPlaceholder:"inputPlaceholder",workPackage:"workPackage",selectedRelationType:"selectedRelationType",filterCandidatesFor:"filterCandidatesFor",additionalFilters:"additionalFilters",hiddenOverflowContainer:"hiddenOverflowContainer"},outputs:{onCancel:"onCancel",onSelected:"onSelected",onEmptySelected:"onEmptySelected"},decls:5,vars:9,consts:[[1,"wp-relations--autocomplete"],["ngClass","wp-inline-create--reference-autocompleter",3,"items","appendTo","multiple","loading","placeholder","typeahead","closeOnSelect","open","change"],["ng-label-tmp",""],["ng-option-tmp",""]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"ng-select",1),n.pc("open",(function(){return t.onOpen()}))("change",(function(e){return t.onWorkPackageSelected(e)})),n.sc(2,"async"),n.Tc(3,C,1,3,"ng-template",2),n.Tc(4,j,1,3,"ng-template",3),n.gc(),n.gc()),2&e&&(n.Pb(1),n.wc("items",n.tc(2,7,t.results$))("appendTo",t.appendToContainer)("multiple",!1)("loading",t.isLoading)("placeholder",t.inputPlaceholder)("typeahead",t.searchInput$)("closeOnSelect",!0))},directives:[g.a,k.n,g.e,g.c],pipes:[k.a],styles:["ng-select.wp-inline-create--reference-autocompleter{border:none}ng-select.wp-inline-create--reference-autocompleter .ng-clear-wrapper{display:none}"],encapsulation:2})},Mo6U:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("mrSG"),s=i("iMRi"),r=i("wZYP"),a=i("r0MM");class c{constructor(e,t,i,n,s){this.injector=e,this.$source=t,this.$loaded=i,this.halInitializer=n,this.$links={},this.$embedded={},this.$halType=s,this.$initialize(t)}static getEmptyResource(e={href:null}){return{_links:{self:e}}}static idFromLink(e){return e.split("/").pop()}get idFromLink(){return this.$href?c.idFromLink(this.$href):""}$initialize(e){this.$source=e.$source||e,this.halInitializer(this)}toString(){return this.$href?`[HalResource href=${this.$href}]`:`[HalResource id=${this.id}]`}get id(){if(this.$source.id)return this.$source.id.toString();const e=this.idFromLink;return e.match(/^\d+$/)?e:null}set id(e){this.$source.id=e}get isNew(){return!this.id||"new"===this.id}get persisted(){return!(!this.id||"new"===this.id)}retainFrom(e){this.__initialized_at=e.__initialized_at}$copy(e={}){return new(0,this.constructor)(this.injector,_.merge(this.$plain(),e),this.$loaded,this.halInitializer,this.$halType)}$plain(){return _.cloneDeep(this.$source)}get $isHal(){return!0}get $link(){return this.$links.self.$link}get name(){return this._name||this.$link.title||""}set name(e){this._name=e}get href(){return this.$link.href}get $href(){return this.$link.href}get state(){return null}push(e){return this.state&&this.state.putValue(e),Promise.resolve()}previewPath(){if(this.isNew&&this.project)return this.project.href}getEditorTypeFor(e){return"constrained"}$load(e=!1){if(!this.state)return this.$loadResource(e);const t=this.state;return e&&t.clear(),t.putFromPromiseIfPristine(()=>this.$loadResource(e)),t.valuesPromise().then(e=>(this.$initialize(e),this.$loaded=!0,this))}$loadResource(e=!1){if(!e){if(this.$loaded)return Promise.resolve(this);if(!this.$loaded&&this.$self)return this.$self}return this.$loaded=!1,this.$self=this.$links.self({}).then(e=>(this.$loaded=!0,this.$initialize(e.$source),this)),this.$self}$update(){return this.$load(!0)}$embeddableKeys(){const e=Object.keys(this.$source);return _.without(e,"_links","_embedded","id")}$linkableKeys(){const e=Object.keys(this.$links);return _.without(e,"self")}}Object(n.c)([Object(a.a)(),Object(n.e)("design:type",s.a)],c.prototype,"states",void 0),Object(n.c)([Object(a.a)(),Object(n.e)("design:type",r.a)],c.prototype,"I18n",void 0)},N5AO:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("fXoL"),s=i("ofXK");function r(e,t){if(1&e&&n.cc(0,"span",2),2&e){const e=n.rc();n.wc("textContent",e.iconTitle)}}class a{constructor(){this.iconTitle=""}}a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=n.Vb({type:a,selectors:[["op-icon"]],hostAttrs:[1,"op-icon--wrapper"],inputs:{iconClasses:["icon-classes","iconClasses"],iconTitle:["icon-title","iconTitle"]},decls:2,vars:3,consts:[["aria-hidden","true",3,"ngClass","title"],["class","hidden-for-sighted",3,"textContent",4,"ngIf"],[1,"hidden-for-sighted",3,"textContent"]],template:function(e,t){1&e&&(n.cc(0,"i",0),n.Tc(1,r,1,1,"span",1)),2&e&&(n.wc("ngClass",t.iconClasses)("title",t.iconTitle),n.Pb(1),n.wc("ngIf",t.iconTitle))},directives:[s.n,s.q],encapsulation:2})},NawS:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("Mo6U"),s=i("ii2/");class r extends n.a{static RELATION_TYPES(e=!0){const t=["relates","duplicates","duplicated","blocks","blocked","precedes","follows","includes","partof","requires","required"];return e&&t.push("parent","children"),t}static LOCALIZED_RELATION_TYPES(e=!0){return r.RELATION_TYPES(e).map(e=>({name:e,label:I18n.t("js.relation_labels."+e)}))}static DEFAULT(){return"relates"}normalizedType(e){return this.denormalized(e).relationType}denormalized(e){const t=this.to.href===e.$href?"from":"to";return{target:this[t],targetId:this[t].id,relationType:"from"===t?this.reverseType:this.type,reverseRelationType:"from"===t?this.type:this.reverseType}}isInvolved(e){return _.values(this.ids).indexOf(e.toString())>=0}get ids(){return{from:s.a.idFromLink(this.from.href),to:s.a.idFromLink(this.to.href)}}updateDescription(e){return this.$links.updateImmediately({description:e})}updateType(e){return this.$links.updateImmediately({type:e})}}},Ndcw:function(e,t,i){"use strict";i.d(t,"a",(function(){return F}));var n=i("fXoL"),s=i("wZYP"),r=i("4EDS"),a=(i("AA01"),i("fbLK")),c=i("F5Dh"),o=i("dMmB"),l=i("ofXK"),d=i("/Rze"),u=i("N5AO"),h=i("3Pt+"),p=i("TAxG"),g=i("ahm3"),f=i("72I8"),b=i("DiYd"),m=i("67Ga"),w=i("SgrZ"),v=i("q/QC"),y=i("OhNT");function k(e,t){if(1&e&&n.cc(0,"option",12),2&e){const e=t.$implicit;n.wc("textContent",e.name)("ngValue",e)}}function C(e,t){if(1&e){const e=n.ic();n.hc(0,"select",10),n.pc("ngModelChange",(function(t){n.Lc(e);return n.rc().filter.operator=t}))("ngModelChange",(function(){n.Lc(e);const t=n.rc();return t.onFilterUpdated(t.filter)})),n.Tc(1,k,1,2,"option",11),n.gc()}if(2&e){const e=n.rc();n.yc("id","operators-",e.filter.id,""),n.yc("name","op[",e.filter.id,"]"),n.wc("ngModel",e.filter.operator)("compareWith",e.compareByHref),n.Pb(1),n.wc("ngForOf",e.availableOperators)}}function j(e,t){if(1&e){const e=n.ic();n.hc(0,"filter-boolean-value",13),n.pc("filterChanged",(function(t){n.Lc(e);return n.rc().onFilterUpdated(t)})),n.gc()}if(2&e){const e=n.rc();n.wc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function P(e,t){if(1&e){const e=n.ic();n.hc(0,"filter-integer-value",13),n.pc("filterChanged",(function(t){n.Lc(e);return n.rc(2).onFilterUpdated(t)})),n.gc()}if(2&e){const e=n.rc(2);n.wc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function x(e,t){if(1&e){const e=n.ic();n.hc(0,"filter-date-value",13),n.pc("filterChanged",(function(t){n.Lc(e);return n.rc(2).onFilterUpdated(t)})),n.gc()}if(2&e){const e=n.rc(2);n.wc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function S(e,t){if(1&e){const e=n.ic();n.hc(0,"filter-dates-value",13),n.pc("filterChanged",(function(t){n.Lc(e);return n.rc(2).onFilterUpdated(t)})),n.gc()}if(2&e){const e=n.rc(2);n.wc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function _(e,t){if(1&e){const e=n.ic();n.hc(0,"filter-date-time-value",13),n.pc("filterChanged",(function(t){n.Lc(e);return n.rc(2).onFilterUpdated(t)})),n.gc()}if(2&e){const e=n.rc(2);n.wc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function O(e,t){if(1&e){const e=n.ic();n.hc(0,"filter-date-times-value",13),n.pc("filterChanged",(function(t){n.Lc(e);return n.rc(2).onFilterUpdated(t)})),n.gc()}if(2&e){const e=n.rc(2);n.wc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function I(e,t){if(1&e){const e=n.ic();n.hc(0,"filter-string-value",13),n.pc("filterChanged",(function(t){n.Lc(e);return n.rc(2).onFilterUpdated(t)})),n.gc()}if(2&e){const e=n.rc(2);n.wc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function T(e,t){if(1&e){const e=n.ic();n.hc(0,"filter-string-value",13),n.pc("filterChanged",(function(t){n.Lc(e);return n.rc(2).onFilterUpdated(t)})),n.gc()}if(2&e){const e=n.rc(2);n.wc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function R(e,t){if(1&e){const e=n.ic();n.hc(0,"filter-toggled-multiselect-value",13),n.pc("filterChanged",(function(t){n.Lc(e);return n.rc(2).onFilterUpdated(t)})),n.gc()}if(2&e){const e=n.rc(2);n.wc("shouldFocus",e.shouldFocus)("filter",e.filter)}}function E(e,t){if(1&e&&(n.fc(0),n.hc(1,"div",14),n.Tc(2,P,1,2,"filter-integer-value",15),n.Tc(3,x,1,2,"filter-date-value",15),n.Tc(4,S,1,2,"filter-dates-value",15),n.Tc(5,_,1,2,"filter-date-time-value",15),n.Tc(6,O,1,2,"filter-date-times-value",15),n.Tc(7,I,1,2,"filter-string-value",15),n.Tc(8,T,1,2,"filter-string-value",15),n.Tc(9,R,1,2,"filter-toggled-multiselect-value",16),n.gc(),n.ec()),2&e){const e=n.rc();n.Pb(1),n.wc("ngSwitch",e.valueType),n.Pb(1),n.wc("ngSwitchCase","[1]Integer"),n.Pb(1),n.wc("ngSwitchCase","[1]Date"),n.Pb(1),n.wc("ngSwitchCase","[2]Date"),n.Pb(1),n.wc("ngSwitchCase","[1]DateTime"),n.Pb(1),n.wc("ngSwitchCase","[2]DateTime"),n.Pb(1),n.wc("ngSwitchCase","[1]String"),n.Pb(1),n.wc("ngSwitchCase","[1]Float")}}function M(e,t){1&e&&n.cc(0,"div",17)}class F{constructor(e,t,i,s){this.wpTableFilters=e,this.schemaCache=t,this.I18n=i,this.bannerService=s,this.shouldFocus=!1,this.filterChanged=new n.s,this.deactivateFilter=new n.s,this.showValuesInput=!1,this.eeShowBanners=!1,this.trackByHref=r.a.halHref,this.compareByHref=r.a.compareByHref,this.text={open_filter:this.I18n.t("js.filter.description.text_open_filter"),close_filter:this.I18n.t("js.filter.description.text_close_filter"),label_filter_add:this.I18n.t("js.work_packages.label_filter_add"),upsale_for_more:this.I18n.t("js.filter.upsale_for_more"),upsale_link:this.I18n.t("js.filter.upsale_link"),button_delete:this.I18n.t("js.button_delete")}}onFilterUpdated(e){this.filter=e,this.showValuesInput=this.showValues(this.filter),this.filterChanged.emit(this.filter)}removeThisFilter(){this.deactivateFilter.emit(this.filter)}get valueType(){if(this.filter.currentSchema&&this.filter.currentSchema.values)return this.filter.currentSchema.values.type}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners,this.availableOperators=this.schemaCache.of(this.filter).availableOperators,this.showValuesInput=this.showValues(this.filter)}showValues(e){return this.filter.currentSchema.isValueRequired()&&"[1]Boolean"!==this.filter.currentSchema.values.type}}F.\u0275fac=function(e){return new(e||F)(n.bc(c.a),n.bc(o.a),n.bc(s.a),n.bc(a.a))},F.\u0275cmp=n.Vb({type:F,selectors:[["","query-filter",""]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged",deactivateFilter:"deactivateFilter"},attrs:["query-filter",""],decls:12,vars:11,consts:[[1,"advanced-filters--filter-name",3,"for","textContent"],[1,"advanced-filters--filter-operator"],[1,"hidden-for-sighted",3,"for"],["required","","class","advanced-filters--select","style","vertical-align: top;",3,"id","name","ngModel","compareWith","ngModelChange",4,"ngIf"],[3,"shouldFocus","filter","filterChanged",4,"ngIf"],[4,"ngIf"],["class","advanced-filters--filter-value",4,"ngIf"],[1,"advanced-filters--remove-filter"],[3,"execute"],["icon-classes","icon-close advanced-filters--remove-filter-icon",3,"icon-title"],["required","",1,"advanced-filters--select",2,"vertical-align","top",3,"id","name","ngModel","compareWith","ngModelChange"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],[3,"textContent","ngValue"],[3,"shouldFocus","filter","filterChanged"],[1,"advanced-filters--filter-value",3,"ngSwitch"],[3,"shouldFocus","filter","filterChanged",4,"ngSwitchCase"],[3,"shouldFocus","filter","filterChanged",4,"ngSwitchDefault"],[1,"advanced-filters--filter-value"]],template:function(e,t){1&e&&(n.fc(0),n.cc(1,"label",0),n.hc(2,"div",1),n.hc(3,"label",2),n.Vc(4),n.gc(),n.Tc(5,C,2,5,"select",3),n.Tc(6,j,1,2,"filter-boolean-value",4),n.gc(),n.Tc(7,E,10,8,"ng-container",5),n.Tc(8,M,1,0,"div",6),n.hc(9,"div",7),n.hc(10,"accessible-by-keyboard",8),n.pc("execute",(function(){return t.removeThisFilter()})),n.cc(11,"op-icon",9),n.gc(),n.gc(),n.ec()),2&e&&(n.Pb(1),n.yc("for","operators-",t.filter.id,""),n.wc("textContent",t.filter.name),n.Qb("title",t.filter.name),n.Pb(2),n.yc("for","operators-",t.filter.id,""),n.Pb(1),n.Yc(" ",t.filter.name," ",t.text.open_filter," "),n.Pb(1),n.wc("ngIf","[1]Boolean"!==t.valueType),n.Pb(1),n.wc("ngIf","[1]Boolean"==t.valueType),n.Pb(1),n.wc("ngIf",t.showValuesInput&&t.valueType),n.Pb(1),n.wc("ngIf",!t.showValuesInput),n.Pb(3),n.wc("icon-title",t.text.button_delete))},directives:[l.q,d.a,u.a,h.y,h.x,h.m,h.p,l.p,h.r,h.B,p.a,l.u,l.v,l.w,g.a,f.a,b.a,m.a,w.a,v.a,y.a],encapsulation:2})},Ng29:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{encodeKey(e){return encodeURIComponent(e)}encodeValue(e){return encodeURIComponent(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}},Nnhs:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{isLocked(){return"locked"===this.status}isOpen(){return"open"===this.status}isClosed(){return"closed"===this.status}}},Nolp:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("mrSG"),s=i("IzEk"),r=i("zOhy"),a=i("uSJ+"),c=i("SKFm"),o=i("r0MM"),l=i("fXoL");class d extends r.a{constructor(){super(...arguments),this.copying=!0}ngOnInit(){super.ngOnInit(),this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed()).subscribe(e=>{e.__initialized_at===this.__initialized_at&&this.wpRelations.addCommonRelation(e.id,"relates",this.copiedWorkPackageId)})}createdWorkPackage(){return this.copiedWorkPackageId=this.stateParams.copiedFromWorkPackageId,new Promise((e,t)=>{this.apiV3Service.work_packages.id(this.copiedWorkPackageId).get().pipe(Object(s.a)(1)).subscribe(i=>{this.createCopyFrom(i).then(e,t)})})}setTitle(){this.titleService.setFirstPart(this.I18n.t("js.work_packages.copy.title"))}createCopyFrom(e){let t=this.halEditing.changeFor(e);return this.wpCreate.copyWorkPackage(t).then(e=>(this.__initialized_at=e.pristineResource.__initialized_at,this.apiV3Service.work_packages.cache.updateWorkPackage(e.pristineResource,!0),this.halEditing.updateValue("new",e),e))}}d.\u0275fac=function(e){return u(e||d)},d.\u0275dir=l.Wb({type:d,features:[l.Mb]}),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",a.a)],d.prototype,"wpRelations",void 0),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",c.a)],d.prototype,"halEditing",void 0);const u=l.jc(d)},Nvnm:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("4rda");class s extends n.a{get value(){return this.schema?this.resource[this.name]||0:null}get percentLabel(){return this.roundedProgress+"%"}get roundedProgress(){return Math.round(Number(this.value))||0}render(e,t){e.setAttribute("title",t),e.innerHTML=`\n      <span>\n        <span style="width: 80px" class="progress-bar">\n          <span style="width: ${this.roundedProgress}%" class="inner-progress closed"></span>\n          <span style="width: 0%" class="inner-progress done"></span>\n        </span>\n        <span class="progress-bar-legend">${this.percentLabel}</span>\n      </span>\n    `}}},ODu2:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("4zHP"),s=i("4EDS"),r=i("fXoL"),a=i("ofXK"),c=i("vd15"),o=i("Tcty"),l=i("/Rze");function d(e,t){if(1&e){const e=r.ic();r.hc(0,"accessible-by-keyboard",11),r.pc("execute",(function(){r.Lc(e);return r.rc(5).toggleComments()})),r.cc(1,"span",12),r.gc()}if(2&e){const e=r.rc(5);r.wc("linkAriaLabel",e.togglerText),r.Pb(1),r.wc("textContent",e.togglerText)}}const u=function(e){return{"-with-toggler":e}};function h(e,t){if(1&e&&(r.hc(0,"h3",8),r.cc(1,"span",9),r.Tc(2,d,2,2,"accessible-by-keyboard",10),r.gc()),2&e){const e=r.rc(),t=e.first,i=e.$implicit,n=r.rc(3);r.wc("ngClass",r.Bc(3,u,t&&n.showToggler)),r.Pb(1),r.wc("textContent",i.date),r.Pb(1),r.wc("ngIf",t&&n.showToggler)}}function p(e,t){if(1&e&&(r.hc(0,"div",5),r.Tc(1,h,3,5,"h3",6),r.cc(2,"activity-entry",7),r.gc()),2&e){const e=t.$implicit,i=t.first,n=r.rc(3);r.Pb(1),r.wc("ngIf",i||e.isNextDate),r.Pb(1),r.wc("workPackage",n.workPackage)("activity",e.activity)("activityNo",e.number(e.isReversed))("isInitial",e.isInitial())}}function g(e,t){if(1&e&&(r.hc(0,"div",2),r.hc(1,"div",3),r.Tc(2,p,3,5,"div",4),r.gc(),r.gc()),2&e){const e=r.rc(2);r.Pb(2),r.wc("ngForOf",e.visibleActivities)("ngForTrackBy",e.trackByHref)}}function f(e,t){if(1&e&&(r.hc(0,"work-package-comment",1),r.Tc(1,g,3,2,"ng-template"),r.gc()),2&e){const e=r.rc();r.wc("workPackage",e.workPackage)}}class b extends n.a{constructor(){super(...arguments),this.tabName=this.I18n.t("js.work_packages.tabs.activity"),this.trackByHref=s.a.trackByHrefAndProperty("version")}ngOnInit(){this.workPackageId=this.$transition.params("to").workPackageId,super.ngOnInit()}}b.\u0275fac=function(e){return m(e||b)},b.\u0275cmp=r.Vb({type:b,selectors:[["wp-activity-tab"]],features:[r.Mb],decls:1,vars:1,consts:[[3,"workPackage",4,"ngIf"],[3,"workPackage"],[1,"detail-activity"],[1,"work-package-details-activities-list"],["class","work-package-details-activities-activity",4,"ngFor","ngForOf","ngForTrackBy"],[1,"work-package-details-activities-activity"],["class","activity-date",3,"ngClass",4,"ngIf"],[3,"workPackage","activity","activityNo","isInitial"],[1,"activity-date",3,"ngClass"],[1,"activity-date--label",3,"textContent"],["linkClass","activity-comments--toggler button -small -transparent -with-icon icon-filter icon-small hide-when-print",3,"linkAriaLabel","execute",4,"ngIf"],["linkClass","activity-comments--toggler button -small -transparent -with-icon icon-filter icon-small hide-when-print",3,"linkAriaLabel","execute"],[3,"textContent"]],template:function(e,t){1&e&&r.Tc(0,f,2,1,"work-package-comment",0),2&e&&r.wc("ngIf",t.workPackage)},directives:[a.q,c.a,a.p,o.a,a.n,l.a],encapsulation:2});const m=r.jc(b)},ONn1:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("JY8V"),s=i("wyKs"),r=i("E2tj"),a=i("kTsZ"),c=i("uSJ+"),o=i("qc15"),l=i("dMmB"),d=i("CNq7"),u=i("fXoL");class h{constructor(e,t,i,n,s,r,a,c){this.querySpace=e,this.wpTableHierarchies=t,this.wpTableColumns=i,this.notificationService=n,this.halResourceService=s,this.apiV3Service=r,this.schemaCache=a,this.wpRelations=c}initialize(e,t){const i=t.elements;Promise.all([this.requireInvolvedRelations(i.map(e=>e.id)),this.requireHierarchyElements(i),this.requireSumsSchema(t)]).then(e=>{this.loadAdditional(_.flatten(e))})}loadAdditional(e){this.apiV3Service.work_packages.requireAll(e).then(()=>{this.querySpace.additionalRequiredWorkPackages.putValue(null,"All required work packages are loaded")}).catch(e=>{this.querySpace.additionalRequiredWorkPackages.putValue(null,"Failure loading required work packages"),this.notificationService.handleRawError(e)})}requireInvolvedRelations(e){return this.wpTableColumns.hasRelationColumns()?this.wpRelations.requireAll(e).then(()=>{const t=this.getInvolvedWorkPackages(e.map(e=>this.wpRelations.state(e).value));return _.flatten(t)}):Promise.resolve([])}requireHierarchyElements(e){if(!this.wpTableHierarchies.isEnabled)return Promise.resolve([]);const t=_.flatten(e.map(e=>e.ancestorIds));return Promise.resolve(t)}getInvolvedWorkPackages(e){const t=[];return _.each(e,e=>{_.each(e,e=>{t.push(e.ids.from,e.ids.to)})}),t}requireSumsSchema(e){return e.sumsSchema?this.schemaCache.ensureLoaded(e.sumsSchema.$href).then(()=>[]):Promise.resolve([])}}h.\u0275fac=function(e){return new(e||h)(u.lc(r.a),u.lc(s.a),u.lc(n.a),u.lc(o.a),u.lc(a.a),u.lc(d.a),u.lc(l.a),u.lc(c.a))},h.\u0275prov=u.Xb({token:h,factory:h.\u0275fac})},OW6k:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("PTRy");class s{constructor(e,t){this.down=!1,this.elements=e,this.scrollWhenOutside=t.scrollWhenOutside||!1,this.maxSpeed=t.maxSpeed||5,this.margin=t.margin||10,this.scrollWhenOutside=t.scrollWhenOutside||!1,this.autoScroll=t.autoScroll,this.point={},this.pointCB=Object(n.createPointCB)(this.point),this.init()}init(){jQuery(window).on("mousemove.domautoscroll touchmove.domautoscroll",e=>{this.down&&(this.pointCB(e),this.onMove(e))}),jQuery(window).on("mousedown.domautoscroll touchstart.domautoscroll",()=>this.down=!0),jQuery(window).on("mouseup.domautoscroll touchend.domautoscroll",()=>this.onUp()),jQuery(window).on("scroll.domautoscroll",e=>this.setScroll(e))}destroy(){jQuery(window).off(".domautoscroll"),this.elements=[],this.cleanAnimation()}add(e){Array.isArray(e)?(this.elements=this.elements.concat(e),this.elements=Array.from(new Set(this.elements))):this.elements.push(e)}onUp(){this.down=!1,cancelAnimationFrame(this.animationFrame),cancelAnimationFrame(this.windowAnimationFrame)}setScroll(e){for(let t=0;t<this.elements.length;t++)if(this.elements[t]===e.target){this.scrolling=!0;break}this.scrolling&&requestAnimationFrame(()=>this.scrolling=!1)}cleanAnimation(){cancelAnimationFrame(this.animationFrame),cancelAnimationFrame(this.windowAnimationFrame)}getTarget(e){if(!e)return[];let t=[];this.elements.includes(e)&&t.push(e);let i=e;for(;i=i.parentNode;)this.elements.includes(i)&&t.push(i);return t}getElementsUnderPoint(){let e=[];for(var t=0;t<this.elements.length;t++)this.inside(this.point,this.elements[t])&&e.push(this.elements[t]);return e}onMove(e){if(!this.autoScroll())return;if(e.dispatched)return;let t=[];null!==e.target&&t.push(e.target);let i=document.body;t.length>0&&t[0].parentNode===i?t=this.getElementsUnderPoint():(t=this.getTarget(t[0]),0===t.length&&(t=this.getElementsUnderPoint())),this.current=t,0===this.current.length&&(this.current=[this.outerScrollContainer]),cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(this.scrollTick.bind(this))}setOuterScrollContainer(e){this.outerScrollContainer=e}scrollTick(){0!==this.current.length&&(this.current.forEach(e=>{e&&this.scrollAutomatically(e)}),cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(this.scrollTick.bind(this)))}scrollAutomatically(e){let t,i,s=Object(n.getClientRect)(e);t=this.point.x<s.left+this.margin?-this.maxSpeed:this.point.x>s.right-this.margin?this.maxSpeed:0,i=this.point.y<s.top+this.margin?-this.maxSpeed:this.point.y>s.bottom-this.margin?this.maxSpeed:0,setTimeout(()=>{i&&this.scrollY(e,i),t&&this.scrollX(e,t)})}scrollY(e,t){e===window?window.scrollTo(e.pageXOffset,e.pageYOffset+t):e.scrollTop+=t}scrollX(e,t){e===window?window.scrollTo(e.pageXOffset+t,e.pageYOffset):e.scrollLeft+=t}inside(e,t,i){return i?e.y>i.top&&e.y<i.bottom&&e.x>i.left&&e.x<i.right:Object(n.pointInside)(e,t)}}},OhNT:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));i("AA01");var n=i("fXoL"),s=i("wZYP"),r=i("4EDS"),a=i("kTsZ"),c=i("iHm1"),o=i("Jui0"),l=i("CNq7"),d=i("vK8y"),u=i("ZOsW"),h=i("3Pt+"),p=i("ofXK");const g=["ngSelectInstance"],f=function(e){return{"-required-highlighting":e}};class b{constructor(e,t,i,s,a,c,o){this.halResourceService=e,this.halSorting=t,this.PathHelper=i,this.apiV3Service=s,this.currentUser=a,this.cdRef=c,this.I18n=o,this.shouldFocus=!1,this.filterChanged=new n.s,this._availableOptions=[],this.compareByHrefOrString=r.a.compareByHrefOrString,this.text={placeholder:this.I18n.t("js.placeholders.selection")}}ngOnInit(){this.fetchAllowedValues()}ngAfterViewInit(){this.ngSelectInstance&&this.shouldFocus&&this.ngSelectInstance.focus()}get value(){return this.filter.values}setValues(e){this.filter.values=_.castArray(e),this.filterChanged.emit(this.filter),this.cdRef.detectChanges()}get availableOptions(){return this._availableOptions}set availableOptions(e){this._availableOptions=this.halSorting.sort(e)}get isEmpty(){return this._isEmpty=0===this.value.length}repositionDropdown(){this.ngSelectInstance&&setTimeout(()=>{const e=this.ngSelectInstance;e&&e.dropdownPanel&&e.dropdownPanel._updatePosition()},25)}get isUserResource(){let e=_.get(this.filter.currentSchema,"values.type",null);return e&&e.indexOf("User")>0}fetchAllowedValues(){this.filter.currentSchema.values.allowedValues.$load?this.loadAllowedValues():this.availableOptions=this.filter.currentSchema.values.allowedValues}loadAllowedValues(){let e=[this.filter.currentSchema.values.allowedValues.$load()];this.isUserResource&&e.push(this.apiV3Service.root.get().toPromise()),Promise.all(e).then(e=>{let t=e[0].elements;this.availableOptions=t,this.isUserResource&&"memberOfGroup"!==this.filter.filter.id&&this.addMeValue(e[1].user)})}addMeValue(e){if(!e||!e.$href)return;let t=this.halResourceService.createHalResource({_links:{self:{href:this.apiV3Service.users.me,title:this.I18n.t("js.label_me")}}},!0);this._availableOptions.unshift(t)}}b.\u0275fac=function(e){return new(e||b)(n.bc(a.a),n.bc(c.a),n.bc(o.a),n.bc(l.a),n.bc(d.a),n.bc(n.i),n.bc(s.a))},b.\u0275cmp=n.Vb({type:b,selectors:[["filter-toggled-multiselect-value"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(g,!0),2&e)&&(n.Ic(i=n.qc())&&(t.ngSelectInstance=i.first))},inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},decls:3,vars:14,consts:[[1,"inline-label","ng-select-container",3,"id"],["appendTo","body","bindLabel","name",1,"advanced-filters--ng-select","-multi-select",3,"ngModel","compareWith","clearSearchOnAdd","placeholder","ngClass","id","items","multiple","closeOnSelect","hideSelected","virtualScroll","change","add","remove","open"],["ngSelectInstance",""]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"ng-select",1,2),n.pc("change",(function(e){return t.setValues(e)}))("add",(function(){return t.repositionDropdown()}))("remove",(function(){return t.repositionDropdown()}))("open",(function(){return t.repositionDropdown()})),n.gc(),n.gc()),2&e&&(n.yc("id","div-values-",t.filter.id,""),n.Pb(1),n.wc("ngModel",t.filter.values)("compareWith",t.compareByHrefOrString)("clearSearchOnAdd",!0)("placeholder",t.text.placeholder)("ngClass",n.Bc(12,f,t.isEmpty))("id","values-"+t.filter.id)("items",t.availableOptions)("multiple",!0)("closeOnSelect",!1)("hideSelected",!0)("virtualScroll",!0))},directives:[u.a,h.m,h.p,p.n],encapsulation:2,changeDetection:0})},P7xQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("mrSG"),s=i("iB+3"),r=i("13ri"),a=i("Kg8T"),c=i("Jui0"),o=(i("ii2/"),i("g1AQ")),l=i("UUNb"),d=i("PUHT"),u=i("4lR/"),h=i("TM9v"),p=i("IaZ+");class g{constructor(e,t,i){this.workPackage=e,this.PathHelper=t,this.$state=i,this.project=e.project}get allActions(){return{workPackage:this.workPackage,project:this.project}}copyLink(){return 0===this.$state.current.name.indexOf("work-packages.partitioned.list.details")?this.PathHelper.workPackageDetailsCopyPath(this.project.identifier,this.workPackage.id):this.PathHelper.workPackageCopyPath(this.workPackage.id)}linkForAction(e){return"copy"===e.key?e.link=this.copyLink():e.link=this.allActions[e.resource][e.link].href,e}isPermitted(e){return void 0!==this.allActions[e.resource]&&void 0!==this.allActions[e.resource][e.link]}permittedActionKeys(e){var t=_.filter(e,e=>this.isPermitted(e));return _.map(t,(function(e){return e.key}))}permittedActionsWithLinks(e){var t=_.filter(_.cloneDeep(e),e=>this.isPermitted(e));return _.map(t,e=>this.linkForAction(e))}}var f=i("r0MM"),b=i("xQCb"),m=i("fXoL");class w extends d.a{constructor(e,t,i,n,s,r,a,c){super(s,a),this.HookService=e,this.$state=t,this.injector=i,this.PathHelper=n,this.elementRef=s,this.opModalService=r,this.opContextMenuService=a,this.authorisationService=c}open(e){this.workPackage.project.$load().then(()=>{this.authorisationService.initModelAuth("work_package",this.workPackage.$links);var t=new g(this.workPackage,this.PathHelper,this.$state);const i=this.getPermittedActions(t);this.buildItems(i),this.opContextMenu.show(this,e)})}triggerContextMenuAction(e,t){const i=e.link;switch(t){case"copy":this.$state.go("work-packages.copy",{copiedFromWorkPackageId:this.workPackage.id});break;case"delete":this.opModalService.show(l.a,this.injector,{workPackages:[this.workPackage]});break;case"log_time":this.timeEntryCreateService.create(moment(new Date),this.workPackage,!1).catch(()=>{});break;default:window.location.href=i}}positionArgs(e){let t=super.positionArgs(e);return _.assign(t,{my:"right top",at:"right bottom"}),t}getPermittedActions(e){let t=e.permittedActionsWithLinks(h.a);return _.each(this.getPermittedPluginActions(e),e=>{let i=e.indexBy?e.indexBy(t):t.length;t.splice(i,0,e)}),t}getPermittedPluginActions(e){let t=this.HookService.call("workPackageSingleContextMenu");return e.permittedActionsWithLinks(t)}buildItems(e){const t=this.workPackage.configureForm;return this.items=e.map(e=>{const t=e.key;return{disabled:!1,linkText:I18n.t("js.button_"+t),href:e.link,icon:e.icon||"icon-"+t,onClick:i=>(!e.link||!r.a.isClickedWithModifier(i))&&(this.triggerContextMenuAction(e,t),!0)}}),t&&this.items.push({href:t.href,icon:"icon-settings3",linkText:I18n.t("js.button_configure-form"),onClick:()=>!1}),this.items}}w.\u0275fac=function(e){return new(e||w)(m.bc(o.a),m.bc(s.StateService),m.bc(m.A),m.bc(c.a),m.bc(m.q),m.bc(p.b),m.bc(u.a),m.bc(a.a))},w.\u0275dir=m.Wb({type:w,selectors:[["","wpSingleContextMenu",""]],inputs:{workPackage:["wpSingleContextMenu-workPackage","workPackage"]},features:[m.Mb]}),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",b.a)],w.prototype,"timeEntryCreateService",void 0)},PBJw:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("wd/R"),s=i("zwY0"),r=i.n(s),a=i("wZYP");class c{constructor(e,t,i,n,s){this.datepickerElemIdentifier=e,this.date=t,this.options=i,this.datepickerTarget=n,this.configurationService=s,this.datepickerFormat="Y-m-d",this.datepickerCont=document.querySelector(this.datepickerElemIdentifier),this.hideDuringScroll=e=>{e.target.classList.contains("flatpickr-monthDropdown-months")||(this.datepickerInstance.close(),this.reshowTimeout&&clearTimeout(this.reshowTimeout),this.reshowTimeout=setTimeout(()=>{this.visibleAndActive()&&this.datepickerInstance.open()},50))},this.initialize(i)}initialize(e){var t;const i=new a.a,s=(null===(t=this.configurationService)||void 0===t?void 0:t.startOfWeekPresent())?this.configurationService.startOfWeek():1,c=_.extend({},e,{weekNumbers:!0,getWeek:e=>n(e).week(),dateFormat:this.datepickerFormat,defaultDate:this.date,locale:{weekdays:{shorthand:i.t("date.abbr_day_names"),longhand:i.t("date.day_names")},months:{shorthand:i.t("date.abbr_month_names").slice(1),longhand:i.t("date.month_names").slice(1)},firstDayOfWeek:s,weekAbbreviation:i.t("date.abbr_week")}});var o;o=this.datepickerTarget?r()(this.datepickerTarget,c):r()(this.datepickerElemIdentifier,c),this.datepickerInstance=Array.isArray(o)?o[0]:o,document.addEventListener("scroll",this.hideDuringScroll,!0)}clear(){this.datepickerInstance.clear()}destroy(){this.hide(),this.datepickerInstance.destroy()}hide(){this.isOpen&&this.datepickerInstance.close(),document.removeEventListener("scroll",this.hideDuringScroll,!0)}show(){this.datepickerInstance.open(),document.addEventListener("scroll",this.hideDuringScroll,!0)}setDates(e){this.datepickerInstance.setDate(e)}get isOpen(){return this.datepickerInstance.isOpen}visibleAndActive(){try{return this.isInViewport(this.datepickerCont)&&document.activeElement===this.datepickerCont}catch(e){return console.error("Failed to test visibleAndActive "+e),!1}}isInViewport(e){const t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}}},PHo6:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("mrSG"),s=i("Mo6U"),r=i("r0MM"),a=i("kTsZ");class c extends s.a{get height(){return this.endRow-this.startRow}get width(){return this.endColumn-this.startColumn}get schema(){return this.halResource.createHalResource({_type:"Schema"},!0)}}Object(n.c)([Object(r.a)(),Object(n.e)("design:type",a.a)],c.prototype,"halResource",void 0)},POAS:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("mrSG"),s=i("XZsv"),r=i("iB+3"),a=i("kTsZ"),c=i("Y0Nk"),o=i("d/TE"),l=i("wZYP"),d=i("tk/3"),u=i("Mo6U"),h=i("r0MM"),p=i("dMmB"),g=i("fXoL");class f{constructor(e){this.injector=e}showSave(e,t=!1){let i={message:this.I18n.t("js.notice_successful_"+(t?"create":"update"))};this.NotificationsService.addSuccess(i)}handleRawError(e,t){if(console.error("Handling error message %O for work package %O",e,t),e instanceof s.a)return this.handleErrorResponse(e,t);const i=this.retrieveError(e);if(i instanceof u.a)return this.handleErrorResponse(i,t);"string"!=typeof e?e instanceof Error?this.NotificationsService.addError(e.message):this.showGeneralError(i||e):this.NotificationsService.addError(e)}retrieveErrorMessage(e){const t=this.retrieveError(e);return t instanceof s.a?t.message:"string"==typeof t?t:this.I18n.t("js.error.internal")}retrieveError(e){let t=e;return e instanceof d.d&&(t=e.message||e.error),"Error"===_.get(e,"data._type")&&(t=e.data),t&&"Error"===t._type?this.halResourceService.createHalResourceOfClass(s.a,t):t}handleErrorResponse(e,t){return e instanceof s.a?t?this.showError(e,t):void this.showApiErrorMessages(e):this.showGeneralError(e)}showError(e,t){this.showCustomError(e,t)||this.showApiErrorMessages(e)}showGeneralError(e){let t=this.I18n.t("js.error.internal");("string"==typeof e||_.has(e,"toString"))&&(t+=" "+e.toString()),this.NotificationsService.addError(t)}showEditingBlockedError(e){this.NotificationsService.addError(this.I18n.t("js.hal.error.edit_prohibited",{attribute:e}))}showCustomError(e,t){if("urn:openproject-org:api:v3:errors:PropertyFormatError"===e.errorIdentifier){let i=this.schemaCache.of(t).ofProperty(e.details.attribute),n=i.name,s="js.hal.error.format."+i.type.toLowerCase();return void 0!==this.I18n.lookup(s)&&(this.NotificationsService.addError(this.I18n.t(s,{attribute:n})),!0)}return!1}showApiErrorMessages(e){let t=e.errorMessages;return t.length>1?this.NotificationsService.addError("",t):this.NotificationsService.addError(t[0]),!0}}f.\u0275fac=function(e){return new(e||f)(g.lc(g.A))},f.\u0275prov=g.Xb({token:f,factory:f.\u0275fac}),Object(n.c)([Object(h.a)(),Object(n.e)("design:type",l.a)],f.prototype,"I18n",void 0),Object(n.c)([Object(h.a)(),Object(n.e)("design:type",r.StateService)],f.prototype,"$state",void 0),Object(n.c)([Object(h.a)(),Object(n.e)("design:type",a.a)],f.prototype,"halResourceService",void 0),Object(n.c)([Object(h.a)(),Object(n.e)("design:type",o.a)],f.prototype,"NotificationsService",void 0),Object(n.c)([Object(h.a)(),Object(n.e)("design:type",c.a)],f.prototype,"loadingIndicator",void 0),Object(n.c)([Object(h.a)(),Object(n.e)("design:type",p.a)],f.prototype,"schemaCache",void 0)},PUHT:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("4lR/"),s=i("9+6k"),r=i("fXoL");class a extends s.a{constructor(e,t){super(t),this.elementRef=e,this.opContextMenu=t,this.items=[]}ngAfterViewInit(){this.$element=jQuery(this.elementRef.nativeElement),this.$element.on("click",e=>(e.preventDefault(),e.stopPropagation(),this.opContextMenu.isActive(this)?(this.opContextMenu.close(),!1):(this.open(e),!1))),Mousetrap(this.$element[0]).bind("shift+alt+f10",e=>{this.open(e)})}positionArgs(e){return{my:"left top",at:"left bottom",of:this.$element,collision:"flipfit"}}}a.\u0275fac=function(e){return new(e||a)(r.bc(r.q),r.bc(n.a))},a.\u0275dir=r.Wb({type:a,selectors:[["","opContextMenuTrigger",""]],features:[r.Mb]})},PZVJ:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return c})),function(e){e.lazy=function(e,t,i,n){if(_.isObject(e)){let s,r=!1,a={get:()=>(r||(s=i(),r=!0),s),set:()=>{},configurable:!0,enumerable:!0};n&&(a.set=e=>{s=n(e),r=!0}),Object.defineProperty(e,t,a)}}}(n||(n={}));var s=i("BtrP"),r=i("NAZG");function a(e){return _.isNil(e)?[]:e.map(e=>e.$copy())}function c(e,t){function i(t,i=!0){return _.isNil(t)?t:t._links||t._embedded||t._type?e.createHalResource(t,i):t}function a(e,i){const s="$"+e,r="_"+e,a=t.$source[r];_.isObject(a)&&Object.keys(a).forEach(e=>{n.lazy(t[s],e,()=>i(a[e]))})}function c(e,i){const n=Array.isArray(e);if(e)if(n)t.$source._links[i]=e.map(e=>({href:e.href}));else if(e.hasOwnProperty("$link")){const n=e.$link;n.href&&(t.$source._links[i]=n)}else"href"in e&&(t.$source._links[i]={href:e.href});else t.$source._links[i]={href:null};return t.$embedded&&t.$embedded[i]&&(t.$embedded[i]=e,t.$source._embedded[i]=n?e.map(e=>e.$source):_.get(e,"$source",e)),e}!function(){t.$source._links||(t.$source._links={});t.$source._links.self||(t.$source._links.self={href:null})}(),a("links",t=>Array.isArray(t)?t.map(t=>s.a.fromObject(e,t).$callable()):s.a.fromObject(e,t).$callable()),a("embedded",e=>Array.isArray(e)?e.map(e=>i(e,!0)):(_.isObject(e)&&_.each(e,(t,s)=>{t&&(t._embedded||t._links)&&n.lazy(e,s,()=>i(t,!0))}),i(e,!0))),t.$embeddableKeys().forEach(e=>{Object.defineProperty(t,e,{get:()=>i(t.$source[e],!0),set(i){t.$source[e]=i},enumerable:!0,configurable:!0})}),t.$linkableKeys().forEach(i=>{n.lazy(t,i,()=>{const n=t.$links[i].$link||t.$links[i];if(Array.isArray(n)){var a=n.map(n=>e.createLinkedResource(t,i,n.$link)),c=new r(...a).on("change",()=>{c.forEach(e=>{e.$link||c.splice(c.indexOf(e),1)}),t.$source._links[i]=c.map(e=>e.$link)});return c}return n.href?"get"!==n.method?s.a.fromObject(e,n).$callable():e.createLinkedResource(t,i,n):null},e=>c(e,i))}),function(){if(!t.$source._embedded)return;Object.keys(t.$source._embedded).forEach(e=>{n.lazy(t,e,()=>t.$embedded[e],t=>c(t,e))})}()}},PkGb:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("iB+3"),s=i("jtHE"),r=i("fXoL");class a{constructor(e,t){this.$state=e,this.$transitions=t,this.currentTab="overview",this.subject=new s.a(1),this.updateTabs(),t.onSuccess({},e=>{this.updateTabs(e.to().name)})}get observable(){return this.subject}get lastActiveTab(){return this.isCurrentState("show")?this.currentShowTab:this.currentDetailsTab}get currentShowState(){return"work-packages.show."+this.currentShowTab}get currentDetailsState(){return"work-packages.partitioned.list.details."+this.currentDetailsTab}get currentDetailsSubState(){return".details."+this.currentDetailsTab}isDetailsState(e){return!!e&&e.includes(".details")}get currentShowTab(){return"overview"===this.currentTab?"activity":this.currentTab}get currentDetailsTab(){return this.currentTab}notify(){this.subject.next({active:this.lastActiveTab,show:this.currentShowState,details:this.currentDetailsState})}updateTab(e){if(this.isCurrentState(e)){const e=this.$state.current.name;this.currentTab=e.split(".").pop(),this.notify()}}isCurrentState(e){return"show"===e?this.$state.includes("work-packages.show.*"):"details"===e&&this.$state.includes("**.details.*")}updateTabs(e){if("work-packages.show.activity"===e)return this.currentTab="overview",this.notify();this.updateTab("show"),this.updateTab("details")}}a.\u0275fac=function(e){return new(e||a)(r.lc(n.StateService),r.lc(n.TransitionService))},a.\u0275prov=r.Xb({token:a,factory:a.\u0275fac,providedIn:"root"})},PtkW:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("E2tj"),s=i("FnNU"),r=i("zqrF"),a=i("4jc8"),c=i("fXoL");class o extends r.a{constructor(e){super(e),this.querySpace=e,this.appliedZoomLevel$=Object(s.g)("auto")}valueFromQuery(e){return Object.assign(Object.assign({},this.defaultState),{visible:e.timelineVisible,zoomLevel:e.timelineZoomLevel,labels:e.timelineLabels})}set appliedZoomLevel(e){this.appliedZoomLevel$.putValue(e)}get appliedZoomLevel(){return this.appliedZoomLevel$.value}hasChanged(e){const t=this.isVisible!==e.timelineVisible,i=this.zoomLevel!==e.timelineZoomLevel,n=!_.isEqual(this.current.labels,e.timelineLabels);return t||i||n}applyToQuery(e){return e.timelineVisible=this.isVisible,e.timelineZoomLevel=this.zoomLevel,e.timelineLabels=this.current.labels,!1}toggle(){let e=this.current;this.setVisible(!e.visible)}setVisible(e){this.updatesState.putValue(Object.assign(Object.assign({},this.current),{visible:e}))}get isVisible(){return this.current.visible}get zoomLevel(){return this.current.zoomLevel}get labels(){return _.isEmpty(this.current.labels)?this.defaultLabels:this.current.labels}updateLabels(e){this.modify({labels:e})}getNormalizedLabels(e){let t=this.defaultLabels;return _.each(this.current.labels,(e,i)=>{const n=i;t[n]=""===e?null:e}),t}setZoomLevel(e){this.modify({zoomLevel:e})}updateZoomWithDelta(e){let t=this.current.zoomLevel;if("auto"!==t)return this.applyZoomLevel(t,e);const i=this.appliedZoomLevel;if(i&&"auto"!==i)this.applyZoomLevel(i,e);else{const t=e<0?"days":"years";this.setZoomLevel(t)}}isAutoZoom(){return"auto"===this.current.zoomLevel}enableAutozoom(){this.modify({zoomLevel:"auto"})}get current(){return this.lastUpdatedState.getValueOr(this.defaultState)}modify(e){this.update(Object.assign(Object.assign({},this.current),e))}applyZoomLevel(e,t){let i=a.n.indexOf(e);i+=t,i>=0&&i<a.n.length&&this.setZoomLevel(a.n[i])}get defaultLabels(){return{left:"",right:"",farRight:"subject"}}get defaultState(){return{zoomLevel:"auto",visible:!1,labels:this.defaultLabels}}}o.\u0275fac=function(e){return new(e||o)(c.lc(n.a))},o.\u0275prov=c.Xb({token:o,factory:o.\u0275fac})},PvNn:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{toHsl(e){return`hsl(${this.valueHash(e)}, 50%, 50%)`}toHsla(e,t){return`hsla(${this.valueHash(e)}, 50%, 50%, ${t}%)`}valueHash(e){let t=0;for(let i=0;i<e.length;i++)t=e.charCodeAt(i)+((t<<5)-t);return t%360}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac,providedIn:"root"})},"PwL/":function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n=i("iB+3"),s=i("Y/CA"),r=i("iMRi"),a=i("oqKi"),c=i("PkGb"),o=i("eyhC"),l=i("rOco"),d=i("POAS"),u=i("qc15"),h=i("pQre"),p=i("fXoL"),g=i("ofXK"),f=i("0loS"),b=i("S2zE"),m=i("/Rze"),w=i("f24R"),v=i("9pt+"),y=i("oUDv"),k=i("2orT"),C=i("711n"),j=i("ZAVI"),P=i("DLfB"),x=i("m3nR");function S(e,t){if(1&e&&(p.hc(0,"li",17),p.cc(1,"a",5),p.cc(2,"wp-watchers-count",8),p.gc()),2&e){const e=p.rc(2);p.Pb(1),p.wc("textContent",e.text.tabs.watchers),p.Pb(1),p.wc("wpId",e.workPackage.id)}}function _(e,t){if(1&e&&p.cc(0,"back-button",26),2&e){const e=p.rc(3);p.wc("customBackMethod",e.backToList.bind(e))}}function O(e,t){if(1&e&&(p.hc(0,"div",18),p.cc(1,"span",19),p.cc(2,"wp-breadcrumb",20),p.hc(3,"edit-form",21),p.hc(4,"div",22),p.Tc(5,_,1,1,"back-button",23),p.hc(6,"div",24),p.cc(7,"wp-subject"),p.gc(),p.gc(),p.cc(8,"div",25),p.gc(),p.gc()),2&e){const e=p.rc(2);p.Pb(1),p.wc("textContent",e.focusAnchorLabel),p.Pb(1),p.wc("workPackage",e.workPackage),p.Pb(1),p.wc("resource",e.workPackage),p.Pb(2),p.wc("ngIf",e.showBackButton())}}function I(e,t){if(1&e&&(p.hc(0,"div",27),p.cc(1,"wp-details-toolbar",20),p.gc()),2&e){const e=p.rc(2);p.Pb(1),p.wc("workPackage",e.workPackage)}}function T(e,t){if(1&e){const e=p.ic();p.hc(0,"div",1),p.hc(1,"div",2),p.hc(2,"ul",3),p.hc(3,"li",4),p.cc(4,"a",5),p.gc(),p.hc(5,"li",6),p.cc(6,"a",5),p.gc(),p.hc(7,"li",7),p.cc(8,"a",5),p.cc(9,"wp-relations-count",8),p.gc(),p.Tc(10,S,3,2,"li",9),p.hc(11,"li",10),p.hc(12,"accessible-by-keyboard",11),p.pc("execute",(function(){p.Lc(e);return p.rc().switchToFullscreen()})),p.gc(),p.gc(),p.hc(13,"li",10),p.hc(14,"accessible-by-keyboard",12),p.pc("execute",(function(){p.Lc(e);return p.rc().close()})),p.gc(),p.gc(),p.gc(),p.gc(),p.Tc(15,O,9,4,"div",13),p.Tc(16,I,2,1,"div",14),p.hc(17,"div",15),p.cc(18,"wp-resizer",16),p.gc(),p.gc()}if(2&e){const e=p.rc();p.Pb(4),p.wc("textContent",e.text.tabs.overview),p.Pb(2),p.wc("textContent",e.text.tabs.activity),p.Pb(2),p.wc("textContent",e.text.tabs.relations),p.Pb(1),p.wc("wpId",e.workPackage.id),p.Pb(1),p.wc("ngIf",e.canViewWorkPackageWatchers()),p.Pb(2),p.wc("linkAriaLabel",e.text.goTofullScreen)("linkTitle",e.text.goTofullScreen),p.Pb(2),p.wc("linkAriaLabel",e.text.closeDetailsView)("linkTitle",e.text.closeDetailsView),p.Pb(1),p.wc("ngIf",e.workPackage),p.Pb(1),p.wc("ngIf",e.workPackage),p.Pb(2),p.wc("elementClass","work-packages-partitioned-page--content-right")("localStorageKey","openProject-splitViewFlexBasis")}}class R extends l.a{constructor(e,t,i,n,s,r,a,c){super(e,a.params.workPackageId),this.injector=e,this.states=t,this.firstRoute=i,this.keepTab=n,this.wpTableSelection=s,this.wpTableFocus=r,this.$state=a,this.backRouting=c,this.baseRoute=this.$state.current.data.baseRoute}ngOnInit(){this.observeWorkPackage();let e=this.$state.params.workPackageId;if(this.wpTableFocus.focusedWorkPackage)this.wpTableFocus.updateFocus(e,!1);else{const t=this.firstRoute.name===this.baseRoute+".details.overview",i=this.firstRoute.params&&e===this.firstRoute.params.workPackageI;this.wpTableFocus.updateFocus(e,t&&i)}this.wpTableSelection.isEmpty&&this.wpTableSelection.setRowState(e,!0),this.wpTableFocus.whenChanged().pipe(this.untilDestroyed()).subscribe(t=>{!(e.toString()===t.toString())&&this.$state.includes(this.baseRoute+".details")&&this.$state.go(this.$state.current.name,{workPackageId:t,focus:!1})})}close(){this.$state.go(this.baseRoute,this.$state.params)}switchToFullscreen(){this.$state.go(this.keepTab.currentShowState,this.$state.params)}get shouldFocus(){return!0===this.$state.params.focus}showBackButton(){return this.baseRoute.includes("bim")}backToList(){this.backRouting.goToBaseState()}initializeTexts(){super.initializeTexts(),this.text.closeDetailsView=this.I18n.t("js.button_close_details"),this.text.goTofullScreen=this.I18n.t("js.work_packages.message_successful_show_in_fullscreen")}}R.\u0275fac=function(e){return new(e||R)(p.bc(p.A),p.bc(r.a),p.bc(a.a),p.bc(c.a),p.bc(o.a),p.bc(s.a),p.bc(n.StateService),p.bc(h.a))},R.\u0275cmp=p.Vb({type:R,selectors:[["wp-split-view-entry"]],features:[p.Ob([{provide:d.a,useClass:u.a}]),p.Mb],decls:1,vars:1,consts:[["class","work-packages--details loading-indicator--location","data-indicator-name","wpDetails",4,"ngIf"],["data-indicator-name","wpDetails",1,"work-packages--details","loading-indicator--location"],["id","tabs"],[1,"tabrow"],["uiSref",".overview","uiSrefActive","selected"],["href","",3,"textContent"],["uiSref",".activity","uiSrefActive","selected"],["uiSref",".relations","uiSrefActive","selected"],[3,"wpId"],["uiSref",".watchers","uiSrefActive","selected",4,"ngIf"],[1,"tab-icon"],["linkClass","work-packages--details-fullscreen-icon","spanClass","icon-context icon-to-fullscreen",3,"linkAriaLabel","linkTitle","execute"],["linkClass","work-packages--details-close-icon","spanClass","icon-context icon-close",3,"linkAriaLabel","linkTitle","execute"],["class","work-packages--details-content work-packages-tab-view--overflow",4,"ngIf"],["class","work-packages--details-toolbar-container",4,"ngIf"],[1,"work-packages--details--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"],["uiSref",".watchers","uiSrefActive","selected"],[1,"work-packages--details-content","work-packages-tab-view--overflow"],["tabindex","-1","focus","shouldFocus",1,"hidden-for-sighted",3,"textContent"],[3,"workPackage"],[3,"resource"],[1,"wp-show--header-container"],["linkClass","work-packages-back-button",3,"customBackMethod",4,"ngIf"],[1,"subject-header"],["ui-view","",1,"work-package-details-tab"],["linkClass","work-packages-back-button",3,"customBackMethod"],[1,"work-packages--details-toolbar-container"]],template:function(e,t){1&e&&p.Tc(0,T,19,13,"div",0),2&e&&p.wc("ngIf",t.workPackage)},directives:[g.q,f.UISref,f.UISrefActive,f.UISrefStatus,b.a,m.a,w.a,v.a,y.a,k.a,C.a,j.a,f.UIView,P.a,x.a],encapsulation:2,changeDetection:0})},Q2ix:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("fXoL"),s=i("wZYP"),r=i("F5Dh"),a=i("XNiG"),c=i("lJxs"),o=i("/uUt"),l=i("vkgz"),d=i("Kj3r"),u=i("E2tj"),h=i("FnNU"),p=i("AEvm"),g=i("3Pt+"),f=i("ofXK");class b extends p.a{constructor(e,t,i){super(),this.I18n=e,this.querySpace=t,this.wpTableFilters=i,this.deactivateFilter=new n.s,this.text={createWithDropdown:this.I18n.t("js.work_packages.create.button"),createButton:this.I18n.t("js.label_work_package"),explanation:this.I18n.t("js.label_create_work_package"),placeholder:this.I18n.t("js.work_packages.placeholder_filter_by_text")},this.searchTerm=Object(h.g)(""),this.searchTermChanged=new a.a,this.wpTableFilters.pristine$().pipe(this.untilDestroyed(),Object(c.a)(()=>{const e=this.wpTableFilters.find("search");return e?e.values[0]:""})).subscribe(e=>{console.log("upstream "+e+" "+this.searchTerm.timestampOfLastValue),this.searchTerm.value&&!this.searchTerm.isValueOlderThan(500)||(console.log("Upstream value setting to "+e),this.searchTerm.putValue(e))}),this.searchTermChanged.pipe(this.untilDestroyed(),Object(o.a)(),Object(l.a)(e=>this.searchTerm.putValue(e)),Object(d.a)(500)).subscribe(e=>{if(e.length>0)this.wpTableFilters.replace("search",t=>{t.operator=t.findOperator("**"),t.values=[e]});else{let e=this.wpTableFilters.find("search");this.wpTableFilters.remove(e),this.deactivateFilter.emit(e)}})}}b.\u0275fac=function(e){return new(e||b)(n.bc(s.a),n.bc(u.a),n.bc(r.a))},b.\u0275cmp=n.Vb({type:b,selectors:[["wp-filter-by-text-input"]],outputs:{deactivateFilter:"deactivateFilter"},features:[n.Mb],decls:2,vars:4,consts:[["id","filter-by-text-input","type","text",3,"placeholder","ngModel","ngModelChange"]],template:function(e,t){1&e&&(n.hc(0,"input",0),n.pc("ngModelChange",(function(e){return t.searchTermChanged.next(e)})),n.sc(1,"async"),n.gc()),2&e&&(n.xc("placeholder",t.text.placeholder),n.wc("ngModel",n.tc(1,2,t.searchTerm.values$())))},directives:[g.c,g.m,g.p],pipes:[f.a],encapsulation:2})},Q2x2:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("4rda");class s extends n.a{isEmpty(){return _.isEmpty(this.value)}get value(){let e=this.resource[this.name];return this.schema&&e?e.elements?e.elements.map(e=>e.name):e.map?e.map(e=>e.name):e.name?[e.name]:["error: "+JSON.stringify(e)]:[]}render(e,t){const i=this.value;e.innerHTML="",e.setAttribute("title",i.join(", ")),0===i.length?this.renderEmpty(e):this.renderValues(i,e)}renderValues(e,t){const i=document.createDocumentFragment(),n=this.optionDiv(this.valueAbridged(e));if(i.appendChild(n),e.length>2){const t=this.optionDiv(e.length.toString(),"badge","-secondary");i.appendChild(t)}t.appendChild(i)}optionDiv(e,...t){const i=document.createElement("div"),s=document.createElement("span");return i.classList.add(n.b),s.classList.add(...t),s.textContent=e,i.appendChild(s),i}valueAbridged(e){const t=_.take(e,2);return e.length>2&&t.push("... "),t.join(", ")}}},Q6HB:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("Jui0"),s=i("pL6k"),r=i("g1AQ"),a=i("PtkW"),c=i("7xci"),o=i("Va5K"),l=i("fXoL");class d{constructor(e,t,i,n,s,r){this.HookService=e,this.UrlParamsHelper=t,this.wpViewRepresentation=i,this.wpViewTimeline=n,this.wpViewIndent=s,this.PathHelper=r,this.BULK_ACTIONS=[{text:I18n.t("js.work_packages.bulk_actions.edit"),key:"edit",link:"update",href:this.PathHelper.staticBase+"/work_packages/bulk/edit"},{text:I18n.t("js.work_packages.bulk_actions.move"),key:"move",link:"move",href:this.PathHelper.staticBase+"/work_packages/move/new"},{text:I18n.t("js.work_packages.bulk_actions.copy"),key:"copy",link:"copy",href:this.PathHelper.staticBase+"/work_packages/move/new?copy=true"},{text:I18n.t("js.work_packages.bulk_actions.delete"),key:"delete",link:"delete",href:this.PathHelper.staticBase+"/work_packages/bulk?_method=delete"}]}getPermittedActionLinks(e,t,i){let n=[],s=this.getAllowedActions(e,t);return s=s.concat(this.getAllowedParentActions(e)),s=s.concat(this.getAllowedRelationActions(e,i)),_.each(s,t=>{n.push({key:t.key,text:t.text,icon:t.icon,link:t.link?e[t.link].href:void 0})}),n}getIntersectOfPermittedActions(e){let t=[],i=_.filter(this.BULK_ACTIONS,t=>_.every(e,e=>this.getAllowedActions(e,[t]).length>=1));return _.each(i,i=>{t.push({key:i.key,text:i.text,link:this.getBulkActionLink(i,e)})}),t}getBulkActionLink(e,t){let i={"ids[]":t.map((function(e){return e.id}))},n=this.UrlParamsHelper.buildQueryString(i),s=e.href.split("?");return s.shift()+"?"+s.concat(new Array(n)).join("&")}getAllowedActions(e,t){let i=[];return _.each(t,t=>{t.link&&e.hasOwnProperty(t.link)&&(t.text=t.text||I18n.t("js.button_"+t.key),i.push(t))}),_.each(this.HookService.call("workPackageTableContextMenu"),t=>{if(e.hasOwnProperty(t.link)){let e=t.indexBy?t.indexBy(i):i.length;i.splice(e,0,t)}}),i}getAllowedParentActions(e){let t=[];return this.wpViewRepresentation.isList?(this.wpViewIndent.canOutdent(e)&&t.push({key:"hierarchy-outdent",icon:"icon-paragraph-left",text:I18n.t("js.relation_buttons.hierarchy_outdent")}),this.wpViewIndent.canIndent(e)&&t.push({key:"hierarchy-indent",icon:"icon-paragraph-right",text:I18n.t("js.relation_buttons.hierarchy_indent")}),t):[]}getAllowedRelationActions(e,t){let i=[];return e.addRelation&&this.wpViewTimeline.isVisible&&(i.push({key:"relation-precedes",text:I18n.t("js.relation_buttons.add_predecessor"),link:"addRelation"}),i.push({key:"relation-follows",text:I18n.t("js.relation_buttons.add_follower"),link:"addRelation"})),e.addChild&&t&&i.push({key:"relation-new-child",text:I18n.t("js.relation_buttons.add_new_child"),link:"addChild"}),i}getPermittedActions(e,t,i){return 1===e.length?this.getPermittedActionLinks(e[0],t,i):this.getIntersectOfPermittedActions(e)}}d.\u0275fac=function(e){return new(e||d)(l.lc(r.a),l.lc(s.a),l.lc(o.a),l.lc(a.a),l.lc(c.a),l.lc(n.a))},d.\u0275prov=l.Xb({token:d,factory:d.\u0275fac})},QOiP:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));const n={PROPERTY:"QueryColumn::Property",RELATION_OF_TYPE:"QueryColumn::RelationOfType",RELATION_TO_TYPE:"QueryColumn::RelationToType"};function s(e){return[n.RELATION_TO_TYPE,n.RELATION_OF_TYPE].indexOf(e._type)>=0}},QihR:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("juWA"),s=i("fXoL");class r{constructor(e){this.timezoneService=e}ngOnInit(){var e=this.timezoneService.formattedDatetimeComponents(this.dateTimeValue);this.date=e[0],this.time=e[1]}}r.\u0275fac=function(e){return new(e||r)(s.bc(n.a))},r.\u0275cmp=s.Vb({type:r,selectors:[["op-date-time"]],inputs:{dateTimeValue:"dateTimeValue"},decls:5,vars:4,consts:[[3,"title"],[3,"textContent"]],template:function(e,t){1&e&&(s.hc(0,"span",0),s.cc(1,"span",1),s.hc(2,"span"),s.Vc(3,"\xa0"),s.gc(),s.cc(4,"span",1),s.gc()),2&e&&(s.zc("title","",t.date," ",t.time,""),s.Pb(1),s.wc("textContent",t.date),s.Pb(3),s.wc("textContent",t.time))},encapsulation:2})},Qs0b:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));const n="https://www.openproject.org/enterprise-edition/?op_edtion=community-edition",s="https://www.openproject.org/enterprise-demo/"},R9pB:function(e,t,i){"use strict";function n(e=16){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i="";for(let n of new Array(e))i+=t.charAt(Math.floor(Math.random()*t.length));return i}i.d(t,"a",(function(){return n}))},RGDJ:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.backgroundClass=function(e,t){return`__hl_background_${e}_${t}`},e.inlineClass=function(e,t){return`__hl_inline_${e}_${t}`},e.colorClass=function(e,t){return e?`__hl_inline_color_${t}_text`:`__hl_inline_color_${t}_dot`},e.overdueDate=function(e){return 0===e?"__hl_date_due_today":e<=-1?"__hl_date_overdue":"__hl_date_not_overdue"},e.isBright=function(e,t,i){const n=`--hl-${t}-${i}-dark`;return""!==e.getPropertyValue(n)}}(n||(n={}))},"RN/J":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("7ond"),s=i("fXoL");class r{constructor(e,t){this.el=e,this.focusHelper=t,this.condition=!0}ngAfterContentInit(){this.condition&&setTimeout(()=>{this.focusHelper.focusElement(jQuery(this.el.nativeElement))},100)}}r.\u0275fac=function(e){return new(e||r)(s.bc(s.q),s.bc(n.a))},r.\u0275dir=s.Wb({type:r,selectors:[["","autoFocus",""]],inputs:{condition:["autoFocus-condition","condition"]}})},RWlv:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{}},RhL0:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a}));const n=["f"],s=["t"];class r{constructor(){this.filterMap={}}add(e,t,i){return!0===i&&(i=s),!1===i&&(i=n),this.filterMap[e]={operator:t,values:i},this}remove(e){delete this.filterMap[e]}toFilterObject(e){let t={};return e.forEach(e=>{_.each(e,(e,i)=>{t[i]=e})}),t}merge(e,...t){const i=_.pickBy(this.toFilterObject(e),(e,i)=>t.includes(i));this.filterMap=Object.assign(Object.assign({},this.filterMap),i)}get filters(){let e=[];return _.each(this.filterMap,(t,i)=>{e.push({[i]:t})}),e}toJson(){return JSON.stringify(this.filters)}toParams(e={}){let t=[];t=this.filters.map(e=>this.serializeFilter(e));let i=Object.assign({filters:`[${t.join(",")}]`},e);return new URLSearchParams(i).toString()}clone(){let e=new r;return this.filters.forEach(t=>{Object.keys(t).forEach(i=>{e.add(i,t[i].operator,t[i].values)})}),e}serializeFilter(e){let t,i;i=Object.keys(e);let n=i[0],s=e[n];return t=`{"${n}":{"operator":"${s.operator}","values":[${s.values.map(e=>this.serializeFilterValue(e)).join(",")}]}}`,t}serializeFilterValue(e){return`"${e}"`}}function a(e,t,i){return(new r).add(e,t,i)}},"Rky/":function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));i("72oW");var n=i("B4Ei"),s=i("pL6k"),r=i("AEvm"),a=i("fXoL");const c=["embeddedTable"];class o extends r.a{constructor(e){super(),this.queryUrlParamsHelper=e,this.hidden=!1}refreshTable(){this.embeddedTable.isInitialized&&this.embeddedTable.loadQuery(!0,!1)}handleQueryLoaded(e){if(!(this.query instanceof n.a))return;const t=this.projectValuesCount(this.query),i=this.projectValuesCount(e);null!==t&&null===i&&(this.hidden=!0),t&&i&&t>0&&0===i&&(this.hidden=!0)}projectValuesCount(e){const t=e.filters.find(e=>"project"===e.id);return t?t.values.length:null}buildQueryProps(){return this.query instanceof n.a?this.queryUrlParamsHelper.buildV3GetQueryFromQueryResource(this.query,{valid_subset:!0},{id:this.workPackage.id}):this.query}}o.\u0275fac=function(e){return new(e||o)(a.bc(s.a))},o.\u0275dir=a.Wb({type:o,viewQuery:function(e,t){var i;(1&e&&a.ad(c,!0),2&e)&&(a.Ic(i=a.qc())&&(t.embeddedTable=i.first))},features:[a.Mb]})},RnhZ:function(e,t,i){var n={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-SG":"zavE","./en-SG.js":"zavE","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function s(e){var t=r(e);return i(t)}function r(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}s.keys=function(){return Object.keys(n)},s.resolve=r,e.exports=s,s.id="RnhZ"},RuUM:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("wZYP"),s=i("d/TE"),r=i("XNiG"),a=i("qc15"),c=i("fXoL");class o{constructor(e,t,i){this.I18n=e,this.workPackageNotificationService=t,this.NotificationsService=i,this.quoteEvents=new r.a}createComment(e,t){return e.addComment({comment:t},{"Content-Type":"application/json; charset=UTF-8"}).catch(t=>this.errorAndReject(t,e))}updateComment(e,t){JSON.stringify({comment:t});return e.update({comment:t},{"Content-Type":"application/json; charset=UTF-8"}).then(e=>(this.NotificationsService.addSuccess(this.I18n.t("js.work_packages.comment_updated")),e)).catch(e=>this.errorAndReject(e))}errorAndReject(e,t){return this.workPackageNotificationService.handleRawError(e,t),Promise.reject(e)}}o.\u0275fac=function(e){return new(e||o)(c.lc(n.a),c.lc(a.a),c.lc(s.a))},o.\u0275prov=c.Xb({token:o,factory:o.\u0275fac})},S2zE:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("uSJ+"),s=i("itXk"),r=i("AEvm"),a=i("CNq7"),c=i("fXoL"),o=i("ofXK");function l(e,t){if(1&e&&c.cc(0,"span",1),2&e){const e=c.rc();c.wc("textContent",e.count)}}class d extends r.a{constructor(e,t){super(),this.apiV3Service=e,this.wpRelations=t,this.count=0}ngOnInit(){this.wpRelations.require(this.wpId.toString()),Object(s.a)([this.wpRelations.state(this.wpId.toString()).values$(),this.apiV3Service.work_packages.id(this.wpId).requireAndStream()]).pipe(this.untilDestroyed()).subscribe(([e,t])=>{let i=_.size(e),n=_.size(t.children);this.count=i+n})}}d.\u0275fac=function(e){return new(e||d)(c.bc(a.a),c.bc(n.a))},d.\u0275cmp=c.Vb({type:d,selectors:[["wp-relations-count"]],inputs:{wpId:"wpId"},features:[c.Mb],decls:1,vars:1,consts:[["class","wp-tabs-count",3,"textContent",4,"ngIf"],[1,"wp-tabs-count",3,"textContent"]],template:function(e,t){1&e&&c.Tc(0,l,1,1,"span",0),2&e&&c.wc("ngIf",t.count>0)},directives:[o.q],encapsulation:2})},S8rk:function(e,t,i){"use strict";i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return o}));var n=i("fXoL"),s=i("ofXK"),r=i("3Pt+");const a=function(e){return{"-active":e}},c="slide-toggle";class o{constructor(e,t){this.elementRef=e,this.cdRef=t,this.valueChanged=new n.s}ngOnChanges(e){console.warn(JSON.stringify(e))}ngOnInit(){const e=this.elementRef.nativeElement.dataset;e.inputName&&(this.containerId=e.containerId,this.containerClasses=e.containerClasses,this.inputId=e.inputId,this.inputName=e.inputName,this.active="true"===e.active.toString())}onValueChanged(e){this.active=e,this.valueChanged.emit(e),this.cdRef.detectChanges()}}o.\u0275fac=function(e){return new(e||o)(n.bc(n.q),n.bc(n.i))},o.\u0275cmp=n.Vb({type:o,selectors:[["slide-toggle"]],inputs:{containerId:"containerId",containerClasses:"containerClasses",inputId:"inputId",inputName:"inputName",active:"active"},outputs:{valueChanged:"valueChanged"},features:[n.Nb],decls:4,vars:10,consts:[[3,"ngClass"],[1,"switch"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"slider","round"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"label",1),n.hc(2,"input",2),n.pc("ngModelChange",(function(e){return t.onValueChanged(e)})),n.gc(),n.cc(3,"span",3),n.gc(),n.gc()),2&e&&(n.Rb("slide-toggle ",t.containerClasses,""),n.wc("ngClass",n.Bc(8,a,t.active)),n.Qb("id",t.containerId),n.Pb(2),n.wc("ngModel",t.active),n.Qb("id",t.inputId||void 0)("name",t.inputName||void 0))},directives:[s.n,r.a,r.m,r.p],styles:['.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:50px;height:24px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:16px;width:16px;left:4px;bottom:4px;background-color:#fff;transition:.4s}.slide-toggle.-active[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{background-color:#00008b}.slide-toggle.-active[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{transform:translateX(26px)}.slider.round[_ngcontent-%COMP%]{border-radius:34px}.slider.round[_ngcontent-%COMP%]:before{border-radius:50%}'],changeDetection:0})},SIjI:function(e,t,i){"use strict";i.d(t,"a",(function(){return I}));var n=i("fXoL"),s=(i("ii2/"),i("cd/7")),r=i("Jui0"),a=i("RGDJ"),c=i("iB+3"),o=i("eyhC"),l=i("WW/2"),d=i("wZYP"),u=i("AEvm"),h=i("Y/CA"),p=i("2G+H"),g=i("ofXK"),f=i("kor4"),b=i("N5AO"),m=i("711n"),w=i("80WE"),v=i("K8b8"),y=i("u8Ab");function k(e,t){if(1&e){const e=n.ic();n.hc(0,"a",7),n.pc("accessibleClick",(function(){n.Lc(e);const t=n.rc();return t.emitStateLinkClicked(t.workPackage,!0)})),n.cc(1,"op-icon",8),n.gc()}if(2&e){const e=n.rc();n.wc("title",e.text.detailsView)}}const C=function(e){return{"-show":e}};function j(e,t){if(1&e){const e=n.ic();n.hc(0,"a",9),n.pc("accessibleClick",(function(){n.Lc(e);const t=n.rc();return t.onRemoved(t.workPackage)})),n.cc(1,"op-icon",10),n.gc()}if(2&e){const e=n.rc();n.wc("ngClass",n.Bc(2,C,e.workPackage.isNew))("title",e.text.removeCard)}}function P(e,t){if(1&e&&(n.hc(0,"edit-form",11),n.hc(1,"div",12),n.cc(2,"editable-attribute-field",13),n.cc(3,"editable-attribute-field",14),n.gc(),n.gc()),2&e){const e=n.rc();n.wc("resource",e.workPackage)("inEditMode",e.workPackage.isNew),n.Pb(2),n.wc("resource",e.workPackage)("wrapperClasses","work-packages--type-selector")("fieldName","type"),n.Pb(1),n.wc("resource",e.workPackage)}}function x(e,t){if(1&e&&n.cc(0,"img",23),2&e){const e=n.rc(2);n.wc("src",e.bcfSnapshotPath(e.workPackage),n.Oc)}}function S(e,t){if(1&e&&n.cc(0,"wp-status-button",24),2&e){const e=n.rc(2);n.wc("workPackage",e.workPackage)}}function _(e,t){if(1&e&&n.cc(0,"user-avatar",25),2&e){const e=n.rc(2);n.wc("user",e.workPackage.assignee)}}function O(e,t){if(1&e){const e=n.ic();n.hc(0,"div",15),n.cc(1,"span",16),n.cc(2,"span",17),n.hc(3,"a",18),n.pc("accessibleClick",(function(){n.Lc(e);const t=n.rc();return t.emitStateLinkClicked(t.workPackage)})),n.Vc(4),n.gc(),n.cc(5,"span",19),n.Tc(6,x,1,1,"img",20),n.Tc(7,S,1,1,"wp-status-button",21),n.Tc(8,_,1,1,"user-avatar",22),n.gc()}if(2&e){const e=n.rc();n.Pb(1),n.wc("textContent",e.wpProjectName(e.workPackage)),n.Pb(1),n.wc("textContent",e.wpTypeAttribute(e.workPackage))("ngClass",e.typeHighlightingClass(e.workPackage)),n.Pb(1),n.wc("ngClass",e.uiStateLinkClass),n.Pb(1),n.Xc(" #",e.workPackage.id," "),n.Pb(1),n.wc("textContent",e.wpSubject(e.workPackage)),n.Pb(1),n.wc("ngIf",e.cardCoverImageShown(e.workPackage)),n.Pb(1),n.wc("ngIf",e.showStatusButton),n.Pb(1),n.wc("ngIf",e.workPackage.assignee)}}class I extends u.a{constructor(e,t,i,r,a,c,o){super(),this.pathHelper=e,this.I18n=t,this.$state=i,this.wpTableSelection=r,this.wpTableFocus=a,this.cardView=c,this.cdRef=o,this.showInfoButton=!1,this.showStatusButton=!0,this.showRemoveButton=!1,this.highlightingMode="inline",this.draggable=!1,this.orientation="vertical",this.shrinkOnMobile=!1,this.onRemove=new n.s,this.stateLinkClicked=new n.s,this.uiStateLinkClass=s.c,this.text={removeCard:this.I18n.t("js.card.remove_from_list"),detailsView:this.I18n.t("js.button_open_details")}}ngOnInit(){this.wpTableSelection.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.cdRef.detectChanges()})}classIdentifier(e){return this.cardView.classIdentifier(e)}emitStateLinkClicked(e,t){const i=this.classIdentifier(e),n=t?Object(p.a)(this.$state):"work-packages.show";this.wpTableSelection.setSelection(e.id,this.cardView.findRenderedCard(i)),this.wpTableFocus.updateFocus(e.id),this.stateLinkClicked.emit({workPackageId:e.id,requestedState:n})}cardClasses(){let e=this.isSelected(this.workPackage)?s.b:"";return e+=this.draggable?" -draggable":"",e+=this.workPackage.isNew?" -new":"",e+=" wp-card-"+this.workPackage.id,e+=" -"+this.orientation,e+=this.shrinkOnMobile?" -shrink":"",e}wpTypeAttribute(e){return e.type.name}wpSubject(e){return e.subject}wpProjectName(e){var t;return null===(t=e.project)||void 0===t?void 0:t.name}cardHighlightingClass(e){return this.cardHighlighting(e)}typeHighlightingClass(e){return this.attributeHighlighting("type",e)}onRemoved(e){this.onRemove.emit(e)}cardCoverImageShown(e){return null!==this.bcfSnapshotPath(e)}bcfSnapshotPath(e){return e.bcfViewpoints&&e.bcfViewpoints.length>0?e.bcfViewpoints[0].href+"/snapshot":null}isSelected(e){return this.wpTableSelection.isSelected(e.id)}cardHighlighting(e){return["status","priority","type"].includes(this.highlightingMode)?a.a.backgroundClass(this.highlightingMode,e[this.highlightingMode].id):""}attributeHighlighting(e,t){return a.a.inlineClass(e,t.type.id)}}I.\u0275fac=function(e){return new(e||I)(n.bc(r.a),n.bc(d.a),n.bc(c.StateService),n.bc(o.a),n.bc(h.a),n.bc(l.a),n.bc(n.i))},I.\u0275cmp=n.Vb({type:I,selectors:[["wp-single-card"]],inputs:{workPackage:"workPackage",showInfoButton:"showInfoButton",showStatusButton:"showStatusButton",showRemoveButton:"showRemoveButton",highlightingMode:"highlightingMode",draggable:"draggable",orientation:"orientation",shrinkOnMobile:"shrinkOnMobile"},outputs:{onRemove:"onRemove",stateLinkClicked:"stateLinkClicked"},features:[n.Mb],decls:7,vars:6,consts:[[1,"wp-card",3,"ngClass"],[1,"wp-card--highlighting",3,"ngClass"],[1,"wp-card--inline-buttons","hidden-for-mobile"],["class","wp-card--details-button -no-decoration",3,"title","accessibleClick",4,"ngIf"],["class","wp-card--inline-cancel-button -no-decoration",3,"ngClass","title","accessibleClick",4,"ngIf"],[3,"resource","inEditMode",4,"ngIf"],["class","wp-card--content",4,"ngIf"],[1,"wp-card--details-button","-no-decoration",3,"title","accessibleClick"],["icon-classes","icon icon-info2"],[1,"wp-card--inline-cancel-button","-no-decoration",3,"ngClass","title","accessibleClick"],["icon-classes","icon icon-close"],[3,"resource","inEditMode"],[1,"wp-card--content","-new"],[1,"wp-card--type",3,"resource","wrapperClasses","fieldName"],["fieldName","subject",1,"wp-card--subject","-bold",3,"resource"],[1,"wp-card--content"],[1,"wp-card--project-name",3,"textContent"],[1,"wp-card--type",3,"textContent","ngClass"],[1,"wp-card--id",3,"ngClass","accessibleClick"],[1,"wp-card--subject",3,"textContent"],["class","wp-card--cover-image",3,"src",4,"ngIf"],["class","wp-card--status",3,"workPackage",4,"ngIf"],["data-class-list","avatar-mini","class","wp-card--assignee",3,"user",4,"ngIf"],[1,"wp-card--cover-image",3,"src"],[1,"wp-card--status",3,"workPackage"],["data-class-list","avatar-mini",1,"wp-card--assignee",3,"user"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.cc(1,"div",1),n.hc(2,"div",2),n.Tc(3,k,2,1,"a",3),n.Tc(4,j,2,4,"a",4),n.gc(),n.Tc(5,P,4,6,"edit-form",5),n.Tc(6,O,9,9,"div",6),n.gc()),2&e&&(n.wc("ngClass",t.cardClasses()),n.Pb(1),n.wc("ngClass",t.cardHighlightingClass(t.workPackage)),n.Pb(2),n.wc("ngIf",!t.workPackage.isNew&&t.showInfoButton),n.Pb(1),n.wc("ngIf",t.workPackage.isNew||t.showRemoveButton),n.Pb(1),n.wc("ngIf",t.workPackage.isNew),n.Pb(1),n.wc("ngIf",!t.workPackage.isNew))},directives:[g.n,g.q,f.a,b.a,m.a,w.a,v.a,y.a],styles:['.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.wp-card[_ngcontent-%COMP%]{display:flex;-webkit-user-select:none;user-select:none;width:100%;border:1px solid var(--widget-box-block-border-color);border-radius:2px;padding:10px;position:relative;box-shadow:1px 1px 3px 0 #d3d3d3;background:var(--body-background);font-size:var(--card-font-size)}.wp-card[_ngcontent-%COMP%]:hover{box-shadow:0 0 10px #d3d3d3}.wp-card.-new[_ngcontent-%COMP%]{padding-right:25px}.wp-card.-checked[_ngcontent-%COMP%]{background-color:var(--table-row-highlighting-color)}.wp-card.-horizontal[_ngcontent-%COMP%]{height:100%}.wp-card.-vertical[_ngcontent-%COMP%]{margin-top:10px}.wp-card.-vertical[_ngcontent-%COMP%]:last-of-type{margin-bottom:5px}wp-single-card.gu-transit[_nghost-%COMP%]   .wp-card[_ngcontent-%COMP%]{border:1px dashed var(--primary-color);pointer-events:none}wp-single-card.gu-transit[_nghost-%COMP%]   .wp-card[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{visibility:hidden}.wp-card--content[_ngcontent-%COMP%]:not(.-new){display:grid;grid-template-columns:auto 1fr auto;grid-template-rows:auto auto auto 1fr auto;grid-row-gap:10px;grid-template-areas:"project project project" "type type type" "subject subject subject" "image image image" "attributeTag avatar idlink";overflow:hidden;flex-grow:1}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--project-name[_ngcontent-%COMP%]{grid-area:project;font-style:italic;color:var(--gray-dark);font-size:12px;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--type[_ngcontent-%COMP%]{grid-area:type}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--subject[_ngcontent-%COMP%]{grid-area:subject;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--assignee[_ngcontent-%COMP%]{grid-area:avatar;place-self:center left}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--id[_ngcontent-%COMP%]{grid-area:idlink;place-self:center right}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--status[_ngcontent-%COMP%]{grid-area:attributeTag;max-width:120px;margin-right:5px;overflow:hidden}.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--cover-image[_ngcontent-%COMP%]{grid-area:image;max-height:350px}@media screen and (max-width:679px){.wp-card--content[_ngcontent-%COMP%]:not(.-new)   .wp-card--cover-image[_ngcontent-%COMP%]{max-height:250px}}.wp-card--highlighting[_ngcontent-%COMP%]{width:5px;height:100%;position:absolute;top:0;left:0;border-radius:2px 0 0 2px}.wp-card--inline-buttons[_ngcontent-%COMP%]{position:absolute;right:0;top:5px;opacity:0}.wp-card--inline-buttons.-show[_ngcontent-%COMP%], .wp-card[_ngcontent-%COMP%]:hover   .wp-card--inline-buttons[_ngcontent-%COMP%]{opacity:1}@media only screen and (max-width:679px){.wp-card.-shrink[_ngcontent-%COMP%]{border:none;box-shadow:none;padding:15px}}'],changeDetection:0})},SKFm:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("mrSG"),s=i("FnNU"),r=i("pLZG"),a=i("lJxs"),c=i("XNiG"),o=i("GntA"),l=i("g1AQ"),d=i("/C7M"),u=i("HKNX"),h=i("fXoL");class p extends s.b{constructor(){super(),this.name="Changesets",this.changesets=Object(s.h)(),this.initializeMembers()}}class g{constructor(e,t){this.wasNew=!1,this.id=t.id.toString(),this.wasNew=e.pristineResource.isNew,this.resource=t,this.changes=e.changeMap}}class f extends u.a{constructor(e,t,i){super((new p).changesets),this.injector=e,this.halEvents=t,this.hook=i,this.committedChanges=new c.a}save(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=yield e.buildRequestPayload(),i=yield e.pristineResource.$links.updateImmediately(t);return i.retainFrom(e.pristineResource),yield this.onSaved(i),this.complete(e,i)}))}complete(e,t){const i=new g(e,t);this.committedChanges.next(i),this.reset(e);const n=i.wasNew?"created":"updated";return this.halEvents.push(i.resource,{eventType:n,commit:i}),i}reset(e){e.clear(),this.clearSome(e.href)}typedState(e){return this.multiState.get(e.href)}edit(e,t){const i=this.multiState.get(e.href),n=this.newChangeset(e,i,t);return i.putValue(n),n}newChangeset(e,t,i){return new(this.hook.call("halResourceChangesetClass",e).pop()||o.a)(e,t,i)}changeFor(e){const t=this.multiState.get(e.href);let i=e;e.state&&(i=e.state.getValueOr(e));let n=t.value;return n&&!n.isEmpty()?n:n?i.hasOwnProperty("lockVersion")&&n.pristineResource.lockVersion<i.lockVersion?this.edit(i):(n.updatePristineResource(i),n):this.edit(i)}temporaryEditResource(e){const t=Object(s.c)(e.state,this.typedState(e));return Object(s.e)(t,e=>e.pipe(Object(r.a)(([e,t])=>!!e),Object(a.a)(([e,t])=>t?(t.updatePristineResource(e),t.projectedResource):e)))}stopEditing(e){this.multiState.get(e.href).clear()}onSaved(e){return e.state?e.push(e):Promise.resolve()}}f.\u0275fac=function(e){return new(e||f)(h.lc(h.A),h.lc(d.a),h.lc(l.a))},f.\u0275prov=h.Xb({token:f,factory:f.\u0275fac})},SU55:function(e,t){!function(e){"use strict";e((function(){e("[data-selected-page].tree-menu--container").each((function(t,i){let n=e(i).data("selected-page");if(n){let t=e("[slug="+n+"]",i);t.toggleClass("-selected",!0),t[0].scrollIntoView()}})),e(".pages-hierarchy.-with-hierarchy .tree-menu--hierarchy-span").on("click keypress",(function(t){return"keypress"===t.type&&13!==t.which||e(t.target).closest("ul.-with-hierarchy > li").toggleClass("-hierarchy-collapsed -hierarchy-expanded"),!1}))}))}(jQuery)},SgrZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));i("AA01");var n=i("59tY"),s=i("wZYP"),r=i("Y41n"),a=i("juWA"),c=i("Hg4z"),o=i("fXoL"),l=i("ecJW"),d=i("oUDv"),u=i("ofXK"),h=i("N5AO");function p(e,t){if(1&e&&(o.hc(0,"span",5),o.cc(1,"op-icon",6),o.gc()),2&e){const e=o.rc();o.Qb("data-tooltip",e.timeZoneText)}}class g extends n.a{constructor(e,t){super(e,t),this.I18n=e,this.timezoneService=t,this.shouldFocus=!1,this.filterChanged=new r.a(Object(c.b)(this)),this.text={spacer:this.I18n.t("js.filter.value_spacer")}}get begin(){return this.filter.values[0]}set begin(e){this.filter.values[0]=e||"",this.filterChanged.emit(this.filter)}get end(){return this.filter.values[1]}set end(e){this.filter.values[1]=e||"",this.filterChanged.emit(this.filter)}get lowerBoundary(){return this.begin&&this.timezoneService.isValidISODateTime(this.begin.toString())?this.timezoneService.parseDatetime(this.begin.toString()):null}get upperBoundary(){return this.end&&this.timezoneService.isValidISODateTime(this.end.toString())?this.timezoneService.parseDatetime(this.end.toString()):null}}g.\u0275fac=function(e){return new(e||g)(o.bc(s.a),o.bc(a.a))},g.\u0275cmp=o.Vb({type:g,selectors:[["filter-date-times-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[o.Mb],decls:5,vars:10,consts:[[1,"inline-label",3,"id"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","focus","id","name","onChange"],[1,"advanced-filters--affix",3,"textContent"],["classes","advanced-filters--date-field","size","10",3,"initialDate","id","name","onChange"],["class","advanced-filters--tooltip-trigger -multiline",4,"ngIf"],[1,"advanced-filters--tooltip-trigger","-multiline"],["icon-classes","icon icon-warning"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"op-date-picker",1),o.pc("onChange",(function(e){return t.begin=t.isoDateParser(e)})),o.gc(),o.cc(2,"span",2),o.hc(3,"op-date-picker",3),o.pc("onChange",(function(e){return t.end=t.isoDateParser(e)})),o.gc(),o.Tc(4,p,2,1,"span",4),o.gc()),2&e&&(o.yc("id","div-values-",t.filter.id,""),o.Pb(1),o.wc("initialDate",t.isoDateFormatter(t.begin))("focus",t.shouldFocus)("id","values-"+t.filter.id+"-begin")("name","v["+t.filter.id+"]-begin"),o.Pb(1),o.wc("textContent",t.text.spacer),o.Pb(1),o.wc("initialDate",t.isoDateFormatter(t.end))("id","values-"+t.filter.id+"-end")("name","v["+t.filter.id+"]-end"),o.Pb(1),o.wc("ngIf",t.isTimeZoneDifferent))},directives:[l.a,d.a,u.q,h.a],encapsulation:2})},SqdZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("fXoL"),s=i("AEvm");class r extends s.a{constructor(e,t,i){super(),this.locals=e,this.cdRef=t,this.elementRef=i,this.closeOnEscape=!0,this.closeOnEscapeFunction=this.closeMe,this.closeOnOutsideClick=!0,this.service=this.locals.service,this.closingEvent=new n.s,this.openingEvent=new n.s}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement)}ngOnDestroy(){this.closingEvent.complete(),this.openingEvent.complete()}onClose(){return this.afterFocusOn&&this.afterFocusOn.focus(),!0}closeMe(e){this.service.close(),e&&(e.stopPropagation(),e.preventDefault())}onOpen(e){this.openingEvent.emit(),this.cdRef.detectChanges()}get afterFocusOn(){return this.$element}}r.\u0275fac=function(e){n.oc()},r.\u0275dir=n.Wb({type:r,features:[n.Mb]})},Sulb:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("mrSG"),s=i("2Vo4"),r=i("wZYP"),a=i("sjKJ"),c=i("K247"),o=i("r0MM"),l=i("fXoL");class d{constructor(e,t,i){this.I18n=e,this.injector=t,this.deviceService=i,this.elementMinWidth=11,this.defaultWidth=230,this.localStorageKey="openProject-mainMenuWidth",this.localStorageStateKey="openProject-mainMenuCollapsed",this.global=window,this.htmlNode=document.getElementsByTagName("html")[0],this.mainMenu=jQuery("#main-menu")[0],this.hideElements=jQuery(".can-hide-navigation"),this.titleData=new s.a(""),this.titleData$=this.titleData.asObservable(),this.changeData=new s.a({}),this.changeData$=this.changeData.asObservable()}initializeMenu(){if(!this.mainMenu)return;this.elementWidth=parseInt(window.OpenProject.guardedLocalStorage(this.localStorageKey));const e=window.OpenProject.guardedLocalStorage(this.localStorageStateKey);this.elementWidth?e&&JSON.parse(e)?this.closeMenu():this.setWidth():this.saveWidth(this.mainMenu.offsetWidth);let t=this.injector.get(a.a);(jQuery(document.body).hasClass("controller-my")&&0===this.elementWidth||null===t.id)&&this.saveWidth(this.defaultWidth),this.closeWhenOnMobile()}toggleNavigation(e){if(e&&(e.stopPropagation(),e.preventDefault()),this.showNavigation)this.closeMenu();else if(this.deviceService.isMobile)this.setWidth(window.innerWidth);else{const e=parseInt(window.OpenProject.guardedLocalStorage(this.localStorageKey)),t=e>=this.elementMinWidth?e:this.defaultWidth;this.saveWidth(t)}setTimeout((function(){jQuery('#main-menu [class*="-menu-item"]:visible').first().focus()}),500)}closeMenu(){this.setWidth(0),window.OpenProject.guardedLocalStorage(this.localStorageStateKey,"true"),jQuery(".wp-query-menu--search-input").blur()}closeWhenOnMobile(){this.deviceService.isMobile&&(this.closeMenu(),window.OpenProject.guardedLocalStorage(this.localStorageStateKey,"false"))}saveWidth(e){this.setWidth(e),window.OpenProject.guardedLocalStorage(this.localStorageKey,String(this.elementWidth)),window.OpenProject.guardedLocalStorage(this.localStorageStateKey,String(0===this.elementWidth))}setWidth(e){if(void 0!==e){let t=this.deviceService.isMobile?window.innerWidth-120:window.innerWidth-520;this.elementWidth=e>t?t:e}this.snapBack(),this.setToggleTitle(),this.toggleClassHidden(),this.global.showNavigation=this.showNavigation,this.htmlNode.style.setProperty("--main-menu-width",this.elementWidth+"px");let t=jQuery.Event("change");jQuery("#content-wrapper").on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",()=>{this.changeData.next(t)})}get showNavigation(){return this.elementWidth>=this.elementMinWidth}snapBack(){this.elementWidth<this.elementMinWidth&&(this.elementWidth=0)}setToggleTitle(){this.showNavigation?this.toggleTitle=this.I18n.t("js.label_hide_project_menu"):this.toggleTitle=this.I18n.t("js.label_expand_project_menu"),this.titleData.next(this.toggleTitle)}toggleClassHidden(){this.hideElements.toggleClass("hidden-navigation",!this.showNavigation)}}d.\u0275fac=function(e){return new(e||d)(l.lc(r.a),l.lc(l.A),l.lc(c.a))},d.\u0275prov=l.Xb({token:d,factory:d.\u0275fac,providedIn:"root"}),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",a.a)],d.prototype,"currentProject",void 0)},T9ri:function(e,t,i){"use strict";function n(e){let t=e.value||"nullValue";if(e.href)try{t+=e.href.map(e=>e.href).join("-")}catch(i){console.error("Failed to extract group identifier for "+e.value)}return t=t.toLowerCase().replace(/[^a-z0-9]+/g,"-"),`${r(e)}-${t}`}function s(e){let t=e.value;return null===t?"-":t}function r(e){return e._links.groupBy.href.split("/").pop()}function a(e){return"__row-group-"+e}function c(e){return e.split("-")[0]}function o(e){return e.split("-").pop()}i.d(t,"c",(function(){return n})),i.d(t,"d",(function(){return s})),i.d(t,"a",(function(){return r})),i.d(t,"f",(function(){return a})),i.d(t,"e",(function(){return c})),i.d(t,"b",(function(){return o}))},TAxG:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("fXoL"),s=i("wZYP"),r=(i("AA01"),i("S8rk"));class a{constructor(e){this.I18n=e,this.shouldFocus=!1,this.filterChanged=new n.s}get value(){return this.filter.values[0]}onFilterUpdated(e){this.filter.values[0]=e,this.filterChanged.emit(this.filter)}}a.\u0275fac=function(e){return new(e||a)(n.bc(s.a))},a.\u0275cmp=n.Vb({type:a,selectors:[["filter-boolean-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},decls:1,vars:4,consts:[[3,"active","containerId","inputId","inputName","valueChanged"]],template:function(e,t){1&e&&(n.hc(0,"slide-toggle",0),n.pc("valueChanged",(function(e){return t.onFilterUpdated(e)})),n.gc()),2&e&&(n.yc("containerId","div-values-",t.filter.id,""),n.yc("inputId","values-",t.filter.name,""),n.yc("inputName","v[",t.filter.name,"]"),n.wc("active",t.value))},directives:[r.a],encapsulation:2})},TKcc:function(e,t,i){var n={"./apl/apl.js":["4kmW",0,45],"./asciiarmor/asciiarmor.js":["Jt+K",0,46],"./asn.1/asn.1.js":["0OHD",0,47],"./asterisk/asterisk.js":["yGjk",0,48],"./brainfuck/brainfuck.js":["oF4/",0,49],"./clike/clike.js":["S6bl",0,5],"./clojure/clojure.js":["LA1u",0,50],"./cmake/cmake.js":["qE+Q",0,51],"./cobol/cobol.js":["JNJg",0,52],"./coffeescript/coffeescript.js":["oL3q",0,1],"./commonlisp/commonlisp.js":["kmAK",0,53],"./crystal/crystal.js":["JRJP",0,54],"./css/css.js":["ewDg",0,3],"./cypher/cypher.js":["vW+e",0,55],"./d/d.js":["zRyg",0,56],"./dart/dart.js":["6q/U",0,5,57],"./diff/diff.js":["3fnu",0,58],"./django/django.js":["SzTn",0,2,3,1,36],"./dockerfile/dockerfile.js":["R6x9",0,1,59],"./dtd/dtd.js":["/YIB",0,60],"./dylan/dylan.js":["PLH4",0,61],"./ebnf/ebnf.js":["AvIz",0,62],"./ecl/ecl.js":["rSpl",0,63],"./eiffel/eiffel.js":["t86p",0,64],"./elm/elm.js":["Rba3",0,65],"./erlang/erlang.js":["9RTS",0,66],"./factor/factor.js":["yv4w",0,1,67],"./fcl/fcl.js":["xvvs",0,68],"./forth/forth.js":["CDkR",0,69],"./fortran/fortran.js":["UYub",0,70],"./gas/gas.js":["Upog",0,71],"./gfm/gfm.js":["RKCW",0,8,1,72],"./gherkin/gherkin.js":["tkAH",0,73],"./go/go.js":["T/QY",0,74],"./groovy/groovy.js":["X7TR",0,75],"./haml/haml.js":["c+b1",0,2,3,1,37],"./handlebars/handlebars.js":["4d6s",0,1],"./haskell-literate/haskell-literate.js":["INem",0,1,76],"./haskell/haskell.js":["0+DK",0,1],"./haxe/haxe.js":["We/1",0,77],"./htmlembedded/htmlembedded.js":["dLt8",0,2,3,1,38],"./htmlmixed/htmlmixed.js":["1p+/",0,2,3,43],"./http/http.js":["scEK",0,78],"./idl/idl.js":["HqpV",0,79],"./javascript/javascript.js":["+dQi",0,2],"./jinja2/jinja2.js":["ToA7",0,80],"./jsx/jsx.js":["onn/",0,2,44],"./julia/julia.js":["NGrM",0,81],"./livescript/livescript.js":["5RX+",0,82],"./lua/lua.js":["jrMQ",0,83],"./markdown/markdown.js":["lZu9",0,8],"./mathematica/mathematica.js":["ztbM",0,84],"./mbox/mbox.js":["6mA5",0,85],"./mirc/mirc.js":["o5kb",0,86],"./mllike/mllike.js":["NU+Z",0,87],"./modelica/modelica.js":["lQiH",0,88],"./mscgen/mscgen.js":["6gTk",0,89],"./mumps/mumps.js":["Q7su",0,90],"./nginx/nginx.js":["srmC",0,91],"./nsis/nsis.js":["bYLO",0,1,92],"./ntriples/ntriples.js":["PWBO",0,93],"./octave/octave.js":["mybg",0,94],"./oz/oz.js":["yhmh",0,95],"./pascal/pascal.js":["lB9V",0,96],"./pegjs/pegjs.js":["ZGb1",0,2,97],"./perl/perl.js":["kG+r",0,98],"./php/php.js":["RNWO",0,2,3,5,39],"./pig/pig.js":["860+",0,99],"./powershell/powershell.js":["naPG",0,100],"./properties/properties.js":["3Fvf",0,101],"./protobuf/protobuf.js":["cHwl",0,102],"./pug/pug.js":["W+/v",0,2,3,7],"./puppet/puppet.js":["cwoo",0,103],"./python/python.js":["25Eh",0,1],"./q/q.js":["MiqB",0,104],"./r/r.js":["kD6b",0,105],"./rpm/rpm.js":["Qs4+",0,106],"./rst/rst.js":["jIQM",0,1,107],"./ruby/ruby.js":["hTYL",0,1],"./rust/rust.js":["sY4N",0,1,108],"./sas/sas.js":["Sh3j",0,109],"./sass/sass.js":["G2Pi",0,3,1],"./scheme/scheme.js":["8wdy",0,110],"./shell/shell.js":["AvDn",0,111],"./sieve/sieve.js":["1dRh",0,112],"./slim/slim.js":["VI2i",0,2,3,1,40],"./smalltalk/smalltalk.js":["n4Nj",0,113],"./smarty/smarty.js":["QWhe",0,114],"./solr/solr.js":["xhF3",0,115],"./soy/soy.js":["vH+N",0,2,3,41],"./sparql/sparql.js":["++e5",0,116],"./spreadsheet/spreadsheet.js":["bEWP",0,117],"./sql/sql.js":["/9rB",0,118],"./stex/stex.js":["+NIl",0,1],"./stylus/stylus.js":["dtKC",0,11],"./swift/swift.js":["wOIU",0,119],"./tcl/tcl.js":["BEBj",0,120],"./textile/textile.js":["TD3l",0,121],"./tiddlywiki/tiddlywiki.js":["9+NH",0,122],"./tiki/tiki.js":["Km7L",0,123],"./toml/toml.js":["0sou",0,124],"./tornado/tornado.js":["xbNY",0,2,3,1,42],"./troff/troff.js":["s1o1",0,125],"./ttcn-cfg/ttcn-cfg.js":["hmTv",0,126],"./ttcn/ttcn.js":["TYrp",0,127],"./turtle/turtle.js":["P3N9",0,128],"./twig/twig.js":["SII/",0,1,129],"./vb/vb.js":["Kr55",0,130],"./vbscript/vbscript.js":["axah",0,131],"./velocity/velocity.js":["/kYp",0,132],"./verilog/verilog.js":["m2bc",0,133],"./vhdl/vhdl.js":["PP56",0,134],"./vue/vue.js":["aT2M",0,2,3,11,7,1,135],"./webidl/webidl.js":["PVgs",0,136],"./xml/xml.js":["1eCo",0,137],"./xquery/xquery.js":["bJEP",0,138],"./yacas/yacas.js":["WThJ",0,139],"./yaml-frontmatter/yaml-frontmatter.js":["0gIM",0,1,140],"./yaml/yaml.js":["ztCB",0,1],"./z80/z80.js":["dRHf",0,141]};function s(e){if(!i.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],s=t[0];return Promise.all(t.slice(1).map(i.e)).then((function(){return i.t(s,7)}))}s.keys=function(){return Object.keys(n)},s.id="TKcc",e.exports=s},TM9v:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=[{key:"log_time",link:"logTime",resource:"workPackage"},{key:"change_project",icon:"icon-move",link:"move",resource:"workPackage"},{key:"copy",link:"copy",resource:"workPackage"},{key:"delete",link:"delete",resource:"workPackage"},{key:"export-pdf",link:"pdf",resource:"workPackage"},{key:"export-atom",link:"atom",resource:"workPackage"}]},TNkA:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("ayqa");class s extends n.a{constructor(){super(...arguments),this.text={placeholder:{startDate:this.I18n.t("js.label_no_start_date"),dueDate:this.I18n.t("js.label_no_due_date")}}}render(e,t){e.innerHTML="";let i=this.createDateDisplayField("startDate"),n=this.createDateDisplayField("dueDate"),s=document.createElement("span");s.textContent=" - ",e.appendChild(i),e.appendChild(s),e.appendChild(n)}createDateDisplayField(e){let t=document.createElement("span"),i=new n.a(e,this.context),s=this.resource[e]?this.timezoneService.formattedDate(this.resource[e]):this.text.placeholder[e];return i.apply(this.resource,this.schema),i.render(t,s),t}}},Tac9:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("IaZ+"),s=i("TrTv"),r=i("SqdZ"),a=i("wZYP"),c=i("fXoL"),o=i("ofXK"),l=i("3Pt+");const d=["selectedPageInput"];function u(e,t){if(1&e){const e=c.ic();c.hc(0,"a",18),c.hc(1,"i",19),c.pc("click",(function(t){c.Lc(e);return c.rc().closeMe(t)})),c.gc(),c.gc()}if(2&e){const e=c.rc();c.Pb(1),c.Qb("title",e.text.close_popup)}}class h extends r.a{constructor(e,t,i,n){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.I18n=n,this.changed=!1,this.showClose=!0,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.page="",this.text={title:this.I18n.t("js.editor.macro.wiki_page_include.button"),hint:this.I18n.t("js.editor.macro.wiki_page_include.hint"),page:this.I18n.t("js.editor.macro.wiki_page_include.page"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.selectedPage=this.page=this.locals.page}applyAndClose(e){this.changed=!0,this.page=this.selectedPage,this.closeMe(e)}ngAfterViewInit(){this.selectedPageInput.nativeElement.focus()}}h.\u0275fac=function(e){return new(e||h)(c.bc(c.q),c.bc(n.a),c.bc(c.i),c.bc(a.a))},h.\u0275cmp=c.Vb({type:h,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&c.Rc(d,!0),2&e)&&(c.Ic(i=c.qc())&&(t.selectedPageInput=i.first))},features:[c.Mb],decls:22,vars:10,consts:[[1,"op-modal--portal","op-modal--macro-modal","ngdialog-theme-openproject"],["tabindex","1",1,"op-modal--modal-container"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-attention",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[1,"form","-vertical",3,"submit"],[1,"form--fieldset"],[3,"textContent"],[1,"form--field"],["for","selected-page",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["tabindex","2","type","text","id","selected-page","name","selected-page",1,"form--select",3,"value","change"],["selectedPageInput",""],[1,"op-modal--modal-footer"],["tabindex","4",1,"op-modal--cancel-button","button",3,"textContent","click"],["tabindex","3",1,"op-modal--submit-button","button","-highlight",3,"textContent","click"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"]],template:function(e,t){1&e&&(c.hc(0,"div",0),c.hc(1,"div",1),c.hc(2,"div",2),c.Tc(3,u,2,1,"a",3),c.cc(4,"h3",4),c.gc(),c.hc(5,"div",5),c.hc(6,"form",6),c.pc("submit",(function(e){return t.applyAndClose(e)})),c.hc(7,"fieldset",7),c.cc(8,"legend",8),c.hc(9,"div",9),c.cc(10,"label",10),c.hc(11,"div",11),c.hc(12,"div",12),c.hc(13,"input",13,14),c.pc("change",(function(e){return t.selectedPage=e.target.value})),c.gc(),c.gc(),c.gc(),c.cc(15,"p",8),c.hc(16,"p"),c.hc(17,"kbd"),c.Vc(18,"project-identifier:my-wiki-page"),c.gc(),c.gc(),c.gc(),c.gc(),c.gc(),c.gc(),c.hc(19,"div",15),c.hc(20,"button",16),c.pc("click",(function(e){return t.closeMe(e)})),c.gc(),c.hc(21,"button",17),c.pc("click",(function(e){return t.applyAndClose(e)})),c.gc(),c.gc(),c.gc(),c.gc()),2&e&&(c.Pb(3),c.wc("ngIf",t.showClose),c.Pb(1),c.wc("textContent",t.text.title),c.Pb(4),c.wc("textContent",t.text.page),c.Pb(2),c.wc("textContent",t.text.page),c.Pb(3),c.wc("value",t.selectedPage),c.Pb(2),c.wc("textContent",t.text.hint),c.Pb(5),c.wc("textContent",t.text.button_cancel),c.Qb("title",t.text.button_cancel),c.Pb(1),c.wc("textContent",t.text.button_save),c.Qb("title",t.text.button_save))},directives:[o.q,l.C,l.n,l.o],encapsulation:2});const p=["codeMirrorPane"];function g(e,t){if(1&e){const e=c.ic();c.hc(0,"a",19),c.hc(1,"i",20),c.pc("click",(function(t){c.Lc(e);return c.rc().closeMe(t)})),c.gc(),c.gc()}if(2&e){const e=c.rc();c.Pb(1),c.Qb("title",e.text.close_popup)}}class f extends r.a{constructor(e,t,i,n){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.I18n=n,this.changed=!1,this.showClose=!0,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this._language="",this.debouncedLanguageLoader=_.debounce(()=>this.loadLanguageAsMode(this.language),300),this.text={title:this.I18n.t("js.editor.macro.code_block.title"),language:this.I18n.t("js.editor.macro.code_block.language"),language_hint:this.I18n.t("js.editor.macro.code_block.language_hint"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.languageClass=t.languageClass||"language-text",this.content=t.content;const s=this.languageClass.match(/language-(\w+)/);this.language=s?s[1]:"text"}applyAndClose(e){this.content=this.codeMirrorInstance.getValue();const t=this.language||"text";this.languageClass="language-"+t,this.changed=!0,this.closeMe(e)}ngAfterViewInit(){i.e(0).then(i.t.bind(null,"VrN/",7)).then(e=>{const t=e.default;this.codeMirrorInstance=t.fromTextArea(this.codeMirrorPane.nativeElement,{lineNumbers:!0,smartIndent:!0,autofocus:!0,value:this.content,mode:""})})}get language(){return this._language}set language(e){this._language=e,this.debouncedLanguageLoader()}loadLanguageAsMode(e){if(!e||"text"===e)return this.updateCodeMirrorMode("");i("TKcc")(`./${e}/${e}.js`).then(()=>{this.updateCodeMirrorMode(e)}).catch(t=>{console.error(`Failed to load language ${e}: ${t}`),this.updateCodeMirrorMode("")})}updateCodeMirrorMode(e){const t=this.codeMirrorInstance;t&&t.setOption("mode",e)}updateLanguage(e){e?e.match(/^\w+$/)?this.language=e:console.error("Not updating non-matching language: "+e):this.language=""}}f.\u0275fac=function(e){return new(e||f)(c.bc(c.q),c.bc(n.a),c.bc(c.i),c.bc(a.a))},f.\u0275cmp=c.Vb({type:f,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&c.Rc(p,!0),2&e)&&(c.Ic(i=c.qc())&&(t.codeMirrorPane=i.first))},features:[c.Mb],decls:20,vars:10,consts:[[1,"op-modal--portal","op-modal--macro-modal","ngdialog-theme-openproject"],["tabindex","1",1,"op-modal--modal-container","-wide"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-attention",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[1,"form","-vertical"],["name","codemirror-element","id","codemirror-element",3,"ngModel"],["codeMirrorPane",""],[1,"form--field"],["for","selected-language",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["tabindex","2","type","text","id","selected-language","name","selected-language",1,"form--select",3,"ngModel","ngModelChange"],["selectedLanguage",""],[3,"textContent"],[1,"op-modal--modal-footer"],["tabindex","4",1,"op-modal--cancel-button","button",3,"textContent","click"],["tabindex","3",1,"op-modal--submit-button","button","-highlight",3,"textContent","click"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"]],template:function(e,t){1&e&&(c.hc(0,"div",0),c.hc(1,"div",1),c.hc(2,"div",2),c.Tc(3,g,2,1,"a",3),c.cc(4,"h3",4),c.gc(),c.hc(5,"div",5),c.hc(6,"form",6),c.cc(7,"textarea",7,8),c.cc(9,"hr"),c.hc(10,"div",9),c.cc(11,"label",10),c.hc(12,"div",11),c.hc(13,"div",12),c.hc(14,"input",13,14),c.pc("ngModelChange",(function(e){return t.updateLanguage(e)})),c.gc(),c.gc(),c.gc(),c.cc(16,"p",15),c.gc(),c.gc(),c.gc(),c.hc(17,"div",16),c.hc(18,"button",17),c.pc("click",(function(e){return t.closeMe(e)})),c.gc(),c.hc(19,"button",18),c.pc("click",(function(e){return t.applyAndClose(e)})),c.gc(),c.gc(),c.gc(),c.gc()),2&e&&(c.Pb(3),c.wc("ngIf",t.showClose),c.Pb(1),c.wc("textContent",t.text.title),c.Pb(3),c.wc("ngModel",t.content),c.Pb(4),c.wc("textContent",t.text.language),c.Pb(3),c.wc("ngModel",t.language),c.Pb(2),c.wc("textContent",t.text.language_hint),c.Pb(2),c.wc("textContent",t.text.button_cancel),c.Qb("title",t.text.button_cancel),c.Pb(1),c.wc("textContent",t.text.button_save),c.Qb("title",t.text.button_save))},directives:[o.q,l.C,l.n,l.o,l.c,l.m,l.p],encapsulation:2});const b=["selectedPageInput"];function m(e,t){if(1&e){const e=c.ic();c.hc(0,"a",22),c.hc(1,"i",23),c.pc("click",(function(t){c.Lc(e);return c.rc().closeMe(t)})),c.gc(),c.gc()}if(2&e){const e=c.rc();c.Pb(1),c.Qb("title",e.text.close_popup)}}class w extends r.a{constructor(e,t,i,n){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.I18n=n,this.changed=!1,this.showClose=!0,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.page="",this.includeParent=!1,this.text={title:this.I18n.t("js.editor.macro.child_pages.button"),hint:this.I18n.t("js.editor.macro.child_pages.hint"),page:this.I18n.t("js.editor.macro.child_pages.page"),include_parent:this.I18n.t("js.editor.macro.child_pages.include_parent"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.selectedPage=this.page=this.locals.page,this.selectedIncludeParent=this.includeParent=this.locals.includeParent}applyAndClose(e){this.changed=!0,this.page=this.selectedPage,this.includeParent=this.selectedIncludeParent,this.closeMe(e)}ngAfterViewInit(){this.selectedPageInput.nativeElement.focus()}updateIncludeParent(e){this.selectedIncludeParent=e}}w.\u0275fac=function(e){return new(e||w)(c.bc(c.q),c.bc(n.a),c.bc(c.i),c.bc(a.a))},w.\u0275cmp=c.Vb({type:w,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&c.Rc(b,!0),2&e)&&(c.Ic(i=c.qc())&&(t.selectedPageInput=i.first))},features:[c.Mb],decls:26,vars:12,consts:[[1,"op-modal--portal","op-modal--macro-modal","ngdialog-theme-openproject"],["tabindex","1",1,"op-modal--modal-container"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-attention",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[1,"form","-vertical",3,"submit"],[1,"form--fieldset"],[3,"textContent"],[1,"form--field"],["for","selected-page",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["tabindex","2","type","text","id","selected-page","name","selected-page","placeholder","my-project:my-page",1,"form--select",3,"value","change"],["selectedPageInput",""],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["tabindex","3","type","checkbox","id","include-parent","name","include-parent",1,"form--check-box",3,"ngModel","ngModelChange"],["parentIncludedInput",""],[1,"op-modal--modal-footer"],["tabindex","4",1,"op-modal--cancel-button","button",3,"textContent","click"],["tabindex","3",1,"op-modal--submit-button","button","-highlight",3,"textContent","click"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"]],template:function(e,t){1&e&&(c.hc(0,"div",0),c.hc(1,"div",1),c.hc(2,"div",2),c.Tc(3,m,2,1,"a",3),c.cc(4,"h3",4),c.gc(),c.hc(5,"div",5),c.hc(6,"form",6),c.pc("submit",(function(e){return t.applyAndClose(e)})),c.hc(7,"fieldset",7),c.cc(8,"legend",8),c.hc(9,"div",9),c.cc(10,"label",10),c.hc(11,"div",11),c.hc(12,"div",12),c.hc(13,"input",13,14),c.pc("change",(function(e){return t.selectedPage=e.target.value})),c.gc(),c.gc(),c.gc(),c.gc(),c.hc(15,"div",9),c.hc(16,"div",11),c.hc(17,"label",15),c.hc(18,"div",16),c.hc(19,"input",17,18),c.pc("ngModelChange",(function(e){return t.updateIncludeParent(e)})),c.gc(),c.gc(),c.Vc(21),c.gc(),c.gc(),c.gc(),c.cc(22,"p",8),c.gc(),c.gc(),c.gc(),c.hc(23,"div",19),c.hc(24,"button",20),c.pc("click",(function(e){return t.closeMe(e)})),c.gc(),c.hc(25,"button",21),c.pc("click",(function(e){return t.applyAndClose(e)})),c.gc(),c.gc(),c.gc(),c.gc()),2&e&&(c.Pb(3),c.wc("ngIf",t.showClose),c.Pb(1),c.wc("textContent",t.text.title),c.Pb(4),c.wc("textContent",t.text.page),c.Pb(2),c.wc("textContent",t.text.page),c.Pb(3),c.wc("value",t.selectedPage),c.Pb(6),c.wc("ngModel",t.selectedIncludeParent),c.Pb(2),c.Xc(" ",t.text.include_parent," "),c.Pb(1),c.wc("textContent",t.text.hint),c.Pb(2),c.wc("textContent",t.text.button_cancel),c.Qb("title",t.text.button_cancel),c.Pb(1),c.wc("textContent",t.text.button_save),c.Qb("title",t.text.button_save))},directives:[o.q,l.C,l.n,l.o,l.a,l.m,l.p],encapsulation:2});class v{constructor(e,t){this.opModalService=e,this.injector=t}configureWorkPackageButton(e,t){return new Promise((i,n)=>{this.opModalService.show(s.a,this.injector,{type:e,classes:t}).closingEvent.subscribe(e=>{e.changed&&i({type:e.type,classes:e.classes})})})}configureWikiPageInclude(e){return new Promise((t,i)=>{const n=e||"";this.opModalService.show(h,this.injector,{page:n}).closingEvent.subscribe(e=>{e.changed&&t(e.page)})})}editCodeBlock(e,t){return new Promise((i,n)=>{this.opModalService.show(f,this.injector,{content:e,languageClass:t}).closingEvent.subscribe(e=>{e.changed&&i({languageClass:e.languageClass,content:e.content})})})}configureChildPages(e,t){return new Promise((i,n)=>{this.opModalService.show(w,this.injector,{page:e,includeParent:t}).closingEvent.subscribe(e=>{e.changed&&i({page:e.page,includeParent:e.includeParent})})})}}v.\u0275fac=function(e){return new(e||v)(c.lc(n.b),c.lc(c.A))},v.\u0275prov=c.Xb({token:v,factory:v.\u0275fac})},Tcty:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));i("ii2/");var n=i("Jui0"),s=i("wZYP"),r=i("fXoL"),a=i("ofXK"),c=i("oLh2"),o=i("Wo/B");function l(e,t){if(1&e&&r.cc(0,"revision-activity",4),2&e){const e=r.rc();r.wc("workPackage",e.workPackage)("activity",e.activity)("activityNo",e.activityNo)}}function d(e,t){if(1&e&&r.cc(0,"user-activity",5),2&e){const e=r.rc();r.wc("workPackage",e.workPackage)("activity",e.activity)("activityNo",e.activityNo)("isInitial",e.isInitial)}}class u{constructor(e,t){this.PathHelper=e,this.I18n=t}ngOnInit(){this.projectId=this.workPackage.project.idFromLink,this.activityType=this.activity._type}}u.\u0275fac=function(e){return new(e||u)(r.bc(n.a),r.bc(s.a))},u.\u0275cmp=r.Vb({type:u,selectors:[["activity-entry"]],inputs:{workPackage:"workPackage",activity:"activity",activityNo:"activityNo",isInitial:"isInitial"},decls:4,vars:3,consts:[[3,"id"],[3,"ngSwitch"],[3,"workPackage","activity","activityNo",4,"ngSwitchCase"],[3,"workPackage","activity","activityNo","isInitial",4,"ngSwitchDefault"],[3,"workPackage","activity","activityNo"],[3,"workPackage","activity","activityNo","isInitial"]],template:function(e,t){1&e&&(r.hc(0,"div",0),r.hc(1,"div",1),r.Tc(2,l,1,3,"revision-activity",2),r.Tc(3,d,1,4,"user-activity",3),r.gc(),r.gc()),2&e&&(r.yc("id","activity-",t.activityNo,""),r.Pb(1),r.wc("ngSwitch",t.activityType),r.Pb(1),r.wc("ngSwitchCase","Revision"))},directives:[a.u,a.v,a.w,c.a,o.a],encapsulation:2})},TjuE:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"e",(function(){return s})),i.d(t,"c",(function(){return r})),i.d(t,"f",(function(){return a})),i.d(t,"b",(function(){return c})),i.d(t,"d",(function(){return o}));const n="Demo project",s="Scrum project",r="openProject-onboardingTour";function a(e,t,i){new MutationObserver((function(t,n){if(jQuery(e).length)return n.disconnect(),void i()})).observe(jQuery(t)[0],{childList:!0,subtree:!0})}function c(){let e=[],t=jQuery(".widget-box.welcome a:contains("+n+")"),i=jQuery(".widget-box.welcome a:contains("+s+")");return t.length&&e.push(t),i.length&&e.push(i),e}function o(e){e.preventDefault(),e.stopPropagation()}},TrTv:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("SqdZ"),s=i("IaZ+"),r=i("wZYP"),a=i("sjKJ"),c=i("CNq7"),o=i("fXoL"),l=i("ofXK"),d=i("3Pt+");const u=["typeSelect"];function h(e,t){if(1&e){const e=o.ic();o.hc(0,"a",25),o.hc(1,"i",26),o.pc("click",(function(t){o.Lc(e);return o.rc().closeMe(t)})),o.gc(),o.gc()}if(2&e){const e=o.rc();o.Pb(1),o.Qb("title",e.text.close_popup)}}function p(e,t){if(1&e&&o.cc(0,"option",15),2&e){const e=t.$implicit,i=o.rc();o.wc("textContent",e.name)("selected",i.selectedType===e.name)("value",e.name)}}class g extends n.a{constructor(e,t,i,n,s,r){super(t,s,e),this.elementRef=e,this.locals=t,this.currentProject=i,this.apiV3Service=n,this.cdRef=s,this.I18n=r,this.changed=!1,this.showClose=!0,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.type="",this.classes="",this.text={title:this.I18n.t("js.editor.macro.work_package_button.button"),none:this.I18n.t("js.label_none"),selected_type:this.I18n.t("js.editor.macro.work_package_button.type"),button_style:this.I18n.t("js.editor.macro.work_package_button.button_style"),button_style_hint:this.I18n.t("js.editor.macro.work_package_button.button_style_hint"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.selectedType=this.type=this.locals.type,this.classes=this.locals.classes,this.buttonStyle="button"===this.classes,this.apiV3Service.withOptionalProject(this.currentProject.identifier).work_packages.form.post({}).subscribe(e=>{this.availableTypes=e.schema.type.allowedValues})}applyAndClose(e){this.changed=!0,this.classes=this.buttonStyle?"button":"",this.type=this.selectedType,this.closeMe(e)}ngAfterViewInit(){this.typeSelect.nativeElement.focus()}}g.\u0275fac=function(e){return new(e||g)(o.bc(o.q),o.bc(s.a),o.bc(a.a),o.bc(c.a),o.bc(o.i),o.bc(r.a))},g.\u0275cmp=o.Vb({type:g,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&o.Rc(u,!0),2&e)&&(o.Ic(i=o.qc())&&(t.typeSelect=i.first))},features:[o.Mb],decls:27,vars:14,consts:[[1,"op-modal--portal","op-modal--macro-modal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","loading-indicator--location"],[1,"op-modal--modal-header"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"icon-context","icon-attention",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[1,"form","-vertical",3,"submit"],[1,"form--fieldset"],[3,"textContent"],[1,"form--field"],["for","selected-type",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["id","selected-type","tabindex","1","name","selected-type",1,"form--select",3,"change"],["typeSelect",""],[3,"textContent","selected","value"],[3,"textContent","selected","value",4,"ngFor","ngForOf"],[1,"form--field","-wide-label"],[1,"form--field-container","-vertical"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","tabindex","2","id","wp_button_macro_style","name","button_style",3,"checked","change"],[1,"op-modal--modal-footer"],["tabindex","4",1,"op-modal--cancel-button","button",3,"textContent","click"],["tabindex","3",1,"op-modal--submit-button","button","-highlight",3,"textContent","click"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.hc(2,"div",2),o.Tc(3,h,2,1,"a",3),o.cc(4,"h3",4),o.gc(),o.hc(5,"div",5),o.hc(6,"form",6),o.pc("submit",(function(e){return t.applyAndClose(e)})),o.hc(7,"fieldset",7),o.cc(8,"legend",8),o.hc(9,"div",9),o.cc(10,"label",10),o.hc(11,"div",11),o.hc(12,"div",12),o.hc(13,"select",13,14),o.pc("change",(function(e){return t.selectedType=e.target.value})),o.cc(15,"option",15),o.Tc(16,p,1,3,"option",16),o.gc(),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(17,"div",17),o.hc(18,"div",18),o.hc(19,"label",19),o.hc(20,"div",20),o.hc(21,"input",21),o.pc("change",(function(e){return t.buttonStyle=e.target.checked})),o.gc(),o.gc(),o.Vc(22),o.gc(),o.gc(),o.gc(),o.cc(23,"p",8),o.gc(),o.gc(),o.hc(24,"div",22),o.hc(25,"button",23),o.pc("click",(function(e){return t.closeMe(e)})),o.gc(),o.hc(26,"button",24),o.pc("click",(function(e){return t.applyAndClose(e)})),o.gc(),o.gc(),o.gc(),o.gc()),2&e&&(o.Pb(3),o.wc("ngIf",t.showClose),o.Pb(1),o.wc("textContent",t.text.title),o.Pb(4),o.wc("textContent",t.text.selected_type),o.Pb(2),o.wc("textContent",t.text.selected_type),o.Pb(5),o.wc("textContent",t.text.none)("selected",!t.selectedType),o.Pb(1),o.wc("ngForOf",t.availableTypes),o.Pb(5),o.wc("checked",t.buttonStyle),o.Pb(1),o.Xc(" ",t.text.button_style," "),o.Pb(1),o.wc("textContent",t.text.button_style_hint),o.Pb(2),o.wc("textContent",t.text.button_cancel),o.Qb("title",t.text.button_cancel),o.Pb(1),o.wc("textContent",t.text.button_save),o.Qb("title",t.text.button_save))},directives:[l.q,d.C,d.n,d.o,d.r,d.B,l.p],encapsulation:2})},"U/vl":function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t,i){this.page=e,this.total=t,this.perPage=i}getLowerPageBound(){return this.perPage*(this.page-1)+1}getUpperPageBound(e){return Math.min(this.perPage*this.page,e)}nextPage(){this.page+=1}previousPage(){this.page-=1}}},U1xf:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e){this.tableVisible=!0,this.compactTableStyle=!1,this.actionsColumnEnabled=!0,this.contextMenuEnabled=!0,this.columnMenuEnabled=!0,this.projectContext=!0,this.projectIdentifier=null,this.inlineCreateEnabled=!0,this.hierarchyToggleEnabled=!0,this.dragAndDropEnabled=!1,this.isEmbedded=!1,this.isCardView=!1,this.withFilters=!1,this.filtersExpanded=!1,this.showFilterButton=!1,this.filterButtonText=I18n.t("js.button_filter"),_.each(e,(e,t)=>{this[t]=e})}}},UUNb:function(e,t,i){"use strict";i.d(t,"a",(function(){return j}));var n=i("DhiE"),s=i("iMRi"),r=i("SqdZ"),a=i("IaZ+"),c=i("Y/CA"),o=i("iB+3"),l=i("wZYP"),d=i("ABwi"),u=i("pQre"),h=i("qc15"),p=i("fXoL"),g=i("ofXK"),f=i("3Pt+");function b(e,t){if(1&e&&(p.hc(0,"li"),p.Vc(1," #"),p.cc(2,"span",11),p.cc(3,"span",11),p.gc()),2&e){const e=t.$implicit;p.Pb(2),p.wc("textContent",e.id),p.Pb(1),p.wc("textContent",e.subject||"")}}function m(e,t){if(1&e&&(p.hc(0,"div"),p.hc(1,"p",12),p.cc(2,"span",13),p.cc(3,"strong",11),p.Vc(4,": "),p.cc(5,"span",11),p.gc(),p.hc(6,"ul"),p.Tc(7,b,4,2,"li",14),p.gc(),p.hc(8,"p"),p.cc(9,"span",11),p.gc(),p.gc()),2&e){const e=p.rc(2);p.Pb(3),p.wc("textContent",e.text.warning),p.Pb(2),p.wc("textContent",e.text.hasChildren(e.singleWorkPackage)),p.Pb(2),p.wc("ngForOf",e.singleWorkPackageChildren),p.Pb(2),p.wc("textContent",e.text.deletesChildren)}}function w(e,t){if(1&e&&(p.fc(0),p.hc(1,"p"),p.cc(2,"span",11),p.cc(3,"br"),p.hc(4,"strong"),p.Vc(5),p.gc(),p.gc(),p.Tc(6,m,10,4,"div",7),p.ec()),2&e){const e=p.rc();p.Pb(2),p.wc("textContent",e.text.text),p.Pb(3),p.Zc(" ",e.singleWorkPackage.type.name," #",e.singleWorkPackage.id," ",e.singleWorkPackage.subject," "),p.Pb(1),p.wc("ngIf",e.singleWorkPackageChildren&&e.singleWorkPackageChildren.length>0)}}function v(e,t){if(1&e&&(p.hc(0,"strong"),p.Vc(1),p.gc()),2&e){const e=p.rc().$implicit,t=p.rc(2);p.Pb(1),p.Xc(" (+ ",t.text.childCount(e),") ")}}function y(e,t){if(1&e&&(p.hc(0,"li"),p.Vc(1," #"),p.cc(2,"span",11),p.Vc(3," "),p.cc(4,"span",11),p.Tc(5,v,2,1,"strong",7),p.gc()),2&e){const e=t.$implicit,i=p.rc(2);p.Pb(2),p.wc("textContent",e.id),p.Pb(2),p.wc("textContent",e.subject),p.Pb(1),p.wc("ngIf",i.children(e).length>0)}}function k(e,t){if(1&e&&(p.fc(0),p.hc(1,"p",12),p.cc(2,"span",13),p.cc(3,"strong",11),p.gc(),p.hc(4,"ul"),p.Tc(5,y,6,3,"li",14),p.gc(),p.ec()),2&e){const e=p.rc();p.Pb(3),p.wc("textContent",e.text.text),p.Pb(2),p.wc("ngForOf",e.workPackages)}}function C(e,t){if(1&e){const e=p.ic();p.hc(0,"div"),p.hc(1,"label",15),p.hc(2,"div",16),p.hc(3,"input",17),p.pc("ngModelChange",(function(t){p.Lc(e);return p.rc().childrenDeletionConfirmed=t})),p.gc(),p.gc(),p.Vc(4),p.gc(),p.gc()}if(2&e){const e=p.rc();p.Pb(3),p.wc("ngModel",e.childrenDeletionConfirmed),p.Pb(1),p.Xc(" ",e.text.label_confirm_children_deletion," ")}}class j extends r.a{constructor(e,t,i,n,s,r,a,c,o,l,d){super(i,s,e),this.elementRef=e,this.WorkPackageService=t,this.locals=i,this.I18n=n,this.cdRef=s,this.$state=r,this.states=a,this.wpTableFocus=c,this.wpListService=o,this.notificationService=l,this.backRoutingService=d,this.busy=!1,this.childrenDeletionConfirmed=!1,this.text={label_visibility_settings:this.I18n.t("js.label_visibility_settings"),button_save:this.I18n.t("js.modals.button_save"),confirm:this.I18n.t("js.button_confirm"),warning:this.I18n.t("js.label_warning"),cancel:this.I18n.t("js.button_cancel"),close:this.I18n.t("js.close_popup_title"),label_confirm_children_deletion:this.I18n.t("js.modals.destroy_work_package.confirm_deletion_children")}}ngOnInit(){super.ngOnInit(),this.workPackages=this.locals.workPackages,this.workPackageLabel=this.I18n.t("js.units.workPackage",{count:this.workPackages.length}),1===this.workPackages.length&&(this.singleWorkPackage=this.workPackages[0],this.singleWorkPackageChildren=this.singleWorkPackage.children),this.text.title=this.I18n.t("js.modals.destroy_work_package.title",{label:this.workPackageLabel}),this.text.text=this.I18n.t("js.modals.destroy_work_package.text",{label:this.workPackageLabel,count:this.workPackages.length}),this.text.childCount=e=>{const t=this.children(e).length;return this.I18n.t("js.units.child_work_packages",{count:t})},this.text.hasChildren=e=>this.I18n.t("js.modals.destroy_work_package.has_children",{childUnits:this.text.childCount(e)}),this.text.deletesChildren=this.I18n.t("js.modals.destroy_work_package.deletes_children")}get blockedDueToUnconfirmedChildren(){return this.mustConfirmChildren&&!this.childrenDeletionConfirmed}get mustConfirmChildren(){if(this.singleWorkPackage&&this.singleWorkPackageChildren){this.singleWorkPackageChildren.length}return!!_.find(this.workPackages,e=>e.children&&e.children.length>0)}confirmDeletion(e){return this.busy||this.blockedDueToUnconfirmedChildren||(this.busy=!0,this.WorkPackageService.performBulkDelete(this.workPackages.map(e=>e.id),!0).then(()=>{this.busy=!1,this.closeMe(e),this.wpTableFocus.clear("Clearing after destroying work packages"),this.$state.current.data.baseRoute&&this.backRoutingService.goBack(!0)}).catch(()=>{this.busy=!1})),!1}children(e){return e.hasOwnProperty("children")?e.children:[]}}j.\u0275fac=function(e){return new(e||j)(p.bc(p.q),p.bc(d.a),p.bc(a.a),p.bc(l.a),p.bc(p.i),p.bc(o.StateService),p.bc(s.a),p.bc(c.a),p.bc(n.a),p.bc(h.a),p.bc(u.a))},j.\u0275cmp=p.Vb({type:j,selectors:[["ng-component"]],features:[p.Mb],decls:13,vars:8,consts:[[1,"op-modal--portal"],["id","wp_destroy_modal","data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","wp-table--configuration-modal","loading-indicator--location","-highlight","-danger-zone"],[1,"op-modal--modal-header"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[1,"icon-context","icon-attention",3,"textContent"],[1,"op-modal--modal-body"],[4,"ngIf"],[1,"op-modal--modal-footer"],[1,"button","-danger",3,"textContent","click"],[1,"button",3,"textContent","click"],[3,"textContent"],[1,"danger-zone--warning"],[1,"icon-context","icon-error"],[4,"ngFor","ngForOf"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","name","confirm-children-deletion","id","confirm-children-deletion",1,"form--check-box",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(p.hc(0,"div",0),p.hc(1,"div",1),p.hc(2,"div",2),p.hc(3,"a",3),p.hc(4,"i",4),p.pc("click",(function(e){return t.closeMe(e)})),p.gc(),p.gc(),p.cc(5,"h3",5),p.gc(),p.hc(6,"div",6),p.Tc(7,w,7,5,"ng-container",7),p.Tc(8,k,6,2,"ng-container",7),p.Tc(9,C,5,2,"div",7),p.gc(),p.hc(10,"div",8),p.hc(11,"button",9),p.pc("click",(function(e){return t.confirmDeletion(e)})),p.gc(),p.hc(12,"button",10),p.pc("click",(function(e){return t.closeMe(e)})),p.gc(),p.gc(),p.gc(),p.gc()),2&e&&(p.Pb(4),p.Qb("title",t.text.close),p.Pb(1),p.wc("textContent",t.text.title),p.Pb(2),p.wc("ngIf",t.singleWorkPackage),p.Pb(1),p.wc("ngIf",t.workPackages.length>1),p.Pb(1),p.wc("ngIf",t.mustConfirmChildren),p.Pb(2),p.wc("textContent",t.text.confirm),p.Qb("disabled",t.busy||t.blockedDueToUnconfirmedChildren||void 0),p.Pb(1),p.wc("textContent",t.text.cancel))},directives:[g.q,g.p,f.a,f.m,f.p],encapsulation:2})},Uprc:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("wZYP"),s=i("AeZM"),r=i("wyKs"),a=i("EnRq"),c=i("fXoL"),o=i("3Pt+"),l=i("N5AO"),d=i("ofXK");function u(e,t){if(1&e&&c.cc(0,"span",6),2&e){const e=c.rc();c.wc("textContent",e.text.display_mode.hierarchy_hint)}}function h(e,t){if(1&e&&c.cc(0,"option",15),2&e){const e=t.$implicit,i=c.rc();c.wc("textContent",e.name)("selected",i.currentGroup&&i.currentGroup.href===e.href)("value",e.href)}}class p{constructor(e,t,i,n,s){this.injector=e,this.I18n=t,this.wpTableGroupBy=i,this.wpTableHierarchies=n,this.wpTableSums=s,this.displayMode="default",this.availableGroups=[],this.displaySums=!1,this.text={choose_mode:this.I18n.t("js.work_packages.table_configuration.choose_display_mode"),label_group_by:this.I18n.t("js.label_group_by"),title:this.I18n.t("js.label_group_by"),placeholder:this.I18n.t("js.placeholders.default"),please_select:this.I18n.t("js.placeholders.selection"),default:"\u2014 "+this.I18n.t("js.work_packages.table_configuration.default"),display_sums:this.I18n.t("js.work_packages.query.display_sums"),display_sums_hint:"\u2014 "+this.I18n.t("js.work_packages.table_configuration.display_sums_hint"),display_mode:{default:this.I18n.t("js.work_packages.table_configuration.default_mode"),grouped:this.I18n.t("js.work_packages.table_configuration.grouped_mode"),hierarchy:this.I18n.t("js.work_packages.table_configuration.hierarchy_mode"),hierarchy_hint:"\u2014 "+this.I18n.t("js.work_packages.table_configuration.hierarchy_hint")}}}onSave(){this.wpTableHierarchies.setEnabled("hierarchy"===this.displayMode);let e="grouped"===this.displayMode?this.currentGroup:null;this.wpTableGroupBy.update(e),this.wpTableSums.setEnabled(this.displaySums)}updateGroup(e){this.displayMode="grouped",this.currentGroup=_.find(this.availableGroups,t=>t.href===e)||null}ngOnInit(){this.wpTableHierarchies.isEnabled?this.displayMode="hierarchy":this.wpTableGroupBy.current&&(this.displayMode="grouped"),this.displaySums=this.wpTableSums.current,this.wpTableGroupBy.onReady().then(()=>{this.availableGroups=_.sortBy(this.wpTableGroupBy.available,"name"),this.currentGroup=this.wpTableGroupBy.current})}}p.\u0275fac=function(e){return new(e||p)(c.bc(c.A),c.bc(n.a),c.bc(s.a),c.bc(r.a),c.bc(a.a))},p.\u0275cmp=c.Vb({type:p,selectors:[["ng-component"]],decls:39,vars:16,consts:[[3,"textContent"],[1,"form--field","-full-width"],[1,"form--field-container"],[1,"option-label"],["type","radio","value","default","name","display_mode_switch",3,"ngModel","ngModelChange"],["icon-classes","icon-no-hierarchy"],[1,"form--inline-instructions",3,"textContent"],["type","radio","value","hierarchy","name","display_mode_switch",3,"ngModel","ngModelChange"],["icon-classes","icon-hierarchy"],["class","form--inline-instructions",3,"textContent",4,"ngIf"],["type","radio","value","grouped","name","display_mode_switch",3,"ngModel","ngModelChange"],["icon-classes","icon-group-by"],["id","selected_grouping","name","selected_grouping",1,"form--select","form--inline-select",3,"change"],[3,"textContent","selected","value",4,"ngFor","ngForOf"],["type","checkbox","name","display_sums_switch",3,"checked","change"],[3,"textContent","selected","value"]],template:function(e,t){1&e&&(c.hc(0,"div"),c.hc(1,"form"),c.cc(2,"p",0),c.hc(3,"div",1),c.hc(4,"div",2),c.hc(5,"label",3),c.hc(6,"input",4),c.pc("ngModelChange",(function(e){return t.displayMode=e})),c.gc(),c.cc(7,"op-icon",5),c.Vc(8," "),c.cc(9,"span",0),c.Vc(10," "),c.cc(11,"span",6),c.gc(),c.gc(),c.gc(),c.hc(12,"div",1),c.hc(13,"div",2),c.hc(14,"label",3),c.hc(15,"input",7),c.pc("ngModelChange",(function(e){return t.displayMode=e})),c.gc(),c.cc(16,"op-icon",8),c.Vc(17," "),c.cc(18,"span",0),c.Vc(19," "),c.Tc(20,u,1,1,"span",9),c.gc(),c.gc(),c.gc(),c.hc(21,"div",1),c.hc(22,"div",2),c.hc(23,"label",3),c.hc(24,"input",10),c.pc("ngModelChange",(function(e){return t.displayMode=e})),c.gc(),c.cc(25,"op-icon",11),c.Vc(26," "),c.cc(27,"span",0),c.Vc(28," "),c.hc(29,"select",12),c.pc("change",(function(e){return t.updateGroup(e.target.value)})),c.Tc(30,h,1,3,"option",13),c.gc(),c.gc(),c.gc(),c.gc(),c.cc(31,"hr"),c.hc(32,"div"),c.hc(33,"div",1),c.hc(34,"div",2),c.hc(35,"label",3),c.hc(36,"input",14),c.pc("change",(function(){return t.displaySums=!t.displaySums})),c.gc(),c.Vc(37),c.cc(38,"span",6),c.gc(),c.gc(),c.gc(),c.gc(),c.gc(),c.gc()),2&e&&(c.Pb(2),c.wc("textContent",t.text.choose_mode),c.Pb(4),c.wc("ngModel",t.displayMode),c.Pb(1),c.Qb("icon-title",t.text.display_mode.default),c.Pb(2),c.wc("textContent",t.text.display_mode.default),c.Pb(2),c.wc("textContent",t.text.default),c.Pb(4),c.wc("ngModel",t.displayMode),c.Pb(1),c.Qb("icon-title",t.text.display_mode.hierarchy),c.Pb(2),c.wc("textContent",t.text.display_mode.hierarchy),c.Pb(2),c.wc("ngIf","hierarchy"===t.displayMode),c.Pb(4),c.wc("ngModel",t.displayMode),c.Pb(1),c.Qb("icon-title",t.text.label_group_by),c.Pb(2),c.wc("textContent",t.text.label_group_by),c.Pb(3),c.wc("ngForOf",t.availableGroups),c.Pb(6),c.wc("checked",t.displaySums),c.Pb(1),c.Xc(" ",t.text.display_sums," "),c.Pb(1),c.wc("textContent",t.text.display_sums_hint))},directives:[o.C,o.n,o.o,o.u,o.c,o.m,o.p,l.a,d.q,d.p,o.r,o.B],encapsulation:2})},Uyc6:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("mrSG"),s=i("zqrF"),r=i("E2tj"),a=i("Jui0"),c=i("iMRi"),o=i("qHU1");const l=-2147483647,d=2147483647,u=16384;class h{constructor(e,t,i,n,s){this.order=e,this.positions=t,this.wpId=i,this.index=n,this.fromIndex=s,this.delta={}}buildDelta(){return Object(o.b)(`Building delta for ${this.wpId}@${this.index}`,()=>{this.isAscendingOrder()?this.buildInsertPosition():this.rebuildPositions()}),Object(o.a)("Order DELTA was built as %O",this.delta),this.delta}isAscendingOrder(){let e;for(let t=0,i=this.order.length;t<i;t++){const i=this.order[t],n=this.positions[i];if(t!==this.index)if(void 0!==e&&void 0!==n){if(n<e)return!1}else e=n}return!0}rebuildPositions(){let[e,t]=this.minMaxPositions;this.redistribute(e,t)}buildInsertPosition(){if(this.order.length<=1&&void 0===this.positions[this.wpId])return void(this.delta[this.wpId]=0);if(null!==this.fromIndex&&1===Math.abs(this.fromIndex-this.index)&&this.positionSwap())return;if(0===this.index)return this.insertAsFirst();const e=this.buildUpPredecessorPosition();if(e>=d)return Object(o.a)("Predecessor position is at max order, need to reorder"),this.reorderedInsert();const t=this.positionFor(this.index+1);if(void 0===t)return void(this.delta[this.wpId]=e+8192);if(t>=d)return Object(o.a)("Successor position is at max order, need to reorder"),this.reorderedInsert();const i=Math.floor((t-e)/2);if(i<1)return Object(o.a)("Cannot insert at optimal position, no space left. Need to reorder"),this.reorderedInsert();this.delta[this.wpId]=e+i}insertAsFirst(){const e=this.positionFor(this.index+1);this.delta[this.wpId]=void 0===e?0:e-8192}positionSwap(){const e=this.positionFor(this.index),t=this.order[this.fromIndex],i=this.positionFor(this.fromIndex);return void 0!==e&&void 0!==i&&(this.delta[this.wpId]=i,this.delta[t]=e,!0)}buildUpPredecessorPosition(){let e=-16384;for(let t=0;t<this.index;t++){const i=this.order[t],n=this.positions[i];e=void 0===n?this.delta[i]=e+u:n}return e}positionFor(e){const t=this.order[e];return this.livePosition(t)}livePosition(e){return void 0===this.delta[e]?this.positions[e]:this.delta[e]}reorderedInsert(){let e=this.firstPosition,t=this.lastPosition;this.redistribute(e,t)}redistribute(e,t){const i=this.order.length;let n=Math.floor((t-e)/(i-1));if(n<1){if(t+i<=d)t+=i;else{if(!(e-i>=l))throw"Elements cannot be moved further and no space is left. Too many elements";e-=i}n=Math.floor((t-e)/(i-1))}for(let s=0;s<i;s++){const t=this.order[s];this.delta[t]=e+s*n}}get minMaxPositions(){let e=d,t=l,i=!1;for(let n=this.order.length-1;n>=0;n--){let s=this.order[n],r=this.livePosition(s);void 0!==r&&(e=Math.min(r,e),t=Math.max(r,t),i=!0)}return i&&e!==t?[e,t]:[0,this.order.length*u]}get firstPosition(){const e=this.order[0];return this.livePosition(e)}get lastPosition(){for(let e=this.order.length-1;e>=0;e--){let t=this.order[e],i=this.livePosition(t);if(void 0!==i)return i}}}var p=i("IzEk"),g=i("6yP5"),f=i("x5It"),b=i("CNq7"),m=i("fXoL");class w extends s.a{constructor(e,t,i,n,s,r){super(e),this.querySpace=e,this.apiV3Service=t,this.states=i,this.causedUpdates=n,this.wpTableSortBy=s,this.pathHelper=r}initialize(e,t,i){return!e.persisted&&this.positions.hasValue()&&this.applyToQuery(e),this.wpTableSortBy.isManualSortingMode?this.withLoadedPositions():Promise.resolve()}move(e,t,i){return Object(n.b)(this,void 0,void 0,(function*(){let n=e.findIndex(e=>e===t);return e.splice(n,1),e.splice(i,0,t),yield this.assignPosition(e,t,i,n),e}))}remove(e,t){return _.remove(e,e=>e===t),this.update({[t]:-1}),e}add(e,t,i=-1){return Object(n.b)(this,void 0,void 0,(function*(){return-1===i?(e.push(t),i=e.length-1):e.splice(i,0,t),yield this.assignPosition(e,t,i),e}))}get applicable(){return this.currentQuery.persisted}get currentQuery(){return this.querySpace.query.value}assignPosition(e,t,i,s=null){return Object(n.b)(this,void 0,void 0,(function*(){const n=yield this.withLoadedPositions(),r=new h(e,n,t,i,s).buildDelta();yield this.update(r)}))}get positions(){return this.updatesState}update(e){return Object(n.b)(this,void 0,void 0,(function*(){let t=this.positions.getValueOr({});if(this.positions.putValue(Object.assign(Object.assign({},t),e)),this.currentQuery.persisted){const t=yield this.apiV3Service.queries.id(this.currentQuery).order.update(e);this.currentQuery.updatedAt=t,this.causedUpdates.add(this.currentQuery)}this.applyToQuery(this.currentQuery),this.querySpace.query.putValue(this.currentQuery)}))}withLoadedPositions(){if(this.currentQuery.persisted){(this.positions.value==={}||this.positions.isValueOlderThan(6e4))&&this.positions.clear("Clearing old positions value"),this.positions.putFromPromiseIfPristine(()=>this.apiV3Service.queries.id(this.currentQuery).order.get())}else this.positions.isPristine()&&this.positions.putValue({});return this.positions.values$().pipe(Object(p.a)(1)).toPromise()}valueFromQuery(e){}orderedWorkPackages(){const e=this.querySpace.results.value.elements.map(e=>this.states.workPackages.get(e.id).getValueOr(e));if(this.currentQuery.persisted||this.positions.isPristine())return e;{const t=this.positions.value;return _.sortBy(e,e=>{const i=t[e.id];return void 0!==i?i:d})}}applyToQuery(e){return e.orderedWorkPackages=this.positions.getValueOr({}),!1}hasChanged(e){return!1}}w.\u0275fac=function(e){return new(e||w)(m.lc(r.a),m.lc(b.a),m.lc(c.a),m.lc(f.a),m.lc(g.a),m.lc(a.a))},w.\u0275prov=m.Xb({token:w,factory:w.\u0275fac})},V0Il:function(e,t,i){"use strict";i.d(t,"a",(function(){return Ge}));var n=i("fXoL"),s=i("wZYP"),r=i("mrSG"),a=i("qHU1"),c=i("iMRi"),o=i("KEdw"),l=i("SKFm"),d=i("6XbZ"),u=i("Yg+W"),h=i("GjwL"),p=i("r0MM");class g extends u.a{constructor(e){super(),this.injector=e}get EVENT(){return"click.table.cell, keydown.table.cell"}get SELECTOR(){return`.${o.b}.${o.d}`}eventScope(e){return jQuery(e.workPackageTable.tableAndTimelineContainer)}processEvent(e,t){Object(a.a)("Starting editing on cell: ",t.target),t.preventDefault();let i=jQuery(t.target).closest("."+o.b),n=i.data("fieldName");if(!n)return Object(a.a)("Click handled by cell not a field? ",t.target),!0;const s=i.closest("."+d.c),r=s.data("workPackageId"),c=this.states.workPackages.get(r).value,l=s.data("classIdentifier"),u=e.editing.startEditing(c,l),p=h.a.getPosition(t);return u.activate(n).then(e=>{e.$onUserActivate.next(),e.focus(p)}).catch(()=>i.addClass(o.e)),!1}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",c.a)],g.prototype,"states",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",l.a)],g.prototype,"halEditing",void 0);var f=i("0Usb"),b=i("FB4C");class m extends u.a{constructor(e){super(),this.injector=e}get EVENT(){return"click.table.relationsCell, keydown.table.relationsCell"}get SELECTOR(){return"."+f.b}eventScope(e){return jQuery(e.workPackageTable.tableAndTimelineContainer)}processEvent(e,t){Object(a.a)("Handled click on relation cell %o",t.target),t.preventDefault();const i=jQuery(t.target).closest("."+f.c).data("columnId"),n=jQuery(t.target).closest("."+d.c).data("workPackageId");return this.wpTableRelationColumns.getExpandFor(n)===i?this.wpTableRelationColumns.collapse(n):this.wpTableRelationColumns.setExpandFor(n,i),!1}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",b.a)],m.prototype,"wpTableRelationColumns",void 0);var w=i("cd/7"),v=i("4lR/"),y=i("qtzK"),k=i("7xci");class C extends y.a{constructor(e,t,i,n={},s){super(e,t,i,n,!0),this.injector=e,this.workPackageId=t,this.$element=i,this.additionalPositionArgs=n,this.table=s}triggerContextMenuAction(e){switch(e.key){case"relation-precedes":this.table.timelineController.startAddRelationPredecessor(this.workPackage);break;case"relation-follows":this.table.timelineController.startAddRelationFollower(this.workPackage);break;case"hierarchy-indent":this.wpViewIndentation.indent(this.workPackage);break;case"hierarchy-outdent":this.wpViewIndentation.outdent(this.workPackage);break;default:super.triggerContextMenuAction(e)}}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",k.a)],C.prototype,"wpViewIndentation",void 0);class j{constructor(e){this.injector=e}get rowSelector(){return"."+d.c}eventScope(e){return jQuery(e.workPackageTable.tableAndTimelineContainer)}openContextMenu(e,t,i,n){const s=new C(this.injector,i,jQuery(t.target),n,e);this.opContextMenu.show(s,t)}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",v.a)],j.prototype,"opContextMenu",void 0);var P=i("/cHX");class x extends j{constructor(e){super(e),this.injector=e}get EVENT(){return"click.table.contextmenu"}get SELECTOR(){return"."+P.c}handleEvent(e,t){let i=jQuery(t.target);if(i.closest("."+w.c).length)return Object(a.a)("Allowing original context menu on state link"),!0;t.preventDefault(),t.stopPropagation();const n=i.closest(this.rowSelector).data("workPackageId");return n&&this.openContextMenu(e.workPackageTable,t,n),!1}}var S=i("E5Dd");class O extends j{constructor(e){super(e),this.injector=e}get EVENT(){return"keydown.table.contextmenu"}get SELECTOR(){return this.rowSelector}handleEvent(e,t){if(!e.workPackageTable.configuration.contextMenuEnabled)return!1;let i=jQuery(t.target);if(t.keyCode!==S.a.F10||!t.shiftKey||!t.altKey)return!0;t.preventDefault(),t.stopPropagation();const n=i.closest(this.SELECTOR).data("workPackageId");let s={my:"left top",at:"left bottom",of:i};return super.openContextMenu(e.workPackageTable,t,n,s),!1}}var I=i("9nXh"),T=i("eyhC");class R extends j{constructor(e){super(e),this.injector=e}get EVENT(){return"contextmenu.table.rightclick"}get SELECTOR(){return`.${d.c},.${I.b}`}eventScope(e){return jQuery(e.workPackageTable.tableAndTimelineContainer)}handleEvent(e,t){if(!e.workPackageTable.configuration.contextMenuEnabled)return!1;let i=jQuery(t.target);if(i.closest("."+w.c).length)return Object(a.a)("Allowing original context menu on state link"),!0;t.preventDefault(),t.stopPropagation();const n=i.closest(this.SELECTOR).data("workPackageId");if(n){let[i]=e.workPackageTable.findRenderedRow(n);this.wpTableSelection.isSelected(n)||this.wpTableSelection.setSelection(n,i),this.openContextMenu(e.workPackageTable,t,n)}return!1}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",T.a)],R.prototype,"wpTableSelection",void 0);var E=i("iB+3"),M=i("Y/CA"),F=i("PkGb"),A=i("e6KS");class L{constructor(e){this.injector=e}get EVENT(){return"click.table.row"}get SELECTOR(){return"."+d.c}eventScope(e){return jQuery(e.workPackageTable.tbody)}handleEvent(e,t){let i=jQuery(t.target);if(i.is("a")||i.parent().is("a"))return!0;if(i.hasClass(""+o.b)||i.hasClass(""+A.b))return Object(a.a)("Skipping click on inner cell"),!0;let n=i.closest(this.SELECTOR),s=n.data("workPackageId"),r=n.data("classIdentifier");if(!s)return!0;let[c,l]=e.workPackageTable.findRenderedRow(r);return t.ctrlKey||t.metaKey||t.shiftKey||(this.wpTableSelection.setSelection(s,c),e.itemClicked.emit({workPackageId:s,double:!1})),t.shiftKey&&this.wpTableSelection.setMultiSelectionFrom(e.workPackageTable.renderedRows,s,c),(t.ctrlKey||t.metaKey)&&this.wpTableSelection.toggleRow(s),e.selectionChanged.emit(this.wpTableSelection.getSelectedWorkPackageIds()),this.wpTableFocus.updateFocus(s),!1}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",E.StateService)],L.prototype,"$state",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",c.a)],L.prototype,"states",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",F.a)],L.prototype,"keepTab",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",T.a)],L.prototype,"wpTableSelection",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",M.a)],L.prototype,"wpTableFocus",void 0);var D=i("pXZk"),V=i("13ri");class q{constructor(e){this.injector=e}get EVENT(){return"dblclick.table.row"}get SELECTOR(){return"."+D.c}eventScope(e){return jQuery(e.workPackageTable.tbody)}handleEvent(e,t){let i=jQuery(t.target);if(V.a.isClickedWithModifier(t))return!0;if(i.hasClass(""+o.b)||i.hasClass(""+A.b))return Object(a.a)("Skipping click on inner cell"),!0;let n=i.closest(this.SELECTOR).closest("."+d.c).data("workPackageId");return!(!i.is("a")&&!i.parent().is("a"))||(this.wpTableFocus.updateFocus(n),e.itemClicked.emit({workPackageId:n,double:!0}),!1)}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",E.StateService)],q.prototype,"$state",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",c.a)],q.prototype,"states",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",T.a)],q.prototype,"wpTableSelection",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",M.a)],q.prototype,"wpTableFocus",void 0);var $=i("E2tj"),N=i("nbRO"),B=i("1RU0");class z{constructor(e){this.injector=e}get EVENT(){return"click.table.groupheader"}get SELECTOR(){return`.${N.b} .expander`}eventScope(e){return jQuery(e.workPackageTable.tbody)}handleEvent(e,t){t.preventDefault(),t.stopPropagation();let i=jQuery(t.target).parents("."+N.b).data("groupIdentifier");this.workPackageViewCollapsedGroupsService.toggleGroupCollapseState(i)}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",$.a)],z.prototype,"querySpace",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",B.a)],z.prototype,"workPackageViewCollapsedGroupsService",void 0);var H=i("wyKs");class Q extends u.a{constructor(e){super(),this.injector=e}get EVENT(){return"click.table.hierarchy"}get SELECTOR(){return".wp-table--hierarchy-indicator"}eventScope(e){return jQuery(e.workPackageTable.tbody)}processEvent(e,t){let i=jQuery(t.target).closest("."+d.c).data("workPackageId");return this.wpTableHierarchies.toggle(i),t.stopImmediatePropagation(),t.preventDefault(),!1}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",c.a)],Q.prototype,"states",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",H.a)],Q.prototype,"wpTableHierarchies",void 0);class W{constructor(e){this.injector=e}get EVENT(){return"click.table.wpLink"}get SELECTOR(){return"."+w.c}eventScope(e){return jQuery(e.workPackageTable.tableAndTimelineContainer)}handleEvent(e,t){if(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)return!0;const i=jQuery(t.target),n=i.closest(this.SELECTOR),s=n.data("wpState"),r=n.data("workPackageId");i.closest("a").blur();let a=i.closest("."+d.c).data("classIdentifier"),[c,o]=e.workPackageTable.findRenderedRow(a);return this.wpTableSelection.setSelection(r,c),e.stateLinkClicked.emit({workPackageId:r,requestedState:s}),t.preventDefault(),t.stopPropagation(),!1}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",E.StateService)],W.prototype,"$state",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",F.a)],W.prototype,"keepTab",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",c.a)],W.prototype,"states",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",T.a)],W.prototype,"wpTableSelection",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",M.a)],W.prototype,"wpTableFocus",void 0);var X=i("1G5W"),U=i("JY8V");class G{constructor(e,t){this.injector=e,this.table=t,this.wpTableColumns.updates$().pipe(Object(X.a)(this.querySpace.stopAllSubscriptions)).subscribe(()=>{if(t.originalRows.length>0){var e=performance.now();t.redrawTable();var i=performance.now();Object(a.a)("column redraw took "+(i-e)+" milliseconds.")}})}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",$.a)],G.prototype,"querySpace",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",U.a)],G.prototype,"wpTableColumns",void 0);var Y=i("5+Sy"),K=i("lJxs"),Z=i("/uUt"),J=i("pLZG"),ee=i("CBsm"),te=i("xV+i");class ie{constructor(e,t){this.injector=e,this.wpTableHierarchies.updates$().pipe(Object(X.a)(this.querySpace.stopAllSubscriptions),Object(K.a)(e=>e.isVisible),Object(Z.a)()).subscribe(()=>{this.wpTableHierarchies.isEnabled||t.redrawTableAndTimeline()});let i=this.wpTableHierarchies.isEnabled;this.wpTableHierarchies.updates$().pipe(Object(X.a)(this.querySpace.stopAllSubscriptions),Object(J.a)(()=>this.querySpace.tableRendered.hasValue())).subscribe(e=>{e.isVisible===i&&this.renderHierarchyState(e),i=e.isVisible})}renderHierarchyState(e){const t=this.querySpace.tableRendered.value;jQuery('[class^="__hierarchy-group-"]').removeClass((e,t)=>(t.match(/__collapsed-group-\d+/g)||[]).join(" "));const i={};_.each(e.collapsed,(e,n)=>{jQuery(`.${Object(ee.d)(n)} .wp-table--hierarchy-indicator`).toggleClass(te.c,e);const s=document.querySelector(".wp-timeline-cell.__hierarchy-root-"+n);s&&(e?s.classList.add("__hierarchy-root-collapsed"):s.classList.remove("__hierarchy-root-collapsed"));const r=jQuery("."+Object(ee.c)(n));r.toggleClass(Object(ee.b)(n),e),r.filter("."+d.c).each((n,s)=>{const r=jQuery(s).index();i[r]||(t[r].hidden=e,i[r]=e)})}),e.last&&Object(Y.g)(e.last),this.querySpace.tableRendered.putValue(t,"Updated hidden state of rows after hierarchy change.")}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",H.a)],ie.prototype,"wpTableHierarchies",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",$.a)],ie.prototype,"querySpace",void 0);class ne{constructor(e,t){this.injector=e,this.wpTableRelationColumns.updates$().pipe(Object(X.a)(this.querySpace.stopAllSubscriptions)).subscribe(()=>{t.redrawTableAndTimeline()})}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",b.a)],ne.prototype,"wpTableRelationColumns",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",$.a)],ne.prototype,"querySpace",void 0);var se=i("Uyc6"),re=i("6yP5");class ae{constructor(e,t){this.injector=e,this.table=t,this.querySpace.initialized.values$().pipe(Object(X.a)(this.querySpace.stopAllSubscriptions)).subscribe(()=>{let e;e=this.wpTableSortBy.isManualSortingMode?this.wpTableOrder.orderedWorkPackages():this.querySpace.results.value.elements,t.initialSetup(e)}),this.states.workPackages.observeChange().pipe(Object(X.a)(this.querySpace.stopAllSubscriptions.asObservable()),Object(J.a)(()=>{let e=this.querySpace.tableRendered.getValueOr([]);return e&&e.length>0})).subscribe(([e,t])=>{void 0!==t&&this.table.refreshRows(t)})}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",$.a)],ae.prototype,"querySpace",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",re.a)],ae.prototype,"wpTableSortBy",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",se.a)],ae.prototype,"wpTableOrder",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",c.a)],ae.prototype,"states",void 0);var ce=i("7ond");class oe{constructor(e,t){this.injector=e,this.table=t,this.querySpace.tableRendered.values$().pipe(Object(X.a)(this.querySpace.stopAllSubscriptions)).subscribe(()=>{this.wpTableFocus.ifShouldFocus(e=>{const t=Object(Y.c)(e);t.length&&(Object(Y.g)(e),this.FocusHelper.focusElement(t,!0))})}),this.wpTableSelection.live$().pipe(Object(X.a)(this.querySpace.stopAllSubscriptions)).subscribe(e=>{this.renderSelectionState(e)}),this.wpTableSelection.registerSelectAllListener(()=>t.renderedRows),this.wpTableSelection.registerDeselectAllListener()}renderSelectionState(e){const t=jQuery(this.table.tableAndTimelineContainer);t.find(`.${d.c}.${w.b}`).removeClass(w.b),_.each(e.selected,(e,i)=>{t.find(`.${d.c}[data-work-package-id="${i}"]`).toggleClass(w.b,e)})}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",T.a)],oe.prototype,"wpTableSelection",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",M.a)],oe.prototype,"wpTableFocus",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",$.a)],oe.prototype,"querySpace",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",ce.a)],oe.prototype,"FocusHelper",void 0);var le=i("PtkW");class de{constructor(e,t){this.injector=e,this.table=t,this.wpTableTimeline.live$().pipe(Object(X.a)(this.querySpace.stopAllSubscriptions)).subscribe(e=>{this.renderVisibility(e.visible)})}renderVisibility(e){const t=jQuery(this.table.tableAndTimelineContainer).parent();t.find(".work-packages-tabletimeline--timeline-side").toggle(e),t.find(".work-packages-tabletimeline--table-side").toggleClass("-timeline-visible",e)}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",$.a)],de.prototype,"querySpace",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",le.a)],de.prototype,"wpTableTimeline",void 0);var ue=i("2Qcm");class he{constructor(e,t){this.injector=e,this.wpTableHighlighting.updates$().pipe(Object(X.a)(this.querySpace.stopAllSubscriptions),Object(Z.a)()).subscribe(()=>t.redrawTable())}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",ue.a)],he.prototype,"wpTableHighlighting",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",$.a)],he.prototype,"querySpace",void 0);var pe=i("IzEk"),ge=i("FDFi"),fe=i("POAS"),be=i("pSHE"),me=i("tmNb"),we=i("99YG"),ve=i("buwf"),ye=i("DhiE"),ke=i("CNq7");class Ce{constructor(e,t){this.injector=e,this.table=t,null!==this.dragService&&(this.inlineCreateService.newInlineWorkPackageCreated.pipe(Object(X.a)(this.querySpace.stopAllSubscriptions)).subscribe(e=>Object(r.b)(this,void 0,void 0,(function*(){const t=yield this.wpTableOrder.add(this.currentOrder,e);this.updateRenderedOrder(t)}))),this.querySpace.stopAllSubscriptions.pipe(Object(pe.a)(1)).subscribe(()=>{this.dragService.remove(this.table.tbody)}),this.dragService.register({dragContainer:this.table.tbody,scrollContainers:[this.table.scrollContainer],accepts:()=>!0,moves:(e,t,i)=>{if(!i.classList.contains("wp-table--drag-and-drop-handle"))return!1;const n=e.dataset.workPackageId,s=this.states.workPackages.get(n).value;return!!s&&this.actionService.canPickup(s)},onMoved:(e,t,i,n)=>Object(r.b)(this,void 0,void 0,(function*(){const t=e.dataset.workPackageId;let s;try{const r=yield this.apiV3Service.work_packages.id(t).get().toPromise();if(Object(Y.a)(n)){const e=Array.from(n.classList).find(e=>e.includes(Object(ee.b)())).replace(Object(ee.b)(),""),t=i.getElementsByClassName(Object(ee.b)(e)),r=t[t.length-1];s=this.findRowIndex(r)}else s=this.findRowIndex(e);const a=yield this.wpTableOrder.move(this.currentOrder,t,s);yield this.actionService.handleDrop(r,e),this.updateRenderedOrder(a),this.actionService.onNewOrder(a);let c=this.querySpace.query.value;c&&this.wpTableSortBy.switchToManualSorting(c)&&(yield this.wpListService.save(c))}catch(r){this.halNotification.handleRawError(r),this.actionService.changeShadowElement(e,!0),we.a.reinsert(e,e.dataset.sourceIndex||-1,i)}})),onRemoved:e=>{const t=e.dataset.workPackageId,i=this.wpTableOrder.remove(this.currentOrder,t);this.updateRenderedOrder(i)},onAdded:e=>Object(r.b)(this,void 0,void 0,(function*(){const t=e.dataset.workPackageId,i=yield this.apiV3Service.work_packages.id(t).get().toPromise(),n=this.findRowIndex(e);return this.actionService.handleDrop(i,e).then(()=>Object(r.b)(this,void 0,void 0,(function*(){const e=yield this.wpTableOrder.add(this.currentOrder,t,n);return this.updateRenderedOrder(e),this.actionService.onNewOrder(e),!0}))).catch(()=>!1)})),onCloned:(e,t)=>Object(r.b)(this,void 0,void 0,(function*(){const i=t.dataset.workPackageId,n=yield this.apiV3Service.work_packages.id(i).get().toPromise(),s=e.children.length,r=document.createElement("td");r.textContent=n.subjectWithId(),r.colSpan=s,r.classList.add("wp-table--cell-td","subject"),e.style.maxWidth="500px",e.innerHTML=r.outerHTML})),onShadowInserted:e=>{this.browserDetector.isEdge||this.actionService.changeShadowElement(e)},onCancel:e=>{this.browserDetector.isEdge||this.actionService.changeShadowElement(e,!0)}}))}updateRenderedOrder(e){return Object(r.b)(this,void 0,void 0,(function*(){e=_.uniq(e);const t=yield Promise.all(e.map(e=>this.apiV3Service.work_packages.id(e).get().toPromise()));this.table.initialSetup(t)}))}get actionService(){return this.dragActionRegistry.get(this.injector)}get currentOrder(){return this.currentRenderedOrder.map(e=>e.workPackageId)}get currentRenderedOrder(){return this.querySpace.renderedWorkPackages.getValueOr([])}findRowIndex(e){return Array.from(this.table.tbody.getElementsByClassName(d.c)).indexOf(e)||0}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",c.a)],Ce.prototype,"states",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",$.a)],Ce.prototype,"querySpace",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",ge.a)],Ce.prototype,"inlineCreateService",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",fe.a)],Ce.prototype,"halNotification",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",re.a)],Ce.prototype,"wpTableSortBy",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",se.a)],Ce.prototype,"wpTableOrder",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",ve.a)],Ce.prototype,"browserDetector",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",ke.a)],Ce.prototype,"apiV3Service",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",ye.a)],Ce.prototype,"wpListService",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",be.a)],Ce.prototype,"dragActionRegistry",void 0),Object(r.c)([Object(p.a)(me.a,null),Object(r.e)("design:type",Object)],Ce.prototype,"dragService",void 0);var je=i("WUI6");class Pe{constructor(e,t){this.injector=e,this.workPackageViewCollapsedGroupsService.updates$().pipe(Object(X.a)(this.querySpace.stopAllSubscriptions),Object(Z.a)()).subscribe(e=>t.setGroupsCollapseState(e.state))}}Object(r.c)([Object(p.a)(),Object(r.e)("design:type",B.a)],Pe.prototype,"workPackageViewCollapsedGroupsService",void 0),Object(r.c)([Object(p.a)(),Object(r.e)("design:type",$.a)],Pe.prototype,"querySpace",void 0);class xe extends je.a{constructor(){super(...arguments),this.eventHandlers=[()=>new Q(this.injector),()=>new g(this.injector),()=>new W(this.injector),()=>new L(this.injector),()=>new q(this.injector),()=>new z(this.injector),()=>new R(this.injector),()=>new x(this.injector),()=>new O(this.injector),()=>new m(this.injector)],this.stateTransformers=[oe,ae,G,Pe,de,ie,ne,he,Ce]}attachTo(e){this.stateTransformers.map(t=>new t(this.injector,e.workPackageTable)),super.attachTo(e)}}var Se=i("itXk"),_e=i("U1xf"),Oe=i("4EDS"),Ie=i("AeZM"),Te=i("5iud");const Re="row-hovered";class Ee{constructor(e){this.tableAndTimeline=e,this.lastHoveredElement=null,this.eventListener=e=>{const t=e.target;t&&t!==this.lastHoveredElement&&this.handleHover(t),this.lastHoveredElement=t}}activate(){window.addEventListener("mousemove",this.eventListener,{passive:!0})}deactivate(){window.removeEventListener("mousemove",this.eventListener),this.removeAllHoverClasses()}locateHoveredTableRow(e){const t=e.closest("tr");return 0===t.length?null:t[0]}locateHoveredTimelineRow(e){const t=e.closest("div.wp-timeline-cell");return 0===t.length?null:t[0]}handleHover(e){const t=jQuery(e),i=this.locateHoveredTableRow(t),n=this.locateHoveredTimelineRow(t);null!==i||null!==n?this.removeOldAndAddNewHoverClass(i,n):this.removeAllHoverClasses()}extractWorkPackageId(e){return parseInt(e.getAttribute("data-work-package-id"))}removeOldAndAddNewHoverClass(e,t){const i=null!==e?e:t,n=this.extractWorkPackageId(i),s=this.tableAndTimeline.find("tr.wp-row-"+n).first(),r=this.tableAndTimeline.find("div.wp-row-"+n).length?this.tableAndTimeline.find("div.wp-row-"+n).first():this.tableAndTimeline.find("div.wp-ancestor-row-"+n).first();requestAnimationFrame(()=>{this.removeAllHoverClasses(),r.addClass(Re),s.addClass(Re)})}removeAllHoverClasses(){this.tableAndTimeline.find(".row-hovered").removeClass(Re)}}var Me=i("5HGI"),Fe=i("AEvm");function Ae(e,t){1&e&&n.cc(0,"col")}function Le(e,t){1&e&&n.cc(0,"col",19)}function De(e,t){1&e&&n.cc(0,"col",19)}function Ve(e,t){1&e&&n.cc(0,"col")}function qe(e,t){1&e&&n.cc(0,"op-icon",23)}function $e(e,t){if(1&e&&(n.hc(0,"th",20),n.hc(1,"div",21),n.Tc(2,qe,1,0,"op-icon",22),n.gc(),n.gc()),2&e){const e=n.rc(2);n.Pb(2),n.wc("ngIf",e.manualSortEnabled)}}function Ne(e,t){if(1&e&&(n.hc(0,"th",24),n.cc(1,"sortHeader",25),n.gc()),2&e){const e=t.$implicit,i=n.rc(2);n.Pb(1),n.wc("headerColumn",e)("locale",e.custom_field&&e.custom_field.name_locale||i.locale)("table",i.workPackageTable)("opColumnsContextMenu-column",e)("opColumnsContextMenu-table",i.workPackageTable)}}function Be(e,t){1&e&&(n.hc(0,"div",28),n.cc(1,"wp-table-config-menu"),n.gc())}function ze(e,t){if(1&e&&(n.hc(0,"th",26),n.Tc(1,Be,2,0,"div",27),n.gc()),2&e){const e=n.rc(2);n.Pb(1),n.wc("ngIf",e.configuration.columnMenuEnabled)}}function He(e,t){if(1&e&&(n.hc(0,"tbody",29),n.hc(1,"tr",30),n.hc(2,"td"),n.hc(3,"span"),n.cc(4,"op-icon",31),n.hc(5,"span"),n.hc(6,"strong"),n.Vc(7),n.gc(),n.Vc(8),n.gc(),n.gc(),n.gc(),n.gc(),n.gc()),2&e){const e=n.rc(2);n.Pb(2),n.Qb("colspan",e.columns.length+2),n.Pb(5),n.Wc(e.text.noResults.title),n.Pb(1),n.Xc(" ",e.text.noResults.description," ")}}function Qe(e,t){if(1&e&&n.cc(0,"tbody",32),2&e){const e=n.rc(2);n.wc("wp-inline-create--table",e.workPackageTable)("wp-inline-create--project-identifier",e.projectIdentifier)}}function We(e,t){1&e&&(n.hc(0,"div",33),n.cc(1,"wp-resizer",34),n.gc()),2&e&&(n.Pb(1),n.wc("elementClass","work-packages-tabletimeline--timeline-side")("resizeEvent","wp-resize.timeline")("localStorageKey","openProject-timelineFlexBasis"))}const Xe=function(){return[]};function Ue(e,t){if(1&e&&(n.hc(0,"div",1),n.hc(1,"div",2),n.hc(2,"table",3),n.hc(3,"colgroup"),n.Tc(4,Ae,1,0,"col",4),n.Tc(5,Le,1,0,"col",5),n.Tc(6,De,1,0,"col",6),n.Tc(7,Ve,1,0,"col",4),n.gc(),n.hc(8,"caption",7),n.hc(9,"span"),n.Vc(10),n.gc(),n.cc(11,"span",8),n.hc(12,"span"),n.Vc(13),n.gc(),n.gc(),n.hc(14,"thead",9),n.hc(15,"tr"),n.Tc(16,$e,3,1,"th",10),n.Tc(17,Ne,2,5,"th",11),n.Tc(18,ze,2,1,"th",12),n.gc(),n.gc(),n.Tc(19,He,9,3,"tbody",13),n.cc(20,"tbody",14),n.Tc(21,Qe,1,2,"tbody",15),n.hc(22,"tfoot"),n.cc(23,"tr",16),n.gc(),n.gc(),n.gc(),n.Tc(24,We,2,3,"div",17),n.hc(25,"div",18),n.cc(26,"wp-timeline-container"),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(4),n.wc("ngIf",e.configuration.dragAndDropEnabled),n.Pb(1),n.wc("ngForOf",n.Ac(14,Xe).constructor(e.columns.length)),n.Pb(1),n.wc("ngIf",e.configuration.columnMenuEnabled),n.Pb(1),n.wc("ngIf",!e.configuration.columnMenuEnabled),n.Pb(3),n.Wc(e.text.tableSummary),n.Pb(3),n.Wc(e.text.tableSummaryHints),n.Pb(3),n.wc("ngIf",e.configuration.dragAndDropEnabled),n.Pb(1),n.wc("ngForOf",e.columns)("ngForTrackBy",e.trackByHref),n.Pb(1),n.wc("ngIf",e.configuration.columnMenuEnabled||e.configuration.actionsColumnEnabled),n.Pb(1),n.wc("ngIf",!e.isEmbedded&&e.query&&0===e.results.count),n.Pb(2),n.wc("ngIf",e.tableElement&&e.configuration.inlineCreateEnabled),n.Pb(2),n.wc("wpTableSumsRow-table",e.workPackageTable),n.Pb(1),n.wc("ngIf",!e.configuration.isEmbedded)}}class Ge extends Fe.a{constructor(e,t,i,s,r,a,c,o,l,d,u){super(),this.elementRef=e,this.injector=t,this.states=i,this.querySpace=s,this.I18n=r,this.cdRef=a,this.zone=c,this.wpTableGroupBy=o,this.wpTableTimeline=l,this.wpTableColumns=d,this.wpTableSortBy=u,this.selectionChanged=new n.s,this.itemClicked=new n.s,this.stateLinkClicked=new n.s,this.trackByHref=Oe.a.trackByHref,this.limitedResults=!1}ngOnInit(){this.configuration=new _e.a(this.configurationObject),this.$element=jQuery(this.elementRef.nativeElement),this.querySpace.stopAllSubscriptions.next(),this.locale=I18n.locale,this.text={cancel:I18n.t("js.button_cancel"),noResults:{title:I18n.t("js.work_packages.no_results.title"),description:I18n.t("js.work_packages.no_results.description")},limitedResults:(e,t)=>I18n.t("js.work_packages.limited_results",{count:e,total:t}),tableSummary:I18n.t("js.work_packages.table.summary"),tableSummaryHints:[I18n.t("js.work_packages.table.text_inline_edit"),I18n.t("js.work_packages.table.text_select_hint"),I18n.t("js.work_packages.table.text_sort_hint")].join(" ")},Object(Se.a)([this.querySpace.results.values$(),this.wpTableGroupBy.live$(),this.wpTableColumns.live$(),this.wpTableTimeline.live$(),this.wpTableSortBy.live$()]).pipe(this.untilDestroyed()).subscribe(([e,t,i,n,s])=>{this.query=this.querySpace.query.value,this.results=e,this.groupBy=t,this.columns=i,this.numTableColumns=this.columns.length+2,this.scrollSyncUpdate&&this.timelineVisible!==n.visible&&this.scrollSyncUpdate(n.visible),this.timelineVisible=n.visible,this.manualSortEnabled=this.wpTableSortBy.isManualSortingMode,this.limitedResults=this.manualSortEnabled&&e.total>e.count,this.cdRef.detectChanges()}),this.cdRef.detectChanges()}ngOnDestroy(){super.ngOnDestroy(),this.wpTableHoverSync.deactivate()}registerTimeline(e,t){const i=this.$element.find(".work-package--results-tbody"),n=this.$element.find(".work-package-table--container")[0];this.workPackageTable=new Me.a(this.injector,this.$element[0],n,i[0],t,e,this.configuration),this.tbody=i,e.workPackageTable=this.workPackageTable,new xe(this.injector).attachTo(this);const s=this.getTableAndTimelineElement();this.tableElement=s[0],this.timeline=s[1],this.wpTableHoverSync=new Ee(this.$element),this.wpTableHoverSync.activate(),this.scrollSyncUpdate=Object(Te.a)(this.$element),this.scrollSyncUpdate(this.timelineVisible),this.cdRef.detectChanges()}get isEmbedded(){return this.configuration.isEmbedded}getTableAndTimelineElement(){const e=this.$element.find(".work-packages-tabletimeline--table-side"),t=this.$element.find(".work-packages-tabletimeline--timeline-side");if(0===t.length||0===e.length)throw new Error("invalid state");return[e[0],t[0]]}}Ge.\u0275fac=function(e){return new(e||Ge)(n.bc(n.q),n.bc(n.A),n.bc(c.a),n.bc($.a),n.bc(s.a),n.bc(n.i),n.bc(n.K),n.bc(Ie.a),n.bc(le.a),n.bc(U.a),n.bc(re.a))},Ge.\u0275cmp=n.Vb({type:Ge,selectors:[["wp-table"]],inputs:{projectIdentifier:"projectIdentifier",configurationObject:["configuration","configurationObject"]},outputs:{selectionChanged:"selectionChanged",itemClicked:"itemClicked",stateLinkClicked:"stateLinkClicked"},features:[n.Mb],decls:1,vars:1,consts:[["class","work-packages-split-view--tabletimeline-content",4,"ngIf"],[1,"work-packages-split-view--tabletimeline-content"],[1,"work-packages-tabletimeline--table-side","work-package-table--container","__hidden_overflow_container"],[1,"keyboard-accessible-list","generic-table","work-package-table"],[4,"ngIf"],["highlight-col","",4,"ngFor","ngForOf"],["highlight-col","",4,"ngIf"],[1,"hidden-for-sighted"],["id","wp-table-sort-summary"],[1,"-sticky"],["class","wp-table--manual-sort-th -short hide-when-print",4,"ngIf"],["class","wp-table--table-header",4,"ngFor","ngForOf","ngForTrackBy"],["class","wp-table--configuration-modal--trigger wp-table--context-menu-th -short hide-when-print",4,"ngIf"],["class","work-package--empty-tbody",4,"ngIf"],[1,"results-tbody","work-package--results-tbody"],["wpInlineCreate","",3,"wp-inline-create--table","wp-inline-create--project-identifier",4,"ngIf"],["wpTableSumsRow","",1,"wp-table--sums-row","wp-table--row",3,"wpTableSumsRow-table"],["class","work-packages--tabletimeline--timeline--resizer hidden-for-mobile hide-when-print",4,"ngIf"],[1,"work-packages-tabletimeline--timeline-side"],["highlight-col",""],[1,"wp-table--manual-sort-th","-short","hide-when-print"],[1,"generic-table--empty-header"],["icon-classes","icon-sort-by",4,"ngIf"],["icon-classes","icon-sort-by"],[1,"wp-table--table-header"],["opColumnsContextMenu","",3,"headerColumn","locale","table","opColumnsContextMenu-column","opColumnsContextMenu-table"],[1,"wp-table--configuration-modal--trigger","wp-table--context-menu-th","-short","hide-when-print"],["class","generic-table--sort-header-outer",4,"ngIf"],[1,"generic-table--sort-header-outer"],[1,"work-package--empty-tbody"],["id","empty-row-notification"],["icon-classes","icon-info1 icon-context"],["wpInlineCreate","",3,"wp-inline-create--table","wp-inline-create--project-identifier"],[1,"work-packages--tabletimeline--timeline--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","resizeEvent","localStorageKey"]],template:function(e,t){1&e&&n.Tc(0,Ue,27,15,"div",0),2&e&&n.wc("ngIf",t.query)},styles:[".wp-table--drag-and-drop-handle:hover{cursor:move}"],encapsulation:2,changeDetection:0})},V4eP:function(e,t,i){"use strict";i.d(t,"d",(function(){return a})),i.d(t,"c",(function(){return c})),i.d(t,"b",(function(){return o})),i.d(t,"e",(function(){return l})),i.d(t,"a",(function(){return d}));var n=i("fXoL"),s=(i("kgyZ"),i("wZYP")),r=i("M0J3");i("GntA");const a=new n.z("editing-portal--schema"),c=new n.z("editing-portal--handler"),o=new n.z("editing-portal--changeset"),l="-editing";class d extends r.a{constructor(e,t,i,n,s,r,a){super(),this.I18n=e,this.elementRef=t,this.change=i,this.schema=n,this.handler=s,this.cdRef=r,this.injector=a,this.self=this,this.schema=this.schema||this.change.schema.ofProperty(this.name),this.change.state&&this.change.state.values$().pipe(this.untilDestroyed()).subscribe(e=>{if(!e.schema.ofProperty(this.name))return s.deactivate(!1);this.change=e,this.schema=e.schema.ofProperty(this.name),this.initialize(),this.cdRef.markForCheck()})}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.initialize()}get overflowingSelector(){return this.$element?this.$element.closest(".__overflowing_element_container").data("overflowingIdentifier"):null}get inFlight(){return this.handler.inFlight}get value(){return this.resource[this.name]}get name(){return this.change.schema.mappedName(this.handler.fieldName)}set value(e){this.resource[this.name]=this.parseValue(e)}get placeholder(){return"subject"===this.name?this.I18n.t("js.placeholders.subject"):""}get resource(){return this.change.projectedResource}initialize(){}parseValue(e){return e}}d.\u0275fac=function(e){return new(e||d)(n.bc(s.a),n.bc(n.q),n.bc(o),n.bc(a),n.bc(c),n.bc(n.i),n.bc(n.A))},d.\u0275dir=n.Wb({type:d,features:[n.Mb]})},VFHb:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("hgso"),s=i("fXoL");class r extends n.a{load(e){return e.watchers.$update().then(e=>e.elements)}}r.\u0275fac=function(e){return a(e||r)},r.\u0275prov=s.Xb({token:r,factory:r.\u0275fac});const a=s.jc(r)},VNOR:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("V4eP"),s=i("k8lp"),r=i("fXoL"),a=i("ofXK"),c=i("32V0");function o(e,t){if(1&e){const e=r.ic();r.hc(0,"edit-field-controls",4),r.pc("onSave",(function(){r.Lc(e);return r.rc().handleUserSubmit()}))("onCancel",(function(){r.Lc(e);return r.rc().handler.handleUserCancel()})),r.gc()}if(2&e){const e=r.rc();r.wc("fieldController",e.field)("saveTitle",e.text.save)("cancelTitle",e.text.cancel)}}class l extends n.a{constructor(){super(...arguments),this.field=this,this.initializationError=!1,this.isPreview=!1,this.previewHtml="",this.text={},this.editorType=this.resource.getEditorTypeFor(this.field.name)}ngOnInit(){super.ngOnInit(),this.handler.registerOnSubmit(()=>this.getCurrentValue()),this.text={attachmentLabel:this.I18n.t("js.label_formattable_attachment_hint"),save:this.I18n.t("js.inplace.button_save",{attribute:this.schema.name}),cancel:this.I18n.t("js.inplace.button_cancel",{attribute:this.schema.name})}}onCkeditorSetup(e){this.resource.isNew||setTimeout(()=>e.editing.view.focus())}getCurrentValue(){return this.editor.getTransformedContent().then(e=>{this.rawValue=e})}onContentChange(e){this.rawValue!==e&&(this.rawValue=e)}handleUserSubmit(){return this.getCurrentValue().then(()=>{this.handler.handleUserSubmit()}),!1}get ckEditorContext(){return{resource:this.change.pristineResource,macros:"none",previewContext:this.previewContext,options:{rtl:this.schema.options&&this.schema.options.rtl}}}get previewContext(){return this.handler.previewContext(this.resource)}reset(){this.editor&&this.editor.initialized&&(this.editor.content=this.rawValue,this.cdRef.markForCheck())}get rawValue(){return this.value&&this.value.raw?this.value.raw:""}set rawValue(e){this.value={raw:e}}isEmpty(){return!(this.value&&this.value.raw)}initialize(){this.resource.isNew&&this.editor&&this.reset()}}l.\u0275fac=function(e){return d(e||l)},l.\u0275cmp=r.Vb({type:l,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&r.Rc(s.a,!0),2&e)&&(r.Ic(i=r.qc())&&(t.editor=i.first))},features:[r.Mb],decls:4,vars:4,consts:[[1,"textarea-wrapper"],[1,"op-ckeditor--wrapper","op-ckeditor-element"],[3,"context","content","ckEditorType","onContentChange","onInitializationFailed","onInitialized"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel",4,"ngIf"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel"]],template:function(e,t){1&e&&(r.hc(0,"div",0),r.hc(1,"div",1),r.hc(2,"op-ckeditor",2),r.pc("onContentChange",(function(e){return t.onContentChange(e)}))("onInitializationFailed",(function(){return t.initializationError=!0}))("onInitialized",(function(e){return t.onCkeditorSetup(e)})),r.gc(),r.gc(),r.Tc(3,o,1,3,"edit-field-controls",3),r.gc()),2&e&&(r.Pb(2),r.wc("context",t.ckEditorContext)("content",t.rawValue)("ckEditorType",t.editorType),r.Pb(1),r.wc("ngIf",!(t.handler.inEditMode||t.initializationError)))},directives:[s.a,a.q,c.a],encapsulation:2,changeDetection:0});const d=r.jc(l)},VPzE:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("iMRi"),s=i("POAS"),r=i("d/TE"),a=i("SqdZ"),c=i("IaZ+"),o=i("wZYP"),l=i("E2tj"),d=i("DhiE"),u=i("fXoL"),h=i("kor4"),p=i("3Pt+"),g=i("k1Xe");const f=["queryNameField"];class b extends a.a{constructor(e,t,i,n,s,r,a,c,o){super(t,c,e),this.elementRef=e,this.locals=t,this.I18n=i,this.states=n,this.querySpace=s,this.wpListService=r,this.halNotification=a,this.cdRef=c,this.notificationsService=o,this.queryName="",this.isStarred=!1,this.isPublic=!1,this.isBusy=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text"),save_as:this.I18n.t("js.label_save_as"),label_name:this.I18n.t("js.modals.label_name"),label_visibility_settings:this.I18n.t("js.label_visibility_settings"),button_save:this.I18n.t("js.modals.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")}}setValues(e){this.isStarred=e.isStarred,this.isPublic=e.isPublic}onOpen(){this.queryNameField.nativeElement.focus()}get afterFocusOn(){return jQuery("#work-packages-settings-button")}saveQueryAs(e){if(this.isBusy||!this.queryName)return;this.isBusy=!0;const t=this.querySpace.query.value;t.public=this.isPublic,this.wpListService.create(t,this.queryName).then(t=>this.isStarred&&!t.starred?this.wpListService.toggleStarred(t).then(()=>this.closeMe(e)):(this.closeMe(e),Promise.resolve(!0))).catch(e=>this.halNotification.handleRawError(e)).then(()=>this.isBusy=!1)}}b.\u0275fac=function(e){return new(e||b)(u.bc(u.q),u.bc(c.a),u.bc(o.a),u.bc(n.a),u.bc(l.a),u.bc(d.a),u.bc(s.a),u.bc(u.i),u.bc(r.a))},b.\u0275cmp=u.Vb({type:b,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&u.Rc(f,!0),2&e)&&(u.Ic(i=u.qc())&&(t.queryNameField=i.first))},features:[u.Mb],decls:19,vars:11,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","wp-table--configuration-modal","loading-indicator--location"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"accessibleClick"],["name","modalSaveForm",1,"form"],[1,"form--field","-required"],["for","save-query-name",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--text-field-container"],["type","text","name","save-query-name","id","save-query-name","required","",1,"form--text-field",3,"ngModel","ngModelChange"],["queryNameField",""],[1,"form--section"],[3,"isSave","isStarred","isPublic","onChange"],[1,"form--space"],[1,"button","-highlight","-with-icon","icon-checkmark",3,"textContent","disabled","click"],[1,"button","-with-icon","icon-cancel",3,"textContent","click"]],template:function(e,t){1&e&&(u.hc(0,"div",0),u.hc(1,"div",1),u.hc(2,"div",2),u.cc(3,"h3",3),u.hc(4,"a",4),u.hc(5,"i",5),u.pc("accessibleClick",(function(e){return t.closeMe(e)})),u.gc(),u.gc(),u.gc(),u.hc(6,"form",6),u.hc(7,"div",7),u.cc(8,"label",8),u.hc(9,"div",9),u.hc(10,"div",10),u.hc(11,"input",11,12),u.pc("ngModelChange",(function(e){return t.queryName=e})),u.gc(),u.gc(),u.gc(),u.gc(),u.hc(13,"section",13),u.cc(14,"h3",3),u.hc(15,"query-sharing-form",14),u.pc("onChange",(function(e){return t.setValues(e)})),u.gc(),u.gc(),u.hc(16,"div",15),u.hc(17,"button",16),u.pc("click",(function(e){return t.saveQueryAs(e)})),u.gc(),u.hc(18,"button",17),u.pc("click",(function(e){return t.closeMe(e)})),u.gc(),u.gc(),u.gc(),u.gc(),u.gc()),2&e&&(u.Pb(3),u.wc("textContent",t.text.save_as),u.Pb(2),u.Qb("title",t.text.close_popup),u.Pb(3),u.wc("textContent",t.text.label_name),u.Pb(3),u.wc("ngModel",t.queryName),u.Pb(3),u.wc("textContent",t.text.label_visibility_settings),u.Pb(1),u.wc("isSave",!0)("isStarred",t.isStarred)("isPublic",t.isPublic),u.Pb(2),u.wc("textContent",t.text.button_save)("disabled",t.isBusy||!t.queryName),u.Pb(1),u.wc("textContent",t.text.button_cancel))},directives:[h.a,p.C,p.n,p.o,p.c,p.x,p.m,p.p,g.a],encapsulation:2})},VYxi:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("Nolp"),s=i("fXoL"),r=i("ofXK"),a=i("711n"),c=i("XZlt"),o=i("qvi4"),l=i("1zMF"),d=i("aveh"),u=i("2bW2");const h=function(){return["status","type"]};function p(e,t){if(1&e){const e=s.ic();s.hc(0,"div",1),s.hc(1,"edit-form",2),s.pc("onSaved",(function(t){s.Lc(e);return s.rc().onSaved(t)})),s.hc(2,"div",3),s.hc(3,"div",4),s.cc(4,"wp-type-status",5),s.gc(),s.hc(5,"ul",6),s.hc(6,"li",7),s.cc(7,"zen-mode-toggle-button"),s.gc(),s.hc(8,"li",7),s.hc(9,"button",8),s.cc(10,"i",9),s.gc(),s.gc(),s.gc(),s.gc(),s.cc(11,"wp-single-view",10),s.hc(12,"wp-edit-actions-bar",11),s.pc("onCancel",(function(){s.Lc(e);return s.rc().cancelAndBackToList()})),s.gc(),s.gc(),s.gc()}if(2&e){const e=s.rc();s.Pb(1),s.wc("resource",e.newWorkPackage)("skippedFields",s.Ac(7,h))("inEditMode",!0),s.Pb(3),s.wc("workPackage",e.newWorkPackage),s.Pb(5),s.Qb("title",e.text.button_settings),s.Pb(2),s.wc("workPackage",e.newWorkPackage)("showProject",e.copying)}}class g extends n.a{constructor(){super(...arguments),this.successState="work-packages.show"}}g.\u0275fac=function(e){return f(e||g)},g.\u0275cmp=s.Vb({type:g,selectors:[["wp-copy-full-view"]],hostAttrs:[1,"work-packages-page--ui-view"],features:[s.Mb],decls:1,vars:1,consts:[["class","work-package--new-state work-packages--new work-packages--show-view toolbar-container",4,"ngIf"],[1,"work-package--new-state","work-packages--new","work-packages--show-view","toolbar-container"],[3,"resource","skippedFields","inEditMode","onSaved"],[1,"toolbar"],[1,"title-container"],[3,"workPackage"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-mobile"],["id","create-wp-menu-button","wpCreateSettingsMenu","",1,"button","last","work-packages-settings-button","toolbar-icon"],[1,"button--icon","icon-show-more"],[3,"workPackage","showProject"],[3,"onCancel"]],template:function(e,t){1&e&&s.Tc(0,p,13,8,"div",0),2&e&&s.wc("ngIf",t.newWorkPackage)},directives:[r.q,a.a,c.a,o.a,l.a,d.a,u.a],encapsulation:2,changeDetection:0});const f=s.jc(g)},Va5K:function(e,t,i){"use strict";i.d(t,"c",(function(){return c})),i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return l}));var n=i("zqrF"),s=i("iMRi"),r=i("E2tj"),a=i("fXoL");const c="list",o="card";class l extends n.a{constructor(e,t){super(t),this.states=e,this.querySpace=t}hasChanged(e){return this.current!==e.displayRepresentation}valueFromQuery(e){return e.displayRepresentation||null}applyToQuery(e){const t=this.current;return e.displayRepresentation=null===t?void 0:t,!1}get current(){return this.lastUpdatedState.getValueOr(null)}get isList(){const e=this.current;return!e||e===c}get isCards(){return this.current===o}setDisplayRepresentation(e){this.update(e)}}l.\u0275fac=function(e){return new(e||l)(a.lc(s.a),a.lc(r.a))},l.\u0275prov=a.Xb({token:l,factory:l.\u0275fac})},VbPg:function(e,t,i){var n={"./admin_users":["FyB/",7,12],"./admin_users.js":["FyB/",7,12],"./administration_settings":["pIQB",7,13],"./administration_settings.js":["pIQB",7,13],"./backlogs":["1cF+",7,1,6],"./backlogs.js":["1cF+",7,1,6],"./backlogs/backlog":["VbDW",7,1],"./backlogs/backlog.js":["VbDW",7,1],"./backlogs/burndown":["n+FW",7,1],"./backlogs/burndown.js":["n+FW",7,1],"./backlogs/common":["+TUS",7,1],"./backlogs/common.js":["+TUS",7,1],"./backlogs/editable_inplace":["xOUI",7,1],"./backlogs/editable_inplace.js":["xOUI",7,1],"./backlogs/impediment":["CO8W",7,1],"./backlogs/impediment.js":["CO8W",7,1],"./backlogs/master_backlog":["QrsS",7,1],"./backlogs/master_backlog.js":["QrsS",7,1],"./backlogs/model":["vTya",7,1],"./backlogs/model.js":["vTya",7,1],"./backlogs/show_main":["ySs4",7,1],"./backlogs/show_main.js":["ySs4",7,1],"./backlogs/sprint":["gFIQ",7,1],"./backlogs/sprint.js":["gFIQ",7,1],"./backlogs/story":["6Ibq",7,1],"./backlogs/story.js":["6Ibq",7,1],"./backlogs/task":["qE9B",7,1],"./backlogs/task.js":["qE9B",7,1],"./backlogs/taskboard":["g/gS",7,1],"./backlogs/taskboard.js":["g/gS",7,1],"./backlogs/work_package":["UHLX",7,1],"./backlogs/work_package.js":["UHLX",7,1],"./custom_fields":["aLwj",7,14],"./custom_fields.js":["aLwj",7,14],"./forums":["9SdV",7,15],"./forums.js":["9SdV",7,15],"./global_roles":["qOGe",7,10],"./global_roles.ts":["qOGe",7,10],"./meeting":["dVjf",7,16],"./meeting.js":["dVjf",7,16],"./members_form":["jeHl",7,17],"./members_form.js":["jeHl",7,17],"./new_user":["1z6l",7,18],"./new_user.js":["1z6l",7,18],"./project":["y2NQ",7,19],"./project.js":["y2NQ",7,19],"./project_form_listener":["Y9rl",7,20],"./project_form_listener.js":["Y9rl",7,20],"./repository_navigation":["wJjJ",7,21],"./repository_navigation.js":["wJjJ",7,21],"./repository_settings":["815p",7,22],"./repository_settings.js":["815p",7,22],"./two_factor_authentication":["Q8SW",9,9],"./two_factor_authentication.ts":["Q8SW",9,9]};function s(e){if(!i.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],s=t[0];return Promise.all(t.slice(2).map(i.e)).then((function(){return i.t(s,t[1])}))}s.keys=function(){return Object.keys(n)},s.id="VbPg",e.exports=s},VgZ9:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("iMRi"),s=i("iB+3"),r=i("Jui0"),a=i("/C7M"),c=i("qc15"),o=i("CNq7"),l=i("fXoL");class d{constructor(e,t,i,n,s,r){this.$state=e,this.states=t,this.halEvents=i,this.notificationService=n,this.pathHelper=s,this.apiV3Service=r}changeParent(e,t){let i={lockVersion:e.lockVersion};return i._links=t?{parent:{href:this.apiV3Service.work_packages.id(t).path}}:{parent:{href:null}},e.changeParent(i).then(i=>(this.apiV3Service.work_packages.cache.updateWorkPackage(i),this.notificationService.showSave(i),this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t,relationType:"parent"}),i)).catch(t=>(this.notificationService.handleRawError(t,e),Promise.reject(t)))}removeParent(e){return this.changeParent(e,null)}addExistingChildWp(e,t){return this.apiV3Service.work_packages.id(t).get().toPromise().then(t=>this.changeParent(t,e.id).then(i=>(this.apiV3Service.work_packages.id(e).refresh(),this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t.id,relationType:"child"}),i)))}addNewChildWp(e,t){t.project.$load().then(()=>{const i=[e+".new",{parent_id:t.id}];this.$state.includes("work-packages.show")&&(i[0]="work-packages.new"),this.$state.go(...i)})}removeChild(e){return e.$load().then(()=>{let t=e.parent;return e.changeParent({_links:{parent:{href:null}},lockVersion:e.lockVersion}).then(e=>{t&&this.apiV3Service.work_packages.id(t).refresh().then(e=>{this.halEvents.push(e,{eventType:"association",relatedWorkPackage:null,relationType:"child"})}),this.apiV3Service.work_packages.cache.updateWorkPackage(e)}).catch(t=>(this.notificationService.handleRawError(t,e),Promise.reject(t)))})}}d.\u0275fac=function(e){return new(e||d)(l.lc(s.StateService),l.lc(n.a),l.lc(a.a),l.lc(c.a),l.lc(r.a),l.lc(o.a))},d.\u0275prov=l.Xb({token:d,factory:d.\u0275fac})},VknD:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("mrSG"),s=i("r0MM"),r=i("6XbZ"),a=i("E2tj"),c=i("dMmB"),o=i("J30J"),l=i("T9ri");class d extends r.a{constructor(){super(...arguments),this.text={sum:this.I18n.t("js.label_sum")}}buildSumsRow(e){const t=document.createElement("tr");return t.classList.add("wp-table--sums-row","wp-table--row",Object(l.f)(e.index)),this.renderColumns(e.sums,t),t}renderColumns(e,t){this.augmentedColumns.forEach((i,n)=>{const s=document.createElement("td"),r=this.renderContent(e,i.id,this.sumsSchema[i.id]);0===n&&this.appendFirstLabel(r),s.appendChild(r),t.append(s)})}appendFirstLabel(e){const t=document.createElement("span");t.textContent=""+this.text.sum,e.prepend(t)}get sumsSchema(){const e=this.querySpace.results.value.sumsSchema.$href;return this.schemaCache.state(e).value}renderContent(e,t,i){const n=document.createElement("div");if(n.classList.add("wp-table--sum-container",t),!i)return n;const s=this.displayFieldService.getField(e,t,i,{injector:this.injector,container:"table",options:{}});return s.isEmpty()||s.render(n,s.valueString),n}}Object(n.c)([Object(s.a)(),Object(n.e)("design:type",a.a)],d.prototype,"querySpace",void 0),Object(n.c)([Object(s.a)(),Object(n.e)("design:type",c.a)],d.prototype,"schemaCache",void 0),Object(n.c)([Object(s.a)(),Object(n.e)("design:type",o.a)],d.prototype,"displayFieldService",void 0)},VpST:function(e,t,i){"use strict";i.d(t,"a",(function(){return ts}));var n=i("u4T9"),s=i("wZYP"),r=(i("ii2/"),i("711n")),a=i("AEvm"),c=i("xgIS"),o=i("Kj3r"),l=i("fXoL"),d=i("ofXK"),u=i("+ytV"),h=i("cI0L"),p=i("80WE");function g(e,t){1&e&&(l.hc(0,"span",10),l.Vc(1," *"),l.gc())}function f(e,t){if(1&e&&(l.hc(0,"div",6),l.hc(1,"wp-replacement-label",7),l.Vc(2),l.Tc(3,g,2,0,"span",8),l.gc(),l.cc(4,"attribute-help-text",9),l.gc()),2&e){const e=l.rc(2).$implicit;l.Pb(1),l.wc("fieldName",e.name),l.Pb(1),l.Xc(" ",e.label," "),l.Pb(1),l.wc("ngIf",e.field.required&&e.field.writable),l.Pb(1),l.wc("attribute",e.name)("attributeScope","WorkPackage")}}const b=function(e){return{"wp-edit-formattable-field":e}};function m(e,t){if(1&e&&(l.hc(0,"div",11),l.cc(1,"editable-attribute-field",12),l.gc()),2&e){const e=l.rc(2).$implicit,t=l.rc();l.Pb(1),l.wc("ngClass",l.Bc(4,b,e.field.isFormattable))("resource",t.workPackage)("isDropTarget",e.field.isFormattable)("fieldName",t.fieldName(e.name))}}function w(e,t){if(1&e&&(l.Tc(0,f,5,5,"div",4),l.Tc(1,m,2,6,"div",5)),2&e){const e=l.rc().$implicit;l.wc("ngIf",!e.multiple&&e.field),l.Pb(1),l.wc("ngIf",!e.multiple&&e.field)}}const v=function(e){return{"-span-all-columns":e}};function y(e,t){if(1&e&&(l.hc(0,"div",2),l.Tc(1,w,2,2,"ng-template",3),l.gc()),2&e){const e=t.$implicit,i=l.rc();l.wc("ngClass",l.Bc(2,v,e.spanAll)),l.Pb(1),l.wc("ngIf",!i.shouldHideField(e))}}class k extends a.a{constructor(e,t,i){super(),this.I18n=e,this.wpEditForm=t,this.injector=i}ngAfterViewInit(){setTimeout(()=>this.fixColumns()),Object(c.a)(window,"resize",{passive:!0}).pipe(this.untilDestroyed(),Object(o.a)(250)).subscribe(()=>{this.fixColumns()})}trackByName(e,t){return t.name}shouldHideField(e){const t=e.field||e.fields[0];return this.wpEditForm.editMode&&!t.writable}fieldName(e){return"startDate"===e?"combinedDate":e}fixColumns(){let e=0;jQuery("div.attributes-group:contains("+this.group.name+")").find(".attributes-key-value").each((function(){let t=jQuery(this).position().top;t<e&&jQuery(this).addClass("-column-start"),e=t}))}}k.\u0275fac=function(e){return new(e||k)(l.bc(s.a),l.bc(r.a),l.bc(l.A))},k.\u0275cmp=l.Vb({type:k,selectors:[["wp-attribute-group"]],inputs:{workPackage:"workPackage",group:"group"},features:[l.Mb],decls:2,vars:2,consts:[[1,"-columns-2"],["class","attributes-key-value",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"attributes-key-value",3,"ngClass"],[3,"ngIf"],["class","attributes-key-value--key",4,"ngIf"],["class","attributes-key-value--value-container",4,"ngIf"],[1,"attributes-key-value--key"],[3,"fieldName"],["class","required",4,"ngIf"],[3,"attribute","attributeScope"],[1,"required"],[1,"attributes-key-value--value-container"],[3,"ngClass","resource","isDropTarget","fieldName"]],template:function(e,t){1&e&&(l.hc(0,"div",0),l.Tc(1,y,2,4,"div",1),l.gc()),2&e&&(l.Pb(1),l.wc("ngForOf",t.group.members)("ngForTrackBy",t.trackByName))},directives:[d.p,d.n,d.q,u.a,h.a,p.a],encapsulation:2});var C=i("oT5z"),j=i("aveh"),P=i("g1AQ"),x=i("72oW"),S=i("CVKj"),O=i("lmDM"),I=i("f24R"),T=i("d/TE"),R=i("E2tj"),E=i("wd/R"),M=i("1G5W"),F=i("pLZG"),A=i("4jc8"),L=i("FnNU"),D=i("mrSG"),V=i("iMRi"),q=i("E5Dd"),$=i("IzEk"),N=i("CNq7");const B="leftHandle",z="rightHandle";function H(e,t,i,n,s,r,a,c,o,l,d,u){e.get(R.a);let h,p,g=null;u.change=n.changeFor(u.workPackage);const f=jQuery("body");function b(e,t){const n=i.getAbsoluteLeftCoordinates(),s=t.clientX-n;return Math.floor(s/e.viewParams.pixelPerDay)}function m(e){return t=>{const i=b(u,t.originalEvent)-g,n=Math.floor(t.offsetX/u.viewParams.pixelPerDay),s=u.viewParams.dateDisplayStart.clone().add(n,"days");h=d.onDaysMoved(u.change,s,i,e),function(e,t){d.assignDateValues(e.change,l,t)}(u,h),d.update(o,l,u)}}function w(e){e.keyCode===q.a.ESCAPE&&y(!0)}function v(e){const t=u.workPackage;if(!d.isEmpty(t))return;(t.isLeaf||t.scheduleManually)&&d.canMoveDates(t)?(c.style.cursor="",p&&p.remove(),p=d.displayPlaceholderUnderCursor(e,u),c.appendChild(p),c.onmouseleave=()=>{p.remove()},c.onmousedown=e=>{p.remove(),o.style.pointerEvents="none",e.preventDefault();const t=Math.floor(e.offsetX/u.viewParams.pixelPerDay),i=u.viewParams.dateDisplayStart.clone().add(t,"days").format("YYYY-MM-DD"),n=d.onMouseDown(e,i,u,l,o);if(d.update(o,l,u),"create"===n)return y(!1),void e.preventDefault();c.onmousemove=e=>{const i=Math.floor(e.offsetX/u.viewParams.pixelPerDay),s=u.viewParams.dateDisplayStart.clone().add(i,"days"),r=i-t,a=d.onDaysMoved(u.change,s,r,n);d.assignDateValues(u.change,l,a),d.update(o,l,u)},c.onmouseleave=()=>{y(!0)},c.onmouseup=()=>{y(!1)},f.on("keyup.timelinecell",w)}):c.style.cursor="not-allowed"}function y(t){if(i.disableViewParamsCalculation=!1,c.onmousemove=v,c.onmousedown=_.noop,c.onmouseleave=_.noop,c.onmouseup=_.noop,o.style.pointerEvents="auto",f.off(".timelinecell"),i.resetCursor(),g=null,h={},t||u.change.isEmpty())k();else{const t=()=>{u.change.clear(),d.onMouseDownEnd(l,u.change)};(function(t){const i=e.get(N.a),c=e.get(R.a),o=E().toISOString();return a.table.promise=n.save(t).then(e=>{r.showSave(e.resource);const t=_.map(c.tableRendered.value,e=>e.workPackageId);return i.work_packages.filterUpdatedSince(t,o).get().toPromise().then(()=>(s.push(e.resource,{eventType:"updated"}),c.timelineRendered.pipe(Object($.a)(1)).toPromise()))})})(u.change).then(t).catch(e=>{r.handleRawError(e,u.workPackage),k()})}}function k(){u.change.clear(),d.update(o,l,u),d.onMouseDownEnd(l,u.change),i.refreshView()}o.onmousedown=e=>{1===e.which&&function(e,t){t.preventDefault();const n="active-drag";if(e.classList.add(n),f.on("mouseup.timelinecell",()=>e.classList.remove(n)),i.disableViewParamsCalculation=!0,g=b(u,t),!u.workPackage.isLeaf&&!u.viewParams.activeSelectionMode&&!u.workPackage.scheduleManually)return;const s=d.onMouseDown(t,null,u,l,e);f.on("mousemove.timelinecell",m(s)),f.on("keyup.timelinecell",w),f.on("mouseup.timelinecell",()=>y(!1))}(o,e)},c.onmousemove=v}var Q=i("Y0Nk"),W=i("SKFm"),X=i("/C7M"),U=i("qc15"),G=i("r0MM"),Y=i("dMmB");const K="labelLeft",Z="containerRight",J="labelRight",ee="labelHoverLeft",te="labelHoverRight",ie="-label-style",ne="labelFarRight",se="show-on-hover",re="hide-on-hover";class ae{constructor(e,t,i,n,s,r,a){this.center=e,this.left=t,this.leftHover=i,this.right=n,this.rightHover=s,this.farRight=r,this.withAlternativeLabels=a}}class ce{constructor(e,t,i,n,s,r){this.injector=e,this.workPackageTimeline=t,this.renderers=i,this.latestRenderInfo=n,this.classIdentifier=s,this.workPackageId=r,this.wpElement=null}getMarginLeftOfLeftSide(){return this.cellRenderer(this.latestRenderInfo.workPackage).getMarginLeftOfLeftSide(this.latestRenderInfo)}getMarginLeftOfRightSide(){return this.cellRenderer(this.latestRenderInfo.workPackage).getMarginLeftOfRightSide(this.latestRenderInfo)}getPaddingLeftForIncomingRelationLines(){return this.cellRenderer(this.latestRenderInfo.workPackage).getPaddingLeftForIncomingRelationLines(this.latestRenderInfo)}getPaddingRightForOutgoingRelationLines(){return this.cellRenderer(this.latestRenderInfo.workPackage).getPaddingRightForOutgoingRelationLines(this.latestRenderInfo)}canConnectRelations(){const e=this.latestRenderInfo.workPackage;return this.schemaCache.of(e).isMilestone?!_.isNil(e.date):!_.isNil(e.startDate)||!_.isNil(e.dueDate)}clear(){this.cellElement.html(""),this.wpElement=null}get cellContainer(){return this.workPackageTimeline.timelineBody}get cellElement(){return this.cellContainer.find("."+this.classIdentifier)}lazyInit(e,t){const i=this.workPackageTimeline.timelineBody[0],n=this.cellElement;if(!n.length)return Promise.reject("uninitialized");return null!==this.wpElement&&i.contains(this.wpElement)&&this.elementShape===e.type||(t.isDuplicatedCell||this.clear(),this.wpElement=e.render(t),this.labels=e.createAndAddLabels(t,this.wpElement),this.elementShape=e.type,n.append(this.wpElement),e.canMoveDates(t.workPackage)&&(this.wpElement.classList.add("-editable"),H(this.injector,0,this.workPackageTimeline,this.halEditing,this.halEvents,this.notificationService,this.loadingIndicator,n[0],this.wpElement,this.labels,e,t))),Promise.resolve()}cellRenderer(e){return this.schemaCache.of(e).isMilestone?this.renderers.milestone:this.renderers.generic}refreshView(e){this.latestRenderInfo=e;const t=this.cellRenderer(e.workPackage);this.lazyInit(t,e).then(()=>{t.update(this.wpElement,this.labels,e)||this.clear()}).catch(()=>null)}}Object(D.c)([Object(G.a)(),Object(D.e)("design:type",W.a)],ce.prototype,"halEditing",void 0),Object(D.c)([Object(G.a)(),Object(D.e)("design:type",X.a)],ce.prototype,"halEvents",void 0),Object(D.c)([Object(G.a)(),Object(D.e)("design:type",U.a)],ce.prototype,"notificationService",void 0),Object(D.c)([Object(G.a)(),Object(D.e)("design:type",V.a)],ce.prototype,"states",void 0),Object(D.c)([Object(G.a)(),Object(D.e)("design:type",Q.a)],ce.prototype,"loadingIndicator",void 0),Object(D.c)([Object(G.a)(),Object(D.e)("design:type",Y.a)],ce.prototype,"schemaCache",void 0);var oe=i("KEdw"),le=i("juWA"),de=i("RGDJ"),ue=i("PtkW");class he{constructor(e,t){this.injector=e,this.workPackageTimeline=t,this.text={label_children_derived_duration:this.I18n.t("js.label_children_derived_duration")},this.fieldRenderer=new oe.a(this.injector,"timeline"),this.dateDisplaysOnMouseMove={},this.ganttChartRowHeight=+getComputedStyle(document.documentElement).getPropertyValue("--table-timeline--row-height").replace("px","")}get type(){return"bar"}canMoveDates(e){const t=this.schemaCache.of(e);return t.startDate.writable&&t.dueDate.writable&&t.isAttributeEditable("startDate")}isEmpty(e){const t=E(e.startDate),i=E(e.dueDate);return _.isNaN(t.valueOf())&&_.isNaN(i.valueOf())}displayPlaceholderUnderCursor(e,t){const i=Math.floor(e.offsetX/t.viewParams.pixelPerDay),n=document.createElement("div");return n.style.pointerEvents="none",n.style.position="absolute",n.style.height="1em",n.style.width="30px",n.style.zIndex="9999",n.style.left=i*t.viewParams.pixelPerDay+"px",this.applyTypeColor(t,n),n}assignDateValues(e,t,i){this.assignDate(e,"startDate",i.startDate),this.assignDate(e,"dueDate",i.dueDate),this.updateLabels(!0,t,e)}onDaysMoved(e,t,i,n){const s=e.pristineResource.startDate,r=e.pristineResource.dueDate,a=E().format("YYYY-MM-DD"),c=E(e.projectedResource.startDate),o=E(e.projectedResource.dueDate);let l={};return"left"===n?l.startDate=E(s||r).add(i,"days"):"right"===n?l.dueDate=E(r||a).add(i,"days"):"both"===n?(s&&(l.startDate=E(s).add(i,"days")),r&&(l.dueDate=E(r).add(i,"days"))):"dragright"===n&&(l.dueDate=c.clone().add(i,"days")),"both"!==n&&(void 0!==l.startDate&&l.startDate.isAfter(o)?l.startDate=o:void 0!==l.dueDate&&l.dueDate.isBefore(c)&&(l.dueDate=c)),l}onMouseDown(e,t,i,n,s){if(i.viewParams.activeSelectionMode)return i.viewParams.activeSelectionMode(i.workPackage),e.preventDefault(),"both";const r=i.change.projectedResource;let a;return jQuery(e.target).hasClass(B)?(a="left",this.workPackageTimeline.forceCursor("col-resize"),null===r.startDate&&(r.startDate=r.dueDate)):jQuery(e.target).hasClass(z)||t?(a="right",this.workPackageTimeline.forceCursor("col-resize")):(a="both",this.workPackageTimeline.forceCursor("ew-resize")),t&&(r.startDate=t,r.dueDate=t,a="dragright"),this.updateLabels(!0,n,i.change),a}onMouseDownEnd(e,t){this.updateLabels(!1,e,t)}update(e,t,i){const n=i.change,s=e.querySelector("."+A.h);let r=E(n.projectedResource.startDate),a=E(n.projectedResource.dueDate);return _.isNaN(r.valueOf())&&_.isNaN(a.valueOf())?e.style.visibility="hidden":e.style.visibility="visible",_.isNaN(a.valueOf())&&!_.isNaN(r.valueOf())&&(a=E(),s.style.backgroundImage="linear-gradient(90deg, rgba(255,255,255,0) 0%, #F1F1F1 100%)"),_.isNaN(r.valueOf())&&!_.isNaN(a.valueOf())&&(r=a.clone(),s.style.backgroundImage="linear-gradient(90deg, #F1F1F1 0%, rgba(255,255,255,0) 80%)"),this.setElementPositionAndSize(e,i,r,a),t&&this.updateLabels(!1,t,n),this.checkForActiveSelectionMode(i,s),this.checkForSpecialDisplaySituations(i,s),this.applyTypeColor(i,s),!0}checkForActiveSelectionMode(e,t){e.viewParams.activeSelectionMode&&(t.style.backgroundImage="",e.viewParams.selectionModeStart===""+e.workPackage.id&&(jQuery(t).addClass(A.m),t.style.background="none"))}getMarginLeftOfLeftSide(e){const t=e.change.projectedResource;let i=E(t.startDate),n=E(t.dueDate);i=_.isNaN(i.valueOf())?n.clone():i;const s=i.diff(e.viewParams.dateDisplayStart,"days");return Object(A.d)(e.viewParams,s)}getMarginLeftOfRightSide(e){const t=e.change.projectedResource;let i=E(t.startDate),n=E(t.dueDate);i=_.isNaN(i.valueOf())?n.clone():i,n=_.isNaN(n.valueOf())?i.clone():n;const s=i.diff(e.viewParams.dateDisplayStart,"days"),r=n.diff(i,"days")+1;return Object(A.d)(e.viewParams,s+r)}getPaddingLeftForIncomingRelationLines(e){return e.viewParams.pixelPerDay/8}getPaddingRightForOutgoingRelationLines(e){return 0}render(e){const t=document.createElement("div"),i=document.createElement("div"),n=document.createElement("div"),s=document.createElement("div");return t.className=A.i+" "+this.type,i.className=A.h,n.className=B,s.className=z,t.appendChild(i),t.appendChild(n),t.appendChild(s),t}createAndAddLabels(e,t){const i=document.createElement("div");i.classList.add("bar-label"),this.applyTypeColor(e,i),t.appendChild(i);const n=document.createElement("div");n.classList.add(K,re),t.appendChild(n);const s=document.createElement("div");s.classList.add(Z),t.appendChild(s);const r=document.createElement("div");r.classList.add(J,re),s.appendChild(r);const a=document.createElement("div");a.classList.add(ne,re),s.appendChild(a);const c=document.createElement("div");c.classList.add(ee,se,ie),t.appendChild(c);const o=document.createElement("div");o.classList.add(te,se,ie),t.appendChild(o);const l=new ae(i,n,c,r,o,a);return this.updateLabels(!1,l,e.change),l}applyTypeColor(e,t){let i=e.workPackage.type,n=e.viewParams.activeSelectionMode;const s=i.id;n?t.classList.remove(de.a.backgroundClass("type",s)):t.classList.add(de.a.backgroundClass("type",s))}assignDate(e,t,i){i&&(e.projectedResource[t]=i.format("YYYY-MM-DD"))}setElementPositionAndSize(e,t,i,n){const s=t.viewParams,r=i.diff(s.dateDisplayStart,"days");e.style.left=Object(A.c)(s,r);const a=n.diff(i,"days")+1;if(e.style.width=Object(A.c)(s,a),!_.isNaN(i.valueOf())||!_.isNaN(n.valueOf())){const i=_.max([t.viewParams.pixelPerDay,2]);e.style.minWidth=i+"px"}}checkForSpecialDisplaySituations(e,t){const i=e.workPackage,n=t.parentElement.parentElement;let s=e.viewParams.activeSelectionMode;if(i.isLeaf||s||i.scheduleManually?t.classList.remove("-readonly"):t.classList.add("-readonly"),i.derivedStartDate&&i.derivedDueDate){const t=E(i.derivedStartDate),s=E(i.derivedDueDate),r=E(e.change.projectedResource.startDate),a=E(e.change.projectedResource.dueDate),c=n.querySelector(".children-duration-bar"),o=document.createElement("div"),l=document.createElement("div"),d=document.querySelectorAll(`.wp-timeline-cell.__hierarchy-group-${i.id}:not([class*='__collapsed-group'])`).length||0;o.classList.add("children-duration-bar","-clamp-style"),o.title=this.text.label_children_derived_duration,l.classList.add("children-duration-hover-container"),l.style.height=this.ganttChartRowHeight*d+10+"px",(t.isBefore(r)||s.isAfter(a))&&o.classList.add("-duration-overflow"),this.setElementPositionAndSize(o,e,t,s),c&&c.remove(),o.appendChild(l),n.appendChild(o)}}updateLabels(e,t,i){const n=this.wpTableTimeline.getNormalizedLabels(i.projectedResource);e||(this.renderLabel(i,t,"left",n.left),this.renderLabel(i,t,"right",n.right),this.renderLabel(i,t,"farRight",n.farRight)),this.renderHoverLabels(t,i)}renderHoverLabels(e,t){this.renderLabel(t,e,"leftHover","startDate"),this.renderLabel(t,e,"rightHover","dueDate")}renderLabel(e,t,i,n){let s=t[i];if(!s)return;if(s.innerHTML="",null===n)return void s.classList.remove("not-empty");let[r,a]=this.fieldRenderer.renderFieldValue(e.projectedResource,n,e);s&&r&&a?(a.classList.add("label-content"),s.appendChild(a),s.classList.add("not-empty")):s&&s.classList.remove("not-empty")}isParentWithVisibleChildren(e){if(!this.workPackageTimeline.inHierarchyMode)return!1;const t=this.workPackageTimeline.workPackageTable.lastRenderPass;return!!t&&!!t.parentsWithVisibleChildren[e.id]}}Object(D.c)([Object(G.a)(),Object(D.e)("design:type",ue.a)],he.prototype,"wpTableTimeline",void 0),Object(D.c)([Object(G.a)(),Object(D.e)("design:type",le.a)],he.prototype,"TimezoneService",void 0),Object(D.c)([Object(G.a)(),Object(D.e)("design:type",Y.a)],he.prototype,"schemaCache",void 0),Object(D.c)([Object(G.a)(),Object(D.e)("design:type",s.a)],he.prototype,"I18n",void 0);class pe extends he{get type(){return"milestone"}isEmpty(e){const t=E(e.date);return _.isNaN(t.valueOf())}canMoveDates(e){const t=this.schemaCache.of(e);return t.date.writable&&t.isAttributeEditable("date")}displayPlaceholderUnderCursor(e,t){const i=Math.floor(e.offsetX/t.viewParams.pixelPerDay),n=document.createElement("div");n.className="timeline-element milestone",n.style.pointerEvents="none",n.style.height="1em",n.style.width="1em",n.style.left=i*t.viewParams.pixelPerDay+"px";const s=document.createElement("div");return s.className="diamond",s.style.left="0.5em",s.style.height="1em",s.style.width="1em",n.appendChild(s),this.applyTypeColor(t,s),n}assignDateValues(e,t,i){this.assignDate(e,"date",i.date),this.updateLabels(!0,t,e)}onDaysMoved(e,t,i,n){const s=e.pristineResource.date;let r={};return s&&(r.date=E(s).add(i,"days")),r}onMouseDown(e,t,i,n,s){if(i.viewParams.activeSelectionMode)return i.viewParams.activeSelectionMode(i.workPackage),e.preventDefault(),"both";let r="both";return this.workPackageTimeline.forceCursor("ew-resize"),t?(i.change.projectedResource.date=t,r="create",r):(this.updateLabels(!0,n,i.change),r)}update(e,t,i){const n=i.viewParams,s=E(i.change.projectedResource.date);if(_.isNaN(s.valueOf()))return!1;const r=jQuery(".diamond",e)[0];r.style.width="15px",r.style.height="15px",r.style.width="15px",r.style.height="15px",r.style.marginLeft=i.viewParams.pixelPerDay/2-7.5+"px",this.applyTypeColor(i,r);const a=s.diff(n.dateDisplayStart,"days");return e.style.left=Object(A.d)(n,a)+"px",t&&this.updateLabels(!1,t,i.change),this.checkForActiveSelectionMode(i,r),!0}getMarginLeftOfLeftSide(e){const t=e.change;const i=E(t.projectedResource.date).diff(e.viewParams.dateDisplayStart,"days");return Object(A.d)(e.viewParams,i)}getMarginLeftOfRightSide(e){return this.getMarginLeftOfLeftSide(e)+e.viewParams.pixelPerDay}getPaddingLeftForIncomingRelationLines(e){return e.viewParams.pixelPerDay/2-1}getPaddingRightForOutgoingRelationLines(e){return 7.5}render(e){const t=document.createElement("div");t.className=A.i+" "+this.type;const i=document.createElement("div");return i.className="diamond",t.appendChild(i),t}createAndAddLabels(e,t){const i=document.createElement("div");i.classList.add(K,re),t.appendChild(i);const n=document.createElement("div");n.classList.add(Z),t.appendChild(n);const s=document.createElement("div");s.classList.add(J,re),n.appendChild(s);const r=document.createElement("div");r.classList.add(ne,re),n.appendChild(r);const a=document.createElement("div");a.classList.add(te,se,ie),t.appendChild(a);const c=document.createElement("div");c.classList.add(ee,se,ie),t.appendChild(c);const o=new ae(null,i,c,s,a,r,e.withAlternativeLabels);return this.updateLabels(!1,o,e.change),o}renderHoverLabels(e,t){e.withAlternativeLabels?(this.renderLabel(t,e,"leftHover","date"),this.renderLabel(t,e,"rightHover","subject")):this.renderLabel(t,e,"rightHover","date")}updateLabels(e,t,i){const n=this.wpTableTimeline.getNormalizedLabels(i.projectedResource);e||(t.withAlternativeLabels?this.renderLabel(i,t,"right","subject"):"startDate"===n.left&&"dueDate"===n.right?(this.renderLabel(i,t,"left",null),this.renderLabel(i,t,"right","date")):(this.renderLabel(i,t,"left",n.left),this.renderLabel(i,t,"right",n.right)),this.renderLabel(i,t,"farRight",n.farRight)),this.renderHoverLabels(t,i)}renderLabel(e,t,i,n){"startDate"!==n&&"dueDate"!==n||(n="date"),super.renderLabel(e,t,i,n)}}class ge{constructor(e,t){this.injector=e,this.wpTimeline=t,this.cells={},this.cellRenderers={milestone:new pe(this.injector,t),generic:new he(this.injector,t)}}hasCell(e){return this.getCellsFor(e).length>0}getCellsFor(e){return _.filter(this.cells,t=>t.workPackageId===e)||[]}refreshAllCells(){this.synchronizeCells(),_.each(this.cells,e=>this.refreshSingleCell(e))}refreshCellsFor(e){_.each(this.getCellsFor(e),e=>this.refreshSingleCell(e))}refreshSingleCell(e,t,i){const n=this.renderInfoFor(e.workPackageId,t,i);n.workPackage&&e.refreshView(n)}synchronizeCells(){const e=Object.keys(this.cells),t=[];_.each(this.wpTimeline.workPackageIdOrder,e=>{const i=e.workPackageId;if(!i)return;if(this.states.workPackages.get(i).isPristine())return;const n=e.classIdentifier;this.cells[n]||(this.cells[n]=this.buildCell(n,i.toString())),t.push(n)}),_.difference(e,t).forEach(e=>{this.cells[e].clear(),delete this.cells[e]})}buildCell(e,t){return new ce(this.injector,this.wpTimeline,this.cellRenderers,this.renderInfoFor(t),e,t)}renderInfoFor(e,t,i){const n=this.states.workPackages.get(e).value;return{viewParams:this.wpTimeline.viewParameters,workPackage:n,change:this.halEditing.changeFor(n),isDuplicatedCell:t,withAlternativeLabels:i}}buildCellsAndRenderOnRow(e,t,i){const n=e.map(e=>this.buildCell(t,e));return n.forEach(e=>this.refreshSingleCell(e,i,!0)),n}}Object(D.c)([Object(G.a)(),Object(D.e)("design:type",V.a)],ge.prototype,"states",void 0),Object(D.c)([Object(G.a)(),Object(D.e)("design:type",W.a)],ge.prototype,"halEditing",void 0);var fe=i("uSJ+"),be=i("wyKs"),me=i("5iud"),we=i("qHU1"),ve=i("itXk"),ye=i("V0Il"),ke=i("T9ri"),Ce=i("1RU0");class je extends a.a{constructor(e,t,i,n,s,r,a,c,o,l,d,u,h){super(),this.injector=e,this.elementRef=t,this.states=i,this.wpTableComponent=n,this.NotificationsService=s,this.wpTableTimeline=r,this.notificationService=a,this.wpRelations=c,this.wpTableHierarchies=o,this.halEvents=l,this.querySpace=d,this.I18n=u,this.workPackageViewCollapsedGroupsService=h,this._viewParameters=new A.a,this.disableViewParamsCalculation=!1,this.workPackageIdOrder=[],this.renderers={},this.cellsRenderer=new ge(this.injector,this),this.selectionParams={notification:null},this.refreshRequest=Object(L.g)(),this.collapsedGroupsCellsMap={},this.orderedRows=[]}get commonPipes(){return e=>e.pipe(this.untilDestroyed(),Object(M.a)(this.querySpace.stopAllSubscriptions),Object(F.a)(()=>this.initialized&&this.wpTableTimeline.isVisible))}get workPackagesWithGroupHeaderCell(){const e=this.querySpace.results.value.elements.filter(e=>this.shouldBeShownInCollapsedGroupHeaders(e)).map(e=>e.id);return this.orderedRows.filter(t=>e.includes(t.workPackageId)&&!this.workPackageIdOrder.includes(t))}ngAfterViewInit(){this.$element=jQuery(this.elementRef.nativeElement),this.text={selectionMode:this.I18n.t("js.timelines.selection_mode.notification")},this.outerContainer=this.$element.find(".wp-table-timeline--outer"),this.timelineBody=this.$element.find(".wp-table-timeline--body"),this.wpTableComponent.registerTimeline(this,this.timelineBody[0]),window.addEventListener("wp-resize.timeline",()=>this.refreshRequest.putValue(void 0)),Object(ve.a)([this.querySpace.tableRendered.values$(),this.refreshRequest.changes$(),this.wpTableTimeline.live$()]).pipe(this.commonPipes).subscribe(([e,t,i])=>{this.workPackageIdOrder=e.filter(e=>!e.hidden),this.orderedRows=e,this.refreshView()}),this.setupManageCollapsedGroupHeaderCells()}workPackageCells(e){return this.cellsRenderer.getCellsFor(e)}workPackageIndex(e){return this.workPackageIdOrder.findIndex(t=>t.classIdentifier===e)}onRefreshRequested(e,t){this.renderers[e]=t}getAbsoluteLeftCoordinates(){return this.$element.offset().left}getParentScrollContainer(){return this.outerContainer.closest(me.b)[0]}get viewParameters(){return this._viewParameters}get inHierarchyMode(){return this.wpTableHierarchies.isEnabled}get initialized(){return this.workPackageTable&&this.querySpace.tableRendered.hasValue()}refreshView(){this.wpTableTimeline.isVisible?(this.wpTableTimeline.isAutoZoom()?this.applyAutoZoomLevel():(this._viewParameters.settings.zoomLevel=this.wpTableTimeline.zoomLevel,this.wpTableTimeline.appliedZoomLevel=this.wpTableTimeline.zoomLevel),Object(we.b)("refreshView() in timeline container",()=>{this.outerContainer.css("width","auto"),this.calculateViewParams(this._viewParameters),this.cellsRenderer.refreshAllCells(),_.each(this.renderers,(e,t)=>{Object(we.a)("Refreshing timeline member "+t),e(this._viewParameters)}),this.refreshCollapsedGroupsHeaderCells(this.collapsedGroupsCellsMap,this.cellsRenderer);const e=this.$element.find(A.l)[0].scrollWidth;this.outerContainer.width(e),setTimeout(()=>{this.querySpace.timelineRendered.next(null)})})):Object(we.a)("refreshView() requested, but TL is invisible.")}startAddRelationPredecessor(e){this.activateSelectionMode(e.id,t=>{this.wpRelations.addCommonRelation(e.id,"follows",t.id).then(()=>{this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t.id,relationType:"follows"})}).catch(e=>this.notificationService.handleRawError(e,t))})}startAddRelationFollower(e){this.activateSelectionMode(e.id,t=>{this.wpRelations.addCommonRelation(e.id,"precedes",t.id).then(()=>{this.halEvents.push(e,{eventType:"association",relatedWorkPackage:t.id,relationType:"precedes"})}).catch(e=>this.notificationService.handleRawError(e,t))})}getFirstDayInViewport(){const e=this.getParentScrollContainer().scrollLeft,t=Math.floor(e/this.viewParameters.pixelPerDay);return this.viewParameters.dateDisplayStart.clone().add(t,"days")}getLastDayInViewport(){const e=this.getParentScrollContainer(),t=e.scrollLeft+e.offsetWidth,i=Math.ceil(t/this.viewParameters.pixelPerDay)+1;return this.viewParameters.dateDisplayStart.clone().add(i,"days")}forceCursor(e){jQuery("."+A.i).css("cursor",e),jQuery(".wp-timeline-cell").css("cursor",e),jQuery(".hascontextmenu").css("cursor",e),jQuery(".leftHandle").css("cursor",e),jQuery(".rightHandle").css("cursor",e)}resetCursor(){jQuery("."+A.i).css("cursor",""),jQuery(".wp-timeline-cell").css("cursor",""),jQuery(".hascontextmenu").css("cursor",""),jQuery(".leftHandle").css("cursor",""),jQuery(".rightHandle").css("cursor","")}resetSelectionMode(){this._viewParameters.activeSelectionMode=null,this._viewParameters.selectionModeStart=null,this.selectionParams.notification&&this.NotificationsService.remove(this.selectionParams.notification),Mousetrap.unbind("esc"),this.$element.removeClass("active-selection-mode"),jQuery("."+A.m).removeClass(A.m),this.refreshView()}activateSelectionMode(e,t){e=e.toString(),this._viewParameters.activeSelectionMode=e=>{t(e),this.resetSelectionMode()},this._viewParameters.selectionModeStart=e,Mousetrap.bind("esc",()=>this.resetSelectionMode()),this.selectionParams.notification=this.NotificationsService.addNotice(this.text.selectionMode),this.$element.addClass("active-selection-mode"),this.refreshView()}calculateViewParams(e){if(this.disableViewParamsCalculation)return!1;const t=new A.a;let i=!1;this.getWorkPackagesToCalculateTimelineWidthFrom().forEach(i=>{const n=i.workPackageId;if(!n)return;const s=this.states.workPackages.get(n).value;if(!s)return;const r=s.startDate?E(s.startDate):e.now,a=s.dueDate?E(s.dueDate):e.now,c=s.date?E(s.date):e.now;t.dateDisplayStart=E.min(t.dateDisplayStart,e.now,r,c),t.dateDisplayEnd=E.max(t.dateDisplayEnd,e.now,a,c)}),t.dateDisplayStart=t.dateDisplayStart.subtract(e.dayCountForMarginLeft,"days");const n=this.$element.children().width(),s=e.pixelPerDay,r=Math.ceil(n/s*1.5);t.dateDisplayEnd=t.dateDisplayEnd.add(r,"days"),t.dateDisplayStart.isSame(this._viewParameters.dateDisplayStart)||(i=!0,this._viewParameters.dateDisplayStart=t.dateDisplayStart),t.dateDisplayEnd.isSame(this._viewParameters.dateDisplayEnd)||(i=!0,this._viewParameters.dateDisplayEnd=t.dateDisplayEnd);const a=[this.getFirstDayInViewport(),this.getLastDayInViewport()];return this._viewParameters.visibleViewportAtCalculationTime=a,i}applyAutoZoomLevel(){if(0===this.workPackageIdOrder.length)return;const e=this.getWorkPackagesToCalculateTimelineWidthFrom(),t=Object(A.b)(e,this.states.workPackages,this._viewParameters),i=this.$element.parent().width()-2*A.g;for(let n of A.n){if(i/Object(A.e)(n)>=t||n===_.last(A.n)){return this._viewParameters.settings.zoomLevel!==n&&(this._viewParameters.settings.zoomLevel=n,this.wpTableComponent.timeline.scrollLeft=0),void(this.wpTableTimeline.appliedZoomLevel=n)}}}setupManageCollapsedGroupHeaderCells(){this.workPackageViewCollapsedGroupsService.updates$().pipe(this.commonPipes).subscribe(e=>{this.manageCollapsedGroupHeaderCells(e,this.querySpace.results.value.elements,this.collapsedGroupsCellsMap)})}manageCollapsedGroupHeaderCells(e,t,i){const n=e.allGroupsChanged,s=e.state,r=Object.keys(s);let a=[];if(r.length){if(n)a=r.filter(t=>this.shouldManageCollapsedGroupHeaderCells(t,e));else{const t=e.lastChangedGroup;this.shouldManageCollapsedGroupHeaderCells(t,e)&&(a=[t])}a.forEach(e=>{s[e]?this.createCollapsedGroupHeaderCells(e,t,i):this.removeCollapsedGroupHeaderCells(e,i)})}}shouldManageCollapsedGroupHeaderCells(e,t){const i=Object(ke.e)(e);return this.workPackageViewCollapsedGroupsService.groupTypesWithHeaderCellsWhenCollapsed.includes(i)&&this.workPackageViewCollapsedGroupsService.groupTypesWithHeaderCellsWhenCollapsed.includes(t.groupedBy)}createCollapsedGroupHeaderCells(e,t,i){this.removeCollapsedGroupHeaderCells(e,i);const n=Object(ke.b)(e),s=Object(ke.e)(e),r=t.filter(e=>e[s].id===n).filter(e=>this.shouldBeShownInCollapsedGroupHeaders(e)&&(e.date||e.startDate)).map(e=>e.id);this.collapsedGroupsCellsMap[e]=this.cellsRenderer.buildCellsAndRenderOnRow(r,`group-${e}-timeline`,!0)}removeCollapsedGroupHeaderCells(e,t){t[e]&&(t[e].forEach(e=>e.clear()),t[e]=[])}refreshCollapsedGroupsHeaderCells(e,t){Object.keys(e).forEach(i=>{e[i].forEach(e=>t.refreshSingleCell(e,!1,!0))})}shouldBeShownInCollapsedGroupHeaders(e){return this.workPackageViewCollapsedGroupsService.wpTypesToShowInCollapsedGroupHeaders.some(t=>t(e))}getWorkPackagesToCalculateTimelineWidthFrom(){return[...this.workPackageIdOrder,...this.workPackagesWithGroupHeaderCell]}}je.\u0275fac=function(e){return new(e||je)(l.bc(l.A),l.bc(l.q),l.bc(V.a),l.bc(ye.a),l.bc(T.a),l.bc(ue.a),l.bc(U.a),l.bc(fe.a),l.bc(be.a),l.bc(X.a),l.bc(R.a),l.bc(s.a),l.bc(Ce.a))},je.\u0275cmp=l.Vb({type:je,selectors:[["wp-timeline-container"]],features:[l.Mb],decls:7,vars:0,consts:[[1,"wp-table-timeline--outer"],[1,"wp-table-timeline--container"],[1,"wp-table-timeline--body"]],template:function(e,t){1&e&&(l.hc(0,"div",0),l.hc(1,"div",1),l.cc(2,"wp-timeline-header"),l.cc(3,"wp-timeline-static-elements"),l.cc(4,"wp-timeline-grid"),l.cc(5,"wp-timeline-relations"),l.cc(6,"div",2),l.gc(),l.gc())},encapsulation:2});var Pe=i("6p3c"),xe=i("8YXA"),Se=i("PUHT"),_e=i("4lR/"),Oe=i("IaZ+"),Ie=i("JY8V"),Te=i("AeZM"),Re=i("6yP5"),Ee=(i("5HGI"),i("sngl")),Me=i("DvFC"),Fe=i("qg8y");class Ae extends Se.a{constructor(e,t,i,n,s,r,a,c,o,l){super(e,t),this.elementRef=e,this.opContextMenu=t,this.wpTableColumns=i,this.wpTableSortBy=n,this.wpTableGroupBy=s,this.wpTableHierarchies=r,this.opModalService=a,this.injector=c,this.I18n=o,this.confirmDialog=l,this.text={confirmDelete:{text:this.I18n.t("js.work_packages.table_configuration.sorting_mode.warning"),title:this.I18n.t("js.modals.form_submit.title")}}}open(e){this.table.configuration.columnMenuEnabled&&(this.buildItems(),this.opContextMenu.show(this,e))}get locals(){return{showAnchorRight:this.column&&"id"!==this.column.id,contextMenuId:"column-context-menu",items:this.items}}positionArgs(e){let t={of:this.$element.find(".generic-table--sort-header-outer")},i=super.positionArgs(e);return _.assign(i,t),i}get afterFocusOn(){return this.$element.find("#"+this.column.id)}buildItems(){let e=this.column;this.items=[{hidden:!this.wpTableSortBy.isSortable(e),linkText:this.I18n.t("js.work_packages.query.sort_descending"),icon:"icon-sort-descending",onClick:t=>this.wpTableSortBy.isManualSortingMode?(this.confirmDialog.confirm({text:this.text.confirmDelete}).then(()=>(this.wpTableSortBy.setAsSingleSortCriteria(e,Fe.b),!0)),!1):(this.wpTableSortBy.addSortCriteria(e,Fe.b),!0)},{hidden:!this.wpTableSortBy.isSortable(e),linkText:this.I18n.t("js.work_packages.query.sort_ascending"),icon:"icon-sort-ascending",onClick:t=>this.wpTableSortBy.isManualSortingMode?(this.confirmDialog.confirm({text:this.text.confirmDelete}).then(()=>(this.wpTableSortBy.setAsSingleSortCriteria(e,Fe.a),!0)),!1):(this.wpTableSortBy.addSortCriteria(e,Fe.a),!0)},{hidden:!this.wpTableGroupBy.isGroupable(e)||this.wpTableGroupBy.isCurrentlyGroupedBy(e),linkText:this.I18n.t("js.work_packages.query.group"),icon:"icon-group-by",onClick:()=>(this.wpTableHierarchies.isEnabled&&this.wpTableHierarchies.setEnabled(!1),this.wpTableGroupBy.setBy(e),!0)},{hidden:this.wpTableColumns.isFirst(e),linkText:this.I18n.t("js.work_packages.query.move_column_left"),icon:"icon-column-left",onClick:()=>(this.wpTableColumns.shift(e,-1),!0)},{hidden:this.wpTableColumns.isLast(e),linkText:this.I18n.t("js.work_packages.query.move_column_right"),icon:"icon-column-right",onClick:()=>(this.wpTableColumns.shift(e,1),!0)},{linkText:this.I18n.t("js.work_packages.query.hide_column"),icon:"icon-delete",onClick:()=>{let t=this.wpTableColumns.previous(e)||this.wpTableColumns.next(e);return this.wpTableColumns.removeColumn(e),setTimeout(()=>{t&&jQuery("#"+t.id).focus()}),!0}},{linkText:this.I18n.t("js.work_packages.query.insert_columns"),icon:"icon-columns",onClick:()=>(this.opModalService.show(Ee.a,this.injector,{initialTab:"columns"}),!0)}]}}Ae.\u0275fac=function(e){return new(e||Ae)(l.bc(l.q),l.bc(_e.a),l.bc(Ie.a),l.bc(Re.a),l.bc(Te.a),l.bc(be.a),l.bc(Oe.b),l.bc(l.A),l.bc(s.a),l.bc(Me.a))},Ae.\u0275dir=l.Wb({type:Ae,selectors:[["","opColumnsContextMenu",""]],inputs:{column:["opColumnsContextMenu-column","column"],table:["opColumnsContextMenu-table","table"]},features:[l.Mb]});var Le=i("FDKb"),De=i("t7qP"),Ve=i("1zMF"),qe=i("P7xQ"),$e=i("5gqY");class Ne{constructor(e,t,i,n){this.I18n=t,this.wpTimelineService=i,this.workPackageTimelineTableController=n,this.$element=jQuery(e.nativeElement)}ngOnInit(){this.workPackageTimelineTableController.onRefreshRequested("header",e=>this.refreshView(e))}refreshView(e){this.innerHeader=this.$element.find(".wp-table-timeline--header-inner"),this.renderLabels(e)}renderLabels(e){if(this.activeZoomLevel!==e.settings.zoomLevel){switch(this.innerHeader.empty(),this.innerHeader.attr("data-current-zoom-level",this.wpTimelineService.zoomLevel),e.settings.zoomLevel){case"days":return this.renderLabelsDays(e);case"weeks":return this.renderLabelsWeeks(e);case"months":return this.renderLabelsMonths(e);case"quarters":return this.renderLabelsQuarters(e);case"years":return this.renderLabelsYears(e)}this.activeZoomLevel=e.settings.zoomLevel}}renderLabelsDays(e){this.renderTimeSlices(e,"month",0,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("MMM YYYY"),t.classList.add("wp-timeline--header-top-bold-element"),t.style.height="13px"}),this.renderTimeSlices(e,"week",13,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("ww"),t.classList.add("-top-border"),t.style.height="32px"}),this.renderTimeSlices(e,"day",23,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("D"),t.classList.add("-top-border"),t.style.height="22px"}),this.renderTimeSlices(e,"day",33,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("dd"),t.classList.add("wp-timeline--header-day-element")})}renderLabelsWeeks(e){this.renderTimeSlices(e,"month",0,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("MMM YYYY"),t.classList.add("wp-timeline--header-top-bold-element")}),this.renderTimeSlices(e,"week",15,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("ww"),t.classList.add("-top-border"),t.style.height="22px"}),this.renderTimeSlices(e,"day",25,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("D"),t.classList.add("wp-timeline--header-middle-element")})}renderLabelsMonths(e){this.renderTimeSlices(e,"year",0,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("YYYY"),t.classList.add("wp-timeline--header-top-bold-element")}),this.renderTimeSlices(e,"month",15,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("MMM"),t.classList.add("-top-border"),t.style.height="30px"}),this.renderTimeSlices(e,"week",25,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("ww"),t.classList.add("wp-timeline--header-middle-element")})}renderLabelsQuarters(e){this.renderTimeSlices(e,"year",0,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("wp-timeline--header-top-bold-element"),t.innerHTML=e.format("YYYY")}),this.renderTimeSlices(e,"quarter",15,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=this.I18n.t("js.timelines.quarter_label",{quarter_number:e.format("Q")}),t.classList.add("-top-border"),t.style.height="30px"}),this.renderTimeSlices(e,"month",25,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("MMM"),t.classList.add("wp-timeline--header-middle-element")})}renderLabelsYears(e){this.renderTimeSlices(e,"year",0,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("YYYY"),t.classList.add("wp-timeline--header-top-bold-element")}),this.renderTimeSlices(e,"quarter",15,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=this.I18n.t("js.timelines.quarter_label",{quarter_number:e.format("Q")}),t.classList.add("-top-border"),t.style.height="30px"}),this.renderTimeSlices(e,"month",25,e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.innerHTML=e.format("M"),t.classList.add("wp-timeline--header-middle-element")})}renderTimeSlices(e,t,i,n,s,r){const{inViewportAndBoundaries:a,rest:c}=Object(A.f)(e,t,n,s);for(let[o,l]of a){const t=this.addLabelCell();t.style.top=i+"px",t.style.left=Object(A.c)(e,o.diff(n,"days")),t.style.width=Object(A.c)(e,l.diff(o,"days")+1),r(o,t)}setTimeout(()=>{for(let[t,s]of c){const a=this.addLabelCell();a.style.top=i+"px",a.style.left=Object(A.c)(e,t.diff(n,"days")),a.style.width=Object(A.c)(e,s.diff(t,"days")+1),r(t,a)}},0)}addLabelCell(){const e=document.createElement("div");return e.className=A.k,this.innerHeader.append(e),e}}Ne.\u0275fac=function(e){return new(e||Ne)(l.bc(l.q),l.bc(s.a),l.bc(ue.a),l.bc(je))},Ne.\u0275cmp=l.Vb({type:Ne,selectors:[["wp-timeline-header"]],decls:2,vars:0,consts:[[1,"wp-table-timeline--header"],[1,"wp-table-timeline--header-inner"]],template:function(e,t){1&e&&(l.hc(0,"div",0),l.cc(1,"div",1),l.gc())},encapsulation:2});var Be=i("lJxs");function ze(e){return"__tl-relation-"+e}class He{constructor(e,t){this.belongsToId=e,this.relation=t}get classNames(){return[ze(this.relation.ids.from),ze(this.relation.ids.to)]}}const Qe="relation-line";function We(e,t,i,n,s,r,a,c){const o=document.createElement("div");return o.classList.add(A.i,Qe,...t),o.style.top=40*i+n+"px",o.style.left=s+"px",o.style.width=r+"px",o.style.height=a+"px",o}class Xe extends a.a{constructor(e,t,i,n,s,r){super(),this.injector=e,this.elementRef=t,this.states=i,this.workPackageTimelineTableController=n,this.wpTableTimeline=s,this.wpRelations=r,this.workPackagesWithRelations={}}ngOnInit(){const e=jQuery(this.elementRef.nativeElement);this.container=e.find(".wp-table-timeline--relations"),this.workPackageTimelineTableController.onRefreshRequested("relations",e=>this.refreshView()),this.setupRelationSubscription()}refreshView(){this.update()}get workPackageIdOrder(){return this.workPackageTimelineTableController.workPackageIdOrder}setupRelationSubscription(){Object(ve.a)([this.querySpace.renderedWorkPackages.values$(),this.wpTableTimeline.live$()]).pipe(Object(F.a)(([e,t])=>t.visible),this.untilDestroyed(),Object(Be.a)(([e,t])=>e)).subscribe(e=>{const t=_.compact(e.map(e=>e.workPackageId));this.wpRelations.requireAll(t),t.forEach(e=>{const t=this.wpRelations.state(e);this.workPackagesWithRelations[e]=t,t.values$().pipe(Object($.a)(1)).subscribe(()=>{this.renderWorkPackagesRelations([e])})})}),this.states.workPackages.observeChange().pipe(this.untilDestroyed(),Object(F.a)(()=>this.wpTableTimeline.isVisible)).subscribe(([e])=>{this.renderWorkPackagesRelations([e])})}renderWorkPackagesRelations(e){e.forEach(e=>{const t=this.workPackagesWithRelations[e];if(_.isNil(t))return;this.removeRelationElementsForWorkPackage(e);const i=_.values(t.value);_.values(i).forEach(e=>{if("precedes"!==e.type&&"follows"!==e.type)return;const t=new He(e.ids.from,e);this.renderElement(this.workPackageTimelineTableController.viewParameters,t)})})}update(){this.removeAllVisibleElements(),this.renderElements()}removeRelationElementsForWorkPackage(e){const t=ze(e);this.container.find("."+t).remove()}removeAllVisibleElements(){this.container.find(".relation-line").remove()}renderElements(){const e=_.keys(this.workPackagesWithRelations);this.renderWorkPackagesRelations(e)}renderElement(e,t){const i=t.relation.ids,n=this.workPackageTimelineTableController.workPackageCells(i.to),s=this.workPackageTimelineTableController.workPackageCells(i.from);0!==n.length&&0!==s.length&&n.forEach(i=>{const n=this.workPackageTimelineTableController.workPackageIndex(i.classIdentifier);s.forEach(s=>{const r=this.workPackageTimelineTableController.workPackageIndex(s.classIdentifier);this.renderRelation(e,t,n,r,i,s)})})}renderRelation(e,t,i,n,s,r){const a=this.workPackageIdOrder[i],c=this.workPackageIdOrder[n];if(!a||!c||a.hidden||c.hidden)return;if(!s.canConnectRelations()||!r.canConnectRelations())return;const o=s.getMarginLeftOfRightSide()-s.getPaddingRightForOutgoingRelationLines(),l=r.getMarginLeftOfLeftSide()+r.getPaddingLeftForIncomingRelationLines(),d=i<n?"toDown":"toUp",u=l>o?"toRight":l<o?"toLeft":"beneath";if(!s)return;const h=s.getPaddingRightForOutgoingRelationLines(),p=r.getPaddingLeftForIncomingRelationLines()+(h>0?h:0);this.container.append(We(0,t.classNames,i,19,o,p,1));let g=o+p;const f=Math.abs(n-i);"toDown"===d?"toRight"===u||"beneath"===u?this.container.append(We(0,t.classNames,i,19,g,1,40*f)):"toLeft"===u&&this.container.append(We(0,t.classNames,i,19,g,1,40*f-10)):"toUp"===d&&this.container.append(We(0,t.classNames,n,30,g,1,40*f-10)),"toRight"===u?"toDown"===d?this.container.append(We(0,t.classNames,n,19,g,l-g,1)):"toUp"===d&&(this.container.append(We(0,t.classNames,n,20,g,1,10)),this.container.append(We(0,t.classNames,n,20,g,l-g,1))):"toLeft"===u&&("toDown"===d?(this.container.append(We(0,t.classNames,n,0,g,1,8)),this.container.append(We(0,t.classNames,n,8,l,g-l,1)),this.container.append(We(0,t.classNames,n,8,l,1,11))):"toUp"===d&&(this.container.append(We(0,t.classNames,n,30,l+1,g-l,1)),this.container.append(We(0,t.classNames,n,19,l+1,1,11))))}}Xe.\u0275fac=function(e){return new(e||Xe)(l.bc(l.A),l.bc(l.q),l.bc(V.a),l.bc(je),l.bc(ue.a),l.bc(fe.a))},Xe.\u0275cmp=l.Vb({type:Xe,selectors:[["wp-timeline-relations"]],features:[l.Mb],decls:1,vars:0,consts:[[1,"wp-table-timeline--relations"]],template:function(e,t){1&e&&l.cc(0,"div",0)},encapsulation:2}),Object(D.c)([Object(G.a)(),Object(D.e)("design:type",R.a)],Xe.prototype,"querySpace",void 0);const Ue="wp-timeline--static-element";class Ge extends class{constructor(){}render(e){const t=document.createElement("div");return t.id=this.identifier,t.classList.add(...this.classNames),this.finishElement(t,e)}get classNames(){return[Ue]}}{finishElement(e,t){const i=t.now.diff(t.dateDisplayStart,"days"),n=E().hour()/24;return e.style.left=Object(A.c)(t,i+n),e}get identifier(){return"wp-timeline-static-element-today-line"}}class Ye{constructor(e,t,i){this.states=t,this.workPackageTimelineTableController=i,this.$element=jQuery(e.nativeElement),this.elements=[new Ge]}ngOnInit(){this.container=this.$element.find(".wp-table-timeline--static-elements"),this.workPackageTimelineTableController.onRefreshRequested("static elements",e=>this.update(e))}update(e){this.removeAllVisibleElements(),this.renderElements(e)}removeAllVisibleElements(){jQuery(".wp-timeline--static-element").remove()}renderElements(e){for(const t of this.elements)this.container[0].appendChild(t.render(e))}}function Ke(e,t){const i=e.day();0!==i&&6!==i||t.classList.add("grid-weekend")}Ye.\u0275fac=function(e){return new(e||Ye)(l.bc(l.q),l.bc(V.a),l.bc(je))},Ye.\u0275cmp=l.Vb({type:Ye,selectors:[["wp-timeline-static-elements"]],decls:1,vars:0,consts:[[1,"wp-table-timeline--static-elements"]],template:function(e,t){1&e&&l.cc(0,"div",0)},encapsulation:2});class Ze{constructor(e,t){this.elementRef=e,this.wpTimeline=t}ngAfterViewInit(){const e=jQuery(this.elementRef.nativeElement);this.gridContainer=e.find(".wp-table-timeline--grid"),this.wpTimeline.onRefreshRequested("grid",e=>this.refreshView(e))}refreshView(e){this.renderLabels(e)}renderLabels(e){if(this.activeZoomLevel!==e.settings.zoomLevel){switch(this.gridContainer.empty(),e.settings.zoomLevel){case"days":return this.renderLabelsDays(e);case"weeks":return this.renderLabelsWeeks(e);case"months":return this.renderLabelsMonths(e);case"quarters":return this.renderLabelsQuarters(e);case"years":return this.renderLabelsYears(e)}this.activeZoomLevel=e.settings.zoomLevel}}renderLabelsDays(e){this.renderTimeSlices(e,"day",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.style.paddingTop="1px",Ke(e,t)}),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight"),t.style.zIndex="2"})}renderLabelsWeeks(e){this.renderTimeSlices(e,"day",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{Ke(e,t)}),this.renderTimeSlices(e,"week",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight")}),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight"),t.style.zIndex="2"})}renderLabelsMonths(e){this.renderTimeSlices(e,"week",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{}),this.renderTimeSlices(e,"month",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight")}),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight"),t.style.zIndex="2"})}renderLabelsQuarters(e){this.renderTimeSlices(e,"month",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{}),this.renderTimeSlices(e,"quarter",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight")}),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight"),t.style.zIndex="2"})}renderLabelsYears(e){this.renderTimeSlices(e,"month",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{}),this.renderTimeSlices(e,"year",e.dateDisplayStart,e.dateDisplayEnd,(e,t)=>{t.classList.add("-grid-highlight")})}renderTimeSlices(e,t,i,n,s){const{inViewportAndBoundaries:r,rest:a}=Object(A.f)(e,t,i,n);for(let[c,o]of r){const t=document.createElement("div");t.classList.add(A.i,A.j),t.style.left=Object(A.c)(e,c.diff(i,"days")),t.style.width=Object(A.c)(e,o.diff(c,"days")+1),this.gridContainer[0].appendChild(t),s(c,t)}setTimeout(()=>{for(let[t,n]of a){const r=document.createElement("div");r.classList.add(A.i,A.j),r.style.left=Object(A.c)(e,t.diff(i,"days")),r.style.width=Object(A.c)(e,n.diff(t,"days")+1),this.gridContainer[0].appendChild(r),s(t,r)}},0)}}Ze.\u0275fac=function(e){return new(e||Ze)(l.bc(l.q),l.bc(je))},Ze.\u0275cmp=l.Vb({type:Ze,selectors:[["wp-timeline-grid"]],decls:1,vars:0,consts:[[1,"wp-table-timeline--grid"]],template:function(e,t){1&e&&l.cc(0,"div",0)},encapsulation:2});var Je=i("ul8C"),et=i("gvAf"),tt=i("K8b8"),it=i("4Obc"),nt=i("+pCT"),st=i("vd15"),rt=i("9oW/"),at=i("Tcty"),ct=i("Wo/B"),ot=i("oLh2"),lt=i("0XIV"),dt=i("ODu2"),ut=i("xRac"),ht=i("kY/U"),pt=i("lJGx"),gt=i("S2zE"),ft=i("9pt+"),bt=i("2orT"),mt=i("m3nR"),wt=i("8+xT"),vt=i("ZAVI"),yt=i("qs3h"),kt=i("m0WY"),Ct=i("BV52"),jt=i("s/U8"),Pt=i("60np"),xt=i("4fzr"),St=i("2TbE"),_t=i("Eofd"),Ot=i("p5fp"),It=i("eaMR"),Tt=i("70hh"),Rt=i("Ndcw"),Et=i("TAxG"),Mt=i("72I8"),Ft=i("DiYd"),At=i("67Ga"),Lt=i("SgrZ"),Dt=i("ahm3"),Vt=i("q/QC"),qt=i("OhNT"),$t=i("BjK6"),Nt=i("82q4"),Bt=i("r76g"),zt=i("Uprc"),Ht=i("byj5"),Qt=i("YO9K"),Wt=i("hj8t"),Xt=i("yUKD"),Ut=i("AcWF"),Gt=i("ylTo"),Yt=(i("y2Tr"),i("th4C")),Kt=i("u8Ab"),Zt=i("/Rze"),Jt=i("N5AO");const ei=function(e){return{deleting:e}};class ti{constructor(e,t){this.I18n=e,this.panelCtrl=t,this.deleting=!1}ngOnInit(){this.text={remove:this.I18n.t("js.label_remove_watcher",{name:this.watcher.name})}}remove(){this.deleting=!0,this.panelCtrl.removeWatcher(this.watcher)}}ti.\u0275fac=function(e){return new(e||ti)(l.bc(s.a),l.bc(Gt.a))},ti.\u0275cmp=l.Vb({type:ti,selectors:[["wp-watcher-entry"]],inputs:{watcher:"watcher"},decls:8,vars:10,consts:[["focus-within","accessible-by-keyboard",1,"form--selected-value--container"],[1,"form--selected-value"],[3,"ngClass"],["data-class-list","avatar-mini"],[1,"work-package--watcher-name",3,"textContent"],["linkClass","form--selected-value--remover",3,"linkAriaLabel","linkTitle","execute"],["icon-classes","icon-remove",3,"icon-title"]],template:function(e,t){1&e&&(l.hc(0,"div",0),l.hc(1,"span",1),l.hc(2,"span",2),l.hc(3,"a"),l.cc(4,"user-avatar",3),l.cc(5,"span",4),l.gc(),l.gc(),l.gc(),l.hc(6,"accessible-by-keyboard",5),l.pc("execute",(function(){return t.remove()})),l.cc(7,"op-icon",6),l.gc(),l.gc()),2&e&&(l.Pb(2),l.wc("ngClass",l.Bc(8,ei,t.deleting)),l.Pb(1),l.Qb("href",t.watcher.showUser.href,l.Oc),l.Pb(1),l.Qb("data-user-name",t.watcher.name)("data-user-id",t.watcher.id),l.Pb(1),l.wc("textContent",t.watcher.name),l.Pb(1),l.wc("linkAriaLabel",t.text.remove)("linkTitle",t.text.remove),l.Pb(1),l.wc("icon-title",t.text.remove))},directives:[Yt.a,d.n,Kt.a,Zt.a,Jt.a],encapsulation:2});var ii=i("VYxi"),ni=i("4fM7"),si=i("XZlt"),ri=i("ZGxV"),ai=i("kZPr"),ci=i("F3Jm"),oi=i("u/Nd"),li=i("VPzE"),di=i("UUNb"),ui=i("k1Xe"),hi=i("saRB"),pi=i("TrTv"),gi=i("Xmgp"),fi=i("EnRq"),bi=i("VknD");class mi{constructor(e,t,i,n,s,r,a,c){this.injector=e,this.elementRef=t,this.querySpace=i,this.states=n,this.schemaCache=s,this.wpTableColumns=r,this.wpTableSums=a,this.I18n=c,this.text={sum:c.t("js.label_sum")}}ngAfterViewInit(){this.$element=jQuery(this.elementRef.nativeElement),Object(ve.a)([this.wpTableColumns.live$(),this.wpTableSums.live$(),this.querySpace.results.values$()]).pipe(Object(M.a)(this.querySpace.stopAllSubscriptions)).subscribe(([e,t,i])=>{t&&i.sumsSchema?this.schemaCache.ensureLoaded(i.sumsSchema.$href).then(t=>{this.refresh(e,i,t)}):this.clear()})}clear(){this.$element.empty()}refresh(e,t,i){this.clear(),this.render(e,t,i)}render(e,t,i){this.groupSumsBuilder=new bi.a(this.injector,this.workPackageTable),this.groupSumsBuilder.renderColumns(t.totalSums,this.elementRef.nativeElement)}}mi.\u0275fac=function(e){return new(e||mi)(l.bc(l.A),l.bc(l.q),l.bc(R.a),l.bc(V.a),l.bc(Y.a),l.bc(Ie.a),l.bc(fi.a),l.bc(s.a))},mi.\u0275dir=l.Wb({type:mi,selectors:[["","wpTableSumsRow",""]],inputs:{workPackageTable:["wpTableSumsRow-table","workPackageTable"]}});var wi=i("WgCp"),vi=i("oJ+N"),yi=i("Ioun"),ki=i("CK39"),Ci=i("kTg4"),ji=i("l4W+"),Pi=i("VFHb"),xi=i("mMv8"),Si=i("t+3x"),_i=i("i95X"),Oi=i("Jui0"),Ii=i("pL6k"),Ti=i("sl7t"),Ri=i("FDFi"),Ei=i("Rky/"),Mi=i("Yblc");i("B4Ei");function Fi(e,t){if(1&e&&(l.hc(0,"div",4),l.hc(1,"div",5),l.cc(2,"h3",6),l.gc(),l.gc()),2&e){const e=l.rc(2);l.Pb(2),l.wc("textContent",e.group.name)}}const Ai=function(e){return{actionsColumnEnabled:!0,hierarchyToggleEnabled:!1,inlineCreateEnabled:!0,compactTableStyle:!0,columnMenuEnabled:!1,contextMenuEnabled:!1,projectIdentifier:e,projectContext:!1}};function Li(e,t){if(1&e){const e=l.ic();l.fc(0),l.Tc(1,Fi,3,1,"div",1),l.hc(2,"wp-embedded-table",2,3),l.pc("onQueryLoaded",(function(t){l.Lc(e);return l.rc().handleQueryLoaded(t)})),l.gc(),l.ec()}if(2&e){const e=l.rc();l.Pb(1),l.wc("ngIf",e.group),l.Pb(1),l.wc("initialLoadingIndicator",!1)("queryProps",e.queryProps)("tableActions",e.tableActions)("configuration",l.Bc(5,Ai,e.workPackage.project.idFromLink))}}class Di extends Ei.a{constructor(e,t,i,n,s,r,a){super(s),this.PathHelper=e,this.wpInlineCreate=t,this.wpRelations=i,this.halEvents=n,this.queryUrlParamsHelper=s,this.notificationService=r,this.I18n=a,this.tableActions=[Ti.a.factoryFor("remove-relation-action",this.I18n.t("js.relation_buttons.remove"),e=>{this.embeddedTable.loadingIndicator=this.wpRelations.require(e.id).then(()=>this.wpInlineCreate.remove(this.workPackage,e)).then(()=>this.refreshTable()).catch(e=>this.notificationService.handleRawError(e,this.workPackage))},e=>!!e.changeParent)]}ngOnInit(){let e=this.getRelationTypeFromQuery();this.wpInlineCreate.referenceTarget=this.workPackage,this.wpInlineCreate.relationType=e,this.queryProps=this.buildQueryProps(),this.wpInlineCreate.newInlineWorkPackageCreated.pipe(this.untilDestroyed()).subscribe(e=>this.addRelation(e)),this.wpRelations.observe(this.workPackage.id).pipe(Object(F.a)(e=>!_.isEmpty(e)),this.untilDestroyed()).subscribe(()=>this.refreshTable())}addRelation(e){this.wpInlineCreate.add(this.workPackage,e).then(()=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:e,relationType:this.getRelationTypeFromQuery()})}).catch(e=>this.notificationService.handleRawError(e,this.workPackage))}getRelationTypeFromQuery(){return this.group.relationType}}Di.\u0275fac=function(e){return new(e||Di)(l.bc(Oi.a),l.bc(Ri.a),l.bc(fe.a),l.bc(X.a),l.bc(Ii.a),l.bc(U.a),l.bc(s.a))},Di.\u0275cmp=l.Vb({type:Di,selectors:[["wp-relation-query"]],inputs:{workPackage:"workPackage",query:"query",group:"group"},features:[l.Ob([{provide:Ri.a,useClass:Mi.a}]),l.Mb],decls:1,vars:1,consts:[[4,"ngIf"],["class","attributes-group--header",4,"ngIf"],[3,"initialLoadingIndicator","queryProps","tableActions","configuration","onQueryLoaded"],["embeddedTable",""],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function(e,t){1&e&&l.Tc(0,Li,4,7,"ng-container",0),2&e&&l.wc("ngIf",!t.hidden)},directives:[d.q,x.a],encapsulation:2});var Vi=i("YefF"),qi=i("PwL/"),$i=i("rJ6b"),Ni=i("2yvi"),Bi=i("5mBr"),zi=i("Q2ix"),Hi=i("1SJX"),Qi=i("hvpr"),Wi=i("HEQ6"),Xi=i("w6CH"),Ui=i("MIK2"),Gi=i("wOIT");class Yi{constructor(e,t,i,n){this.I18n=e,this.injector=t,this.opModalService=i,this.opContextMenu=n}ngOnInit(){this.text={configureTable:I18n.t("js.toolbar.settings.configure_view")}}openTableConfigurationModal(){this.opContextMenu.close(),this.opModalService.show(Ee.a,this.injector)}}Yi.\u0275fac=function(e){return new(e||Yi)(l.bc(s.a),l.bc(l.A),l.bc(Oe.b),l.bc(_e.a))},Yi.\u0275cmp=l.Vb({type:Yi,selectors:[["wp-table-config-menu"]],decls:2,vars:2,consts:[["linkClass","wp-table--columns-selection",3,"linkTitle","linkAriaLabel","execute"],["icon-classes","icon-button icon-small icon-settings"]],template:function(e,t){1&e&&(l.hc(0,"accessible-by-keyboard",0),l.pc("execute",(function(){return t.openTableConfigurationModal()})),l.cc(1,"op-icon",1),l.gc()),2&e&&l.wc("linkTitle",t.text.configureTable)("linkAriaLabel",t.text.configureTable)},directives:[Zt.a,Jt.a],encapsulation:2});var Ki=i("ZTEj"),Zi=i("XlgE"),Ji=i("eJFM"),en=i("+B5R"),tn=i("GZlY"),nn=i("2bW2"),sn=i("+NA0"),rn=i("SIjI"),an=i("GntA");class cn extends an.a{setValue(e,t){super.setValue(e,t),"workPackage"===e&&this.updateForm()}buildPayloadFromChanges(){let e=super.buildPayloadFromChanges();return delete e._links.project,e}}var on=i("fdeW"),ln=i("ahVz"),dn=i("hxzR"),un=i("EzE4"),hn=i("DLfB"),pn=i("yOxh"),gn=i("nv3t"),fn=i("0loS"),bn=i("3Pt+"),mn=i("+rOU"),wn=i("vxfF"),vn=i("5+WD"),yn=i("kor4"),kn=i("1EAr"),Cn=i("ZOsW"),jn=i("ximh"),Pn=i("ecJW"),xn=i("QihR"),Sn=i("RN/J"),_n=i("oUDv"),On=i("2hMx"),In=i("+1L4"),Tn=i("cJ7v"),Rn=i("lmKF"),En=i("HN1l"),Mn=i("v9+U"),Fn=i("mRSd"),An=i("X4Sm"),Ln=i("qvi4"),Dn=i("lfQJ"),Vn=i("AdL0"),qn=i("8h6p"),$n=i("IYP9"),Nn=i("upbp"),Bn=i("CV67"),zn=i("xFOf"),Hn=i("CS/5"),Qn=i("gh2L"),Wn=i("jQQo"),Xn=i("S8rk"),Un=i("32V0"),Gn=i("7MH/"),Yn=i("feia"),Kn=i("k8lp"),Zn=i("jEcX"),Jn=i("xiBa"),es=i("zTuL");class ts{constructor(e){ts.bootstrapAttributeGroups(e)}static bootstrapAttributeGroups(e){if(this.bootstrapAttributeGroupsCalled)return;this.bootstrapAttributeGroupsCalled=!0;const t=e.get(P.a);t.register("attributeGroupComponent",(e,t)=>"WorkPackageFormAttributeGroup"===e.type?k:t.isNew||"WorkPackageFormChildrenQueryGroup"!==e.type?t.isNew||"WorkPackageFormRelationQueryGroup"!==e.type?null:Di:Si.a),t.register("workPackageAttachmentUploadComponent",e=>Ni.a),t.register("workPackageAttachmentListComponent",e=>Bi.a),t.register("halResourceChangesetClass",e=>{switch(e._type){case"WorkPackage":return sn.a;case"TimeEntry":return cn;default:return null}})}}ts.bootstrapAttributeGroupsCalled=!1,ts.\u0275mod=l.Zb({type:ts}),ts.\u0275inj=l.Yb({factory:function(e){return new(e||ts)(l.lc(l.A))},providers:[U.a,vi.a,ki.a,Y.a,Hi.a,Ci.a,ji.a,fe.a,xi.a,fe.a,Pi.a,X.a],imports:[[n.a,C.a,gi.a,ut.a,Xi.a,tn.a]]}),l.Pc(ye.a,[fn.UISref,fn.AnchorUISref,fn.UIView,fn.UISrefActive,fn.UISrefStatus,d.n,d.o,d.p,d.q,d.x,d.t,d.u,d.v,d.w,d.r,d.s,bn.C,bn.r,bn.B,bn.c,bn.s,bn.v,bn.a,bn.y,bn.z,bn.u,bn.m,bn.n,bn.x,bn.k,bn.j,bn.t,bn.b,bn.d,bn.p,bn.q,bn.o,mn.a,mn.b,mn.h,mn.e,wn.a,vn.e,vn.f,vn.a,vn.b,vn.d,vn.c,yn.a,kn.a,Zt.a,Cn.a,Cn.n,Cn.d,Cn.c,Cn.e,Cn.f,Cn.g,Cn.h,Cn.i,Cn.j,Cn.k,Cn.l,Cn.m,jn.a,Pn.a,xn.a,Jt.a,Sn.a,Yt.a,_n.a,On.a,In.a,Tn.a,Rn.a,En.a,Mn.a,Fn.a,An.a,Ln.a,Dn.a,Vn.a,qn.a,$n.a,Nn.a,Bn.a,Kt.a,zn.a,Hn.c,Hn.d,Hn.a,Hn.b,Hn.e,Qn.a,Wn.a,Xn.a,Un.a,Gn.a,r.a,p.a,h.a,Yn.a,Kn.a,Ni.a,Bi.a,Zn.a,Jn.a,es.a,Vi.a,ln.a,dn.a,on.a,un.a,Wi.a,Ki.a,ai.a,ri.a,si.a,nn.a,ii.a,ni.a,x.a,S.a,wi.a,yi.a,Pe.a,_i.a,Ji.a,ye.a,Yi,O.a,I.a,mi,Nt.a,Tt.a,Rt.a,Et.a,Mt.a,Ft.a,At.a,Lt.a,Dt.a,Vt.a,qt.a,It.a,Ot.a,xe.a,Ae,Le.a,De.a,Ve.a,qe.a,$e.a,en.a,gn.a,Je.a,Ne,Xe,Ye,Ze,je,St.a,zi.a,et.a,j.a,tt.a,u.a,nt.a,Si.a,Di,k,hn.a,it.a,st.a,rt.a,at.a,ct.a,ot.a,lt.a,dt.a,Gt.a,ti,yt.a,kt.a,Ct.a,jt.a,Pt.a,xt.a,Ui.a,_t.a,$t.a,qi.a,gt.a,ft.a,bt.a,mt.a,wt.a,vt.a,$i.a,Ee.a,Bt.a,zt.a,Ht.a,Qt.a,Wt.a,Xt.a,Ut.a,ci.a,ui.a,oi.a,li.a,di.a,pn.a,ht.a,pt.a,Gi.a,hi.a,pi.a,Qi.a,rn.a,Zi.a],[d.a,d.C,d.m,d.j,d.A,d.f,d.z,d.B,d.c,d.e,d.h,d.i,d.k]),l.Pc(je,[fn.UISref,fn.AnchorUISref,fn.UIView,fn.UISrefActive,fn.UISrefStatus,d.n,d.o,d.p,d.q,d.x,d.t,d.u,d.v,d.w,d.r,d.s,bn.C,bn.r,bn.B,bn.c,bn.s,bn.v,bn.a,bn.y,bn.z,bn.u,bn.m,bn.n,bn.x,bn.k,bn.j,bn.t,bn.b,bn.d,bn.p,bn.q,bn.o,mn.a,mn.b,mn.h,mn.e,wn.a,vn.e,vn.f,vn.a,vn.b,vn.d,vn.c,yn.a,kn.a,Zt.a,Cn.a,Cn.n,Cn.d,Cn.c,Cn.e,Cn.f,Cn.g,Cn.h,Cn.i,Cn.j,Cn.k,Cn.l,Cn.m,jn.a,Pn.a,xn.a,Jt.a,Sn.a,Yt.a,_n.a,On.a,In.a,Tn.a,Rn.a,En.a,Mn.a,Fn.a,An.a,Ln.a,Dn.a,Vn.a,qn.a,$n.a,Nn.a,Bn.a,Kt.a,zn.a,Hn.c,Hn.d,Hn.a,Hn.b,Hn.e,Qn.a,Wn.a,Xn.a,Un.a,Gn.a,r.a,p.a,h.a,Yn.a,Kn.a,Ni.a,Bi.a,Zn.a,Jn.a,es.a,Vi.a,ln.a,dn.a,on.a,un.a,Wi.a,Ki.a,ai.a,ri.a,si.a,nn.a,ii.a,ni.a,x.a,S.a,wi.a,yi.a,Pe.a,_i.a,Ji.a,ye.a,Yi,O.a,I.a,mi,Nt.a,Tt.a,Rt.a,Et.a,Mt.a,Ft.a,At.a,Lt.a,Dt.a,Vt.a,qt.a,It.a,Ot.a,xe.a,Ae,Le.a,De.a,Ve.a,qe.a,$e.a,en.a,gn.a,Je.a,Ne,Xe,Ye,Ze,je,St.a,zi.a,et.a,j.a,tt.a,u.a,nt.a,Si.a,Di,k,hn.a,it.a,st.a,rt.a,at.a,ct.a,ot.a,lt.a,dt.a,Gt.a,ti,yt.a,kt.a,Ct.a,jt.a,Pt.a,xt.a,Ui.a,_t.a,$t.a,qi.a,gt.a,ft.a,bt.a,mt.a,wt.a,vt.a,$i.a,Ee.a,Bt.a,zt.a,Ht.a,Qt.a,Wt.a,Xt.a,Ut.a,ci.a,ui.a,oi.a,li.a,di.a,pn.a,ht.a,pt.a,Gi.a,hi.a,pi.a,Qi.a,rn.a,Zi.a],[d.a,d.C,d.m,d.j,d.A,d.f,d.z,d.B,d.c,d.e,d.h,d.i,d.k]),l.Pc(Gt.a,[fn.UISref,fn.AnchorUISref,fn.UIView,fn.UISrefActive,fn.UISrefStatus,d.n,d.o,d.p,d.q,d.x,d.t,d.u,d.v,d.w,d.r,d.s,bn.C,bn.r,bn.B,bn.c,bn.s,bn.v,bn.a,bn.y,bn.z,bn.u,bn.m,bn.n,bn.x,bn.k,bn.j,bn.t,bn.b,bn.d,bn.p,bn.q,bn.o,mn.a,mn.b,mn.h,mn.e,wn.a,vn.e,vn.f,vn.a,vn.b,vn.d,vn.c,yn.a,kn.a,Zt.a,Cn.a,Cn.n,Cn.d,Cn.c,Cn.e,Cn.f,Cn.g,Cn.h,Cn.i,Cn.j,Cn.k,Cn.l,Cn.m,jn.a,Pn.a,xn.a,Jt.a,Sn.a,Yt.a,_n.a,On.a,In.a,Tn.a,Rn.a,En.a,Mn.a,Fn.a,An.a,Ln.a,Dn.a,Vn.a,qn.a,$n.a,Nn.a,Bn.a,Kt.a,zn.a,Hn.c,Hn.d,Hn.a,Hn.b,Hn.e,Qn.a,Wn.a,Xn.a,Un.a,Gn.a,r.a,p.a,h.a,Yn.a,Kn.a,Ni.a,Bi.a,Zn.a,Jn.a,es.a,Vi.a,ln.a,dn.a,on.a,un.a,Wi.a,Ki.a,ai.a,ri.a,si.a,nn.a,ii.a,ni.a,x.a,S.a,wi.a,yi.a,Pe.a,_i.a,Ji.a,ye.a,Yi,O.a,I.a,mi,Nt.a,Tt.a,Rt.a,Et.a,Mt.a,Ft.a,At.a,Lt.a,Dt.a,Vt.a,qt.a,It.a,Ot.a,xe.a,Ae,Le.a,De.a,Ve.a,qe.a,$e.a,en.a,gn.a,Je.a,Ne,Xe,Ye,Ze,je,St.a,zi.a,et.a,j.a,tt.a,u.a,nt.a,Si.a,Di,k,hn.a,it.a,st.a,rt.a,at.a,ct.a,ot.a,lt.a,dt.a,Gt.a,ti,yt.a,kt.a,Ct.a,jt.a,Pt.a,xt.a,Ui.a,_t.a,$t.a,qi.a,gt.a,ft.a,bt.a,mt.a,wt.a,vt.a,$i.a,Ee.a,Bt.a,zt.a,Ht.a,Qt.a,Wt.a,Xt.a,Ut.a,ci.a,ui.a,oi.a,li.a,di.a,pn.a,ht.a,pt.a,Gi.a,hi.a,pi.a,Qi.a,rn.a,Zi.a],[d.a,d.C,d.m,d.j,d.A,d.f,d.z,d.B,d.c,d.e,d.h,d.i,d.k]),l.Pc(Qi.a,[fn.UISref,fn.AnchorUISref,fn.UIView,fn.UISrefActive,fn.UISrefStatus,d.n,d.o,d.p,d.q,d.x,d.t,d.u,d.v,d.w,d.r,d.s,bn.C,bn.r,bn.B,bn.c,bn.s,bn.v,bn.a,bn.y,bn.z,bn.u,bn.m,bn.n,bn.x,bn.k,bn.j,bn.t,bn.b,bn.d,bn.p,bn.q,bn.o,mn.a,mn.b,mn.h,mn.e,wn.a,vn.e,vn.f,vn.a,vn.b,vn.d,vn.c,yn.a,kn.a,Zt.a,Cn.a,Cn.n,Cn.d,Cn.c,Cn.e,Cn.f,Cn.g,Cn.h,Cn.i,Cn.j,Cn.k,Cn.l,Cn.m,jn.a,Pn.a,xn.a,Jt.a,Sn.a,Yt.a,_n.a,On.a,In.a,Tn.a,Rn.a,En.a,Mn.a,Fn.a,An.a,Ln.a,Dn.a,Vn.a,qn.a,$n.a,Nn.a,Bn.a,Kt.a,zn.a,Hn.c,Hn.d,Hn.a,Hn.b,Hn.e,Qn.a,Wn.a,Xn.a,Un.a,Gn.a,r.a,p.a,h.a,Yn.a,Kn.a,Ni.a,Bi.a,Zn.a,Jn.a,es.a,Vi.a,ln.a,dn.a,on.a,un.a,Wi.a,Ki.a,ai.a,ri.a,si.a,nn.a,ii.a,ni.a,x.a,S.a,wi.a,yi.a,Pe.a,_i.a,Ji.a,ye.a,Yi,O.a,I.a,mi,Nt.a,Tt.a,Rt.a,Et.a,Mt.a,Ft.a,At.a,Lt.a,Dt.a,Vt.a,qt.a,It.a,Ot.a,xe.a,Ae,Le.a,De.a,Ve.a,qe.a,$e.a,en.a,gn.a,Je.a,Ne,Xe,Ye,Ze,je,St.a,zi.a,et.a,j.a,tt.a,u.a,nt.a,Si.a,Di,k,hn.a,it.a,st.a,rt.a,at.a,ct.a,ot.a,lt.a,dt.a,Gt.a,ti,yt.a,kt.a,Ct.a,jt.a,Pt.a,xt.a,Ui.a,_t.a,$t.a,qi.a,gt.a,ft.a,bt.a,mt.a,wt.a,vt.a,$i.a,Ee.a,Bt.a,zt.a,Ht.a,Qt.a,Wt.a,Xt.a,Ut.a,ci.a,ui.a,oi.a,li.a,di.a,pn.a,ht.a,pt.a,Gi.a,hi.a,pi.a,Qi.a,rn.a,Zi.a],[d.a,d.C,d.m,d.j,d.A,d.f,d.z,d.B,d.c,d.e,d.h,d.i,d.k])},W6hW:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("iB+3"),s=i("pL6k"),r=i("fXoL");class a{constructor(e,t){this.UrlParamsHelper=e,this.$state=t}updateIfDifferent(e,t){let i=this.getNewChecksum(e,t),n=Promise.resolve();return this.isUninitialized()||(this.isIdDifferent(e.id)?(n=this.maintainUrlQueryState(e.id,null),this.clear()):this.isChecksumDifferent(i)&&(n=this.maintainUrlQueryState(e.id,i))),this.set(e.id,i),n}update(e,t){let i=this.getNewChecksum(e,t);this.set(e.id,i),this.maintainUrlQueryState(e.id,i)}setToQuery(e,t){let i=this.getNewChecksum(e,t);return this.set(e.id,i),this.maintainUrlQueryState(e.id,null)}isQueryOutdated(e,t){let i=this.getNewChecksum(e,t);return this.isOutdated(e.id,i)}executeIfOutdated(e,t,i){(this.isUninitialized()||this.isOutdated(e,t))&&(this.set(e,t),i())}set(e,t){this.id=e,this.checksum=t}clear(){this.id=null,this.checksum=null,this.visibleChecksum=null}isUninitialized(){return!this.id&&!this.checksum}isIdDifferent(e){return this.id!==e}isChecksumDifferent(e){return this.checksum&&e!==this.checksum}isOutdated(e,t){const i=!!this.id,n=!!this.checksum,s=this.id!==e,r=t!==this.checksum,a=this.checksum&&!t&&this.visibleChecksum;return(i||n)&&(s||!s&&r&&(t||this.visibleChecksum)||!i&&a)}getNewChecksum(e,t){return this.UrlParamsHelper.encodeQueryJsonParams(e,_.pick(t,["page","perPage"]))}maintainUrlQueryState(e,t){return this.visibleChecksum=t,this.$state.go(".",{query_props:t,query_id:e},{custom:{notify:!1}})}}a.\u0275fac=function(e){return new(e||a)(r.lc(s.a),r.lc(n.StateService))},a.\u0275prov=r.Xb({token:a,factory:a.\u0275fac})},WPBv:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("/nP/");function s(e){var t=jQuery(e.data.menu);e.target!==t.find(" > li.drop-down.open > ul").get(0)&&(t.find(" > li.drop-down.open").removeClass("open").find("> ul").slideUp(n.a),jQuery("html").off("click",s))}function r(e){e.find(" > li.drop-down").on("click",t=>{!function(e){var t=e.find(" > li.drop-down");t.hasClass("open")||(t.find("> ul").slideDown(n.a,(function(){t.find("li > a:first").focus(),jQuery("html").on("click",{menu:e.get(0)},s)})),t.addClass("open"))}(e);var i=jQuery(t.target);(i.is(".drop-down")||i.closest("li, ul").is(".drop-down"))&&t.preventDefault()})}},WUI6:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));const n=new(i("fXoL").z)("CardEventHandler");class s{constructor(e){this.injector=e}attachTo(e){this.eventHandlers.map(t=>{let i=t(e);return i.eventScope(e).on(i.EVENT,i.SELECTOR,t=>{i.handleEvent(e,t)}),i})}}},"WW/2":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("E2tj"),s=i("fXoL");class r{constructor(e){this.querySpace=e}classIdentifier(e){return"wp-row-"+e.id}get renderedCards(){return this.querySpace.tableRendered.getValueOr([])}findRenderedCard(e){return _.findIndex(this.renderedCards,t=>t.classIdentifier===e)}updateRenderedCardsValues(e){this.querySpace.tableRendered.putValue(e.map(e=>({classIdentifier:this.classIdentifier(e),workPackageId:e.id,hidden:!1})))}}r.\u0275fac=function(e){return new(e||r)(s.lc(n.a))},r.\u0275prov=s.Xb({token:r,factory:r.\u0275fac})},Wcm6:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("mrSG"),s=i("eyhC"),r=i("Y/CA"),a=i("WW/2"),c=i("iB+3"),o=i("K247"),l=i("r0MM");class d{constructor(e,t){this.injector=e}get EVENT(){return"click.cardView.card"}get SELECTOR(){return".wp-card"}eventScope(e){return jQuery(e.container.nativeElement)}handleEvent(e,t){let i=jQuery(t.target);if(i.is("a")||i.parent().is("a"))return!0;let n=i.closest("wp-single-card"),s=n.data("workPackageId");return!s||(this.handleWorkPackage(e,s,n,t),!1)}handleWorkPackage(e,t,i,n){this.setSelection(e,t,i,n),e.itemClicked.emit({workPackageId:t,double:!1})}setSelection(e,t,i,n){let s=i.data("classIdentifier"),r=this.wpCardView.findRenderedCard(s);n.ctrlKey||n.metaKey||n.shiftKey||this.wpTableSelection.setSelection(t,r),n.shiftKey&&this.wpTableSelection.setMultiSelectionFrom(this.wpCardView.renderedCards,t,r),(n.ctrlKey||n.metaKey)&&this.wpTableSelection.toggleRow(t),e.selectionChanged.emit(this.wpTableSelection.getSelectedWorkPackageIds()),this.wpTableFocus.updateFocus(t)}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",o.a)],d.prototype,"deviceService",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.StateService)],d.prototype,"$state",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",s.a)],d.prototype,"wpTableSelection",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",r.a)],d.prototype,"wpTableFocus",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",a.a)],d.prototype,"wpCardView",void 0);class u{constructor(e,t){this.injector=e}get EVENT(){return"dblclick.cardView.card"}get SELECTOR(){return".wp-card"}eventScope(e){return jQuery(e.container.nativeElement)}handleEvent(e,t){let i=jQuery(t.target);if(i.is("a")||i.parent().is("a"))return!0;let n=i.closest("wp-single-card").data("workPackageId");return!n||(e.itemClicked.emit({workPackageId:n,double:!0}),!1)}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.StateService)],u.prototype,"$state",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",s.a)],u.prototype,"wpTableSelection",void 0);var h=i("cd/7"),p=i("qHU1"),g=i("4lR/"),f=i("qtzK");class b{constructor(e,t){this.injector=e}get EVENT(){return"contextmenu.cardView.rightclick"}get SELECTOR(){return".wp-card"}eventScope(e){return jQuery(e.container.nativeElement)}handleEvent(e,t){let i=jQuery(t.target);if(i.closest("."+h.c).length)return Object(p.a)("Allowing original context menu on state link"),!0;t.preventDefault(),t.stopPropagation();const n=i.closest("wp-single-card"),s=n.data("workPackageId");if(!s)return!0;{let i=n.data("classIdentifier"),r=this.wpCardView.findRenderedCard(i);this.wpTableSelection.isSelected(s)||this.wpTableSelection.setSelection(s,r);const a=new f.a(this.injector,s,jQuery(t.target),{},e.showInfoButton);this.opContextMenu.show(a,t)}return!1}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",s.a)],b.prototype,"wpTableSelection",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",a.a)],b.prototype,"wpCardView",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",g.a)],b.prototype,"opContextMenu",void 0);var m=i("WUI6");class w extends m.a{constructor(){super(...arguments),this.eventHandlers=[e=>new d(this.injector,e),e=>new u(this.injector,e),e=>new b(this.injector,e)]}}},WgCp:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("72oW"),s=i("tN7n"),r=i("0zio"),a=i("ho3E"),c=i("pL6k"),o=i("fXoL"),l=i("HEQ6");const d=["embeddedTableForConfiguration"],u=function(){return{tableVisible:!1}};class h{constructor(e,t,i){this.locals=e,this.urlParamsHelper=t,this.cdRef=i}ngOnInit(){this.locals.urlParams?this.queryProps=this.urlParamsHelper.buildV3GetQueryFromJsonParams(this.locals.currentQuery):this.queryProps=this.locals.currentQuery}ngAfterViewInit(){setTimeout(()=>{this.embeddedTable.openConfigurationModal(()=>{this.service.detach(),this.locals.urlParams?this.locals.callback(this.embeddedTable.buildUrlParams()):this.locals.callback(this.embeddedTable.buildQueryProps())}),this.cdRef.detectChanges()})}get service(){return this.locals.service}}h.\u0275fac=function(e){return new(e||h)(o.bc(a.a),o.bc(c.a),o.bc(o.i))},h.\u0275cmp=o.Vb({type:h,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&o.Rc(d,!0),2&e)&&(o.Ic(i=o.qc())&&(t.embeddedTable=i.first))},features:[o.Ob([[{provide:s.a,useClass:r.a}]])],decls:3,vars:3,consts:[["wp-isolated-query-space",""],[3,"queryProps","configuration"],["embeddedTableForConfiguration",""]],template:function(e,t){1&e&&(o.fc(0,0),o.cc(1,"wp-embedded-table",1,2),o.ec()),2&e&&(o.Pb(1),o.wc("queryProps",t.queryProps)("configuration",o.Ac(2,u)))},directives:[l.a,n.a],encapsulation:2})},"Wo/B":function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n=i("mrSG"),s=i("Jui0"),r=i("8zkO"),a=(i("ii2/"),i("mMv8")),c=i("RuUM"),o=i("wZYP"),l=i("2Uhg"),d=(i("Mo6U"),i("CNq7")),u=i("fXoL"),h=i("jhN1"),p=i("ofXK"),g=i("+pCT"),f=i("QihR"),b=i("0XIV"),m=i("u8Ab"),w=i("/Rze"),v=i("N5AO"),y=i("7MH/");function k(e,t){if(1&e&&u.cc(0,"user-avatar",17),2&e){const e=u.rc(2);u.Qb("data-user-name",e.userName)("data-user-id",e.userId)}}function C(e,t){if(1&e){const e=u.ic();u.hc(0,"accessible-by-keyboard",18),u.pc("execute",(function(){u.Lc(e);return u.rc(2).quoteComment()})),u.cc(1,"op-icon",19),u.gc()}if(2&e){const e=u.rc(2);u.wc("linkTitle",e.text.quote_comment),u.Pb(1),u.wc("icon-title",e.text.quote_comment)}}function j(e,t){if(1&e){const e=u.ic();u.hc(0,"accessible-by-keyboard",18),u.pc("execute",(function(){u.Lc(e);return u.rc(2).activate()})),u.cc(1,"op-icon",20),u.gc()}if(2&e){const e=u.rc(2);u.Rb("edit-activity--",e.activityNo,""),u.wc("linkTitle",e.text.edit_comment),u.Pb(1),u.wc("icon-title",e.text.edit_comment)}}function P(e,t){if(1&e&&u.cc(0,"img",21),2&e){const e=u.rc(2);u.wc("src",e.bcfSnapshotUrl,u.Oc)}}function x(e,t){if(1&e&&(u.hc(0,"div",22),u.hc(1,"div",23),u.cc(2,"edit-form-portal",24),u.gc(),u.gc()),2&e){const e=u.rc(2);u.Pb(2),u.wc("changeInput",e.change)("schemaInput",e.schema)("editFieldHandler",e.handler)}}function S(e,t){if(1&e&&u.cc(0,"div",25),2&e){const e=u.rc(2);u.wc("innerHtml",e.postedComment,u.Mc)}}function O(e,t){if(1&e&&(u.hc(0,"li"),u.cc(1,"span",28),u.gc()),2&e){const e=t.$implicit;u.Pb(1),u.wc("innerHtml",e,u.Mc)}}function I(e,t){if(1&e&&(u.hc(0,"ul",26),u.Tc(1,O,2,1,"li",27),u.gc()),2&e){const e=u.rc(2);u.Pb(1),u.wc("ngForOf",e.details)}}function T(e,t){if(1&e){const e=u.ic();u.hc(0,"div",1),u.pc("mouseenter",(function(){u.Lc(e);return u.rc().focus()}))("mouseleave",(function(){u.Lc(e);return u.rc().blur()})),u.Tc(1,k,1,2,"user-avatar",2),u.hc(2,"span",3),u.cc(3,"user-link",4),u.gc(),u.hc(4,"span",5),u.Vc(5),u.cc(6,"op-date-time",6),u.gc(),u.hc(7,"div",7),u.cc(8,"activity-link",8),u.hc(9,"div",9),u.Tc(10,C,2,2,"accessible-by-keyboard",10),u.Tc(11,j,2,5,"accessible-by-keyboard",11),u.gc(),u.gc(),u.Tc(12,P,1,1,"img",12),u.hc(13,"div",13),u.Tc(14,x,3,3,"div",14),u.Tc(15,S,1,1,"div",15),u.Tc(16,I,2,1,"ul",16),u.gc(),u.gc()}if(2&e){const e=u.rc();u.Pb(1),u.wc("ngIf",e.userName),u.Pb(2),u.wc("user",e.user),u.Pb(2),u.Xc(" ",e.isInitial?e.text.label_created_on:e.text.label_updated_on," "),u.Pb(1),u.wc("dateTimeValue",e.activity.createdAt),u.Pb(2),u.wc("workPackage",e.workPackage)("activityNo",e.activityNo),u.Pb(1),u.wc("hidden",e.shouldHideIcons()),u.Pb(1),u.wc("ngIf",e.userCanQuote),u.Pb(1),u.wc("ngIf",e.userCanEdit),u.Pb(1),u.wc("ngIf",e.bcfSnapshotUrl),u.Pb(2),u.wc("ngIf",e.active),u.Pb(1),u.wc("ngIf",!e.active&&(e.isComment||e.isBcfComment)),u.Pb(1),u.wc("ngIf",!e.isInitial)}}class R extends l.a{constructor(e,t,i,n,s,r,a,c,o,l,d){super(e,t),this.elementRef=e,this.injector=t,this.sanitization=i,this.PathHelper=n,this.wpLinkedActivities=s,this.commentService=r,this.ConfigurationService=a,this.apiV3Service=c,this.cdRef=o,this.I18n=l,this.ngZone=d,this.userCanEdit=!1,this.userCanQuote=!1,this.details=[],this.focused=!1,this.text={label_created_on:this.I18n.t("js.label_created_on"),label_updated_on:this.I18n.t("js.label_updated_on"),quote_comment:this.I18n.t("js.label_quote_comment"),edit_comment:this.I18n.t("js.label_edit_comment")}}ngOnInit(){super.ngOnInit(),this.updateCommentText(),this.isComment="Activity::Comment"===this.activity._type,this.isBcfComment="Activity::BcfComment"===this.activity._type,this.$element=jQuery(this.elementRef.nativeElement),this.reset(),this.userCanEdit=!!this.activity.update,this.userCanQuote=!!this.workPackage.addComment,this.$element.bind("focusin",this.focus.bind(this)),this.$element.bind("focusout",this.blur.bind(this)),_.each(this.activity.details,e=>{this.details.push(e.html)}),this.apiV3Service.users.id(this.activity.user.idFromLink).get().subscribe(e=>{this.user=e,this.userId=e.id,this.userName=e.name,this.userAvatar=e.avatar,this.cdRef.detectChanges()}),window.location.hash==="#activity-"+this.activityNo&&this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.elementRef.nativeElement.scrollIntoView(!0)})})}shouldHideIcons(){return!((this.isComment||this.isBcfComment)&&this.focussing())}activate(){super.activate(this.activity.comment.raw),this.cdRef.detectChanges()}handleUserSubmit(){return this.inFlight||!this.rawComment?Promise.resolve():this.updateComment()}quoteComment(){this.commentService.quoteEvents.next(this.quotedText(this.activity.comment.raw))}get bcfSnapshotUrl(){return _.get(this.activity,"bcfViewpoints[0]")?_.get(this.activity,"bcfViewpoints[0]").href+"/snapshot":null}updateComment(){return Object(n.b)(this,void 0,void 0,(function*(){return this.inFlight=!0,yield this.onSubmit(),this.commentService.updateComment(this.activity,this.rawComment||"").then(e=>{this.activity=e,this.updateCommentText(),this.wpLinkedActivities.require(this.workPackage,!0),this.apiV3Service.work_packages.cache.updateWorkPackage(this.workPackage)}).finally(()=>{this.deactivate(!0),this.inFlight=!1})}))}focusEditIcon(){jQuery(".edit-activity--"+this.activityNo+" a").focus()}focus(){this.focused=!0,this.cdRef.detectChanges()}blur(){this.focused=!1,this.cdRef.detectChanges()}focussing(){return this.focused}setErrors(e){}quotedText(e){let t=e.split("\n").map((function(e){return"\n> "+e})).join("");return this.userName+" wrote:\n"+t}get htmlId(){return"user_activity_edit_field_"+this.activityNo}deactivate(e){super.deactivate(e),e&&this.focusEditIcon()}updateCommentText(){this.postedComment=this.sanitization.bypassSecurityTrustHtml(this.activity.comment.html)}}R.\u0275fac=function(e){return new(e||R)(u.bc(u.q),u.bc(u.A),u.bc(h.b),u.bc(s.a),u.bc(a.a),u.bc(c.a),u.bc(r.a),u.bc(d.a),u.bc(u.i),u.bc(o.a),u.bc(u.K))},R.\u0275cmp=u.Vb({type:R,selectors:[["user-activity"]],inputs:{workPackage:"workPackage",activity:"activity",activityNo:"activityNo",isInitial:"isInitial"},features:[u.Mb],decls:1,vars:1,consts:[["class","work-package-details-activities-activity-contents",3,"mouseenter","mouseleave",4,"ngIf"],[1,"work-package-details-activities-activity-contents",3,"mouseenter","mouseleave"],["data-class-list","avatar",4,"ngIf"],[1,"user"],[3,"user"],[1,"date"],[3,"dateTimeValue"],[1,"comments-number"],[3,"workPackage","activityNo"],[1,"comments-icons",3,"hidden"],[3,"linkTitle","execute",4,"ngIf"],[3,"linkTitle","class","execute",4,"ngIf"],["class","activity-thumbnail",3,"src",4,"ngIf"],[1,"user-comment"],["class","inplace-edit",4,"ngIf"],["class","message wiki op-uc-container",3,"innerHtml",4,"ngIf"],["class","work-package-details-activities-messages",4,"ngIf"],["data-class-list","avatar"],[3,"linkTitle","execute"],["icon-classes","action-icon icon-quote",3,"icon-title"],["icon-classes","action-icon icon-edit",3,"icon-title"],[1,"activity-thumbnail",3,"src"],[1,"inplace-edit"],[1,"user-comment--form","inplace-edit--write-value"],[3,"changeInput","schemaInput","editFieldHandler"],[1,"message","wiki","op-uc-container",3,"innerHtml"],[1,"work-package-details-activities-messages"],[4,"ngFor","ngForOf"],[1,"message",3,"innerHtml"]],template:function(e,t){1&e&&u.Tc(0,T,17,13,"div",0),2&e&&u.wc("ngIf",t.workPackage)},directives:[p.q,g.a,f.a,b.a,m.a,w.a,v.a,y.a,p.p],encapsulation:2,changeDetection:0})},X4Sm:function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var n=i("wZYP"),s=(i("5HGI"),i("qg8y")),r=i("wyKs"),a=i("6yP5"),c=i("AeZM"),o=i("FB4C"),l=i("itXk"),d=i("AEvm"),u=i("fXoL"),h=i("ofXK"),p=i("N5AO");function g(e,t){if(1&e){const e=u.ic();u.hc(0,"span",9),u.pc("click",(function(t){u.Lc(e);return u.rc(2).toggleHierarchy(t)})),u.cc(1,"op-icon",10),u.gc()}if(2&e){const e=u.rc(2);u.Qb("title",e.text.toggleHierarchy),u.Pb(1),u.yc("icon-classes","icon ",e.hierarchyIcon,"")}}const f=function(e,t){return[e,t]};function b(e,t){if(1&e&&(u.hc(0,"a",11),u.Vc(1),u.gc()),2&e){const e=u.rc(2);u.xc("lang",e.locale),u.xc("id",e.headerColumn.id),u.wc("ngClass",u.Cc(4,f,e.directionClass&&"sort",e.directionClass)),u.Pb(1),u.Wc(e.headerColumn.name)}}function m(e,t){if(1&e&&(u.hc(0,"a"),u.Vc(1),u.gc()),2&e){const e=u.rc(2);u.Pb(1),u.Wc(e.headerColumn.name)}}function w(e,t){if(1&e&&u.cc(0,"op-icon",12),2&e){const e=u.rc(2);u.xc("icon-title",e.text.openMenu)}}function v(e,t){if(1&e&&(u.hc(0,"span",4),u.Tc(1,g,2,2,"span",5),u.Tc(2,b,2,7,"a",6),u.Tc(3,m,2,1,"a",7),u.Tc(4,w,1,1,"op-icon",8),u.gc()),2&e){const e=u.rc();u.Pb(1),u.wc("ngIf",e.displayHierarchyIcon),u.Pb(1),u.wc("ngIf",e.sortable),u.Pb(1),u.wc("ngIf",!e.sortable),u.Pb(1),u.wc("ngIf",e.displayDropdownIcon)}}function y(e,t){if(1&e&&u.cc(0,"op-icon",12),2&e){const e=u.rc(2);u.xc("icon-title",e.text.openMenu)}}function k(e,t){if(1&e&&(u.hc(0,"span",4),u.hc(1,"a"),u.cc(2,"op-icon",13),u.Vc(3),u.gc(),u.Tc(4,y,1,1,"op-icon",8),u.gc()),2&e){const e=u.rc();u.Pb(1),u.Qb("title",e.headerColumn.name),u.Pb(2),u.Xc(" ",e.columnName," "),u.Pb(1),u.wc("ngIf",e.displayDropdownIcon)}}function C(e,t){if(1&e&&u.cc(0,"span",14),2&e){const e=u.rc();u.Qb("title",e.text.sortColumn)}}function j(e,t){if(1&e&&(u.hc(0,"a",11),u.Vc(1),u.gc()),2&e){const e=u.rc(2);u.xc("lang",e.locale),u.xc("id",e.headerColumn.id),u.wc("ngClass",u.Cc(4,f,e.directionClass&&"sort",e.directionClass)),u.Pb(1),u.Wc(e.headerColumn.name)}}function P(e,t){if(1&e&&(u.hc(0,"a"),u.Vc(1),u.gc()),2&e){const e=u.rc(2);u.Pb(1),u.Wc(e.headerColumn.name)}}function x(e,t){if(1&e&&u.cc(0,"op-icon",12),2&e){const e=u.rc(2);u.xc("icon-title",e.text.openMenu)}}function S(e,t){if(1&e&&(u.hc(0,"span",4),u.Tc(1,j,2,7,"a",6),u.Tc(2,P,2,1,"a",7),u.Tc(3,x,1,1,"op-icon",8),u.gc()),2&e){const e=u.rc();u.Pb(1),u.wc("ngIf",e.sortable),u.Pb(1),u.wc("ngIf",!e.sortable),u.Pb(1),u.wc("ngIf",e.displayDropdownIcon)}}class _ extends d.a{constructor(e,t,i,n,s,r,a){super(),this.wpTableHierarchies=e,this.wpTableSortBy=t,this.wpTableGroupBy=i,this.wpTableRelationColumns=n,this.elementRef=s,this.cdRef=r,this.I18n=a,this.text={toggleHierarchy:this.I18n.t("js.work_packages.hierarchy.show"),openMenu:this.I18n.t("js.label_open_menu"),sortColumn:"Sorting column"}}ngAfterViewInit(){setTimeout(()=>this.initialize())}initialize(){this.element=jQuery(this.elementRef.nativeElement),Object(l.a)([this.wpTableSortBy.onReadyWithAvailable(),this.wpTableSortBy.live$()]).pipe(this.untilDestroyed()).subscribe(()=>{let e=this.wpTableSortBy.current[0];e&&this.headerColumn.$href===e.column.$href?this.currentSortDirection=e.direction:this.currentSortDirection=null,this.setActiveColumnClass(),this.sortable=this.wpTableSortBy.isSortable(this.headerColumn),this.directionClass=this.getDirectionClass(),this.cdRef.detectChanges()}),this.isHierarchyColumn="subject"===this.headerColumn.id,"sortHandle"===this.headerColumn.id&&(this.columnType="sort"),this.isHierarchyColumn?this.columnType="hierarchy":"toType"===this.wpTableRelationColumns.relationColumnType(this.headerColumn)?(this.columnType="relation",this.columnName=this.headerColumn.type.name):"ofType"===this.wpTableRelationColumns.relationColumnType(this.headerColumn)&&(this.columnType="relation",this.columnName=I18n.t("js.relation_labels."+this.headerColumn.relationType)),this.isHierarchyColumn&&(this.hierarchyIcon="icon-hierarchy",this.isHierarchyDisabled=this.wpTableGroupBy.isEnabled,this.wpTableGroupBy.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.isHierarchyDisabled=this.wpTableGroupBy.isEnabled,this.cdRef.detectChanges()}),this.wpTableHierarchies.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.setHierarchyIcon(),this.cdRef.detectChanges()}),this.setHierarchyIcon()),this.cdRef.detectChanges()}get displayDropdownIcon(){return this.table&&this.table.configuration.columnMenuEnabled}get displayHierarchyIcon(){return this.table&&this.table.configuration.hierarchyToggleEnabled}toggleHierarchy(e){return this.wpTableHierarchies.toggleState()&&this.wpTableGroupBy.disable(),this.setHierarchyIcon(),e.stopPropagation(),!1}setHierarchyIcon(){this.wpTableHierarchies.isEnabled?(this.text.toggleHierarchy=I18n.t("js.work_packages.hierarchy.hide"),this.hierarchyIcon="icon-hierarchy"):(this.text.toggleHierarchy=I18n.t("js.work_packages.hierarchy.show"),this.hierarchyIcon="icon-no-hierarchy")}getDirectionClass(){if(!this.currentSortDirection)return"";switch(this.currentSortDirection.$href){case s.a:return"asc";case s.b:return"desc";default:return""}}setActiveColumnClass(){this.element.toggleClass("active-column",!!this.currentSortDirection)}}_.\u0275fac=function(e){return new(e||_)(u.bc(r.a),u.bc(a.a),u.bc(c.a),u.bc(o.a),u.bc(u.q),u.bc(u.i),u.bc(n.a))},_.\u0275cmp=u.Vb({type:_,selectors:[["sortHeader"]],inputs:{headerColumn:"headerColumn",locale:"locale",table:"table"},features:[u.Mb],decls:5,vars:4,consts:[[1,"generic-table--sort-header-outer",3,"ngSwitch"],["class","generic-table--sort-header",4,"ngSwitchCase"],["class","draggable-table--sort-header",4,"ngSwitchCase"],["class","generic-table--sort-header",4,"ngSwitchDefault"],[1,"generic-table--sort-header"],["class","hierarchy-header--icon","tabindex","-1","aria-hidden","true",3,"click",4,"ngIf"],["href","#","lang-attribute","",3,"ngClass","lang","id",4,"ngIf"],[4,"ngIf"],["icon-classes","dropdown-indicator icon-small icon-pulldown",3,"icon-title",4,"ngIf"],["tabindex","-1","aria-hidden","true",1,"hierarchy-header--icon",3,"click"],[3,"icon-classes"],["href","#","lang-attribute","",3,"ngClass","lang","id"],["icon-classes","dropdown-indicator icon-small icon-pulldown",3,"icon-title"],["icon-classes","icon-context icon-relations relations-header--icon"],[1,"draggable-table--sort-header"]],template:function(e,t){1&e&&(u.hc(0,"div",0),u.Tc(1,v,5,4,"span",1),u.Tc(2,k,5,3,"span",1),u.Tc(3,C,1,1,"span",2),u.Tc(4,S,4,3,"span",3),u.gc()),2&e&&(u.wc("ngSwitch",t.columnType),u.Pb(1),u.wc("ngSwitchCase","hierarchy"),u.Pb(1),u.wc("ngSwitchCase","relation"),u.Pb(1),u.wc("ngSwitchCase","sort"))},directives:[h.u,h.v,h.w,h.q,p.a,h.n],encapsulation:2})},XV4z:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("mrSG"),s=i("sBdf"),r=i("kTsZ"),a=i("Jui0"),c=i("sjKJ"),o=i("wZYP"),l=i("AAic"),d=i("2Vo4"),u=i("CNq7"),h=i("fXoL");class p{constructor(e,t,i,n,s,r,a){this.apiV3Service=e,this.PathHelper=t,this.CurrentProject=i,this.halResourceService=n,this.boardActions=s,this.I18n=r,this.boardsList=a,this.currentBoard$=new d.a(null),this.text={unnamed_board:this.I18n.t("js.boards.label_unnamed_board"),action_board:e=>this.I18n.t("js.boards.board_type.action_by_attribute",{attribute:this.I18n.t("js.boards.board_type.action_type."+e)}),unnamed_list:this.I18n.t("js.boards.label_unnamed_list")}}loadAllBoards(e=this.CurrentProject.identifier,t=!1){return t||void 0===this.loadAllPromise?this.loadAllPromise=this.apiV3Service.boards.allInScope(e).toPromise():this.loadAllPromise}canManage(e){return!!e.grid.$links.delete}save(e){return this.reorderWidgets(e),this.apiV3Service.boards.id(e).save(e)}create(e){return Object(n.b)(this,void 0,void 0,(function*(){const t=yield this.apiV3Service.boards.create(e.type,this.boardName(e),this.CurrentProject.identifier,e.attribute).toPromise();return"free"===e.type?yield this.boardsList.addFreeQuery(t,{name:this.text.unnamed_list}):yield this.boardActions.get(e.attribute).addInitialColumnsForAction(t),yield this.save(t).toPromise(),t}))}delete(e){return this.apiV3Service.boards.id(e).delete().toPromise()}boardName(e){return e.boardName?e.boardName:"action"===e.type?this.text.action_board(e.attribute):this.text.unnamed_board}reorderWidgets(e){e.grid.columnCount=Math.max(e.grid.widgets.length,1),e.grid.widgets.map((e,t)=>(e.startColumn=t+1,e.endColumn=t+2,e))}}p.\u0275fac=function(e){return new(e||p)(h.lc(u.a),h.lc(a.a),h.lc(c.a),h.lc(r.a),h.lc(l.a),h.lc(o.a),h.lc(s.a))},p.\u0275prov=h.Xb({token:p,factory:p.\u0275fac,providedIn:"root"})},XZlt:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));i("ii2/");var n=i("fXoL"),s=i("ofXK"),r=i("80WE");const a=function(){return{colorize:!1}};function c(e,t){if(1&e&&(n.hc(0,"div",1),n.hc(1,"div",2),n.cc(2,"editable-attribute-field",3),n.gc(),n.hc(3,"div",4),n.cc(4,"editable-attribute-field",5),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("resource",e.workPackage)("displayFieldOptions",n.Ac(7,a))("wrapperClasses","wp-new-top-row--status -no-label")("fieldName","status"),n.Pb(2),n.wc("resource",e.workPackage)("wrapperClasses","wp-new-top-row--type -no-label")("fieldName","type")}}class o{}o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=n.Vb({type:o,selectors:[["wp-type-status"]],inputs:{workPackage:"workPackage"},decls:1,vars:1,consts:[["class","wp-new-top-row",4,"ngIf"],[1,"wp-new-top-row"],[1,"work-packages--status-selector","wp-new-top-row--element"],[3,"resource","displayFieldOptions","wrapperClasses","fieldName"],[1,"work-packages--type-selector","wp-new-top-row--element"],[3,"resource","wrapperClasses","fieldName"]],template:function(e,t){1&e&&n.Tc(0,c,5,8,"div",0),2&e&&n.wc("ngIf",t.workPackage)},directives:[s.q,r.a],encapsulation:2})},XZsv:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return r}));var n=i("Mo6U");const s="urn:openproject-org:api:v3:errors:MultipleErrors";class r extends n.a{constructor(){super(...arguments),this.isValidationError=!1}toString(){return`[ErrorResource ${this.message}]`}get errorMessages(){return this.isMultiErrorMessage()?this.errors.map(e=>e.message):[this.message]}isMultiErrorMessage(){return this.errorIdentifier===s}getInvolvedAttributes(){var e=[];return this.details?e=[{details:this.details}]:this.errors&&(e=this.errors),_.flatten(e.map(e=>e.errorIdentifier===s?this.extractMultiError(e)[0]:e.details.attribute))}getMessagesPerAttribute(){let e={};return this.details?e[this.details.attribute]=[this.message]:_.forEach(this.errors,t=>{if(t.errorIdentifier===s){const[i,n]=this.extractMultiError(t);let s=e[i]||[];e[i]=s.concat(n)}else e[t.details.attribute]?e[t.details.attribute].push(t.message):e[t.details.attribute]=[t.message]}),e}extractMultiError(e){return[e.errors[0].details.attribute,e.errors.map(e=>e.message)]}}},XlgE:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("wZYP"),s=i("Va5K"),r=i("PtkW"),a=i("itXk"),c=i("AEvm"),o=i("fXoL"),l=i("+B5R"),d=i("N5AO");class u extends c.a{constructor(e,t,i,n){super(),this.I18n=e,this.cdRef=t,this.wpDisplayRepresentationService=i,this.wpTableTimeline=n,this.text={card:this.I18n.t("js.views.card"),list:this.I18n.t("js.views.list"),timeline:this.I18n.t("js.views.timeline")}}ngOnInit(){Object(a.a)([this.wpDisplayRepresentationService.live$(),this.wpTableTimeline.live$()]).pipe(this.untilDestroyed()).subscribe(([e,t])=>{this.detectView(e,t.visible),this.cdRef.detectChanges()})}detectView(e,t){e!==s.b?this.view=t?"timeline":s.c:this.view=s.b}}u.\u0275fac=function(e){return new(e||u)(o.bc(n.a),o.bc(o.i),o.bc(s.a),o.bc(r.a))},u.\u0275cmp=o.Vb({type:u,selectors:[["wp-view-toggle-button"]],features:[o.Mb],decls:4,vars:2,consts:[["id","wp-view-toggle-button","wpViewDropdown","",1,"button"],[3,"icon-classes"],["aria-hidden","true",1,"button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown"]],template:function(e,t){1&e&&(o.hc(0,"button",0),o.cc(1,"op-icon",1),o.cc(2,"span",2),o.cc(3,"op-icon",3),o.gc()),2&e&&(o.Pb(1),o.yc("icon-classes","button--icon icon-view-",t.view,""),o.Pb(1),o.wc("textContent",t.text[t.view]))},directives:[l.a,d.a],encapsulation:2,changeDetection:0})},Xmgp:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("xRac"),s=i("3Pt+"),r=i("Tac9"),a=i("5Mgc"),c=i("GLdX"),o=i("ofXK"),l=i("fXoL");class d{}d.\u0275mod=l.Zb({type:d}),d.\u0275inj=l.Yb({factory:function(e){return new(e||d)},providers:[r.a,a.a,c.a],imports:[[s.i,o.b,n.a]]})},"Y/CA":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("E2tj"),s=i("lJxs"),r=i("/uUt"),a=i("eyhC"),c=i("zqrF"),o=i("fXoL");class l extends c.b{constructor(e,t){super(e),this.querySpace=e,this.wpTableSelection=t}isFocused(e){return this.focusedWorkPackage===e}ifShouldFocus(e){const t=this.current;t&&t.focusAfterRender&&(e(t.workPackageId),t.focusAfterRender=!1,this.update(t))}get focusedWorkPackage(){const e=this.current;if(e)return e.workPackageId;const t=this.querySpace.results.value;return t&&t.elements.length>0?t.elements[0].id.toString():null}whenChanged(){return this.live$().pipe(Object(s.a)(e=>e.workPackageId),Object(r.a)())}updateFocus(e,t=!1){this.wpTableSelection.isEmpty&&this.wpTableSelection.setRowState(e,!0),this.update({workPackageId:e,focusAfterRender:t})}valueFromQuery(e,t){}}l.\u0275fac=function(e){return new(e||l)(o.lc(n.a),o.lc(a.a))},l.\u0275prov=o.Xb({token:l,factory:l.\u0275fac})},Y0Nk:function(e,t,i){"use strict";i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return o}));var n=i("vkgz"),s=i("fXoL");function r(e,t){return i=>(e.start(),i.pipe(Object(n.a)(()=>e.delayedStop(t),()=>e.stop(),()=>e.stop())))}function a(e){return t=>(setTimeout(()=>e().start()),t.pipe(Object(n.a)(()=>{},()=>e().stop(),()=>e().stop())))}class c{constructor(e){this.indicator=e,this.indicatorTemplate='<div class="loading-indicator--background">\n      <div class="loading-indicator">\n        <div class="block-1"></div>\n        <div class="block-2"></div>\n        <div class="block-3"></div>\n        <div class="block-4"></div>\n        <div class="block-5"></div>\n      </div>\n    </div>\n   '}set promise(e){this.start();const t=()=>this.delayedStop();e.then(t).catch(t)}start(){this.stop(),this.indicator.prepend(this.indicatorTemplate)}delayedStop(e=25){setTimeout(()=>this.stop(),e)}stop(){this.indicator.find(".loading-indicator--background").remove()}}class o{get table(){return this.indicator("table")}get wpDetails(){return this.indicator("wpDetails")}get modal(){return this.indicator("modal")}getter(e){return this.indicator.bind(this,e)}indicator(e){return"string"==typeof e&&(e=this.getIndicatorAt(e)),new c(e)}getIndicatorAt(e){return jQuery(".loading-indicator--location").filter(`[data-indicator-name="${e}"]`)}}o.\u0275fac=function(e){return new(e||o)},o.\u0275prov=s.Xb({token:o,factory:o.\u0275fac,providedIn:"root"})},Y41n:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("fXoL"),s=i("XNiG"),r=i("Kj3r"),a=i("1G5W");class c{constructor(e,t=250){this.emitter=new n.s,this.debouncer=new s.a,this.debouncer.pipe(Object(r.a)(t),Object(a.a)(e)).subscribe(e=>this.emitter.emit(e))}emit(e){this.debouncer.next(e)}subscribe(e,t,i){return this.emitter.subscribe(e,t,i)}}},YO9K:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("wZYP"),s=i("qg8y"),r=i("6yP5"),a=i("fXoL"),c=i("3Pt+"),o=i("ofXK");function l(e,t){if(1&e&&a.cc(0,"option",18),2&e){const e=a.rc().$implicit;a.wc("textContent",e.column.name)("value",e.column.href)}}function d(e,t){if(1&e&&a.cc(0,"option",19),2&e){const e=t.$implicit;a.wc("textContent",e.name)("value",e.href)}}function u(e,t){if(1&e){const e=a.ic();a.hc(0,"label",5),a.hc(1,"input",20),a.pc("ngModelChange",(function(t){a.Lc(e);return a.rc().$implicit.direction=t})),a.gc(),a.Vc(2),a.gc()}if(2&e){const e=t.$implicit,i=a.rc(),n=i.index,s=i.$implicit;a.Pb(1),a.yc("name","modal-sorting-attribute-",n,"--sort-direction"),a.wc("ngModel",s.direction)("value",e.$href)("textContent",e.name),a.Pb(1),a.Xc(" ",e.name," ")}}function h(e,t){if(1&e){const e=a.ic();a.hc(0,"div"),a.hc(1,"div",3),a.cc(2,"label",11),a.hc(3,"div",4),a.hc(4,"div",12),a.hc(5,"select",13),a.pc("change",(function(i){a.Lc(e);const n=t.$implicit;return a.rc(2).updateSelection(n,i.target.value)})),a.Tc(6,l,1,2,"option",14),a.cc(7,"option",15),a.Tc(8,d,1,2,"option",16),a.gc(),a.gc(),a.gc(),a.gc(),a.hc(9,"div",3),a.hc(10,"div",4),a.Tc(11,u,3,5,"label",17),a.gc(),a.gc(),a.gc()}if(2&e){const e=t.$implicit,i=t.index,n=a.rc(2);a.Rb("form--row modal-sorting-row-",i,""),a.Pb(2),a.yc("for","modal-sorting-attribute-",i,""),a.wc("textContent",n.text["sort_criteria_"+i]),a.Pb(3),a.yc("id","modal-sorting-attribute-",i,""),a.yc("name","modal-sorting-attribute-",i,""),a.Pb(1),a.wc("ngIf",!!e.column.href),a.Pb(1),a.wc("textContent",n.emptyColumn.name)("value",n.emptyColumn.href)("selected",!e.column.href),a.Pb(1),a.wc("ngForOf",n.availableColumns),a.Pb(3),a.wc("ngForOf",n.availableDirections)}}function p(e,t){if(1&e&&(a.fc(0),a.Tc(1,h,12,13,"div",10),a.ec()),2&e){const e=a.rc();a.Pb(1),a.wc("ngForOf",e.sortationObjects)}}class g{constructor(e,t){this.column=e,this.direction=t}}class f{constructor(e,t,i){this.injector=e,this.I18n=t,this.wpTableSortBy=i,this.text={title:this.I18n.t("js.label_sort_by"),placeholder:this.I18n.t("js.placeholders.default"),sort_criteria_1:this.I18n.t("js.filter.sorting.criteria.one"),sort_criteria_2:this.I18n.t("js.filter.sorting.criteria.two"),sort_criteria_3:this.I18n.t("js.filter.sorting.criteria.three"),sorting_mode:{description:this.I18n.t("js.work_packages.table_configuration.sorting_mode.description"),automatic:this.I18n.t("js.work_packages.table_configuration.sorting_mode.automatic"),manually:this.I18n.t("js.work_packages.table_configuration.sorting_mode.manually"),warning:this.I18n.t("js.work_packages.table_configuration.sorting_mode.warning")}},this.availableDirections=[{$href:s.a,name:this.I18n.t("js.label_ascending")},{$href:s.b,name:this.I18n.t("js.label_descending")}],this.availableColumns=[],this.allColumns=[],this.sortationObjects=[],this.emptyColumn={name:this.text.placeholder,href:null},this.sortingMode="automatic"}onSave(){let e;e="automatic"===this.sortingMode?this.sortationObjects.filter(e=>null!==e.column):[new g(this.manualSortColumn,s.a)],e=e.map(e=>this.getMatchingSort(e.column.href,e.direction)),this.wpTableSortBy.update(_.compact(e))}ngOnInit(){this.wpTableSortBy.onReadyWithAvailable().subscribe(()=>{let e=this.wpTableSortBy.available.filter(e=>!e.column.$href.endsWith("/parent")).map(e=>({name:e.column.name,href:e.column.$href}));this.allColumns=_.uniqBy(e,"href"),this.getManualSortingOption(),_.each(this.wpTableSortBy.current,e=>{e.column.$href.endsWith("/parent")||(this.sortationObjects.push(new g({name:e.column.name,href:e.column.$href},e.direction.$href)),e.column.href===this.manualSortColumn.href&&this.updateSortingMode("manual"))}),this.updateUsedColumns(),this.fillUpSortElements()})}updateSelection(e,t){e.column=_.find(this.allColumns,e=>e.href===t)||this.emptyColumn,this.updateUsedColumns()}updateUsedColumns(){let e=this.sortationObjects.filter(e=>null!==e.column).map(e=>e.column);this.availableColumns=_.sortBy(_.differenceBy(this.allColumns,e,"href"),"name")}updateSortingMode(e){this.sortingMode=e}getMatchingSort(e,t){return _.find(this.wpTableSortBy.available,i=>i.column.$href===e&&i.direction.$href===t)}fillUpSortElements(){for(;this.sortationObjects.length<3;)this.sortationObjects.push(new g(this.emptyColumn,s.a))}getManualSortingOption(){this.manualSortColumn=this.allColumns.find(e=>e.href.endsWith("/manualSorting")),this.allColumns.splice(this.allColumns.indexOf(this.manualSortColumn),1)}}f.\u0275fac=function(e){return new(e||f)(a.bc(a.A),a.bc(n.a),a.bc(r.a))},f.\u0275cmp=a.Vb({type:f,selectors:[["ng-component"]],decls:16,vars:7,consts:[["name","modalSortingForm"],["id","modal-sorting","data-indicator-name","sorting-modal",1,"modal-content-container","loading-indicator--location"],[3,"textContent"],[1,"form--field","-full-width"],[1,"form--field-container"],[1,"option-label"],["type","radio","name","sorting_mode_switch","value","manual",3,"ngModel","ngModelChange","change"],["type","radio","name","sorting_mode_switch","value","automatic",3,"ngModel","ngModelChange","change"],[1,"form--field-instructions"],[4,"ngIf"],[3,"class",4,"ngFor","ngForOf"],[1,"form--label","hidden-for-sighted",3,"for","textContent"],[1,"form--select-container"],[1,"form--select",3,"id","name","change"],["selected","",3,"textContent","value",4,"ngIf"],[3,"textContent","value","selected"],[3,"textContent","value",4,"ngFor","ngForOf"],["class","option-label",4,"ngFor","ngForOf"],["selected","",3,"textContent","value"],[3,"textContent","value"],["type","radio",3,"ngModel","value","textContent","name","ngModelChange"]],template:function(e,t){1&e&&(a.hc(0,"form",0),a.hc(1,"div",1),a.cc(2,"p",2),a.hc(3,"div",3),a.hc(4,"div",4),a.hc(5,"label",5),a.hc(6,"input",6),a.pc("ngModelChange",(function(e){return t.sortingMode=e}))("change",(function(e){return t.updateSortingMode(e.target.value)})),a.gc(),a.Vc(7),a.gc(),a.gc(),a.gc(),a.hc(8,"div",3),a.hc(9,"div",4),a.hc(10,"label",5),a.hc(11,"input",7),a.pc("ngModelChange",(function(e){return t.sortingMode=e}))("change",(function(e){return t.updateSortingMode(e.target.value)})),a.gc(),a.Vc(12),a.gc(),a.gc(),a.hc(13,"div",8),a.Vc(14),a.gc(),a.gc(),a.Tc(15,p,2,1,"ng-container",9),a.gc(),a.gc()),2&e&&(a.Pb(2),a.wc("textContent",t.text.sorting_mode.description),a.Pb(4),a.wc("ngModel",t.sortingMode),a.Pb(1),a.Xc(" ",t.text.sorting_mode.manually," "),a.Pb(4),a.wc("ngModel",t.sortingMode),a.Pb(1),a.Xc(" ",t.text.sorting_mode.automatic," "),a.Pb(2),a.Xc(" ",t.text.sorting_mode.warning," "),a.Pb(1),a.wc("ngIf","automatic"===t.sortingMode))},directives:[c.C,c.n,c.o,c.u,c.c,c.m,c.p,o.q,o.p,c.r,c.B],encapsulation:2})},Yblc:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("mrSG"),s=i("FDFi"),r=i("i95X"),a=i("uSJ+"),c=i("r0MM"),o=i("fXoL");class l extends s.a{constructor(e){super(e),this.injector=e,this.referenceComponentClass=r.a,this.relationType="",this.referenceTarget=null,this.buttonTexts={reference:this.I18n.t("js.relation_buttons.add_existing"),create:this.I18n.t("js.relation_buttons.create_new")}}add(e,t){return this.wpRelations.addCommonRelation(t,this.relationType,e.id)}remove(e,t){const i=this.wpRelations.find(t,e,this.relationType);return void 0!==i?this.wpRelations.removeRelation(i):Promise.reject()}get canAdd(){return!!(this.referenceTarget&&this.canCreateWorkPackages&&this.referenceTarget.addRelation)}get canReference(){return!!this.canAdd}}l.\u0275fac=function(e){return new(e||l)(o.lc(o.A))},l.\u0275prov=o.Xb({token:l,factory:l.\u0275fac}),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",a.a)],l.prototype,"wpRelations",void 0)},YefF:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("A0F/"),s=i("fXoL");class r extends n.a{blockedTransition(e){const t=e.to(),i=e.from(),n=e.params("from"),s=e.params("to");return i.name&&i.name.match(/\.(new|copy)$/)?!(t.data&&t.data.allowMovingInEditMode):void 0===s.workPackageId||s.workPackageId!==n.workPackageId}}r.\u0275fac=function(e){return a(e||r)},r.\u0275prov=s.Xb({token:r,factory:r.\u0275fac});const a=s.jc(r);var c=i("HEQ6"),o=i("0loS");class l{}l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=s.Vb({type:l,selectors:[["work-packages-base"]],features:[s.Ob([{provide:n.a,useClass:r}])],decls:2,vars:0,consts:[["wp-isolated-query-space","",1,"work-packages-page--ui-view"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.cc(1,"ui-view"),s.gc())},directives:[c.a,o.UIView],encapsulation:2})},"Yg+W":function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return r}));var n=i("E5Dd");function s(e,t){return"click"!==e.type&&("keydown"!==e.type||e.which!==n.a.ENTER)||(t(),!1)}class r{handleEvent(e,t){s(t,()=>this.processEvent(e.workPackageTable,t))}}},ZAVI:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("iB+3"),s=(i("ii2/"),i("R9pB")),r=i("AEvm"),a=i("CNq7"),c=i("fXoL"),o=i("ofXK"),l=i("80WE");function d(e,t){if(1&e&&(c.hc(0,"div",1),c.hc(1,"div",2),c.cc(2,"editable-attribute-field",3),c.gc(),c.hc(3,"div",4),c.cc(4,"editable-attribute-field",3),c.gc(),c.gc()),2&e){const e=c.rc();c.wc("ngClass","__overflowing_"+e.uniqueElementIdentifier),c.Qb("data-overflowing-identifier",".__overflowing_"+e.uniqueElementIdentifier),c.Pb(2),c.wc("resource",e.workPackage)("wrapperClasses","work-packages--type-selector work-packages--subject-element -no-label")("fieldName","type"),c.Pb(2),c.wc("resource",e.workPackage)("wrapperClasses","work-packages--details--subject work-packages--subject-element -no-label")("fieldName","subject")}}class u extends r.a{constructor(e,t){super(),this.uiRouterGlobals=e,this.apiV3Service=t,this.uniqueElementIdentifier="work-packages--subject-type-row-"+Object(s.a)(16)}ngOnInit(){this.workPackage||this.apiV3Service.work_packages.id(this.uiRouterGlobals.params.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackage=e})}}u.\u0275fac=function(e){return new(e||u)(c.bc(n.UIRouterGlobals),c.bc(a.a))},u.\u0275cmp=c.Vb({type:u,selectors:[["wp-subject"]],inputs:{workPackage:"workPackage"},features:[c.Mb],decls:1,vars:1,consts:[["class","work-packages--subject-type-row __overflowing_element_container",3,"ngClass",4,"ngIf"],[1,"work-packages--subject-type-row","__overflowing_element_container",3,"ngClass"],[1,"work-packages--type-selector","work-packages--subject-element"],[3,"resource","wrapperClasses","fieldName"],[1,"work-packages--details--subject","work-packages--subject-element"]],template:function(e,t){1&e&&c.Tc(0,d,5,8,"div",0),2&e&&c.wc("ngIf",t.workPackage)},directives:[o.q,o.n,l.a],encapsulation:2})},ZGxV:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("zOhy"),s=i("fXoL"),r=i("ofXK"),a=i("711n"),c=i("XZlt"),o=i("aveh"),l=i("2bW2"),d=i("f24R");const u=function(){return["status","type"]};function h(e,t){if(1&e){const e=s.ic();s.hc(0,"div",1),s.hc(1,"edit-form",2),s.pc("onSaved",(function(t){s.Lc(e);return s.rc().onSaved(t)})),s.hc(2,"div",3),s.hc(3,"div",4),s.cc(4,"wp-type-status",5),s.hc(5,"div",6),s.hc(6,"a",7),s.pc("click",(function(){s.Lc(e);return s.rc().switchToFullscreen()})),s.cc(7,"span",8),s.gc(),s.gc(),s.gc(),s.cc(8,"wp-single-view",9),s.gc(),s.hc(9,"div",10),s.hc(10,"wp-edit-actions-bar",11),s.pc("onCancel",(function(){s.Lc(e);return s.rc().cancelAndBackToList()})),s.gc(),s.gc(),s.hc(11,"div",12),s.cc(12,"wp-resizer",13),s.gc(),s.gc(),s.gc()}if(2&e){const e=s.rc();s.Pb(1),s.wc("resource",e.newWorkPackage)("skippedFields",s.Ac(8,u))("inEditMode",!0),s.Pb(3),s.wc("workPackage",e.newWorkPackage),s.Pb(4),s.wc("workPackage",e.newWorkPackage)("showProject",e.copying),s.Pb(4),s.wc("elementClass","work-packages-partitioned-page--content-right")("localStorageKey","openProject-splitViewFlexBasis")}}class p extends n.a{}p.\u0275fac=function(e){return g(e||p)},p.\u0275cmp=s.Vb({type:p,selectors:[["wp-new-split-view"]],features:[s.Mb],decls:1,vars:1,consts:[["class","work-packages--details work-packages--new",4,"ngIf"],[1,"work-packages--details","work-packages--new"],[3,"resource","skippedFields","inEditMode","onSaved"],[1,"work-packages--details-content","-create-mode"],[1,"work-packages--new-details-header"],[3,"workPackage"],[1,"wp--details--switch-fullscreen-wrapper"],[1,"work-packages-show-view-button","wp--details--switch-fullscreen",3,"click"],[1,"icon-context","icon-to-fullscreen"],[3,"workPackage","showProject"],[1,"work-packages--details-toolbar-container"],[3,"onCancel"],[1,"work-packages--details--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"]],template:function(e,t){1&e&&s.Tc(0,h,13,9,"div",0),2&e&&s.wc("ngIf",t.newWorkPackage)},directives:[r.q,a.a,c.a,o.a,l.a,d.a],encapsulation:2,changeDetection:0});const g=s.jc(p)},ZTEj:function(e,t,i){"use strict";i.d(t,"a",(function(){return V}));var n=i("E2tj"),s=i("ooSb"),r=i("FB4C"),a=i("Zq3F"),c=i("AeZM"),o=i("wyKs"),l=i("6yP5"),d=i("JY8V"),u=i("F5Dh"),h=i("PtkW"),p=i("eyhC"),g=i("EnRq"),f=i("ONn1"),b=i("2Qcm"),m=i("4n9w"),w=i("+oAL"),v=i("Y/CA"),y=i("SKFm"),k=i("DhiE"),C=i("ABwi"),j=i("VgZ9"),P=i("l08T"),x=i("Q6HB"),S=i("FDFi"),_=i("f9kS"),O=i("Yblc"),I=i("W6hW"),T=i("pSHE"),R=i("FnNU"),E=i("fXoL");class M extends n.a{constructor(){super(...arguments),this.chartType=Object(R.g)()}}M.\u0275fac=function(e){return F(e||M)},M.\u0275prov=E.Xb({token:M,factory:M.\u0275fac});const F=E.jc(M);var A=i("HEQ6"),L=i("7xci");const D=[{provide:n.a,useClass:M},s.a,I.a,k.a,r.a,a.a,c.a,o.a,l.a,d.a,u.a,h.a,p.a,g.a,f.a,v.a,b.a,C.a,L.a,j.a,P.a,x.a,S.a,_.a,O.a,y.a,m.a,w.a,T.a];class V extends A.a{}V.\u0275fac=function(e){return q(e||V)},V.\u0275dir=E.Wb({type:V,selectors:[["","wp-isolated-graph-query-space",""]],features:[E.Ob(D),E.Mb]});const q=E.jc(V)},ZVvT:function(e,t,i){"use strict";i.d(t,"a",(function(){return k}));var n=i("SqdZ"),s=i("wZYP"),r=i("IaZ+"),a=i("PqYM"),c=i("eIep"),o=i("GJmQ"),l=i("Y0Nk"),d=i("Jui0"),u=i("d/TE"),h=i("CNq7"),p=i("fXoL"),g=i("tk/3"),f=i("ofXK");const b=["downloadLink"];function m(e,t){if(1&e&&(p.hc(0,"div",13),p.cc(1,"span",14),p.gc()),2&e){const e=p.rc();p.Pb(1),p.wc("ngClass",e.statusIcon)}}function w(e,t){if(1&e&&(p.hc(0,"ul"),p.cc(1,"li",3),p.gc()),2&e){const e=t.$implicit;p.Pb(1),p.wc("textContent",e)}}function v(e,t){if(1&e&&(p.hc(0,"p"),p.cc(1,"span",3),p.cc(2,"a",3),p.gc()),2&e){const e=p.rc(2);p.Pb(1),p.wc("textContent",e.text.redirect_errors),p.Pb(1),p.wc("textContent",e.text.redirect_link),p.Qb("href",e.payload.redirect,p.Oc)}}function y(e,t){if(1&e&&(p.fc(0),p.cc(1,"h3",15),p.Tc(2,w,2,1,"ul",16),p.Tc(3,v,3,3,"p",12),p.ec()),2&e){const e=p.rc();p.Pb(1),p.wc("textContent",e.text.errors),p.Pb(1),p.wc("ngForOf",e.payload.errors),p.Pb(1),p.wc("ngIf",null==e.payload?null:e.payload.redirect)}}class k extends n.a{constructor(e,t,i,n,s,r,a,c,o){super(e,t,n),this.locals=e,this.cdRef=t,this.I18n=i,this.elementRef=n,this.pathHelper=s,this.apiV3Service=r,this.loadingIndicator=a,this.notifications=c,this.httpClient=o,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={title:this.I18n.t("js.job_status.title"),closePopup:this.I18n.t("js.close_popup_title"),redirect:this.I18n.t("js.job_status.redirect"),redirect_errors:this.I18n.t("js.job_status.redirect_errors")+" ",redirect_link:this.I18n.t("js.job_status.redirect_link"),errors:this.I18n.t("js.job_status.errors"),download_starts:this.I18n.t("js.job_status.download_starts"),click_to_download:this.I18n.t("js.job_status.click_to_download")},this.isLoading=!1,this.title=this.text.title,this.downloadHref=null,this.jobId=e.jobId}ngOnInit(){super.ngOnInit(),this.listenOnJobStatus()}listenOnJobStatus(){Object(a.a)(0,2e3).pipe(Object(c.a)(()=>this.performRequest()),Object(o.a)(e=>!!e.body&&this.continuedStatus(e.body),!0),this.untilDestroyed(),Object(l.b)(this.loadingIndicator.getter("modal"))).subscribe(e=>this.onResponse(e),e=>this.handleError(e),()=>this.isLoading=!1)}iconForStatus(){switch(this.status){case"cancelled":case"failure":case"error":return"icon-error";case"success":return"icon-checkmark";default:return null}}continuedStatus(e){return["in_queue","in_process"].includes(e.status)}onResponse(e){var t;let i=e.body;if(!i)throw new Error(e);let n=this.status=i.status;this.message=i.message||this.I18n.t("js.job_status.generic_messages."+n,{defaultValue:n}),this.payload=i.payload,i.payload&&(this.title=i.payload.title||this.text.title,this.handleRedirect(i.payload),this.handleDownload(null===(t=i.payload)||void 0===t?void 0:t.download)),this.statusIcon=this.iconForStatus(),this.cdRef.detectChanges()}handleRedirect(e){(null==e?void 0:e.redirect)&&!(null==e?void 0:e.errors)&&(setTimeout(()=>window.location.href=e.redirect,2e3),this.message+=". "+this.text.redirect)}handleDownload(e){void 0!==e&&(this.downloadHref=e,setTimeout(()=>this.downloadLink.nativeElement.click(),50))}performRequest(){return this.httpClient.get(this.jobUrl,{observe:"response",responseType:"json"})}handleError(e){if(404===(null==e?void 0:e.status))return this.statusIcon="icon-help",void(this.message=this.I18n.t("js.job_status.generic_messages.not_found"));this.statusIcon="icon-error",this.message=(null==e?void 0:e.message)||this.I18n.t("js.error.internal"),this.notifications.addError(this.message)}get jobUrl(){return this.apiV3Service.job_statuses.id(this.jobId).toString()}}k.\u0275fac=function(e){return new(e||k)(p.bc(r.a),p.bc(p.i),p.bc(s.a),p.bc(p.q),p.bc(d.a),p.bc(h.a),p.bc(l.a),p.bc(u.a),p.bc(g.b))},k.\u0275cmp=p.Vb({type:k,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&p.ad(b,!0),2&e)&&(p.Ic(i=p.qc())&&(t.downloadLink=i.first))},features:[p.Mb],decls:16,vars:9,consts:[[1,"op-modal--portal","job-status--modal","-wide-fixed"],["tabindex","0",1,"op-modal--modal-container"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],["data-indicator-name","modal",1,"loading-indicator--location"],["class","status-icon-wrapper",4,"ngIf"],[1,"job-status--modal-main-message",3,"textContent"],[3,"hidden"],["download","","target","_blank",3,"textContent"],["downloadLink",""],[4,"ngIf"],[1,"status-icon-wrapper"],[1,"icon-big",3,"ngClass"],[1,"job-status--modal-additional-errors",3,"textContent"],[4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(p.hc(0,"div",0),p.hc(1,"div",1),p.hc(2,"div",2),p.cc(3,"h3",3),p.hc(4,"a",4),p.hc(5,"i",5),p.pc("click",(function(e){return t.closeMe(e)})),p.gc(),p.gc(),p.gc(),p.hc(6,"div"),p.hc(7,"div",6),p.Tc(8,m,2,1,"div",7),p.gc(),p.hc(9,"div"),p.cc(10,"span",8),p.hc(11,"span",9),p.Vc(12),p.cc(13,"a",10,11),p.gc(),p.Tc(15,y,4,3,"ng-container",12),p.gc(),p.gc(),p.gc(),p.gc()),2&e&&(p.Pb(3),p.wc("textContent",t.title),p.Pb(2),p.Qb("title",t.text.closePopup),p.Pb(3),p.wc("ngIf",!t.isLoading&&t.statusIcon),p.Pb(2),p.wc("textContent",t.message),p.Pb(1),p.wc("hidden",!t.downloadHref),p.Pb(1),p.Xc(" ",t.text.download_starts," "),p.Pb(1),p.wc("textContent",t.text.click_to_download),p.Qb("href",t.downloadHref,p.Oc),p.Pb(2),p.wc("ngIf",null==t.payload?null:t.payload.errors))},directives:[f.q,f.n,f.p],styles:[".job-status--modal[_ngcontent-%COMP%]{min-height:350px;min-width:450px;overflow-y:scroll}@media screen and (max-width:679px){.job-status--modal[_ngcontent-%COMP%]{min-width:200px}}.loading-indicator--location[_ngcontent-%COMP%]{height:220px}.status-icon-wrapper[_ngcontent-%COMP%]{display:flex;height:100%;align-items:center;justify-content:center}.job-status--modal-main-message[_ngcontent-%COMP%]{font-weight:700;display:flex;justify-content:center}.job-status--modal-additional-errors[_ngcontent-%COMP%]{margin-top:2rem}"]})},Zb8V:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("SKFm"),s=i("wZYP"),r=i("fXoL"),a=i("711n"),c=i("AEvm"),o=(i("GntA"),i("ofXK")),l=i("80WE");const d=["editForm"],u=function(e){return{"-required":e}};function h(e,t){if(1&e&&r.cc(0,"div",3),2&e){const e=r.rc();r.wc("ngClass",r.Bc(2,u,e.isRequired("workPackage")))("textContent",e.text.attributes.workPackage)}}function p(e,t){if(1&e&&(r.hc(0,"div",4),r.cc(1,"editable-attribute-field",10),r.gc()),2&e){const e=r.rc();r.Pb(1),r.wc("resource",e.entry)("fieldName","workPackage")}}function g(e,t){if(1&e&&r.cc(0,"editable-attribute-field",10),2&e){const e=r.rc();r.wc("resource",e.entry)("fieldName","activity")}}function f(e,t){if(1&e&&r.cc(0,"i",12),2&e){const e=r.rc();r.wc("textContent",e.text.wpRequired)}}function b(e,t){if(1&e&&(r.fc(0),r.cc(1,"div",3),r.hc(2,"div",4),r.cc(3,"editable-attribute-field",10),r.gc(),r.ec()),2&e){const e=t.$implicit,i=r.rc();r.Pb(1),r.wc("ngClass",r.Bc(4,u,i.isRequired(e.key)))("textContent",e.label),r.Pb(2),r.wc("resource",i.entry)("fieldName",e.key)}}class m extends c.a{constructor(e,t,i){super(),this.halEditing=e,this.cdRef=t,this.i18n=i,this.showWorkPackageField=!0,this.modifiedEntry=new r.s,this.text={attributes:{comment:this.i18n.t("js.time_entry.comment"),hours:this.i18n.t("js.time_entry.hours"),activity:this.i18n.t("js.time_entry.activity"),workPackage:this.i18n.t("js.time_entry.work_package"),spentOn:this.i18n.t("js.time_entry.spent_on")},wpRequired:this.i18n.t("js.time_entry.work_package_required")},this.workPackageSelected=!1,this.customFields=[]}ngOnInit(){this.halEditing.temporaryEditResource(this.changeset.projectedResource).values$().pipe(this.untilDestroyed()).subscribe(e=>{e&&e.workPackage&&(this.workPackageSelected=!0,this.cdRef.markForCheck())}),this.setCustomFields(),this.cdRef.detectChanges()}get entry(){return this.changeset.projectedResource}signalModifiedEntry(e){this.modifiedEntry.emit(e)}save(){return this.editForm.submit()}get inEditMode(){return!0}isRequired(e){return"workPackage"===e||this.schema.ofProperty(e).required}setCustomFields(){Object.entries(this.schema).forEach(([e,t])=>{e.match(/customField\d+/)&&this.customFields.push({key:e,label:t.name})})}get schema(){return this.changeset.schema}}m.\u0275fac=function(e){return new(e||m)(r.bc(n.a),r.bc(r.i),r.bc(s.a))},m.\u0275cmp=r.Vb({type:m,selectors:[["te-form"]],viewQuery:function(e,t){var i;(1&e&&r.Rc(d,!0),2&e)&&(r.Ic(i=r.qc())&&(t.editForm=i.first))},inputs:{changeset:"changeset",showWorkPackageField:"showWorkPackageField"},outputs:{modifiedEntry:"modifiedEntry"},features:[r.Mb],decls:19,vars:31,consts:[[3,"resource","inEditMode","onSaved"],["editForm",""],[1,"attributes-map"],[1,"attributes-map--key",3,"ngClass","textContent"],[1,"attributes-map--value"],[3,"resource","wrapperClasses","fieldName"],["class","attributes-map--key",3,"ngClass","textContent",4,"ngIf"],["class","attributes-map--value",4,"ngIf"],[3,"resource","fieldName",4,"ngIf"],[3,"textContent",4,"ngIf"],[3,"resource","fieldName"],[4,"ngFor","ngForOf"],[3,"textContent"]],template:function(e,t){1&e&&(r.hc(0,"edit-form",0,1),r.pc("onSaved",(function(e){return t.signalModifiedEntry(e)})),r.hc(2,"div",2),r.cc(3,"div",3),r.hc(4,"div",4),r.cc(5,"editable-attribute-field",5),r.gc(),r.cc(6,"div",3),r.hc(7,"div",4),r.cc(8,"editable-attribute-field",5),r.gc(),r.Tc(9,h,1,4,"div",6),r.Tc(10,p,2,2,"div",7),r.cc(11,"div",3),r.hc(12,"div",4),r.Tc(13,g,1,2,"editable-attribute-field",8),r.Tc(14,f,1,1,"i",9),r.gc(),r.cc(15,"div",3),r.hc(16,"div",4),r.cc(17,"editable-attribute-field",10),r.gc(),r.Tc(18,b,4,6,"ng-container",11),r.gc(),r.gc()),2&e&&(r.wc("resource",t.entry)("inEditMode",t.inEditMode),r.Pb(3),r.wc("ngClass",r.Bc(23,u,t.isRequired("spentOn")))("textContent",t.text.attributes.spentOn),r.Pb(2),r.wc("resource",t.entry)("wrapperClasses","-tiny")("fieldName","spentOn"),r.Pb(1),r.wc("ngClass",r.Bc(25,u,t.isRequired("hours")))("textContent",t.text.attributes.hours),r.Pb(2),r.wc("resource",t.entry)("wrapperClasses","-tiny")("fieldName","hours"),r.Pb(1),r.wc("ngIf",t.showWorkPackageField),r.Pb(1),r.wc("ngIf",t.showWorkPackageField),r.Pb(1),r.wc("ngClass",r.Bc(27,u,t.isRequired("activity")))("textContent",t.text.attributes.activity),r.Pb(2),r.wc("ngIf",t.workPackageSelected),r.Pb(1),r.wc("ngIf",!t.workPackageSelected),r.Pb(1),r.wc("ngClass",r.Bc(29,u,t.isRequired("comment")))("textContent",t.text.attributes.comment),r.Pb(2),r.wc("resource",t.entry)("fieldName","comment"),r.Pb(1),r.wc("ngForOf",t.customFields))},directives:[a.a,o.n,l.a,o.q,o.p],encapsulation:2,changeDetection:0})},Zq3F:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("E2tj"),s=i("kt6C"),r=i("U/vl");class a{constructor(e){this.current=new r.a(e.offset,e.total,e.pageSize)}get page(){return this.current.page}set page(e){this.current.page=e}get perPage(){return this.current.perPage}set perPage(e){this.current.perPage=e}get total(){return this.current.total}set total(e){this.current.total=e}}var c=i("zqrF"),o=i("fXoL");class l extends c.b{constructor(e,t){super(e),this.paginationService=t}get paginationObject(){return this.current?{pageSize:this.current.perPage,offset:this.current.page}:{pageSize:this.paginationService.getCachedPerPage([]),offset:1}}valueFromQuery(e,t){return new a(t)}updateFromObject(e){let t=this.current;e.page&&(t.page=e.page),e.perPage&&(t.perPage=e.perPage),e.total&&(t.total=e.total),this.updatesState.putValue(t)}updateFromResults(e){let t={page:e.offset,perPage:e.pageSize,total:e.total,count:e.count};this.updateFromObject(t)}get current(){return this.lastUpdatedState.value}}l.\u0275fac=function(e){return new(e||l)(o.lc(n.a),o.lc(s.a))},l.\u0275prov=o.Xb({token:l,factory:l.\u0275fac})},"ZsX/":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("tk/3"),s=i("w1tV"),r=i("pLZG"),a=i("lJxs"),c=i("kTsZ"),o=i("fXoL");class l{constructor(e,t){this.http=e,this.halResource=t}uploadAndMapResponse(e,t,i="post"){const{uploads:n,finished:s}=this.upload(e,t);return{uploads:n,finished:s.then(e=>e.map(e=>({response:e,uploadUrl:e.staticDownloadLocation.href})))}}upload(e,t,i="post"){t=_.filter(t,e=>"directory"!==e.type);const n=_.map(t,t=>this.uploadSingle(e,t,i));return{uploads:n,finished:this.whenFinished(n)}}uploadSingle(e,t,i="post",n="json"){const r=new FormData,a={description:t.description,fileName:t.customName||t.name};r.append("metadata",JSON.stringify(a)),r.append("file",t,a.fileName);return[t,this.http.request(i,e,{body:r,observe:"events",withCredentials:!0,responseType:n,reportProgress:!0}).pipe(Object(s.a)())]}whenFinished(e){const t=e.map(([e,t])=>t.pipe(Object(r.a)(e=>e.type===n.e.Response),Object(a.a)(e=>this.halResource.createHalResource(e.body))).toPromise());return Promise.all(t)}}l.\u0275fac=function(e){return new(e||l)(o.lc(n.b),o.lc(c.a))},l.\u0275prov=o.Xb({token:l,factory:l.\u0275fac})},ahVz:function(e,t,i){"use strict";i.d(t,"a",(function(){return j}));var n=i("mrSG"),s=i("dfy/"),r=i("Dp3K"),a=i("IzEk"),c=i("POAS"),o=i("qc15"),l=i("E05v"),d=i("r0MM"),u=i("wZYP"),h=i("eaMR"),p=i("fXoL"),g=i("ofXK"),f=i("CV67"),b=i("CS/5"),m=i("0loS"),w=i("DLfB");function v(e,t){if(1&e&&p.cc(0,"back-button",11),2&e){const e=p.rc();p.wc("customBackMethod",e.backButtonCallback)}}function y(e,t){if(1&e&&(p.hc(0,"li",15),p.cc(1,"ndc-dynamic",16),p.gc()),2&e){const e=p.rc().$implicit,t=p.rc(2);p.wc("ngClass",e.containerClasses),p.Pb(1),p.wc("ndcDynamicComponent",e.component)("ndcDynamicInputs",e.inputs)("ndcDynamicInjector",t.injector)("ndcDynamicOutputs",e.outputs)}}function k(e,t){if(1&e&&(p.fc(0),p.Tc(1,y,2,5,"li",14),p.ec()),2&e){const e=t.$implicit;p.Pb(1),p.wc("ngIf",!e.show||e.show())}}function C(e,t){if(1&e&&(p.hc(0,"ul",12),p.Tc(1,k,2,1,"ng-container",13),p.gc()),2&e){const e=p.rc();p.Pb(1),p.wc("ngForOf",e.toolbarButtonComponents)}}class j extends r.a{constructor(){super(...arguments),this.text={jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.pagination"),text_jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.label_pagination")},this.showToolbar=!1,this.toolbarButtonComponents=[],this.filterAllowed=!0,this.currentPartition="-split",this.filterContainerDefinition={component:h.a}}ngOnInit(){super.ngOnInit(),this.showToolbarSaveButton=!!this.$state.params.query_props,this.setPartition(this.$state.current),this.removeTransitionSubscription=this.$transitions.onSuccess({},e=>{const t=e.params("to"),i=e.to();this.showToolbarSaveButton=!!t.query_props,this.setPartition(i),this.cdRef.detectChanges()});const e=!this.querySpace.initialized.hasValue();this.refresh(e,e),this.setupInformationLoadedListener(),this.queryParamListener.observe$.pipe(this.untilDestroyed()).subscribe(()=>{this.currentQuery=void 0,this.refresh(!0,!0)}),this.unRegisterTitleListener=this.$transitions.onSuccess({},()=>{this.updateTitle(this.querySpace.query.value)}),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.onQueryUpdated(e)})}setPartition(e){this.currentPartition=e.data&&e.data.partition?e.data.partition:"-split"}setupInformationLoadedListener(){this.querySpace.initialized.values$().pipe(Object(a.a)(1)).subscribe(()=>{this.showToolbar=!0,this.cdRef.detectChanges()})}onQueryUpdated(e){this.updateTitle(e),this.currentQuery=e,this.cdRef.detectChanges()}ngOnDestroy(){super.ngOnDestroy(),this.unRegisterTitleListener(),this.removeTransitionSubscription(),this.queryParamListener.removeQueryChangeListener()}changeChangesFromTitle(e){this.currentQuery&&this.currentQuery.persisted?this.updateTitleName(e):this.wpListService.create(this.currentQuery,e).then(()=>this.toolbarDisabled=!1).catch(()=>this.toolbarDisabled=!1)}updateTitleName(e){this.toolbarDisabled=!0,this.currentQuery.name=e,this.wpListService.save(this.currentQuery).then(()=>this.toolbarDisabled=!1).catch(()=>this.toolbarDisabled=!1)}updateTitle(e){e&&(e.persisted?this.selectedTitle=e.name:this.selectedTitle=this.wpStaticQueries.getStaticName(e),this.titleEditingEnabled=this.authorisationService.can("query","updateImmediately"),this.shouldUpdateHtmlTitle()&&this.titleService.setFirstPart(this.selectedTitle))}refresh(e=!1,t=!1){let i,n=this.currentQuery;if(t||!n)i=this.loadFirstPage();else{let e=this.wpListService.getPaginationInfo();i=this.wpListService.loadQueryFromExisting(n,e,this.projectIdentifier).toPromise()}return e?this.loadingIndicator=i.then(e=>(this.wpStatesInitialization.initialize(e,e.results),this.additionalLoadingTime())):i.then(e=>{this.wpStatesInitialization.initialize(e,e.results)})}loadFirstPage(){return this.currentQuery?this.wpListService.reloadQuery(this.currentQuery,this.projectIdentifier).toPromise():this.wpListService.loadCurrentQueryFromParams(this.projectIdentifier)}additionalLoadingTime(){return Promise.resolve()}set loadingIndicator(e){this.loadingIndicatorService.table.promise=e}shouldUpdateHtmlTitle(){return!0}}j.\u0275fac=function(e){return P(e||j)},j.\u0275cmp=p.Vb({type:j,selectors:[["partitioned-query-space-page"]],features:[p.Ob([{provide:c.a,useClass:o.a},l.a]),p.Mb],decls:11,vars:11,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["linkClass","back-button",3,"customBackMethod",4,"ngIf"],[3,"title","inFlight","showSaveCondition","editable","onSave","onEmptySubmit"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"]],template:function(e,t){1&e&&(p.hc(0,"div",0),p.hc(1,"div",1),p.hc(2,"div",2),p.Tc(3,v,1,1,"back-button",3),p.hc(4,"editable-toolbar-title",4),p.pc("onSave",(function(e){return t.changeChangesFromTitle(e)}))("onEmptySubmit",(function(){return t.updateTitleName("")})),p.gc(),p.Tc(5,C,2,1,"ul",5),p.gc(),p.gc(),p.hc(6,"div",6),p.cc(7,"ndc-dynamic",7),p.gc(),p.hc(8,"div",8),p.cc(9,"div",9),p.cc(10,"div",10),p.gc(),p.gc()),2&e&&(p.wc("ngClass",t.currentPartition),p.Pb(3),p.wc("ngIf",t.backButtonCallback),p.Pb(1),p.wc("title",t.selectedTitle)("inFlight",t.toolbarDisabled)("showSaveCondition",t.showToolbarSaveButton)("editable",t.titleEditingEnabled),p.Pb(1),p.wc("ngIf",t.showToolbar),p.Pb(2),p.wc("ndcDynamicComponent",t.filterContainerDefinition.component)("ndcDynamicInputs",t.filterContainerDefinition.inputs)("ndcDynamicOutputs",t.filterContainerDefinition.outputs)("ndcDynamicInjector",t.injector))},directives:[g.n,g.q,f.a,b.c,b.d,m.UIView,w.a,g.p],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr)}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{overflow:auto}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   wp-resizer[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}@media only screen and (max-width:679px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:0;max-width:100vw;max-height:100%}}"],changeDetection:0}),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",u.a)],j.prototype,"I18n",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",s.a)],j.prototype,"titleService",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",l.a)],j.prototype,"queryParamListener",void 0);const P=p.jc(j)},ahm3:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));i("AA01");var n=i("wZYP"),s=i("Y41n"),r=i("AEvm"),a=i("Hg4z"),c=i("dMmB"),o=i("fXoL"),l=i("3Pt+"),d=i("oUDv");class u extends r.a{constructor(e,t){super(),this.I18n=e,this.schemaCache=t,this.shouldFocus=!1,this.filterChanged=new s.a(Object(a.b)(this))}get value(){return parseInt(this.filter.values[0])}set value(e){this.filter.values="number"==typeof e?[e.toString()]:[],this.filterChanged.emit(this.filter)}get unit(){switch(this.schema.filter.allowedValues[0].id){case"startDate":case"dueDate":case"updatedAt":case"createdAt":return this.I18n.t("js.work_packages.time_relative.days");default:return""}}get schema(){return this.schemaCache.of(this.filter)}}u.\u0275fac=function(e){return new(e||u)(o.bc(n.a),o.bc(c.a))},u.\u0275cmp=o.Vb({type:u,selectors:[["filter-integer-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[o.Mb],decls:3,vars:7,consts:[[1,"inline-label",3,"id"],["required","","min","0","type","number",1,"advanced-filters--number-field",3,"ngModel","focus","id","name","ngModelChange"],[1,"advanced-filters--affix",3,"for","textContent"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"input",1),o.pc("ngModelChange",(function(e){return t.value=e})),o.gc(),o.cc(2,"label",2),o.gc()),2&e&&(o.yc("id","div-values-",t.filter.id,""),o.Pb(1),o.yc("id","values-",t.filter.id,""),o.yc("name","v[",t.filter.id,"]"),o.wc("ngModel",t.value)("focus",t.shouldFocus),o.Pb(1),o.yc("for","values-",t.filter.id,""),o.wc("textContent",t.unit))},directives:[l.s,l.c,l.x,l.m,l.p,d.a],encapsulation:2})},aveh:function(e,t,i){"use strict";i.d(t,"a",(function(){return Z}));var n=i("wZYP"),s=i("Jui0"),r=i("/uUt"),a=i("lJxs"),c=i("qHU1"),o=i("sjKJ"),l=i("iMRi"),d=(i("ii2/"),i("SKFm")),u=i("J30J"),h=i("B4Ei"),p=i("g1AQ"),g=i("XNiG"),f=i("R9pB"),b=i("buwf"),m=i("kTsZ"),w=i("AEvm"),v=i("dMmB"),y=i("fXoL"),k=i("ofXK"),C=i("CS/5"),j=i("lJGx"),P=i("80WE"),x=i("K8b8"),S=i("cI0L"),O=i("+pCT"),I=i("QihR"),T=i("+ytV"),R=i("HEQ6");function E(e,t){if(1&e&&(y.hc(0,"div",22),y.cc(1,"editable-attribute-field",23),y.gc()),2&e){const e=y.rc(2);y.Pb(1),y.wc("resource",e.workPackage)("wrapperClasses","-no-label")("fieldName","subject")}}function M(e,t){if(1&e&&y.cc(0,"wp-status-button",24),2&e){const e=y.rc(2);y.wc("workPackage",e.workPackage)}}function F(e,t){1&e&&y.cc(0,"attribute-help-text",25),2&e&&y.wc("attribute","status")("attributeScope","WorkPackage")}function A(e,t){if(1&e&&(y.hc(0,"div",26),y.cc(1,"span",27),y.Vc(2,": "),y.cc(3,"span",27),y.hc(4,"span"),y.Vc(5,"\xa0"),y.gc(),y.cc(6,"user-link",28),y.Vc(7,". "),y.cc(8,"span",27),y.hc(9,"span"),y.Vc(10,"\xa0"),y.gc(),y.cc(11,"op-date-time",29),y.Vc(12,". "),y.gc()),2&e){const e=y.rc(2);y.Pb(1),y.wc("textContent",e.idLabel),y.Pb(2),y.wc("textContent",e.text.infoRow.createdBy),y.Pb(3),y.wc("user",e.workPackage.author),y.Pb(2),y.wc("textContent",e.text.infoRow.lastUpdatedOn),y.Pb(3),y.wc("dateTimeValue",e.workPackage.updatedAt)}}function L(e,t){1&e&&(y.hc(0,"span",39),y.Vc(1,"*"),y.gc())}const D=function(e){return{"-span-all-columns":e}};function V(e,t){if(1&e&&(y.hc(0,"div",33),y.hc(1,"div",34),y.hc(2,"wp-replacement-label",35),y.Vc(3),y.Tc(4,L,2,0,"span",36),y.gc(),y.cc(5,"attribute-help-text",25),y.gc(),y.hc(6,"div",37),y.cc(7,"editable-attribute-field",38),y.gc(),y.gc()),2&e){const e=t.$implicit,i=y.rc(3);y.wc("ngClass",y.Bc(8,D,e.spanAll)),y.Pb(2),y.wc("fieldName",e.name),y.Pb(1),y.Xc(" ",e.label," "),y.Pb(1),y.wc("ngIf",e.field.required&&e.field.writable),y.Pb(1),y.wc("attribute",e.name)("attributeScope","WorkPackage"),y.Pb(2),y.wc("resource",i.workPackage)("fieldName",e.name)}}function q(e,t){if(1&e&&(y.hc(0,"div",30),y.hc(1,"div"),y.cc(2,"p",31),y.Tc(3,V,8,10,"div",32),y.gc(),y.gc()),2&e){const e=y.rc(2);y.Pb(2),y.wc("textContent",e.text.project.required),y.Pb(1),y.wc("ngForOf",e.projectContext.field)("ngForTrackBy",e.trackByName)}}function $(e,t){if(1&e&&(y.hc(0,"div",40),y.hc(1,"div"),y.hc(2,"p"),y.cc(3,"span",41),y.cc(4,"br"),y.cc(5,"a",42),y.gc(),y.gc(),y.gc()),2&e){const e=y.rc(2);y.Pb(3),y.wc("innerHTML",e.projectContextText,y.Mc),y.Pb(2),y.wc("textContent",e.text.project.switchTo),y.Qb("href",e.projectContext.href,y.Oc)}}const N=function(e){return{workPackage:e}};function B(e,t){if(1&e&&(y.fc(0),y.cc(1,"ndc-dynamic",6),y.ec()),2&e){const e=t.$implicit,i=y.rc(2);y.Pb(1),y.wc("ndcDynamicComponent",e)("ndcDynamicInputs",y.Bc(2,N,i.workPackage))}}const z=function(e,t,i){return{workPackage:e,group:t,query:i}};function H(e,t){if(1&e&&(y.fc(0,46),y.cc(1,"ndc-dynamic",6),y.ec()),2&e){const e=y.rc().$implicit,t=y.rc(2);y.Pb(1),y.wc("ndcDynamicComponent",t.attributeGroupComponent(e))("ndcDynamicInputs",y.Dc(2,z,t.workPackage,e,e.query))}}const Q=function(e,t){return{workPackage:e,group:t}};function W(e,t){if(1&e&&(y.fc(0),y.hc(1,"div",3),y.hc(2,"div",4),y.cc(3,"h3",5),y.gc(),y.gc(),y.cc(4,"ndc-dynamic",47),y.ec()),2&e){const e=y.rc().$implicit,t=y.rc(2);y.Pb(3),y.wc("textContent",e.name),y.Pb(1),y.wc("ndcDynamicComponent",t.attributeGroupComponent(e))("ndcDynamicInjector",t.injector)("ndcDynamicInputs",y.Cc(4,Q,t.workPackage,e))}}function X(e,t){if(1&e&&(y.hc(0,"div",43),y.Tc(1,H,2,6,"ng-container",44),y.Tc(2,W,5,7,"ng-container",45),y.gc()),2&e){const e=t.$implicit,i=y.rc(2);y.wc("hidden",i.shouldHideGroup(e))("ngClass","__overflowing_"+e.id),y.Qb("data-group-name",e.name)("data-overflowing-identifier",".__overflowing_"+e.id),y.Pb(1),y.wc("ngIf",e.isolated),y.Pb(1),y.wc("ngIf",!e.isolated)}}const U=function(e){return{"-can-have-columns":e}};function G(e,t){if(1&e&&(y.hc(0,"div",8),y.Tc(1,E,2,3,"div",9),y.hc(2,"div",10),y.Tc(3,M,1,1,"wp-status-button",11),y.Tc(4,F,1,2,"attribute-help-text",12),y.Tc(5,A,13,5,"div",13),y.cc(6,"wp-custom-actions",14),y.gc(),y.Tc(7,q,4,3,"div",15),y.Tc(8,$,6,3,"div",16),y.Tc(9,B,2,4,"ng-container",17),y.hc(10,"div",18),y.hc(11,"div",19),y.cc(12,"editable-attribute-field",20),y.gc(),y.gc(),y.Tc(13,X,3,6,"div",21),y.gc()),2&e){const e=y.rc();y.wc("ngClass",y.Bc(15,U,e.enableTwoColumnLayout)),y.Pb(1),y.wc("ngIf",e.workPackage.isNew),y.Pb(2),y.wc("ngIf",!e.workPackage.isNew),y.Pb(1),y.wc("ngIf",!e.workPackage.isNew),y.Pb(1),y.wc("ngIf",!e.workPackage.isNew),y.Pb(1),y.wc("workPackage",e.workPackage),y.Pb(1),y.wc("ngIf",e.projectContext&&e.projectContext.field),y.Pb(1),y.wc("ngIf",!e.workPackage.isNew&&e.projectContext&&!e.projectContext.matches),y.Pb(1),y.wc("ngForOf",e.prependedAttributeGroupComponents()),y.Pb(3),y.wc("fieldName","description")("resource",e.workPackage)("isDropTarget",!0)("wrapperClasses","-no-label"),y.Pb(1),y.wc("ngForOf",e.groupedFields)("ngForTrackBy",e.trackByName)}}const Y=function(e){return{resource:e}};function K(e,t){if(1&e&&y.cc(0,"ndc-dynamic",6),2&e){const e=y.rc();y.wc("ndcDynamicComponent",e.attachmentUploadComponent())("ndcDynamicInputs",y.Bc(2,Y,e.workPackage))}}class Z extends w.a{constructor(e,t,i,n,s,r,a,c,o,l,d,u,h){super(),this.I18n=e,this.currentProject=t,this.PathHelper=i,this.states=n,this.halEditing=s,this.halResourceService=r,this.displayFieldService=a,this.schemaCache=c,this.hook=o,this.injector=l,this.cdRef=d,this.elementRef=u,this.browserDetector=h,this.showProject=!1,this.groupedFields=[],this.resourceContextChange=new g.a,this.text={attachments:{label:this.I18n.t("js.label_attachments")},project:{required:this.I18n.t("js.project.required_outside_context"),context:this.I18n.t("js.project.context"),switchTo:this.I18n.t("js.project.click_to_switch_context")},fields:{description:this.I18n.t("js.work_packages.properties.description")},infoRow:{createdBy:this.I18n.t("js.label_created_by"),lastUpdatedOn:this.I18n.t("js.label_last_updated_on")}},this.firstTimeFocused=!1}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement);const e=this.halEditing.changeFor(this.workPackage);this.resourceContextChange.next(this.contextFrom(e.projectedResource)),this.refresh(e),this.resourceContextChange.pipe(this.untilDestroyed(),Object(r.a)((e,t)=>_.isEqual(e,t)),Object(a.a)(()=>this.halEditing.changeFor(this.workPackage))).subscribe(e=>this.refresh(e)),this.halEditing.temporaryEditResource(this.workPackage).values$().pipe(this.untilDestroyed()).subscribe(e=>{this.resourceContextChange.next(this.contextFrom(e))})}refresh(e){const t=this.workPackage.isNew,i=e.projectedResource;i.project?this.projectContext={href:this.PathHelper.projectWorkPackagePath(i.project.idFromLink,this.workPackage.id),matches:i.project.href===this.currentProject.apiv3Path}:this.projectContext={matches:!1,href:null},t&&!this.currentProject.inProjectContext&&(this.projectContext.field=this.getFields(e,["project"]));const n=this.schema(i)._attributeGroups;this.groupedFields=this.rebuildGroupedFields(e,n),this.cdRef.detectChanges()}shouldHideGroup(e){const t=0===e.members.length,i=this.workPackage.isNew&&!!e.query;return t||i}trackByName(e,t){return t.name}prependedAttributeGroupComponents(){return this.hook.call("prependedAttributeGroups",this.workPackage)}attributeGroupComponent(e){return this.hook.call("attributeGroupComponent",e,this.workPackage).pop()||null}attachmentListComponent(){return this.hook.call("workPackageAttachmentListComponent",this.workPackage).pop()||null}attachmentUploadComponent(){return this.hook.call("workPackageAttachmentUploadComponent",this.workPackage).pop()||null}get idLabel(){return"#"+this.workPackage.id}get projectContextText(){let e=this.workPackage.project.idFromLink,t=`<a href="${this.PathHelper.projectPath(e)}">${this.workPackage.project.name}<a>`;return this.I18n.t("js.project.work_package_belongs_to",{projectname:t})}get enableTwoColumnLayout(){return this.workPackage.isNew&&!this.browserDetector.isEdge}rebuildGroupedFields(e,t){return t?t.map(t=>{let i=this.getAttributesGroupId(t);return"WorkPackageFormAttributeGroup"===t._type?{name:t.name,id:i||Object(f.a)(16),members:this.getFields(e,t.attributes),type:t._type,isolated:!1}:{name:t.name,id:i||Object(f.a)(16),query:this.halResourceService.createHalResourceOfClass(h.a,t._embedded.query),relationType:t.relationType,members:[t._embedded.query],type:t._type,isolated:!0}}):[]}getFields(e,t){const i=[];return t.forEach(t=>{if("date"===t)return void i.push(this.getDateField(e));if(!e.schema.ofProperty(t))return void Object(c.a)("Unknown field for current schema",t);const n=this.displayField(e,t);i.push({name:t,label:n.label,multiple:!1,spanAll:n.isFormattable,field:n})}),i}getDateField(e){let t={label:this.I18n.t("js.work_packages.properties.date"),multiple:!1};return e.schema.ofProperty("date")?(t.field=this.displayField(e,"date"),t.name="date"):(t.field=this.displayField(e,"combinedDate"),t.name="combinedDate"),t}contextFrom(e){let t=this.schema(e),i=null,n=e.project&&e.project.href;return i=t.baseSchema?t.baseSchema.href:t.href,{isNew:e.isNew,schema:i,project:n}}displayField(e,t){return this.displayFieldService.getField(e.projectedResource,t,e.schema.ofProperty(t),{container:"single-view",injector:this.injector,options:{}})}getAttributesGroupId(e){let t=this.$element.find("[data-group-name='"+e.name+"']").data("overflowingIdentifier");return t?t.replace(".__overflowing_",""):""}schema(e){return this.halEditing.typedState(e).hasValue()?this.halEditing.typedState(this.workPackage).value.schema:this.schemaCache.of(e)}}Z.\u0275fac=function(e){return new(e||Z)(y.bc(n.a),y.bc(o.a),y.bc(s.a),y.bc(l.a),y.bc(d.a),y.bc(m.a),y.bc(u.a),y.bc(v.a),y.bc(p.a),y.bc(y.A),y.bc(y.i),y.bc(y.q),y.bc(b.a))},Z.\u0275cmp=y.Vb({type:Z,selectors:[["wp-single-view"]],inputs:{workPackage:"workPackage",showProject:"showProject"},features:[y.Mb],decls:8,vars:7,consts:[["class","work-package--single-view",3,"ngClass",4,"ngIf"],[1,"work-packages--attachments","attributes-group"],[1,"work-packages--attachments-container"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],[3,"ndcDynamicComponent","ndcDynamicInputs"],[3,"ndcDynamicComponent","ndcDynamicInputs",4,"ngIf"],[1,"work-package--single-view",3,"ngClass"],["class","wp-new--subject-wrapper",4,"ngIf"],[1,"wp-info-wrapper"],[3,"workPackage",4,"ngIf"],[3,"attribute","attributeScope",4,"ngIf"],["class","work-packages--info-row",4,"ngIf"],[1,"custom-actions",3,"workPackage"],["class","attributes-group -project-context __overflowing_element_container __overflowing_project_context","data-overflowing-identifier",".__overflowing_project_context",4,"ngIf"],["class","attributes-group -project-context hide-when-print",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"attributes-group","description-group"],[1,"single-attribute","work-packages--details--description"],[3,"fieldName","resource","isDropTarget","wrapperClasses"],["class","attributes-group __overflowing_element_container",3,"hidden","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"wp-new--subject-wrapper"],[3,"resource","wrapperClasses","fieldName"],[3,"workPackage"],[3,"attribute","attributeScope"],[1,"work-packages--info-row"],[3,"textContent"],[1,"user-link",3,"user"],[3,"dateTimeValue"],["data-overflowing-identifier",".__overflowing_project_context",1,"attributes-group","-project-context","__overflowing_element_container","__overflowing_project_context"],[1,"wp-project-context--warning",3,"textContent"],["class","attributes-key-value",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"attributes-key-value",3,"ngClass"],[1,"attributes-key-value--key"],[3,"fieldName"],["class","required",4,"ngIf"],[1,"attributes-key-value--value-container"],[3,"resource","fieldName"],[1,"required"],[1,"attributes-group","-project-context","hide-when-print"],[3,"innerHTML"],[1,"project-context--switch-link",3,"textContent"],[1,"attributes-group","__overflowing_element_container",3,"hidden","ngClass"],["wp-isolated-query-space","",4,"ngIf"],[4,"ngIf"],["wp-isolated-query-space",""],[3,"ndcDynamicComponent","ndcDynamicInjector","ndcDynamicInputs"]],template:function(e,t){1&e&&(y.Tc(0,G,14,17,"div",0),y.hc(1,"div",1),y.hc(2,"div",2),y.hc(3,"div",3),y.hc(4,"div",4),y.cc(5,"h3",5),y.gc(),y.gc(),y.cc(6,"ndc-dynamic",6),y.Tc(7,K,1,4,"ndc-dynamic",7),y.gc(),y.gc()),2&e&&(y.wc("ngIf",t.workPackage),y.Pb(5),y.wc("textContent",t.text.attachments.label),y.Pb(1),y.wc("ndcDynamicComponent",t.attachmentListComponent())("ndcDynamicInputs",y.Bc(5,Y,t.workPackage)),y.Pb(1),y.wc("ngIf",t.workPackage.canAddAttachments))},directives:[k.q,C.c,C.d,k.n,j.a,k.p,P.a,x.a,S.a,O.a,I.a,T.a,R.a],encapsulation:2,changeDetection:0})},ayqa:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("mrSG"),s=i("juWA"),r=i("RGDJ"),a=i("5qbd"),c=i("r0MM"),o=i("CNq7");class l extends a.a{render(e,t){if(super.render(e,t),this.showSchedulingMode()){const t=document.createElement("span");t.classList.add("icon-context"),this.resource.scheduleManually&&t.classList.add("icon-pin"),e.prepend(t)}if(this.shouldHighlight&&this.canOverdue){const t=this.timezoneService.daysFromToday(this.value);this.apiV3Service.statuses.id(this.resource.status.id).get().toPromise().then(i=>{i.isClosed||e.classList.add(r.a.overdueDate(t))})}}get canOverdue(){return-1!==["dueDate","date"].indexOf(this.name)}get valueString(){return this.value?this.timezoneService.formattedDate(this.value):""}showSchedulingMode(){return"startDate"===this.name||"date"===this.name}}Object(n.c)([Object(c.a)(),Object(n.e)("design:type",s.a)],l.prototype,"timezoneService",void 0),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",o.a)],l.prototype,"apiV3Service",void 0)},bXa3:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("o0hg"),s=i("GwdO");class r extends n.c{post(e={},t=null){return this.halResourceService.post(this.path,this.extractPayload(e,t))}extractPayload(e,t=null){return s.a.extractPayload(e,t)}}},buKu:function(e,t,i){"use strict";i.r(t);i("yLV6"),i("E+lO");var n=i("PBJw");function s(e){window.OpenProject.getPluginContext().then(t=>{const i=t.services.opModalService,n=t.classes.modals.passwordConfirmation;e(document).on("submit","form[data-request-for-confirmation]",(function(e){const t=jQuery(this);return!!t.find('input[name="_password_confirmation"]').length||function(e,t,i,n){return e.find("_password_confirmation").length>0||(t.preventDefault(),i.show(n,"global").closingEvent.subscribe(t=>{t.confirmed&&(jQuery("<input>").attr({type:"hidden",name:"_password_confirmation",value:t.password_confirmation}).appendTo(e),e.trigger("submit"))}),!1)}(t,e,i,n)}))})}var r=i("K247");function a(e,t){var i="fieldset-toggle-state-label",n=e.find("a span."+i),s=e.children("a");0===n.length&&(n=jQuery("<span />").addClass(i).addClass("hidden-for-sighted"),s.append(n)),n.text(" "+t)}function c(e){var t=e.children("legend");e.hasClass("collapsed")?a(t,I18n.t("js.label_collapsed")):a(t,I18n.t("js.label_expanded"))}function o(e){var t=jQuery(e);if(t.is("legend"))return jQuery(e).parent();if(t.is("fieldset"))return t;throw"Cannot derive fieldset from element!"}function l(){const e=jQuery("fieldset.form--fieldset.-collapsible");e.on("click",".form--fieldset-legend",(function(e){return function(e){var t=o(e);t.attr("data-touched","true");var i=t.find("> div").not(".form--toolbar");t.toggleClass("collapsed"),i.slideToggle("fast"),c(t)}(this),e.preventDefault(),e.stopPropagation(),!1})),e.each((function(){var e=o(this);let t=e.find("> div");e.hasClass("collapsed")&&t.hide(),c(e)}))}var d=i("/nP/"),u=i("WPBv");function h(){!function(){let e=jQuery("#wrapper"),t=jQuery("ul.menu_root.closed li.open a.arrow-left-to-project");1===t.length&&e.hasClass("hidden-navigation")&&t.trigger("click")}(),function(){const e=jQuery("span.errorSpan").first();e.find("*").filter(":input").trigger("focus")}(),f(),b(),setTimeout((function(){jQuery(".flash.autohide-notification").remove()}),5e3),jQuery("body").on("click keydown touchend",".close-handler,.notification-box--close",(function(e){"click"!==e.type&&13!==e.which||jQuery(this).parent(".flash, .errorExplanation, .notification-box").not(".persistent-toggle--notification").remove()})),jQuery(document).ajaxComplete(f),jQuery(document).ajaxComplete(b),jQuery(document).ajaxSend((function(e,t){jQuery(e.target.activeElement).closest("[ajax-indicated]").length&&jQuery("ajax-indicator")&&jQuery("#ajax-indicator").show();var i=jQuery("meta[name=csrf-token]");if(i){var n=i.attr("content");t.setRequestHeader("X-CSRF-Token",n)}t.setRequestHeader("X-Authentication-Scheme","Session")})),jQuery(document).ajaxStop((function(){jQuery("#ajax-indicator")&&jQuery("#ajax-indicator").hide(),p()})),jQuery(".attachments h4").click((function(){jQuery(this).toggleClass("closed").next().slideToggle(100)}));let e=null;jQuery(window).on("resize",(function(){e&&clearTimeout(e),e=setTimeout((function(){jQuery(window).trigger("resizeEnd")}),200)})),jQuery("#nav-login-content").click((function(e){e.stopPropagation()}));var t=jQuery("a.afocus").first(),i=jQuery(".autofocus").first();void 0!==t?t.focus():void 0!==i&&(i.focus(),"INPUT"===i[0].tagName&&i.select()),p(),jQuery(document.body).on("click",".formatting-help-link-button",(function(){return window.open(window.appBasePath+"/help/wiki_syntax","","resizable=yes, location=no, width=600, height=640, menubar=no, status=no, scrollbars=yes"),!1}))}function p(){jQuery("a.afocus").each((function(){var e=jQuery(this);e.click((function(t){var i=jQuery("#"+e.attr("href").substr(1));return null===i&&(i=jQuery("#"+e.attr("href").substr(1).concat("_id"))),e.unbind(t),!1}))}))}function g(e){jQuery(e).each((function(e,t){jQuery(t).show()}))}function f(){g(".flash")}function b(){g('.errorExplanation[role="alert"]')}var m,w=i("mrSG"),v=i("TjuE"),y=i("qHU1");function k(e){return Object(w.b)(this,void 0,void 0,(function*(){Object(y.a)("Loading and triggering onboarding tour "+e);(yield i.e(29).then(i.bind(null,"r6rV"))).start(e)}))}(m=jQuery)((function(){m(document.documentElement).on("click",e=>{const t=jQuery(e.target);return function(e,t){t.hasClass("-augmented-datepicker")&&(t.attr("autocomplete","off"),window.OpenProject.getPluginContext().then(e=>{new n.a(".-augmented-datepicker",t.val(),{weekNumbers:!0,allowInput:!0},t[0],e.services.configurationService).show()}))}(0,t),function(e,t){document.contains(e.target)||e.preventDefault();const i=t.closest("a");if(0===i.length)return;const n=i.attr("href")||"",s=n.indexOf("#");""!==n&&0!==s||(-1!==s&&"#"!==n&&(window.location.hash=n),e.preventDefault())}(e,t),!0});const e=window.location.hash;if(e&&e.startsWith("#"))try{const t=document.querySelector(e);t&&t.scrollIntoView()}catch(a){console.log("Could not scroll to given location hash: "+e+" ( "+a.message+")")}if(m(document).on("submit","form",(function(){window.OpenProject.pageIsSubmitted=!0})),document.querySelector(".warning-bar--item")){let e=document.querySelector("#content");e&&(e.style.marginBottom="100px")}var t,i;m(window).on("beforeunload",e=>{const t=e.originalEvent;window.OpenProject.pageWasEdited&&!window.OpenProject.pageIsSubmitted&&(t.preventDefault(),t.returnValue=I18n.t("js.work_packages.confirm_edit_cancel"))}),m(document.documentElement).on("dragover drop",e=>(e.preventDefault(),!1)),function(){const e=document.querySelectorAll(".augment--refresh-on-form-changes");for(let t=0;t<e.length;t++){let i=e[t];const n=jQuery(i),s=n.data("refreshUrl"),r=n.data("inputSelector");n.find(r).on("change",()=>{window.location.href=s+"?"+n.serialize()})}}(),s(m),(new r.a).isMobile&&function(){let e=window.scrollY;window.addEventListener("scroll",(function(){let t=window.scrollY<0?0:window.scrollY;!jQuery("#main").hasClass("hidden-navigation")||jQuery("#top-menu").hasClass("-global-search-expanded")||Math.abs(t-e)<=55||(void 0!==e&&void 0!==t&&e>t?jQuery("#wrapper").removeClass("-header-scrolled"):jQuery("#wrapper").addClass("-header-scrolled"),e=t)}))}(),function(){const e=new URL(window.location.href),t=document.body.classList.contains("-browser-mobile"),i="true"===jQuery("meta[name=demo_projects_available]").attr("content");let n=sessionStorage.getItem(v.c),s=!1;!t&&i&&(e.searchParams.get("first_time_user")&&2===Object(v.b)().length&&(n="",sessionStorage.setItem(v.c,"readyToStart"),jQuery(".op-modal--modal-close-button").click((function(){s=!0,k("homescreen")})),document.addEventListener("keydown",(function(e){"Escape"!==e.key||s||(s=!0,k("homescreen"))}),{once:!0})),"readyToStart"===n&&k("homescreen"),("startMainTourFromBacklogs"===n||e.searchParams.get("start_onboarding_tour"))&&k("main"),e.searchParams.get("start_scrum_onboarding_tour")&&jQuery(".backlogs-menu-item").length>0&&k("backlogs"),"startTaskBoardTour"===n&&k("taskboard"))}(),l(),new d.b(jQuery("#top-menu-items")),jQuery(".project-actions, .toolbar-items").each((function(e,t){Object(u.a)(jQuery(t))})),function(){jQuery("#settings_session_ttl_enabled").on("change",(function(){jQuery("#settings_session_ttl_container").toggle(jQuery(this).is(":checked"))})).trigger("change"),jQuery('[name="settings[enabled_scm][]"]').change((function(){var e=!this.checked,t=this.value,i=jQuery("#settings_repositories_automatic_managed_vendor"),n=i.find('option[value="'+t+'"]');0!==n.length&&(n.prop("disabled",e),e&&n.prop("selected")&&i.val(""))}));let e=function(e){let t=jQuery(e),i=t.attr("id")||"",n=i.replace("lang-for-",""),s=t.val(),r=jQuery("#settings-"+n),a=r.siblings("ckeditor-augmented-textarea").data("editor");return{id:i,settingName:n,newLang:s,textArea:r,editor:a}};jQuery(".lang-select-switch").focus((function(){let t=e(this);jQuery(`#${t.id}-${t.newLang}`).val(t.editor.getData())})).change((function(){let t=e(this),i=jQuery(`#${t.id}-${t.newLang}`).val();t.editor.setData(i),t.textArea.attr("name",`settings[${t.settingName}][${t.newLang}]`)})),jQuery(".admin-settings--form").submit((function(){return jQuery("#settings_consent_required").is(":checked")&&jQuery("#toggle_consent_time").is(":checked")&&jQuery("#settings_consent_time").val((new Date).toISOString()).prop("disabled",!1),!0})),jQuery("#email_delivery_method_switch").on("change",(function(){const e=jQuery(this).val();jQuery(".email_delivery_method_settings").hide(),jQuery("#email_delivery_method_"+e).show()})).trigger("change"),jQuery("#settings_smtp_authentication").on("change",(function(){var e="none"===jQuery(this).val();jQuery("#settings_smtp_user_name,#settings_smtp_password").closest(".form--field").toggle(!e)})),jQuery(".settings-repositories--checkout-toggle").change((function(){var e=this.checked;jQuery(this).closest("fieldset").find("input,select").filter(":not([type=checkbox])").filter(":not([type=hidden])").removeAttr("required").prop("required",e)})),jQuery(".settings--highlighting-mode select").change((function(){var e=jQuery(this).val();jQuery(".settings--highlighted-attributes").toggle("inline"===e)})),0===jQuery(".settings--highlighted-attributes input[type='checkbox']:checked").length&&jQuery(".settings--highlighted-attributes input[type='checkbox']").prop("checked",!0),jQuery("#tab-content-work_packages form").submit((function(){var e=jQuery(".settings--highlighted-attributes input[type='checkbox']");jQuery(".settings--highlighted-attributes input[type='checkbox']:checked").length===e.length&&e.prop("checked",!1)}))}(),jQuery(".color--preview").each((function(){let e,t,i=jQuery(this),n=i.data("target");e=n?jQuery(n):i.next("input"),0!==e.length&&(t=function(){var t="";e.val()&&e.val().length>0?t=e.val():e.attr("placeholder")&&e.attr("placeholder").length>0&&(t=e.attr("placeholder")),i.css("background-color",t)},e.keyup(t).change(t).focus(t),t())})),t=jQuery(".danger-zone--verification"),i=jQuery(".danger-zone--expected-value").text(),t.find("input").on("input",(function(){var e=t.find("input").val();i.toLowerCase()===e.toLowerCase()?t.find("button").prop("disabled",!1):t.find("button").prop("disabled",!0)})),h()}));var C=i("FnNU"),j=i("IzEk");class P{checkAll(e,t){jQuery("#"+e+" input:checkbox").not(":disabled").each((function(){this.checked=t}))}toggleCheckboxesBySelector(e){const t=jQuery(e);var i=!0;for(let n=0;n<t.length;n++)!1===t[n].checked&&(i=!1);for(let n=0;n<t.length;n++)t[n].checked=!i}}window.OpenProject=new class{constructor(){this.pluginContext=Object(C.g)(),this.helpers=new P,this.pageWasEdited=!1,this.pageIsSubmitted=!1}getPluginContext(){return this.pluginContext.values$().pipe(Object(j.a)(1)).toPromise()}get urlRoot(){return jQuery("meta[name=app_base_path]").attr("content")||""}get environment(){return jQuery("meta[name=openproject_initializer]").data("environment")}get edition(){return jQuery("meta[name=openproject_initializer]").data("edition")}get isStandardEdition(){return"standard"===this.edition}get isBimEdition(){return"bim"===this.edition}guardedLocalStorage(e,t){try{if(void 0===t){const t=window.localStorage.getItem(e);return null===t?void 0:t}window.localStorage.setItem(e,t)}catch(i){console.error("Failed to access your browsers local storage. Is your local database corrupted?")}}};i("SU55")},buwf:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("ofXK"),s=i("fXoL");class r{constructor(e){this.documentElement=e}get isMobile(){return this.hasBodyClass("-browser-mobile")}get isEdge(){return this.hasBodyClass("-browser-edge")}hasBodyClass(e){return this.documentElement.body.classList.contains(e)}}r.\u0275fac=function(e){return new(e||r)(s.lc(n.d))},r.\u0275prov=s.Xb({token:r,factory:r.\u0275fac,providedIn:"root"})},byj5:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("wZYP"),s=i("l08T"),r=i("F5Dh"),a=i("fbLK"),c=i("fXoL"),o=i("ofXK"),l=i("70hh");function d(e,t){if(1&e){const e=c.ic();c.hc(0,"query-filters",1),c.pc("filtersChanged",(function(t){c.Lc(e);return c.rc().filters=t})),c.gc()}if(2&e){const e=c.rc();c.wc("filters",e.filters)}}class u{constructor(e,t,i,n,s){this.injector=e,this.I18n=t,this.wpTableFilters=i,this.wpFiltersService=n,this.bannerService=s,this.filters=[],this.eeShowBanners=!1,this.text={columnsLabel:this.I18n.t("js.label_columns"),selectedColumns:this.I18n.t("js.description_selected_columns"),multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect"),upsaleRelationColumns:this.I18n.t("js.modals.upsale_relation_columns"),upsaleRelationColumnsLink:this.I18n.t("js.modals.upsale_relation_columns_link")}}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners,this.wpTableFilters.onReady().then(()=>this.filters=this.wpTableFilters.current),this.wpTableFilters.changes$().subscribe(e=>{this.filters=this.wpTableFilters.current})}onSave(){this.filters&&this.wpTableFilters.replaceIfComplete(this.filters)}}u.\u0275fac=function(e){return new(e||u)(c.bc(c.A),c.bc(n.a),c.bc(r.a),c.bc(s.a),c.bc(a.a))},u.\u0275cmp=c.Vb({type:u,selectors:[["wp-table-config-filters-tab"]],decls:1,vars:1,consts:[[3,"filters","filtersChanged",4,"ngIf"],[3,"filters","filtersChanged"]],template:function(e,t){1&e&&c.Tc(0,d,1,1,"query-filters",0),2&e&&c.wc("ngIf",!!t.filters)},directives:[o.q,l.a],encapsulation:2})},cI0L:function(e,t,i){"use strict";i.d(t,"b",(function(){return v})),i.d(t,"a",(function(){return y}));var n=i("FnNU"),s=i("CNq7"),r=i("IzEk"),a=i("fXoL");class c{constructor(e){this.apiV3Service=e,this.helpTexts=Object(n.g)()}require(e,t){return this.load(),new Promise((i,n)=>{this.helpTexts.valuesPromise().then(()=>i(this.find(e,t)))})}requireById(e){return this.load(),this.helpTexts.values$().pipe(Object(r.a)(1)).toPromise().then(()=>{const t=this.helpTexts.getValueOr([]);return _.find(t,t=>t.id.toString()===e)})}load(){this.helpTexts.putFromPromiseIfPristine(()=>this.apiV3Service.help_texts.get().toPromise().then(e=>e.elements))}find(e,t){const i=this.helpTexts.getValueOr([]);return _.find(i,i=>i.scope===t&&i.attribute===e)}}c.\u0275fac=function(e){return new(e||c)(a.lc(s.a))},c.\u0275prov=a.Xb({token:c,factory:c.\u0275fac,providedIn:"root"});var o=i("wZYP"),l=i("IaZ+"),d=i("SqdZ"),u=i("kor4"),h=i("jEcX"),p=i("ofXK"),g=i("N5AO");function f(e,t){if(1&e&&(a.hc(0,"a",11),a.cc(1,"op-icon",12),a.cc(2,"span",13),a.gc()),2&e){const e=a.rc();a.Qb("href",e.helpTextLink,a.Oc)("title",e.text.edit),a.Pb(2),a.wc("textContent",e.text.edit)}}class b extends d.a{constructor(e,t,i,n){super(e,i,n),this.locals=e,this.I18n=t,this.cdRef=i,this.elementRef=n,this.closeOnEscape=!0,this.closeOnOutsideClick=!1,this.text={edit:this.I18n.t("js.button_edit"),close:this.I18n.t("js.button_close")},this.helpText=this.locals.helpText}ngOnInit(){super.ngOnInit(),this.helpText.attachments.$load().then(()=>this.cdRef.detectChanges())}get helpTextLink(){return this.helpText.editText?this.helpText.editText.$link.href:""}}b.\u0275fac=function(e){return new(e||b)(a.bc(l.a),a.bc(o.a),a.bc(a.i),a.bc(a.q))},b.\u0275cmp=a.Vb({type:b,selectors:[["ng-component"]],features:[a.Mb],decls:12,vars:5,consts:[["data-indicator-name","modal",1,"op-modal--portal","loading-indicator--location"],["tabindex","0",1,"op-modal--modal-container","attribute-help-text--modal"],[1,"op-modal--modal-header"],[1,"icon-context","icon-help1"],[1,"ellipsis",3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"accessibleClick"],["tabindex","0",1,"op-modal--modal-body","-formattable","op-uc-container","op-uc-container__no-permalinks",3,"innerHtml"],["data-allow-uploading","false",3,"resource"],[1,"modal--form-actions"],["class","help-text--edit-button button",4,"ngIf"],[1,"help-text--edit-button","button"],["icon-classes","button--icon icon-edit"],[1,"button--text",3,"textContent"]],template:function(e,t){1&e&&(a.hc(0,"div",0),a.hc(1,"div",1),a.hc(2,"div",2),a.hc(3,"h3"),a.cc(4,"span",3),a.cc(5,"span",4),a.gc(),a.hc(6,"a",5),a.hc(7,"i",6),a.pc("accessibleClick",(function(e){return t.closeMe(e)})),a.gc(),a.gc(),a.gc(),a.cc(8,"div",7),a.cc(9,"attachments",8),a.hc(10,"div",9),a.Tc(11,f,3,3,"a",10),a.gc(),a.gc(),a.gc()),2&e&&(a.Pb(5),a.wc("textContent",t.helpText.attributeCaption),a.Pb(2),a.Qb("title",t.text.close),a.Pb(1),a.wc("innerHtml",t.helpText.helpText.html,a.Mc),a.Pb(1),a.wc("resource",t.helpText),a.Pb(2),a.wc("ngIf",t.helpText.editText))},directives:[u.a,h.a,p.q,g.a],encapsulation:2,changeDetection:0});var m=i("/Rze");function w(e,t){if(1&e){const e=a.ic();a.hc(0,"accessible-by-keyboard",1),a.pc("execute",(function(){a.Lc(e);return a.rc().handleClick()})),a.cc(1,"op-icon",2),a.Vc(2),a.gc()}if(2&e){const e=a.rc();a.yc("linkClass","icon help-text--entry help-text--for-",e.attribute,""),a.wc("linkAriaLabel",e.text.open_dialog),a.Pb(2),a.Xc(" ",e.additionalLabel,"\n")}}const v="attribute-help-text";class y{constructor(e,t,i,n,s,r){this.elementRef=e,this.attributeHelpTexts=t,this.opModalService=i,this.cdRef=n,this.injector=s,this.I18n=r,this.exists=!1,this.text={open_dialog:this.I18n.t("js.help_texts.show_modal"),edit:this.I18n.t("js.button_edit"),close:this.I18n.t("js.button_close")}}ngOnInit(){const e=this.elementRef.nativeElement;this.helpTextId=this.helpTextId||e.dataset.helpTextId,this.attribute=this.attribute||e.dataset.attribute,this.attributeScope=this.attributeScope||e.dataset.attributeScope,this.additionalLabel=this.additionalLabel||e.dataset.additionalLabel,this.helpTextId?this.exists=!0:this.load().then(e=>(this.exists=!!e,this.cdRef.detectChanges(),e))}handleClick(){this.load().then(e=>{this.opModalService.show(b,this.injector,{helpText:e})})}load(){return this.helpTextId?this.attributeHelpTexts.requireById(this.helpTextId):this.attributeHelpTexts.require(this.attribute,this.attributeScope)}}y.\u0275fac=function(e){return new(e||y)(a.bc(a.q),a.bc(c),a.bc(l.b),a.bc(a.i),a.bc(a.A),a.bc(o.a))},y.\u0275cmp=a.Vb({type:y,selectors:[["attribute-help-text"]],inputs:{attribute:"attribute",additionalLabel:"additionalLabel",attributeScope:"attributeScope",helpTextId:"helpTextId"},decls:1,vars:1,consts:[[3,"linkAriaLabel","linkClass","execute",4,"ngIf"],[3,"linkAriaLabel","linkClass","execute"],["icon-classes","icon icon-help1"]],template:function(e,t){1&e&&a.Tc(0,w,3,3,"accessible-by-keyboard",0),2&e&&a.wc("ngIf",t.exists)},directives:[p.q,m.a,g.a],encapsulation:2,changeDetection:0})},cJ7v:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("wZYP"),s=i("d/TE"),r=i("fXoL"),a=i("ofXK"),c=i("N5AO"),o=i("lmKF"),l=i("/Rze");function d(e,t){if(1&e){const e=r.ic();r.hc(0,"a",7),r.pc("click",(function(t){r.Lc(e);return r.rc().executeTarget(t)})),r.gc()}if(2&e){const e=r.rc();r.wc("textContent",e.notification.link.text)}}function u(e,t){if(1&e){const e=r.ic();r.hc(0,"div"),r.hc(1,"a",11),r.pc("click",(function(){r.Lc(e);return r.rc(2).show=!0})),r.cc(2,"op-icon",12),r.gc(),r.hc(3,"a",11),r.pc("click",(function(){r.Lc(e);return r.rc(2).show=!1})),r.cc(4,"op-icon",13),r.gc(),r.cc(5,"span",2),r.gc()}if(2&e){const e=r.rc(2);r.Pb(1),r.wc("hidden",e.show),r.Pb(2),r.wc("hidden",!e.show),r.Pb(2),r.wc("textContent",e.uploadText)}}function h(e,t){if(1&e){const e=r.ic();r.hc(0,"notifications-upload-progress",16),r.pc("onSuccess",(function(){r.Lc(e);return r.rc(3).onUploadSuccess()}))("onError",(function(t){r.Lc(e);return r.rc(3).onUploadError(t)})),r.gc()}if(2&e){const e=t.$implicit;r.wc("upload",e)}}function p(e,t){if(1&e&&(r.hc(0,"ul",14),r.Tc(1,h,1,1,"notifications-upload-progress",15),r.gc()),2&e){const e=r.rc(2);r.Pb(1),r.wc("ngForOf",e.data)}}const g=function(e){return{"-hidden":e}};function f(e,t){if(1&e&&(r.hc(0,"div"),r.Tc(1,u,6,3,"div",8),r.hc(2,"div",9),r.Tc(3,p,2,1,"ul",10),r.gc(),r.gc()),2&e){const e=r.rc();r.Pb(1),r.wc("ngIf",e.canBeHidden()),r.Pb(1),r.wc("ngClass",r.Bc(3,g,!e.show&&e.canBeHidden())),r.Pb(1),r.wc("ngIf",e.data&&e.data.length>0)}}function b(e,t){1&e&&r.cc(0,"div")}function m(e,t){if(1&e&&r.cc(0,"li",2),2&e){const e=t.$implicit;r.wc("textContent",e)}}function w(e,t){if(1&e&&(r.hc(0,"div"),r.hc(1,"ul",17),r.Tc(2,m,1,1,"li",18),r.gc(),r.gc()),2&e){const e=r.rc();r.Pb(2),r.wc("ngForOf",e.data)}}function v(e,t){if(1&e){const e=r.ic();r.hc(0,"accessible-by-keyboard",19),r.pc("execute",(function(){r.Lc(e);return r.rc().remove()})),r.gc()}if(2&e){const e=r.rc();r.wc("linkTitle",e.text.close_popup)}}class y{constructor(e,t){this.I18n=e,this.notificationsService=t,this.text={close_popup:this.I18n.t("js.close_popup_title")},this.uploadCount=0,this.show=!1}ngOnInit(){this.type=this.notification.type}get data(){return this.notification.data}canBeHidden(){return this.data&&this.data.length>5}removable(){return"upload"!==this.notification.type}remove(){this.notificationsService.remove(this.notification)}executeTarget(){this.notification.link&&(this.notification.link.target(),this.remove())}onUploadError(e){this.remove()}onUploadSuccess(){this.uploadCount+=1}get uploadText(){return this.I18n.t("js.label_upload_counter",{done:this.uploadCount,count:this.data.length})}}y.\u0275fac=function(e){return new(e||y)(r.bc(n.a),r.bc(s.a))},y.\u0275cmp=r.Vb({type:y,selectors:[["notification"]],inputs:{notification:"notification"},decls:11,vars:11,consts:[["tabindex","0"],["role","alert","aria-atomic","true",1,"notification-box--content"],[3,"textContent"],["class","notification-box--target-link",3,"textContent","click",4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["linkClass","notification-box--close icon-context icon-close",3,"linkTitle","execute",4,"ngIf"],[1,"notification-box--target-link",3,"textContent","click"],[4,"ngIf"],[3,"ngClass"],["class","notification-box--uploads",4,"ngIf"],[3,"hidden","click"],["icon-classes","icon-arrow-right2"],["icon-classes","icon-arrow-down1"],[1,"notification-box--uploads"],[3,"upload","onSuccess","onError",4,"ngFor","ngForOf"],[3,"upload","onSuccess","onError"],[1,"notification-box--errors"],[3,"textContent",4,"ngFor","ngForOf"],["linkClass","notification-box--close icon-context icon-close",3,"linkTitle","execute"]],template:function(e,t){1&e&&(r.hc(0,"div",0),r.hc(1,"div",1),r.hc(2,"p"),r.cc(3,"span",2),r.cc(4,"span",2),r.Tc(5,d,1,1,"a",3),r.gc(),r.hc(6,"div",4),r.Tc(7,f,4,5,"div",5),r.Tc(8,b,1,0,"div",5),r.Tc(9,w,3,1,"div",5),r.gc(),r.gc(),r.Tc(10,v,1,1,"accessible-by-keyboard",6),r.gc()),2&e&&(r.Rb("notification-box -",t.type,""),r.Pb(3),r.wc("textContent",t.notification.message),r.Pb(1),r.wc("textContent"," "),r.Pb(1),r.wc("ngIf",t.notification.link),r.Pb(1),r.wc("ngSwitch",t.type),r.Pb(1),r.wc("ngSwitchCase","upload"),r.Pb(1),r.wc("ngSwitchCase","success"),r.Pb(1),r.wc("ngSwitchCase","error"),r.Pb(1),r.wc("ngIf",t.removable()))},directives:[a.q,a.u,a.v,a.n,c.a,a.p,o.a,l.a],encapsulation:2,changeDetection:0})},cK71:function(e,t,i){e.exports=global.I18n=i("eFC/")},"cd/7":function(e,t,i){"use strict";i.d(t,"c",(function(){return n})),i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return r}));const n="__ui-state-link",s="-checked";class r{constructor(e,t){this.$state=e,this.keepTab=t}linkToDetails(e,t,i){return this.build(e,"currentDetailsState",t,i)}linkToShow(e,t,i){return this.build(e,"currentShowState",t,i)}build(e,t,i,s){let r=document.createElement("a");return r.href=this.$state.href(this.keepTab[t],{workPackageId:e}),r.classList.add(n),r.dataset.workPackageId=e,r.dataset.wpState=t,r.setAttribute("title",i),r.textContent=s,r}}},crnd:function(e,t){function i(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id="crnd"},"d/TE":function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("8zkO"),s=i("FnNU"),r=i("fXoL");class a{constructor(e){this.configurationService=e,this.stack=Object(s.g)([]),jQuery(window).on("op:notifications:add",(e,t)=>{this.add(t)})}get current(){return this.stack}add(e,t=5e3){return jQuery(".flash.notice").remove(),this.stack.doModify(t=>{let i=[e].concat(t);return _.remove(i,(e,t)=>t>0&&("success"===e.type||"error"===e.type)),i}),"success"===e.type&&this.configurationService.autoHidePopups()&&setTimeout(()=>this.remove(e),t),e}addError(e,t=[]){Array.isArray(t)||(t=[t]);let i=this.createNotification(e,"error");return i.data=t,this.add(i)}addWarning(e){return this.add(this.createNotification(e,"warning"))}addSuccess(e){return this.add(this.createNotification(e,"success"))}addNotice(e){return this.add(this.createNotification(e,"info"))}addAttachmentUpload(e,t){return this.add(this.createAttachmentUploadNotification(e,t))}remove(e){this.stack.doModify(t=>(_.remove(t,t=>t===e),t))}clear(){this.stack.putValue([])}createNotification(e,t){return"string"==typeof e?{message:e,type:t}:(e.type=t,e)}createAttachmentUploadNotification(e,t){if(!t.length)throw new Error("Cannot create an upload notification without uploads!");let i=this.createNotification(e,"upload");return i.data=t,i}}a.\u0275fac=function(e){return new(e||a)(r.lc(n.a))},a.\u0275prov=r.Xb({token:a,factory:a.\u0275fac,providedIn:"root"})},d4d5:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{get id(){return this.$source.id||this.idFromLink}set id(e){this.$source.id=e}}},dMmB:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));i("FnNU");var n=i("iMRi"),s=i("Mo6U"),r=i("kTsZ"),a=i("vZpQ"),c=i("7bpi"),o=i("HKNX"),l=i("IzEk"),d=i("fXoL");class u extends o.a{constructor(e,t){super(e.schemas),this.states=e,this.halResourceService=t}state(e){return super.state(this.stateKey(e))}of(e){let t=this.state(e).value;if(!t)throw`Schema for resource ${e} was expected to be loaded but isn't.`;return"WorkPackage"===e._type?c.a.create(t,e):a.a.create(t,e)}getSchemaHref(e){var t;let i=null===(t=e.$links.schema)||void 0===t?void 0:t.href;if(!i)throw new Error(`Resource ${e} has no schema to load.`);return i}ensureLoaded(e){let t=e instanceof s.a?this.getSchemaHref(e):e;return this.requireAndStream(t).pipe(Object(l.a)(1)).toPromise()}requireAndStream(e,t=!1){return(this.stale(e)||t)&&this.clearAndLoad(e,this.load(e)),this.state(e).values$()}load(e){return this.halResourceService.get(e).pipe(Object(l.a)(1))}loadAll(e){return Promise.all(e.map(e=>this.load(e)))}update(e,t){this.multiState.get(this.stateKey(e)).putValue(t)}stateKey(e){return e instanceof s.a?this.getSchemaHref(e):e}}u.\u0275fac=function(e){return new(e||u)(d.lc(n.a),d.lc(r.a))},u.\u0275prov=d.Xb({token:u,factory:u.\u0275fac})},"dfy/":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("fXoL"),s=i("jhN1");class r{constructor(e){this.titleService=e}get current(){return this.titleService.getTitle()}get titleParts(){return this.current.split(" | ")}setFirstPart(e){let t=this.titleParts;t[0]=e,this.titleService.setTitle(t.join(" | "))}}r.\u0275fac=function(e){return new(e||r)(n.lc(s.e))},r.\u0275prov=n.Xb({token:r,factory:r.\u0275fac,providedIn:"root"})},e6KS:function(e,t,i){"use strict";i.d(t,"c",(function(){return d})),i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return h}));var n=i("mrSG"),s=i("XZsv"),r=i("iMRi"),a=i("SKFm"),c=i("/C7M"),o=i("POAS"),l=i("r0MM");const d="inline-edit--active-field",u="inline-edit--field";class h{constructor(e){this.injector=e,this.activeFields={},this.errorsPerAttribute={},this.editMode=!1}onSaved(e){}hasActiveFields(){return!_.isEmpty(this.activeFields)}get change(){return this.halEditing.changeFor(this.resource)}activate(e,t=!1){return this.loadFieldSchema(e,t).then(i=>i.writable||t?this.renderField(e,i):(this.halNotification.showEditingBlockedError(i.name||e),Promise.reject()))}activateWhenNeeded(e){return this.activeFields[e]?Promise.resolve():this.requireVisible(e).then(()=>this.activate(e,!0))}activateMissingFields(){this.change.getForm().then(e=>{_.each(e.validationErrors,(e,t)=>{"id"!==t&&this.activateWhenNeeded(t)})})}submit(){return Object(n.b)(this,void 0,void 0,(function*(){if(this.change.isEmpty()&&!this.resource.isNew)return this.closeEditFields(),Promise.resolve(this.resource);this.change.inFlight=!0,this.errorsPerAttribute={};const e=_.keys(this.activeFields);return yield Promise.all(_.map(this.activeFields,e=>e.onSubmit())),new Promise((t,i)=>{this.halEditing.save(this.change).then(i=>{this.closeEditFields(e),t(i.resource),this.halNotification.showSave(i.resource,i.wasNew),this.editMode=!1,this.onSaved(i),this.change.inFlight=!1}).catch(e=>(this.halNotification.handleRawError(e,this.resource),e instanceof s.a&&(this.handleSubmissionErrors(e),i()),this.change.inFlight=!1,Promise.reject(e)))})}))}closeEditFields(e="all",t=!0){"all"===e&&(e=_.keys(this.activeFields)),e.forEach(e=>{const i=this.activeFields[e];i&&i.deactivate(!1),t&&this.change.reset(e)})}handleSubmissionErrors(e){this.handleErroneousAttributes(e)}handleErroneousAttributes(e){const t=e.getInvolvedAttributes();if(this.errorsPerAttribute=e.getMessagesPerAttribute(),0!==t.length)return this.setErrorsForFields(t)}setErrorsForFields(e){let t=e.map(e=>this.requireVisible(e).then(()=>(this.activeFields[e]&&this.activeFields[e].setErrors(this.errorsPerAttribute[e]||[]),this.activateWhenNeeded(e))));Promise.all(t).then(()=>{setTimeout(()=>this.focusOnFirstError())}).catch(()=>{console.error("Failed to activate all erroneous fields.")})}loadFieldSchema(e,t=!1){return new Promise((i,n)=>{this.loadFormAndCheck(e,t);const s=this.change.schema.ofProperty(e);if(!s)throw new Error;i(s)})}loadFormAndCheck(e,t=!1){this.change.getForm().then(()=>{const i=this.change.schema.ofProperty(e);i.writable||t||(this.halNotification.showEditingBlockedError(i.name||e),this.closeEditFields([e]))}).catch(t=>{console.error("Failed to build edit field: %o",t),this.halNotification.handleRawError(t,this.resource),this.closeEditFields([e])})}renderField(e,t){return this.activateField(this,t,e,this.errorsPerAttribute[e]||[]).then(t=>(this.activeFields[e]=t,t)).catch(e=>{console.error("Failed to render edit field:"+e),this.halNotification.handleRawError(e)})}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",r.a)],h.prototype,"states",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",a.a)],h.prototype,"halEditing",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",o.a)],h.prototype,"halNotification",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",c.a)],h.prototype,"halEvents",void 0)},"eFC/":function(e,t,i){var n,s;s=this,void 0===(n=(function(){return function(e){"use strict";var t=e&&e.I18n||{},i=Array.prototype.slice,n=function(e){return("0"+e.toString()).substr(-2)},s=function(e,t){return h("round",e,-t).toFixed(t)},r=function(e){var t=typeof e;return"function"===t||"object"===t},a=function(e){return"function"==typeof e},c=function(e){return null!=e},o=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},l=function(e){return"string"==typeof value||"[object String]"===Object.prototype.toString.call(e)},d=function(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)},u=function(e){return!0===e||!1===e},h=function(e,t,i){return void 0===i||0==+i?Math[e](t):(t=+t,i=+i,isNaN(t)||"number"!=typeof i||i%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-i:-i)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+i:i))))},p=function(e,t){return a(e)?e(t):e},g=function(e,t){var i,n;for(i in t)t.hasOwnProperty(i)&&(n=t[i],l(n)||d(n)||u(n)||o(n)?e[i]=n:(null==e[i]&&(e[i]={}),g(e[i],n)));return e},f={day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:[null,"January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:[null,"Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridian:["AM","PM"]},b={precision:3,separator:".",delimiter:",",strip_insignificant_zeros:!1},m={unit:"$",precision:2,format:"%u%n",sign_first:!0,delimiter:",",separator:"."},w={unit:"%",precision:3,format:"%n%u",separator:".",delimiter:""},v=[null,"kb","mb","gb","tb"],y={defaultLocale:"en",locale:"en",defaultSeparator:".",placeholder:/(?:\{\{|%\{)(.*?)(?:\}\}?)/gm,fallbacks:!1,translations:{},missingBehaviour:"message",missingTranslationPrefix:""};return t.reset=function(){var e;for(e in y)this[e]=y[e]},t.initializeOptions=function(){var e;for(e in y)c(this[e])||(this[e]=y[e])},t.initializeOptions(),t.locales={},t.locales.get=function(e){var i=this[e]||this[t.locale]||this.default;return a(i)&&(i=i(e)),!1===o(i)&&(i=[i]),i},t.locales.default=function(e){var i=[],n=[];return e&&i.push(e),!e&&t.locale&&i.push(t.locale),t.fallbacks&&t.defaultLocale&&i.push(t.defaultLocale),i.forEach((function(e){var i=e.split("-"),s=null,r=null;3===i.length?(s=[i[0],i[1]].join("-"),r=i[0]):2===i.length&&(s=i[0]),-1===n.indexOf(e)&&n.push(e),t.fallbacks&&[s,r].forEach((function(t){null!=t&&t!==e&&-1===n.indexOf(t)&&n.push(t)}))})),i.length||i.push("en"),n},t.pluralization={},t.pluralization.get=function(e){return this[e]||this[t.locale]||this.default},t.pluralization.default=function(e){switch(e){case 0:return["zero","other"];case 1:return["one"];default:return["other"]}},t.currentLocale=function(){return this.locale||this.defaultLocale},t.isSet=c,t.lookup=function(e,t){t=t||{};var i,n,s,r,a=this.locales.get(t.locale).slice();for(a[0],s=this.getFullScope(e,t);a.length;)if(i=a.shift(),n=s.split(this.defaultSeparator),r=this.translations[i]){for(;n.length&&null!=(r=r[n.shift()]););if(null!=r)return r}if(c(t.defaultValue))return p(t.defaultValue,e)},t.pluralizationLookupWithoutFallback=function(e,t,i){var n,s,a=this.pluralization.get(t)(e);if(r(i))for(;a.length;)if(n=a.shift(),c(i[n])){s=i[n];break}return s},t.pluralizationLookup=function(e,t,i){i=i||{};var n,s,a,o,l=this.locales.get(i.locale).slice();for(l[0],t=this.getFullScope(t,i);l.length;)if(n=l.shift(),s=t.split(this.defaultSeparator),a=this.translations[n]){for(;s.length&&(a=a[s.shift()],r(a));)0==s.length&&(o=this.pluralizationLookupWithoutFallback(e,n,a));if(null!=o&&null!=o)break}return null!=o&&null!=o||c(i.defaultValue)&&(o=r(i.defaultValue)?this.pluralizationLookupWithoutFallback(e,i.locale,i.defaultValue):i.defaultValue,a=i.defaultValue),{message:o,translations:a}},t.meridian=function(){var e=this.lookup("time"),t=this.lookup("date");return e&&e.am&&e.pm?[e.am,e.pm]:t&&t.meridian?t.meridian:f.meridian},t.prepareOptions=function(){for(var e,t=i.call(arguments),n={};t.length;)if("object"==typeof(e=t.shift()))for(var s in e)e.hasOwnProperty(s)&&(c(n[s])||(n[s]=e[s]));return n},t.createTranslationOptions=function(e,t){var i=[{scope:e}];return c(t.defaults)&&(i=i.concat(t.defaults)),c(t.defaultValue)&&i.push({message:t.defaultValue}),i},t.translate=function(e,t){t=t||{};var i,n=this.createTranslationOptions(e,t),s=this.prepareOptions(t);return delete s.defaultValue,n.some((function(t){if(c(t.scope)?i=this.lookup(t.scope,s):c(t.message)&&(i=p(t.message,e)),null!=i)return!0}),this)?("string"==typeof i?i=this.interpolate(i,t):r(i)&&c(t.count)&&(i=this.pluralize(t.count,e,t)),i):this.missingTranslation(e,t)},t.interpolate=function(e,t){t=t||{};var i,n,s,r,a=e.match(this.placeholder);if(!a)return e;for(;a.length;)n=(i=a.shift()).replace(this.placeholder,"$1"),r=c(t[n])?t[n].toString().replace(/\$/gm,"_#$#_"):n in t?this.nullPlaceholder(i,e,t):this.missingPlaceholder(i,e,t),s=new RegExp(i.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}")),e=e.replace(s,r);return e.replace(/_#\$#_/g,"$")},t.pluralize=function(e,t,i){var n,s;return i=this.prepareOptions({count:String(e)},i),null==(s=this.pluralizationLookup(e,t,i)).translations||null==s.translations?this.missingTranslation(t,i):null!=s.message&&null!=s.message?this.interpolate(s.message,i):(n=this.pluralization.get(i.locale),this.missingTranslation(t+"."+n(e)[0],i))},t.missingTranslation=function(e,t){if("guess"==this.missingBehaviour){var i=e.split(".").slice(-1)[0];return(this.missingTranslationPrefix.length>0?this.missingTranslationPrefix:"")+i.replace("_"," ").replace(/([a-z])([A-Z])/g,(function(e,t,i){return t+" "+i.toLowerCase()}))}return'[missing "'+[null!=t&&null!=t.locale?t.locale:this.currentLocale(),this.getFullScope(e,t)].join(this.defaultSeparator)+'" translation]'},t.missingPlaceholder=function(e,t,i){return"[missing "+e+" value]"},t.nullPlaceholder=function(){return t.missingPlaceholder.apply(t,arguments)},t.toNumber=function(e,t){t=this.prepareOptions(t,this.lookup("number.format"),b);var i,n,r=e<0,a=s(Math.abs(e),t.precision).toString().split("."),c=[],o=t.format||"%n",l=r?"-":"";for(e=a[0],i=a[1];e.length>0;)c.unshift(e.substr(Math.max(0,e.length-3),3)),e=e.substr(0,e.length-3);return n=c.join(t.delimiter),t.strip_insignificant_zeros&&i&&(i=i.replace(/0+$/,"")),t.precision>0&&i&&(n+=t.separator+i),n=(o=t.sign_first?"%s"+o:o.replace("%n","%s%n")).replace("%u",t.unit).replace("%n",n).replace("%s",l)},t.toCurrency=function(e,t){return t=this.prepareOptions(t,this.lookup("number.currency.format"),this.lookup("number.format"),m),this.toNumber(e,t)},t.localize=function(e,t,i){switch(i||(i={}),e){case"currency":return this.toCurrency(t);case"number":return e=this.lookup("number.format"),this.toNumber(t,e);case"percentage":return this.toPercentage(t);default:var n;return n=e.match(/^(date|time)/)?this.toTime(e,t):t.toString(),this.interpolate(n,i)}},t.parseDate=function(e){var t,i,n;if("object"==typeof e)return e;if(t=e.toString().match(/(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2}):(\d{2})([\.,]\d{1,3})?)?(Z|\+00:?00)?/)){for(var s=1;s<=6;s++)t[s]=parseInt(t[s],10)||0;t[2]-=1,n=t[7]?1e3*("0"+t[7]):null,i=t[8]?new Date(Date.UTC(t[1],t[2],t[3],t[4],t[5],t[6],n)):new Date(t[1],t[2],t[3],t[4],t[5],t[6],n)}else"number"==typeof e?(i=new Date).setTime(e):e.match(/([A-Z][a-z]{2}) ([A-Z][a-z]{2}) (\d+) (\d+:\d+:\d+) ([+-]\d+) (\d+)/)?(i=new Date).setTime(Date.parse([RegExp.$1,RegExp.$2,RegExp.$3,RegExp.$6,RegExp.$4,RegExp.$5].join(" "))):(e.match(/\d+ \d+:\d+:\d+ [+-]\d+ \d+/),(i=new Date).setTime(Date.parse(e)));return i},t.strftime=function(e,i){var s=this.lookup("date"),r=t.meridian();if(s||(s={}),s=this.prepareOptions(s,f),isNaN(e.getTime()))throw new Error("I18n.strftime() requires a valid date object, but received an invalid date.");var a=e.getDay(),c=e.getDate(),o=e.getFullYear(),l=e.getMonth()+1,d=e.getHours(),u=d,h=d>11?1:0,p=e.getSeconds(),g=e.getMinutes(),b=e.getTimezoneOffset(),m=Math.floor(Math.abs(b/60)),w=Math.abs(b)-60*m,v=(b>0?"-":"+")+(m.toString().length<2?"0"+m:m)+(w.toString().length<2?"0"+w:w);return u>12?u-=12:0===u&&(u=12),i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=i.replace("%a",s.abbr_day_names[a])).replace("%A",s.day_names[a])).replace("%b",s.abbr_month_names[l])).replace("%B",s.month_names[l])).replace("%d",n(c))).replace("%e",c)).replace("%-d",c)).replace("%H",n(d))).replace("%-H",d)).replace("%I",n(u))).replace("%-I",u)).replace("%m",n(l))).replace("%-m",l)).replace("%M",n(g))).replace("%-M",g)).replace("%p",r[h])).replace("%S",n(p))).replace("%-S",p)).replace("%w",a)).replace("%y",n(o))).replace("%-y",n(o).replace(/^0+/,""))).replace("%Y",o)).replace("%z",v)},t.toTime=function(e,t){var i=this.parseDate(t),n=this.lookup(e);return i.toString().match(/invalid/i)?i.toString():n?this.strftime(i,n):i.toString()},t.toPercentage=function(e,t){return t=this.prepareOptions(t,this.lookup("number.percentage.format"),this.lookup("number.format"),w),this.toNumber(e,t)},t.toHumanSize=function(e,t){for(var i,n,s=1024,r=e,a=0;r>=s&&a<4;)r/=s,a+=1;return 0===a?(i=this.t("number.human.storage_units.units.byte",{count:r}),n=0):(i=this.t("number.human.storage_units.units."+v[a]),n=r-Math.floor(r)==0?0:1),t=this.prepareOptions(t,{unit:i,precision:n,format:"%n%u",delimiter:""}),this.toNumber(r,t)},t.getFullScope=function(e,t){return t=t||{},o(e)&&(e=e.join(this.defaultSeparator)),t.scope&&(e=[t.scope,e].join(this.defaultSeparator)),e},t.extend=function(e,t){return void 0===e&&void 0===t?{}:g(e,t)},t.t=t.translate,t.l=t.localize,t.p=t.pluralize,t}(s)}).call(t,i,t,e))||(e.exports=n)},eJFM:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("fXoL"),s=i("2Qcm"),r=i("6yP5"),a=i("1G5W"),c=i("/uUt"),o=i("E2tj"),l=i("tmNb"),d=i("87fy"),u=i("DhiE"),h=(i("U1xf"),i("hvpr")),p=i("ofXK"),g=i("f24R");function f(e,t){if(1&e&&(n.hc(0,"div",2),n.cc(1,"wp-resizer",3),n.gc()),2&e){const e=n.rc();n.Pb(1),n.wc("elementClass",e.resizerClass)("localStorageKey",e.resizerStorageKey)}}class b{constructor(e,t,i,s,r){this.wpTableHighlight=e,this.wpTableSortBy=t,this.wpList=i,this.querySpace=s,this.cdRef=r,this.showResizer=!1,this.resizerClass="",this.resizerStorageKey="",this.selectionChanged=new n.s,this.itemClicked=new n.s,this.stateLinkClicked=new n.s,this.gridOrientation="horizontal",this.highlightingMode="none"}ngOnInit(){this.dragInto=this.configuration.dragAndDropEnabled,this.canDragOutOf=()=>this.configuration.dragAndDropEnabled,this.wpTableHighlight.updates$().pipe(Object(a.a)(this.querySpace.stopAllSubscriptions),Object(c.a)()).subscribe(()=>{this.highlightingMode=this.wpTableHighlight.current.mode,this.cdRef.detectChanges()})}switchToManualSorting(){let e=this.querySpace.query.value;e&&this.wpTableSortBy.switchToManualSorting(e)&&this.wpList.save(e)}}b.\u0275fac=function(e){return new(e||b)(n.bc(s.a),n.bc(r.a),n.bc(u.a),n.bc(o.a),n.bc(n.i))},b.\u0275cmp=n.Vb({type:b,selectors:[["wp-grid"]],inputs:{configuration:"configuration",showResizer:"showResizer",resizerClass:"resizerClass",resizerStorageKey:"resizerStorageKey"},outputs:{selectionChanged:"selectionChanged",itemClicked:"itemClicked",stateLinkClicked:"stateLinkClicked"},features:[n.Ob([l.a,d.a])],decls:2,vars:10,consts:[[3,"dragOutOfHandler","dragInto","cardsRemovable","highlightingMode","showStatusButton","orientation","showEmptyResultsBox","showInfoButton","shrinkOnMobile","onMoved","selectionChanged","itemClicked","stateLinkClicked"],["class","hidden-for-mobile hide-when-print",4,"ngIf"],[1,"hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"]],template:function(e,t){1&e&&(n.hc(0,"wp-card-view",0),n.pc("onMoved",(function(){return t.switchToManualSorting()}))("selectionChanged",(function(e){return t.selectionChanged.emit(e)}))("itemClicked",(function(e){return t.itemClicked.emit(e)}))("stateLinkClicked",(function(e){return t.stateLinkClicked.emit(e)})),n.gc(),n.Tc(1,f,2,2,"div",1)),2&e&&(n.wc("dragOutOfHandler",t.canDragOutOf)("dragInto",t.dragInto)("cardsRemovable",!1)("highlightingMode",t.highlightingMode)("showStatusButton",!0)("orientation",t.gridOrientation)("showEmptyResultsBox",!0)("showInfoButton",!0)("shrinkOnMobile",!0),n.Pb(1),n.wc("ngIf",t.showResizer))},directives:[h.a,p.q,g.a],encapsulation:2,changeDetection:0})},eaMR:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("F5Dh"),s=i("l08T"),r=i("Y41n"),a=i("AEvm"),c=i("Hg4z"),o=i("fXoL"),l=i("ofXK"),d=i("70hh");function u(e,t){if(1&e){const e=o.ic();o.hc(0,"button",3),o.pc("click",(function(){o.Lc(e);return o.rc().wpFiltersService.toggleVisibility()})),o.sc(1,"async"),o.cc(2,"i",4),o.cc(3,"span",5),o.gc()}if(2&e){const e=o.rc();o.Tb("-active",o.tc(1,3,e.visible$)),o.Pb(3),o.wc("textContent",e.filterButtonText)}}function h(e,t){if(1&e){const e=o.ic();o.hc(0,"query-filters",8),o.pc("filtersChanged",(function(t){o.Lc(e);return o.rc(2).replaceIfComplete(t)})),o.gc()}if(2&e){const e=o.rc(2);o.wc("filters",e.filters)("showCloseFilter",!0)}}function p(e,t){if(1&e&&(o.hc(0,"div",6),o.Tc(1,h,1,2,"query-filters",7),o.gc()),2&e){const e=o.rc();o.Pb(1),o.wc("ngIf",!!e.filters)}}const g=function(e){return{"-loaded":e}};class f extends a.a{constructor(e,t,i){super(),this.wpTableFilters=e,this.cdRef=t,this.wpFiltersService=i,this.showFilterButton=!1,this.filterButtonText=I18n.t("js.button_filter"),this.filtersChanged=new r.a(Object(c.b)(this)),this.filters=this.wpTableFilters.current,this.loaded=!1,this.visible$=this.wpFiltersService.observeUntil(Object(c.b)(this))}ngOnInit(){this.wpTableFilters.pristine$().pipe(this.untilDestroyed()).subscribe(()=>{this.filters=this.wpTableFilters.current,this.loaded=!0,this.cdRef.detectChanges()})}replaceIfComplete(e){let t=e.filter(e=>this.wpTableFilters.isAvailable(e));this.wpTableFilters.replaceIfComplete(t),this.filtersChanged.emit(t)}}f.\u0275fac=function(e){return new(e||f)(o.bc(n.a),o.bc(o.i),o.bc(s.a))},f.\u0275cmp=o.Vb({type:f,selectors:[["filter-container"]],inputs:{showFilterButton:"showFilterButton",filterButtonText:"filterButtonText"},outputs:{filtersChanged:"filtersChanged"},features:[o.Mb],decls:4,vars:7,consts:[["class","button -small advanced-filters--toggle",3,"-active","click",4,"ngIf"],[1,"work-packages--filters-optional-container",3,"ngClass"],["id","query_form_content","class","hide-when-print",4,"ngIf"],[1,"button","-small","advanced-filters--toggle",3,"click"],[1,"button--icon","icon-filter"],[1,"button--text",3,"textContent"],["id","query_form_content",1,"hide-when-print"],[3,"filters","showCloseFilter","filtersChanged",4,"ngIf"],[3,"filters","showCloseFilter","filtersChanged"]],template:function(e,t){1&e&&(o.Tc(0,u,4,5,"button",0),o.hc(1,"div",1),o.Tc(2,p,2,1,"div",2),o.sc(3,"async"),o.gc()),2&e&&(o.wc("ngIf",t.showFilterButton),o.Pb(1),o.wc("ngClass",o.Bc(5,g,t.loaded)),o.Pb(1),o.wc("ngIf",o.tc(3,3,t.visible$)))},directives:[l.q,l.n,d.a],pipes:[l.a],encapsulation:2,changeDetection:0})},ecJW:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("fXoL"),s=i("8zkO"),r=i("juWA"),a=i("PBJw"),c=i("Y41n"),o=i("AEvm"),l=i("Hg4z"),d=i("E5Dd"),u=i("ofXK"),h=i("oUDv");const p=["dateInput"];class g extends o.a{constructor(e,t,i){super(),this.elementRef=e,this.ConfigurationService=t,this.timezoneService=i,this.onChange=new c.a(Object(l.b)(this)),this.onCancel=new n.s,this.initialDate="",this.appendTo=document.body,this.classes="",this.id="",this.name="",this.required=!1,this.size=20,this.focus=!1,this.disabled=!1,this.id||(this.id="datepicker-input-"+Math.floor(1e3*Math.random()).toString(3))}ngAfterViewInit(){this.initializeDatepicker()}ngOnDestroy(){this.datePickerInstance&&this.datePickerInstance.destroy()}openOnClick(){this.disabled||this.datePickerInstance.show()}onInputChange(e){this.isEmpty()?this.datePickerInstance.clear():this.inputIsValidDate()&&this.onChange.emit(this.currentValue)}closeOnOutsideClick(e){e.relatedTarget&&this.datePickerInstance.datepickerInstance.calendarContainer.contains(e.relatedTarget)||this.datePickerInstance.hide()}isEmpty(){return""===this.currentValue.trim()}get currentValue(){var e;return(null===(e=this.inputElement)||void 0===e?void 0:e.value)||""}get inputElement(){return this.dateInput.nativeElement}inputIsValidDate(){return null!==this.currentValue.match(/\d{4}-\d{2}-\d{2}/)}initializeDatepicker(){let e,t={allowInput:!0,appendTo:this.appendTo,onChange:(e,t)=>{let i=t;this.isEmpty()||(this.inputElement.value=i,this.onChange.emit(i))},onKeyDown:(e,t,i,n)=>{n.which==d.a.ESCAPE&&this.onCancel.emit()}};e=this.isEmpty&&this.initialDate?this.timezoneService.parseISODate(this.initialDate).toDate():this.currentValue,this.datePickerInstance=new a.a("#"+this.id,e,t)}}g.\u0275fac=function(e){return new(e||g)(n.bc(n.q),n.bc(s.a),n.bc(r.a))},g.\u0275cmp=n.Vb({type:g,selectors:[["op-date-picker"]],viewQuery:function(e,t){var i;(1&e&&n.ad(p,!0),2&e)&&(n.Ic(i=n.qc())&&(t.dateInput=i.first))},inputs:{initialDate:"initialDate",appendTo:"appendTo",classes:"classes",id:"id",name:"name",required:"required",size:"size",focus:"focus",disabled:"disabled"},outputs:{onChange:"onChange",onCancel:"onCancel"},features:[n.Mb],decls:2,vars:8,consts:[["type","text",3,"id","name","value","ngClass","size","required","focus","disabled","click","blur","input"],["dateInput",""]],template:function(e,t){1&e&&(n.hc(0,"input",0,1),n.pc("click",(function(){return t.openOnClick()}))("blur",(function(e){return t.closeOnOutsideClick(e)}))("input",(function(e){return t.onInputChange(e)})),n.gc()),2&e&&n.wc("id",t.id)("name",t.name)("value",t.initialDate)("ngClass",t.classes)("size",t.size)("required",t.required)("focus",t.focus)("disabled",t.disabled)},directives:[u.n,h.a],encapsulation:2})},ev9f:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{get state(){return this.states.statuses.get(this.href)}}},eyhC:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("E2tj"),s=i("iMRi"),r=i("4lR/"),a=i("zqrF"),c=i("fXoL");class o extends a.b{constructor(e,t,i){super(e),this.querySpace=e,this.states=t,this.opContextMenu=i,this.reset()}ngOnDestroy(){Mousetrap.unbind(["command+d","ctrl+d"]),Mousetrap.unbind(["command+a","ctrl+a"])}initializeSelection(e){let t={selected:{},activeRowIndex:null};e.forEach(e=>t.selected[e]=!0),this.updatesState.clear(),this.pristineState.putValue(t)}isSelected(e){var t;return!!(null===(t=this.current)||void 0===t?void 0:t.selected[e])}selectAll(e){const t=this._emptyState;e.forEach(e=>{e.workPackageId&&(t.selected[e.workPackageId]=!0)}),this.update(t)}getSelectedWorkPackages(){let e=this.states.workPackages;return this.getSelectedWorkPackageIds().map(t=>e.get(t).value)}getSelectedWorkPackageIds(){var e;let t=[];return _.each(null===(e=this.current)||void 0===e?void 0:e.selected,(e,i)=>{e&&t.push(i)}),t}reset(){this.update(this._emptyState)}get isEmpty(){return 0===this.selectionCount}get selectionCount(){var e;return _.size(null===(e=this.current)||void 0===e?void 0:e.selected)}toggleRow(e){var t;let i=null===(t=this.current)||void 0===t?void 0:t.selected[e];this.setRowState(e,!i)}setRowState(e,t){let i=this.current||this._emptyState;i.selected[e]=t,this.update(i)}setSelection(e,t){const i=this._emptyState;i.selected[e]=!0,i.activeRowIndex=t,this.update(i)}setMultiSelectionFrom(e,t,i){let n=this.current||this._emptyState;if(0===this.selectionCount||null===n.activeRowIndex)n.selected[t]=!0,n.activeRowIndex=i;else{let t=Math.min(i,n.activeRowIndex),s=Math.max(i,n.activeRowIndex);e.forEach((e,i)=>{e.workPackageId&&(n.selected[e.workPackageId]=i>=t&&i<=s)})}this.update(n)}registerSelectAllListener(e){Mousetrap.bind(["command+a","ctrl+a"],t=>(this.selectAll(e()),t.preventDefault(),this.opContextMenu.close(),!1))}registerDeselectAllListener(){Mousetrap.bind(["command+d","ctrl+d"],e=>(this.reset(),e.preventDefault(),this.opContextMenu.close(),!1))}get _emptyState(){return{selected:{},activeRowIndex:null}}valueFromQuery(e,t){}}o.\u0275fac=function(e){return new(e||o)(c.lc(n.a),c.lc(s.a),c.lc(r.a))},o.\u0275prov=c.Xb({token:o,factory:o.\u0275fac})},f24R:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("/uUt"),s=i("Kj3r"),r=i("iB+3"),a=i("Sulb"),c=i("buwf"),o=i("AEvm"),l=i("xgIS"),d=i("fXoL"),u=i("v9+U");class h extends o.a{constructor(e,t,i,n){super(),this.toggleService=e,this.elementRef=t,this.$transitions=i,this.browserDetector=n,this.resizeStyle="flexBasis",this.elementMinWidth=530,this.moving=!1,this.resizerClass="work-packages--resizer icon-resizer-vertical-lines"}ngOnInit(){this.resizingElement=document.getElementsByClassName(this.elementClass)[0];let e=this.parseLocalStorageValue();this.elementWidth=e||(this.resizingElement.offsetWidth<this.elementMinWidth?this.elementMinWidth:this.resizingElement.offsetWidth),0===this.elementWidth&&this.resizingElement.parentElement&&(this.elementWidth=this.resizingElement.parentElement.offsetWidth/2),this.resizingElement.style[this.resizeStyle]=this.elementWidth+"px",this.element=this.elementRef.nativeElement,this.toggleService.changeData$.pipe(Object(n.a)(),this.untilDestroyed()).subscribe(e=>{this.toggleFullscreenColumns()}),Object(l.a)(window,"resize",{passive:!0}).pipe(this.untilDestroyed(),Object(s.a)(250)).subscribe(()=>this.toggleFullscreenColumns())}ngAfterViewInit(){this.resizer=this.elementRef.nativeElement.getElementsByClassName(this.resizerClass)[0],this.applyColumnLayout(this.resizingElement,this.elementWidth)}ngOnDestroy(){super.ngOnDestroy(),this.resizingElement.style[this.resizeStyle]=""}resizeStart(){let e=this.parseLocalStorageValue(),t=this.resizingElement.offsetWidth;e&&e>t&&(this.elementWidth=t)}resizeEnd(){let e=this.parseLocalStorageValue();e&&(this.elementWidth=e);const t=new Event(this.resizeEvent);window.dispatchEvent(t),this.manageErrorClass(!1)}resizeMove(e){let t;this.elementWidth=this.elementWidth-e.relative.x,this.elementWidth<this.elementMinWidth?(t=this.elementMinWidth,this.manageErrorClass(!0)):(t=this.elementWidth,this.manageErrorClass(!1)),window.OpenProject.guardedLocalStorage(this.localStorageKey,""+t),this.applyColumnLayout(this.resizingElement,t),this.resizingElement.style[this.resizeStyle]=t+"px"}parseLocalStorageValue(){let e=window.OpenProject.guardedLocalStorage(this.localStorageKey),t=parseInt(e||"",10);if("number"==typeof t&&NaN!==t)return t}applyColumnLayout(e,t){e===jQuery(".work-packages-full-view--split-right")[0]?this.toggleFullscreenColumns():this.toggleColumns(e,700)}toggleColumns(e,t=750){e&&!this.browserDetector.isEdge&&jQuery(e).toggleClass("-can-have-columns",e.offsetWidth>t)}toggleFullscreenColumns(){let e=jQuery(".work-packages-full-view--split-left")[0];this.toggleColumns(e)}manageErrorClass(e){e&&!this.resizer.classList.contains("-error-font")&&this.resizer.classList.add("-error-font"),!e&&this.resizer.classList.contains("-error-font")&&this.resizer.classList.remove("-error-font")}}h.\u0275fac=function(e){return new(e||h)(d.bc(a.a),d.bc(d.q),d.bc(r.TransitionService),d.bc(c.a))},h.\u0275cmp=d.Vb({type:h,selectors:[["wp-resizer"]],inputs:{elementClass:"elementClass",resizeEvent:"resizeEvent",localStorageKey:"localStorageKey",resizeStyle:"resizeStyle"},features:[d.Mb],decls:1,vars:2,consts:[["cursorClass","col-resize",3,"customHandler","resizerClass","end","start","move"]],template:function(e,t){1&e&&(d.hc(0,"resizer",0),d.pc("end",(function(){return t.resizeEnd()}))("start",(function(){return t.resizeStart()}))("move",(function(e){return t.resizeMove(e)})),d.gc()),2&e&&d.wc("customHandler",!1)("resizerClass",t.resizerClass)},directives:[u.a],encapsulation:2,changeDetection:0})},f9kS:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("VgZ9"),s=i("FDFi"),r=i("i95X"),a=i("dMmB"),c=i("fXoL");class o extends s.a{constructor(e,t,i){super(e),this.injector=e,this.wpRelationsHierarchyService=t,this.schemaCache=i,this.referenceComponentClass=r.a,this.relationType="children",this.referenceTarget=null,this.buttonTexts={reference:this.I18n.t("js.relation_buttons.add_existing_child"),create:this.I18n.t("js.relation_buttons.add_new_child")}}add(e,t){return this.wpRelationsHierarchyService.addExistingChildWp(e,t)}remove(e,t){return this.wpRelationsHierarchyService.removeChild(t)}get canAdd(){return!!(this.referenceTarget&&this.canCreateWorkPackages&&this.canAddChild)}get canReference(){return!(!this.referenceTarget||!this.canAddChild)}get canAddChild(){return this.schema&&!this.schema.isMilestone&&this.referenceTarget.changeParent}get schema(){return this.referenceTarget&&this.schemaCache.of(this.referenceTarget)}}o.\u0275fac=function(e){return new(e||o)(c.lc(c.A),c.lc(n.a),c.lc(a.a))},o.\u0275prov=c.Xb({token:o,factory:o.\u0275fac})},fFIw:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("tk/3"),s=i("Cfvw"),r=i("LRne"),a=i("eIep"),c=i("w1tV"),o=i("ZsX/"),l=i("fXoL");class d extends o.a{uploadSingle(e,t,i="post",n="text"){return[t,Object(s.a)(this.getDirectUploadFormFrom(e,t)).pipe(Object(a.a)(this.uploadToExternal(t,i,n)),Object(c.a)())]}uploadToExternal(e,t,i){return n=>(n.form.append("file",e,e.customName||e.name),this.http.request(t,n.url,{body:n.form,observe:"events",withCredentials:!1,responseType:i,reportProgress:!0}).pipe(Object(a.a)(this.finishUpload(n))))}finishUpload(e){return t=>t instanceof n.g?this.http.get(e.response._links.completeUpload.href,{observe:"response"}):Object(r.a)(t)}getDirectUploadFormFrom(e,t){const i=new FormData,n={description:t.description,fileName:t.customName||t.name,fileSize:t.size,contentType:t.type};i.append("metadata",JSON.stringify(n));return this.http.request("post",e,{body:i,withCredentials:!0,responseType:"json"}).toPromise().then(e=>{let t=new FormData;return _.each(e._links.addAttachment.form_fields,(e,i)=>{t.append(i,e)}),{url:e._links.addAttachment.href,form:t,response:e}})}}d.\u0275fac=function(e){return u(e||d)},d.\u0275prov=l.Xb({token:d,factory:d.\u0275fac});const u=l.jc(d)},fMMW:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("mrSG"),s=i("Mo6U"),r=i("vK8y"),a=i("kTsZ"),c=i("4EDS"),o=i("+NA0"),l=i("r0MM"),d=c.a.compareByHrefOrString;class u{constructor(e,t,i=[]){this.injector=e,this.filters=t,this.excluded=i,this.handlers={"=":this.applyFirstValue.bind(this),"!*":this.setToNull.bind(this)}}applyDefaultsFromFilters(e){_.each(this.filters,t=>{if(-1!==this.excluded.indexOf(t.id))return;const i=t.operator.id,n=this.handlers[i];null==n||n.call(this,e,t)})}applyFirstValue(e,t){if(this.filterAlreadyApplied(e,t))return;let i=t.values[0];if(i){let n=this.mapFilterToAttribute(t);this.setValueFor(e,n,i)}}setToNull(e,t){let i=this.mapFilterToAttribute(t);this.setValue(e,i,{href:null})}setValueFor(e,t,i){let n=this.findSpecialValue(i,t)||i;n&&this.setValue(e,t,n)}setValue(e,t,i){e instanceof o.a?e.setValue(t,i):e[t]=i}findSpecialValue(e,t){return"parent"===t?e:e instanceof s.a&&"/api/v3/users/me"===e.$href&&this.currentUser.isLoggedIn?this.halResourceService.fromSelfLink("/api/v3/users/"+this.currentUser.userId):void 0}filterAlreadyApplied(e,t){if(t.values.length<=1)return!1;const i=e instanceof o.a?e.projectedResource[t.id]:e[t.id];for(let n=0;n<t.values.length;n++)if(d(i,t.values[n]))return!0;return!1}mapFilterToAttribute(e){return"onlySubproject"===e.id?"project":e.id}}Object(n.c)([Object(l.a)(),Object(n.e)("design:type",r.a)],u.prototype,"currentUser",void 0),Object(n.c)([Object(l.a)(),Object(n.e)("design:type",a.a)],u.prototype,"halResourceService",void 0)},fbLK:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("ofXK"),s=i("fXoL");class r{constructor(e){this.documentElement=e,this._banners=!0,this._banners=e.body.classList.contains("ee-banners-visible")}get eeShowBanners(){return this._banners}conditional(e,t){this._banners?this.callMaybe(e):this.callMaybe(t)}callMaybe(e){e&&e()}}r.\u0275fac=function(e){return new(e||r)(s.lc(n.d))},r.\u0275prov=s.Xb({token:r,factory:r.\u0275fac,providedIn:"root"})},fdeW:function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var n=i("IzEk"),s=i("x5It"),r=i("tmNb"),a=i("Va5K"),c=i("POAS"),o=i("qc15"),l=i("wZYP"),d=i("E2tj"),u=i("K247"),h=i("sjKJ"),p=i("F5Dh"),g=i("AEvm"),f=i("iB+3"),b=i("PkGb"),m=i("fXoL"),w=i("ofXK"),v=i("V0Il"),y=i("eJFM"),k=i("lmDM");function C(e,t){1&e&&m.cc(0,"div",4)}function j(e,t){if(1&e){const e=m.ic();m.hc(0,"wp-table",5),m.pc("itemClicked",(function(t){m.Lc(e);return m.rc().handleWorkPackageClicked(t)}))("stateLinkClicked",(function(t){m.Lc(e);return m.rc().openStateLink(t)})),m.gc()}if(2&e){const e=m.rc();m.wc("projectIdentifier",e.CurrentProject.identifier)("configuration",e.wpTableConfiguration)}}const P=function(e){return{"-with-resizer":e}};function x(e,t){if(1&e){const e=m.ic();m.hc(0,"div",6),m.hc(1,"wp-grid",7),m.pc("itemClicked",(function(t){m.Lc(e);return m.rc().handleWorkPackageCardClicked(t)}))("stateLinkClicked",(function(t){m.Lc(e);return m.rc().openStateLink(t)})),m.gc(),m.gc()}if(2&e){const e=m.rc();m.wc("ngClass",m.Bc(3,P,e.showResizerInCardView())),m.Pb(1),m.wc("configuration",e.wpTableConfiguration)("showResizer",e.showResizerInCardView())}}function S(e,t){1&e&&(m.hc(0,"div",8),m.cc(1,"wp-table-pagination"),m.gc())}class _ extends g.a{constructor(e,t,i,n,s,r,a,c,o,l,d,u){super(),this.I18n=e,this.injector=t,this.$state=i,this.keepTab=n,this.querySpace=s,this.wpViewFilters=r,this.deviceService=a,this.CurrentProject=c,this.wpDisplayRepresentation=o,this.cdRef=l,this.elementRef=d,this.ngZone=u,this.text={jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.pagination"),text_jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.label_pagination"),button_settings:this.I18n.t("js.button_settings")},this.showTableView=!0,this.tableInformationLoaded=!1,this.noResults=!1,this.showResultOverlay$=this.wpViewFilters.incomplete$,this.wpTableConfiguration={dragAndDropEnabled:!0}}ngOnInit(){this.setupInformationLoadedListener(),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.updateViewRepresentation(e),this.noResults=0===e.results.total,this.cdRef.detectChanges()}),this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{const e=this.elementRef.nativeElement.querySelector(".wp-table--row.-checked"),t=this.elementRef.nativeElement.querySelector(".wp-card.-checked");e&&e.previousSibling&&e.previousSibling.scrollIntoView({block:"start"}),t&&t.scrollIntoView({block:"start"})},0)})}setupInformationLoadedListener(){this.querySpace.initialized.values$().pipe(Object(n.a)(1)).subscribe(()=>{this.tableInformationLoaded=!0,this.cdRef.detectChanges()})}showResizerInCardView(){return!1}updateViewRepresentation(e){this.showTableView=!(this.deviceService.isMobile||this.wpDisplayRepresentation.valueFromQuery(e)===a.b)}handleWorkPackageClicked(e){e.double&&this.openInFullView(e.workPackageId)}openStateLink(e){this.$state.go(this.keepTab[e.requestedState]||e.requestedState,{workPackageId:e.workPackageId,focus:!0})}handleWorkPackageCardClicked(e){this.deviceService.isMobile?this.openInFullView(e.workPackageId):this.handleWorkPackageClicked(e)}openInFullView(e){this.$state.go("work-packages.show",{workPackageId:e})}}_.\u0275fac=function(e){return new(e||_)(m.bc(l.a),m.bc(m.A),m.bc(f.StateService),m.bc(b.a),m.bc(d.a),m.bc(p.a),m.bc(u.a),m.bc(h.a),m.bc(a.a),m.bc(m.i),m.bc(m.q),m.bc(m.K))},_.\u0275cmp=m.Vb({type:_,selectors:[["wp-list-view"]],hostAttrs:[1,"work-packages-split-view--tabletimeline-side"],features:[m.Ob([{provide:c.a,useClass:o.a},r.a,s.a]),m.Mb],decls:5,vars:6,consts:[["class","result-overlay",4,"ngIf"],["class","work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration","itemClicked","stateLinkClicked",4,"ngIf"],["class","work-packages--card-view-container",3,"ngClass",4,"ngIf"],["class","work-packages-split-view--tabletimeline-footer hide-when-print",4,"ngIf"],[1,"result-overlay"],[1,"work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration","itemClicked","stateLinkClicked"],[1,"work-packages--card-view-container",3,"ngClass"],["resizerClass","work-packages-partitioned-page--content-right","resizerStorageKey","openProject-splitViewFlexBasis",3,"configuration","showResizer","itemClicked","stateLinkClicked"],[1,"work-packages-split-view--tabletimeline-footer","hide-when-print"]],template:function(e,t){1&e&&(m.Tc(0,C,1,0,"div",0),m.sc(1,"async"),m.Tc(2,j,1,2,"wp-table",1),m.Tc(3,x,2,5,"div",2),m.Tc(4,S,2,0,"div",3)),2&e&&(m.wc("ngIf",m.tc(1,4,t.showResultOverlay$)&&t.showTableView),m.Pb(2),m.wc("ngIf",t.tableInformationLoaded&&t.showTableView),m.Pb(1),m.wc("ngIf",!t.showTableView),m.Pb(1),m.wc("ngIf",t.tableInformationLoaded))},directives:[w.q,v.a,w.n,y.a,k.a],pipes:[w.a],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.result-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;z-index:900;background-color:#fff;opacity:.5}.work-packages--card-view-container[_ngcontent-%COMP%]{width:100%;overflow:auto;padding-bottom:5px;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages--card-view-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages--card-view-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages--card-view-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages--card-view-container[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.work-packages--card-view-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}@media screen and (min-width:679px){.work-packages--card-view-container.-with-resizer[_ngcontent-%COMP%]{padding-left:10px}}@media screen and (max-width:679px){.work-packages--card-view-container[_ngcontent-%COMP%]{min-width:calc(100vw + 10px)}}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]{display:flex;flex:1 1 100%;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}@media screen and (min-width:679px){.work-packages-split-view--tabletimeline-container.-with-resizer[_ngcontent-%COMP%]{padding-left:10px}}@media screen and (max-width:679px){.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]{min-width:calc(100vw + 10px)}}"],changeDetection:0})},feia:function(e,t,i){"use strict";i.d(t,"b",(function(){return w})),i.d(t,"a",(function(){return v}));var n=i("8zkO"),s=i("Jui0"),r=i("kTsZ"),a=i("iMRi"),c=i("1G5W"),o=i("pLZG"),l=i("d/TE"),d=i("wZYP"),u=i("k8lp"),h=i("Hg4z"),p=i("AEvm"),g=i("fXoL"),f=i("ofXK"),b=i("jEcX");function m(e,t){if(1&e&&(g.fc(0),g.cc(1,"attachments",3),g.ec()),2&e){const e=g.rc();g.Pb(1),g.wc("resource",e.resource)}}const w="ckeditor-augmented-textarea";class v extends p.a{constructor(e,t,i,n,s,r,a){super(),this.elementRef=e,this.pathHelper=t,this.halResourceService=i,this.Notifications=n,this.I18n=s,this.states=r,this.ConfigurationService=a,this.changed=!1,this.inFlight=!1,this.isEditing=!1}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.textareaSelector=this.$element.attr("textarea-selector"),this.previewContext=this.$element.attr("preview-context"),this.macros="false"!==this.$element.attr("macros"),this.editorType=this.$element.attr("editor-type")||"full";const e=this.$element.data("resource");this.resource=e?this.halResourceService.createHalResource(e,!0):void 0,this.formElement=this.$element.closest("form"),this.wrappedTextArea=this.formElement.find(this.textareaSelector),this.wrappedTextArea.removeAttr("required").hide(),this.initialContent=this.wrappedTextArea.val(),this.$attachmentsElement=this.formElement.find("#attachments_fields"),this.context={resource:this.resource,previewContext:this.previewContext},this.macros||(this.context.macros="none")}ngOnDestroy(){super.ngOnDestroy(),this.formElement.off("submit.ckeditor")}markEdited(){window.OpenProject.pageWasEdited=!0}setup(e){return this.$element.data("editor",e),this.resource&&this.resource.attachments&&(this.setupAttachmentAddedCallback(e),this.setupAttachmentRemovalSignal(e)),this.formElement.on("submit.ckeditor change.ckeditor",()=>{try{this.wrappedTextArea.val(this.ckEditorInstance.getRawData())}catch(e){return console.error(`Failed to save CKEditor body to textarea: ${e}.`),this.Notifications.addError(e||this.I18n.t("js.error.internal")),!1}return this.addUploadedAttachmentsToForm(),!0}),this.setLabel(),e}setupAttachmentAddedCallback(e){e.model.on("op:attachment-added",()=>{this.states.forResource(this.resource).putValue(this.resource)})}setupAttachmentRemovalSignal(e){this.attachments=_.clone(this.resource.attachments.elements),this.states.forResource(this.resource).changes$().pipe(Object(c.a)(Object(h.b)(this)),Object(o.a)(e=>!!e)).subscribe(t=>{let i=_.differenceBy(this.attachments,t.attachments.elements,e=>e.id).map(e=>e.downloadLocation.$href);i.length&&e.model.fire("op:attachment-removed",i),this.attachments=_.clone(t.attachments.elements)})}setLabel(){let e=this.textareaSelector.substring(1),t=jQuery(`label[for=${e}]`),i=this.$element.find(".ck-content");i.attr("aria-label",null),i.attr("aria-labelledby",e),t.click(()=>{i.focus()})}addUploadedAttachmentsToForm(){if(!this.resource||!this.resource.attachments||this.resource.id)return;const e=this.$attachmentsElement.find("input[type='file']").map((e,t)=>{let i=(t.getAttribute("name")||"").match(/attachments\[(\d+)\]\[(?:file|id)\]/);return i?parseInt(i[1]):0}).toArray().sort().pop()||0;let t=this.resource.attachments.elements||[];jQuery.each(t,(t,i)=>{this.$attachmentsElement.append(`<input type="hidden" name="attachments[${e+t+1}][id]" value="${i.id}">`)})}}v.\u0275fac=function(e){return new(e||v)(g.bc(g.q),g.bc(s.a),g.bc(r.a),g.bc(l.a),g.bc(d.a),g.bc(a.a),g.bc(n.a))},v.\u0275cmp=g.Vb({type:v,selectors:[["ckeditor-augmented-textarea"]],viewQuery:function(e,t){var i;(1&e&&g.Rc(u.a,!0),2&e)&&(g.Ic(i=g.qc())&&(t.ckEditorInstance=i.first))},features:[g.Mb],decls:4,vars:4,consts:[[1,"op-ckeditor--wrapper"],[3,"context","content","ckEditorType","onInitialized","onContentChange"],[4,"ngIf"],["data-allow-uploading","true","data-destroy-immediately","false",3,"resource"]],template:function(e,t){1&e&&(g.fc(0),g.hc(1,"div",0),g.hc(2,"op-ckeditor",1),g.pc("onInitialized",(function(e){return t.setup(e)}))("onContentChange",(function(){return t.markEdited()})),g.gc(),g.gc(),g.Tc(3,m,2,1,"ng-container",2),g.ec()),2&e&&(g.Pb(2),g.wc("context",t.context)("content",t.initialContent)("ckEditorType",t.editorType),g.Pb(1),g.wc("ngIf",t.resource&&t.resource.attachments))},directives:[u.a,f.q,b.a],encapsulation:2})},g1AQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.hooks={}}register(e,t){t&&(this.hooks[e]||(this.hooks[e]=[]),this.hooks[e].push(t))}call(e,...t){let i=[];if(this.hooks[e])for(let n=0;n<this.hooks[e].length;n++){let s=this.hooks[e][n](...t);s&&i.push(s)}return i}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac})},gh2L:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("t8SH"),s=i("fXoL"),r=i("ZOsW"),a=i("3Pt+"),c=i("ofXK"),o=i("ximh");function l(e,t){if(1&e&&(s.cc(0,"b",4),s.Vc(1)),2&e){const e=t.searchTerm,i=s.rc();s.wc("textContent",i.text.add_new_action),s.Pb(1),s.Xc(": ",e," ")}}function d(e,t){if(1&e&&(s.hc(0,"div",5),s.Vc(1),s.gc()),2&e){const e=t.item,i=t.searchTerm;s.wc("ngOptionHighlight",i),s.Pb(1),s.Wc(e.name)}}class u extends n.a{}u.\u0275fac=function(e){return h(e||u)},u.\u0275cmp=s.Vb({type:u,selectors:[["wp-autocompleter"]],features:[s.Mb],decls:4,vars:14,consts:[["bindLabel","name",3,"ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","clearSearchOnAdd","appendTo","hideSelected","id","ngModelChange","change","open","close","keydown"],["ngSelectComponent",""],["ng-tag-tmp",""],["ng-option-tmp",""],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight"]],template:function(e,t){1&e&&(s.hc(0,"ng-select",0,1),s.pc("ngModelChange",(function(e){return t.model=e}))("change",(function(e){return t.changeModel(e)}))("open",(function(){return t.opened()}))("close",(function(){return t.closed()}))("keydown",(function(e){return t.keyPressed(e)})),s.Tc(2,l,2,2,"ng-template",2),s.Tc(3,d,2,2,"ng-template",3),s.gc()),2&e&&s.wc("ngModel",t.model)("items",t.availableValues)("ngClass",t.classes)("addTag",t.createAllowed)("virtualScroll",!0)("required",t.required)("clearable",!t.required)("disabled",t.disabled)("typeahead",t.typeahead)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("appendTo",t.appendTo)("hideSelected",t.hideSelected)("id",t.id)},directives:[r.a,a.m,a.p,c.n,a.x,r.l,r.c,o.a],encapsulation:2});const h=s.jc(u)},gvAf:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("iB+3"),s=i("wZYP"),r=i("AEvm"),a=i("CNq7"),c=i("fXoL"),o=i("ofXK"),l=i("aveh"),d=i("4Obc");function u(e,t){if(1&e&&c.cc(0,"wp-single-view",2),2&e){const e=c.rc();c.wc("workPackage",e.workPackage)}}function h(e,t){if(1&e&&(c.hc(0,"div",3),c.hc(1,"div",4),c.hc(2,"div",5),c.cc(3,"h3",6),c.gc(),c.gc(),c.cc(4,"newest-activity-on-overview",2),c.gc()),2&e){const e=c.rc();c.Pb(3),c.wc("textContent",e.tabName),c.Pb(1),c.wc("workPackage",e.workPackage)}}class p extends r.a{constructor(e,t,i){super(),this.I18n=e,this.$state=t,this.apiV3Service=i,this.tabName=this.I18n.t("js.label_latest_activity"),this.workPackageId=this.$state.params.workPackageId,this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe(e=>this.workPackage=e)}}p.\u0275fac=function(e){return new(e||p)(c.bc(s.a),c.bc(n.StateService),c.bc(a.a))},p.\u0275cmp=c.Vb({type:p,selectors:[["wp-overview-tab"]],features:[c.Mb],decls:2,vars:2,consts:[[3,"workPackage",4,"ngIf"],["class","attributes-group",4,"ngIf"],[3,"workPackage"],[1,"attributes-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function(e,t){1&e&&(c.Tc(0,u,1,1,"wp-single-view",0),c.Tc(1,h,5,2,"div",1)),2&e&&(c.wc("ngIf",t.workPackage),c.Pb(1),c.wc("ngIf",t.workPackage))},directives:[o.q,l.a,d.a],encapsulation:2})},hgso:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("FnNU"),s=i("IzEk");class r{constructor(){this.cacheDurationInSeconds=120,this.cache={id:null,state:Object(n.g)()}}require(e,t=!1){const i=e.id,n=this.cache.state;return(t||this.cache.id!==i)&&n.clear(),this.isCached(i)?Promise.resolve(n.value):(this.cache.id=i,this.cache.state.putFromPromiseIfPristine(()=>this.load(e)),this.cache.state.values$().pipe(Object(s.a)(1)).toPromise())}clear(e){this.cache.id===e&&this.cache.state.clear()}isCached(e){const t=this.cache.state;return this.cache.id===e&&t.hasValue()&&!t.isValueOlderThan(1e3*this.cacheDurationInSeconds)}}},hj8t:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("wZYP"),s=i("PtkW"),r=i("JY8V"),a=i("4jc8"),c=i("fXoL"),o=i("3Pt+"),l=i("ofXK");function d(e,t){if(1&e&&c.cc(0,"option",15),2&e){const e=t.$implicit,i=c.rc(2);c.wc("textContent",i.text.zoom[e])("value",e)("selected",i.zoomLevel===e)}}function u(e,t){if(1&e&&c.cc(0,"option",15),2&e){const e=t.$implicit,i=c.rc().$implicit,n=c.rc(2);c.wc("textContent",e.name)("value",e.id)("selected",n.labels[i]===e.id)}}function h(e,t){if(1&e){const e=c.ic();c.hc(0,"div",16),c.hc(1,"div",1),c.hc(2,"label",17),c.Vc(3),c.gc(),c.hc(4,"div",3),c.hc(5,"div",18),c.hc(6,"select",19),c.pc("change",(function(i){c.Lc(e);const n=t.$implicit;return c.rc(2).updateLabels(n,i.target.value)})),c.Tc(7,u,1,3,"option",13),c.gc(),c.gc(),c.gc(),c.gc(),c.gc()}if(2&e){const e=t.$implicit,i=c.rc(2);c.Pb(2),c.yc("for","modal-timelines-label-",e,""),c.Pb(1),c.Xc(" ",i.text.labels[e]," "),c.Pb(3),c.yc("id","modal-timelines-label-",e,""),c.Pb(1),c.wc("ngForOf",i.availableAttributes)}}function p(e,t){if(1&e){const e=c.ic();c.fc(0),c.hc(1,"fieldset",8),c.cc(2,"legend",9),c.cc(3,"p",10),c.hc(4,"div",1),c.hc(5,"div",3),c.hc(6,"div",11),c.hc(7,"select",12),c.pc("change",(function(t){c.Lc(e);return c.rc().zoomLevel=t.target.value})),c.Tc(8,d,1,3,"option",13),c.gc(),c.gc(),c.gc(),c.gc(),c.gc(),c.hc(9,"fieldset",8),c.cc(10,"legend",9),c.cc(11,"p",10),c.Tc(12,h,8,4,"div",14),c.gc(),c.ec()}if(2&e){const e=c.rc();c.Pb(2),c.wc("textContent",e.text.zoom.level),c.Pb(1),c.wc("textContent",e.text.zoom.description),c.Pb(4),c.Qb("disabled",!0===e.autoZoom?"disabled":void 0),c.Pb(1),c.wc("ngForOf",e.availableZoomLevels),c.Pb(2),c.wc("textContent",e.text.labels.title),c.Pb(1),c.wc("textContent",e.text.labels.description),c.Pb(1),c.wc("ngForOf",e.availableLabels)}}class g{constructor(e,t,i,n){this.injector=e,this.I18n=t,this.wpTableTimeline=i,this.wpTableColumns=n,this.timelineVisible=!1,this.availableZoomLevels=["auto",...a.n],this.text={title:this.I18n.t("js.timelines.gantt_chart"),display_timelines:this.I18n.t("js.timelines.button_activate"),display_timelines_hint:this.I18n.t("js.work_packages.table_configuration.show_timeline_hint"),zoom:{level:this.I18n.t("js.tl_toolbar.zooms"),description:this.I18n.t("js.timelines.zoom.description"),days:this.I18n.t("js.timelines.zoom.days"),weeks:this.I18n.t("js.timelines.zoom.weeks"),months:this.I18n.t("js.timelines.zoom.months"),quarters:this.I18n.t("js.timelines.zoom.quarters"),years:this.I18n.t("js.timelines.zoom.years"),auto:this.I18n.t("js.timelines.zoom.auto")},labels:{title:this.I18n.t("js.timelines.labels.title"),description:this.I18n.t("js.timelines.labels.description"),bar:this.I18n.t("js.timelines.labels.bar"),none:this.I18n.t("js.timelines.filter.noneSelection"),left:this.I18n.t("js.timelines.labels.left"),right:this.I18n.t("js.timelines.labels.right"),farRight:this.I18n.t("js.timelines.labels.farRight")}}}onSave(){this.wpTableTimeline.update(Object.assign(Object.assign({},this.wpTableTimeline.current),{visible:this.timelineVisible,labels:this.labels,zoomLevel:this.zoomLevel}))}updateLabels(e,t){""===t&&(t=null),this.labels[e]=t}ngOnInit(){this.timelineVisible=this.wpTableTimeline.isVisible,this.zoomLevel=this.wpTableTimeline.zoomLevel;const e=this.wpTableTimeline.labels;this.labels=_.clone(e),this.availableLabels=Object.keys(this.labels);const t=this.wpTableColumns.allPropertyColumns.sort((e,t)=>e.name.localeCompare(t.name));this.availableAttributes=[{id:"",name:this.text.labels.none}].concat(t)}}g.\u0275fac=function(e){return new(e||g)(c.bc(c.A),c.bc(n.a),c.bc(s.a),c.bc(r.a))},g.\u0275cmp=c.Vb({type:g,selectors:[["ng-component"]],decls:9,vars:4,consts:[[1,"form"],[1,"form--field"],["for","display_timelines_switch",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--check-box-container"],["type","checkbox","id","display_timelines_switch","name","display_timelines_switch",3,"checked","change"],[1,"form--field-instructions",3,"textContent"],[4,"ngIf"],[1,"form--fieldset"],[1,"form--fieldset-legend",3,"textContent"],[3,"textContent"],[1,"form--text-select-container","-slim"],["id","modal-timelines-zoomlevel",1,"form--select",3,"change"],[3,"textContent","value","selected",4,"ngFor","ngForOf"],["class","form--row",4,"ngFor","ngForOf"],[3,"textContent","value","selected"],[1,"form--row"],[1,"form--label",3,"for"],[1,"form--select-container"],[1,"form--select",3,"id","change"]],template:function(e,t){1&e&&(c.hc(0,"div"),c.hc(1,"form",0),c.hc(2,"div",1),c.cc(3,"label",2),c.hc(4,"div",3),c.hc(5,"div",4),c.hc(6,"input",5),c.pc("change",(function(){return t.timelineVisible=!t.timelineVisible})),c.gc(),c.gc(),c.gc(),c.cc(7,"p",6),c.gc(),c.Tc(8,p,13,7,"ng-container",7),c.gc(),c.gc()),2&e&&(c.Pb(3),c.wc("textContent",t.text.display_timelines),c.Pb(3),c.wc("checked",t.timelineVisible),c.Pb(1),c.wc("textContent",t.text.display_timelines_hint),c.Pb(1),c.wc("ngIf",t.timelineVisible))},directives:[o.C,o.n,o.o,l.q,l.p,o.r,o.B],encapsulation:2})},ho3E:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));const n=new(i("fXoL").z)("OpQueryConfigurationLocalsToken")},hvpr:function(e,t,i){"use strict";i.d(t,"a",(function(){return F}));var n=i("mrSG"),s=i("fXoL"),r=i("E2tj"),a=i("wZYP"),c=i("FDFi"),o=i("4n9w"),l=i("4EDS"),d=i("Kg8T"),u=i("iB+3"),h=i("iMRi"),p=i("Uyc6"),g=i("Jui0"),f=i("lJxs"),b=i("pLZG"),m=i("zp1y"),w=i("x5It"),v=i("eyhC"),y=i("Wcm6"),k=i("WW/2"),C=i("87fy"),j=i("qc15"),P=i("K247"),x=i("WUI6"),S=i("AEvm"),_=i("Hg4z"),O=i("/C7M");const I=["container"];function T(e,t){if(1&e&&(s.hc(0,"div",5),s.cc(1,"ndc-dynamic",6),s.gc()),2&e){const e=s.rc();s.Pb(1),s.wc("ndcDynamicComponent",e.referenceClass)("ndcDynamicInjector",e.injector)("ndcDynamicOutputs",e.referenceOutputs)}}function R(e,t){1&e&&s.cc(0,"hr",9)}function E(e,t){if(1&e){const e=s.ic();s.fc(0),s.hc(1,"wp-single-card",7),s.pc("onRemove",(function(){s.Lc(e);const i=t.$implicit;return s.rc().removeCard(i)}))("stateLinkClicked",(function(t){s.Lc(e);return s.rc().stateLinkClicked.emit(t)})),s.gc(),s.Tc(2,R,1,0,"hr",8),s.ec()}if(2&e){const e=t.$implicit,i=s.rc();s.Pb(1),s.wc("workPackage",e)("showInfoButton",i.showInfoButton)("showStatusButton",i.showStatusButton)("showRemoveButton",i.cardsRemovable)("highlightingMode",i.highlightingMode)("draggable",i.canDragOutOf(e))("orientation",i.orientation)("shrinkOnMobile",i.shrinkOnMobile),s.Qb("data-is-new",e.isNew||void 0)("data-work-package-id",e.id)("data-class-identifier",i.cardView.classIdentifier(e)),s.Pb(1),s.wc("ngIf",i.shrinkOnMobile)}}function M(e,t){if(1&e&&(s.hc(0,"div"),s.cc(1,"no-results",10),s.gc()),2&e){const e=s.rc();s.Pb(1),s.wc("title",e.text.noResults.title)("description",e.text.noResults.description)}}class F extends S.a{constructor(e,t,i,n,r,a,c,o,d,u,h,p,g,f,b,m,w,v){super(),this.querySpace=e,this.states=t,this.injector=i,this.$state=n,this.I18n=r,this.wpCreate=a,this.wpInlineCreate=c,this.notificationService=o,this.halEvents=d,this.authorisationService=u,this.causedUpdates=h,this.cdRef=p,this.pathHelper=g,this.wpTableSelection=f,this.wpViewOrder=b,this.cardView=m,this.cardDragDrop=w,this.deviceService=v,this.showStatusButton=!0,this.showInfoButton=!1,this.orientation="vertical",this.cardsRemovable=!1,this.showEmptyResultsBox=!1,this.shrinkOnMobile=!1,this.onMoved=new s.s,this.selectionChanged=new s.s,this.itemClicked=new s.s,this.stateLinkClicked=new s.s,this.trackByHref=l.a.trackByHrefAndProperty("lockVersion"),this.isResultEmpty=!1,this.text={removeCard:this.I18n.t("js.card.remove_from_list"),addNewCard:this.I18n.t("js.card.add_new"),noResults:{title:this.I18n.t("js.work_packages.no_results.title"),description:this.I18n.t("js.work_packages.no_results.description")}},this.canAdd=!1,this.canReference=!1,this.inReference=!1,this.referenceClass=this.wpInlineCreate.referenceComponentClass,this.referenceOutputs={onCancel:()=>this.setReferenceMode(!1),onReferenced:e=>this.cardDragDrop.addWorkPackageToQuery(e,0)}}ngOnInit(){this.registerCreationCallback(),this.authorisationService.observeUntil(Object(_.b)(this)).subscribe(()=>{this.canAdd=this.wpInlineCreate.canAdd,this.canReference=this.wpInlineCreate.canReference,this.cdRef.detectChanges()}),this.halEvents.aggregated$("WorkPackage").pipe(Object(f.a)(e=>e.filter(e=>"updated"===e.eventType)),Object(b.a)(e=>{const t=this.workPackages.map(e=>e.id.toString());return!!e.find(e=>-1!==t.indexOf(e.id))})).subscribe(()=>{this.workPackages=this.wpViewOrder.orderedWorkPackages(),this.cdRef.detectChanges()}),this.querySpace.results.values$().pipe(Object(m.a)(this.querySpace.query.values$()),this.untilDestroyed()).subscribe(([e,t])=>{this.query=t,this.workPackages=this.wpViewOrder.orderedWorkPackages(),this.cardView.updateRenderedCardsValues(this.workPackages),this.isResultEmpty=0===this.workPackages.length,this.cdRef.detectChanges()})}ngAfterViewInit(){this.cardDragDrop.init(this),this.deviceService.isMobile||this.cardDragDrop.registerDragAndDrop();let e=this.injector.get(x.b,y.a);e instanceof y.a?e.attachTo(this):new e(this.injector).attachTo(this),this.wpTableSelection.registerSelectAllListener(()=>this.cardView.renderedCards),this.wpTableSelection.registerDeselectAllListener()}ngOnDestroy(){super.ngOnDestroy(),this.cardDragDrop.destroy()}get workPackages(){return this.cardDragDrop.workPackages}set workPackages(e){this.cardDragDrop.workPackages=e}setReferenceMode(e){this.inReference=e,this.cdRef.detectChanges()}addNewCard(){this.cardDragDrop.addNewCard()}removeCard(e){this.cardDragDrop.removeCard(e)}onCardSaved(e){return Object(n.b)(this,void 0,void 0,(function*(){yield this.cardDragDrop.onCardSaved(e)}))}classes(){let e="wp-cards-container ";return e+="-"+this.orientation,e+=this.shrinkOnMobile?" -shrink":"",e}registerCreationCallback(){this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed()).subscribe(e=>Object(n.b)(this,void 0,void 0,(function*(){this.onCardSaved(e)})))}}F.\u0275fac=function(e){return new(e||F)(s.bc(r.a),s.bc(h.a),s.bc(s.A),s.bc(u.StateService),s.bc(a.a),s.bc(o.a),s.bc(c.a),s.bc(j.a),s.bc(O.a),s.bc(d.a),s.bc(w.a),s.bc(s.i),s.bc(g.a),s.bc(v.a),s.bc(p.a),s.bc(k.a),s.bc(C.a),s.bc(P.a))},F.\u0275cmp=s.Vb({type:F,selectors:[["wp-card-view"]],viewQuery:function(e,t){var i;(1&e&&s.Rc(I,!0),2&e)&&(s.Ic(i=s.qc())&&(t.container=i.first))},inputs:{canDragOutOf:["dragOutOfHandler","canDragOutOf"],dragInto:"dragInto",highlightingMode:"highlightingMode",workPackageAddedHandler:"workPackageAddedHandler",showStatusButton:"showStatusButton",showInfoButton:"showInfoButton",orientation:"orientation",cardsRemovable:"cardsRemovable",showEmptyResultsBox:"showEmptyResultsBox",shrinkOnMobile:"shrinkOnMobile"},outputs:{onMoved:"onMoved",selectionChanged:"selectionChanged",itemClicked:"itemClicked",stateLinkClicked:"stateLinkClicked"},features:[s.Mb],decls:5,vars:5,consts:[[3,"ngClass"],["container",""],["class","wp-inline-create--reference-container",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"wp-inline-create--reference-container"],[3,"ndcDynamicComponent","ndcDynamicInjector","ndcDynamicOutputs"],[3,"workPackage","showInfoButton","showStatusButton","showRemoveButton","highlightingMode","draggable","orientation","shrinkOnMobile","onRemove","stateLinkClicked"],["class","form--separator hidden-for-desktop",4,"ngIf"],[1,"form--separator","hidden-for-desktop"],[3,"title","description"]],template:function(e,t){1&e&&(s.hc(0,"div",0,1),s.Tc(2,T,2,3,"div",2),s.Tc(3,E,3,12,"ng-container",3),s.gc(),s.Tc(4,M,2,2,"div",4)),2&e&&(s.wc("ngClass",t.classes()),s.Pb(2),s.wc("ngIf",t.inReference),s.Pb(1),s.wc("ngForOf",t.workPackages)("ngForTrackBy",t.trackByHref),s.Pb(1),s.wc("ngIf",t.showEmptyResultsBox&&t.isResultEmpty))},styles:[".wp-inline-create-button[_ngcontent-%COMP%]{font-size:.9rem;padding-top:1rem;text-align:center}.wp-inline-create--reference-container[_ngcontent-%COMP%]{margin-bottom:3rem;margin-top:10px}",".wp-cards-container.-horizontal[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));grid-column-gap:10px;grid-row-gap:10px;margin-right:5px}@media only screen and (max-width:679px){.wp-cards-container.-horizontal.-shrink[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-row-gap:0;margin-right:0}.wp-cards-container.-horizontal.-shrink[_ngcontent-%COMP%]   .form--separator[_ngcontent-%COMP%]{margin-bottom:0}}",".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.wp-cards-container.-vertical[_ngcontent-%COMP%]{height:100%;padding:0 15px;border-radius:2px;overflow-y:scroll;scrollbar-color:transparent transparent;scrollbar-width:thin}.wp-cards-container.-vertical[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.wp-cards-container.-vertical[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.wp-cards-container.-vertical[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.wp-cards-container.-vertical[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.wp-cards-container.-vertical[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}"],changeDetection:0})},hxxE:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{updateElements(){return this.$href?this.$load().then(e=>this.elements=e.elements):Promise.resolve()}}},hxzR:function(e,t,i){"use strict";i.d(t,"a",(function(){return _}));var n=i("IzEk"),s=i("POAS"),r=i("qc15"),a=i("E05v"),c=i("ahVz"),o=i("2TbE"),l=i("p5fp"),d=i("XlgE"),u=i("BjK6"),h=i("ul8C"),p=i("qvi4"),g=i("EzE4"),f=i("LRne"),b=i("82q4"),m=i("fXoL"),w=i("ofXK"),v=i("CV67"),y=i("CS/5"),k=i("0loS"),C=i("DLfB");function j(e,t){if(1&e&&m.cc(0,"back-button",11),2&e){const e=m.rc();m.wc("customBackMethod",e.backButtonCallback)}}function P(e,t){if(1&e&&(m.hc(0,"li",15),m.cc(1,"ndc-dynamic",16),m.gc()),2&e){const e=m.rc().$implicit,t=m.rc(2);m.wc("ngClass",e.containerClasses),m.Pb(1),m.wc("ndcDynamicComponent",e.component)("ndcDynamicInputs",e.inputs)("ndcDynamicInjector",t.injector)("ndcDynamicOutputs",e.outputs)}}function x(e,t){if(1&e&&(m.fc(0),m.Tc(1,P,2,5,"li",14),m.ec()),2&e){const e=t.$implicit;m.Pb(1),m.wc("ngIf",!e.show||e.show())}}function S(e,t){if(1&e&&(m.hc(0,"ul",12),m.Tc(1,x,2,1,"ng-container",13),m.gc()),2&e){const e=m.rc();m.Pb(1),m.wc("ngForOf",e.toolbarButtonComponents)}}class _ extends c.a{constructor(){super(...arguments),this.toolbarButtonComponents=[{component:o.a,inputs:{stateName$:Object(f.a)("work-packages.partitioned.list.new"),allowed:["work_packages.createWorkPackage"]}},{component:l.a},{component:d.a,containerClasses:"hidden-for-mobile"},{component:b.a,show:()=>!(!this.currentQuery||!this.currentQuery.groupBy)},{component:u.a,containerClasses:"hidden-for-mobile"},{component:h.a,containerClasses:"hidden-for-mobile -no-spacing"},{component:p.a,containerClasses:"hidden-for-mobile"},{component:g.a}]}ngOnInit(){super.ngOnInit(),this.text.button_settings=this.I18n.t("js.button_settings")}additionalLoadingTime(){return this.wpTableTimeline.isVisible?this.querySpace.timelineRendered.pipe(Object(n.a)(1)).toPromise():this.querySpace.tableRendered.valuesPromise()}shouldUpdateHtmlTitle(){return"work-packages.partitioned.list"===this.$state.current.name}}_.\u0275fac=function(e){return O(e||_)},_.\u0275cmp=m.Vb({type:_,selectors:[["wp-view-page"]],features:[m.Ob([{provide:s.a,useClass:r.a},a.a]),m.Mb],decls:11,vars:11,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["linkClass","back-button",3,"customBackMethod",4,"ngIf"],[3,"title","inFlight","showSaveCondition","editable","onSave","onEmptySubmit"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"]],template:function(e,t){1&e&&(m.hc(0,"div",0),m.hc(1,"div",1),m.hc(2,"div",2),m.Tc(3,j,1,1,"back-button",3),m.hc(4,"editable-toolbar-title",4),m.pc("onSave",(function(e){return t.changeChangesFromTitle(e)}))("onEmptySubmit",(function(){return t.updateTitleName("")})),m.gc(),m.Tc(5,S,2,1,"ul",5),m.gc(),m.gc(),m.hc(6,"div",6),m.cc(7,"ndc-dynamic",7),m.gc(),m.hc(8,"div",8),m.cc(9,"div",9),m.cc(10,"div",10),m.gc(),m.gc()),2&e&&(m.wc("ngClass",t.currentPartition),m.Pb(3),m.wc("ngIf",t.backButtonCallback),m.Pb(1),m.wc("title",t.selectedTitle)("inFlight",t.toolbarDisabled)("showSaveCondition",t.showToolbarSaveButton)("editable",t.titleEditingEnabled),m.Pb(1),m.wc("ngIf",t.showToolbar),m.Pb(2),m.wc("ndcDynamicComponent",t.filterContainerDefinition.component)("ndcDynamicInputs",t.filterContainerDefinition.inputs)("ndcDynamicOutputs",t.filterContainerDefinition.outputs)("ndcDynamicInjector",t.injector))},directives:[w.n,w.q,v.a,y.c,y.d,k.UIView,C.a,w.p],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr)}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{overflow:auto}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   wp-resizer[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#ddd transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}@media only screen and (max-width:679px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:0;max-width:100vw;max-height:100%}}"],changeDetection:0});const O=m.jc(_)},i95X:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("wZYP"),s=i("FDFi"),r=i("6p3c"),a=i("uSJ+"),c=i("E2tj"),o=i("pL6k"),l=i("NawS"),d=i("/C7M"),u=i("qc15"),h=i("CNq7"),p=i("fXoL"),g=i("MIK2"),f=i("/Rze"),b=i("N5AO");class m{constructor(e,t,i,n,s,r,a,c,o){this.parent=e,this.wpInlineCreate=t,this.apiV3Service=i,this.wpRelations=n,this.notificationService=s,this.halEvents=r,this.urlParamsHelper=a,this.querySpace=c,this.I18n=o,this.isDisabled=!1,this.queryFilters=this.buildQueryFilters(),this.text={abort:this.I18n.t("js.relation_buttons.abort")}}addExisting(){if(_.isNil(this.selectedWpId))return;const e=this.selectedWpId;this.isDisabled=!0,this.wpInlineCreate.add(this.workPackage,e).then(()=>{this.apiV3Service.work_packages.id(this.workPackage).refresh(),this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:e,relationType:this.relationType}),this.isDisabled=!1,this.wpInlineCreate.newInlineWorkPackageReferenced.next(e),this.cancel()}).catch(e=>{this.notificationService.handleRawError(e,this.workPackage),this.isDisabled=!1,this.cancel()})}onSelected(e){e&&(this.selectedWpId=e.id,this.addExisting())}get relationType(){return this.wpInlineCreate.relationType}get workPackage(){return this.wpInlineCreate.referenceTarget}cancel(){this.parent.resetRow()}buildQueryFilters(){const e=this.querySpace.query.value;if(!e)return[];const t=l.a.RELATION_TYPES(!0);let i=e.filters.filter(e=>{let i=this.urlParamsHelper.buildV3GetFilterIdFromFilter(e);return-1===t.indexOf(i)});return this.urlParamsHelper.buildV3GetFilters(i)}}m.\u0275fac=function(e){return new(e||m)(p.bc(r.a),p.bc(s.a),p.bc(h.a),p.bc(a.a),p.bc(u.a),p.bc(d.a),p.bc(o.a),p.bc(c.a),p.bc(n.a))},m.\u0275cmp=p.Vb({type:m,selectors:[["ng-component"]],decls:7,vars:4,consts:[["data-indicator-name","relationAddChild",1,"loading-indicator--location"],[1,"wp-relations-create--form","wp-relations--add-form"],[1,"wp-relations-input-section"],["hiddenOverflowContainer",".work-packages-full-view--split-left",3,"workPackage","additionalFilters","filterCandidatesFor","onSelected"],[1,"wp-relations-controls-section","relation-row"],["linkClass","wp-create-relation--cancel","aria-hidden","false",3,"execute"],["icon-classes","icon-remove",3,"icon-title"]],template:function(e,t){1&e&&(p.hc(0,"div",0),p.hc(1,"div",1),p.hc(2,"div",2),p.hc(3,"wp-relations-autocomplete",3),p.pc("onSelected",(function(e){return t.onSelected(e)})),p.gc(),p.gc(),p.hc(4,"div",4),p.hc(5,"accessible-by-keyboard",5),p.pc("execute",(function(){return t.cancel()})),p.cc(6,"op-icon",6),p.gc(),p.gc(),p.gc(),p.gc()),2&e&&(p.Pb(3),p.wc("workPackage",t.workPackage)("additionalFilters",t.queryFilters)("filterCandidatesFor",t.relationType),p.Pb(3),p.wc("icon-title",t.text.abort))},directives:[g.a,f.a,b.a],encapsulation:2})},iHm1:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.config={user:"name",project:"name"}}sort(e,t){if(0===e.length)return e;const i=t||e[0]._type;if(!i)return e;const n=this.sortingProperty(i);return n?_.sortBy(e,e=>e[n].toLowerCase()):e}sortingProperty(e){return e=e.toLowerCase().replace(/^\[\]/,""),this.config[e]}hasSortingProperty(e){return void 0!==this.sortingProperty(e)}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac,providedIn:"root"})},iMRi:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("FnNU"),s=i("XNiG");class r extends n.b{constructor(){super(...arguments),this.name="MainStore",this.projects=Object(n.h)(),this.workPackages=Object(n.h)(),this.posts=Object(n.h)(),this.schemas=Object(n.h)(),this.types=Object(n.h)(),this.statuses=Object(n.h)(),this.timeEntries=Object(n.h)(),this.versions=Object(n.h)(),this.users=Object(n.h)(),this.queries=new c,this.changes=new a,this.additional={}}forType(e){let t=this[e]||this.additional[e];return t||(t=this.additional[e]=Object(n.h)()),t}forResource(e){const t=_.camelCase(e._type)+"s";let i=this.forType(t);return i&&i.get(e.id)}add(e,t){this.additional[e]=t}}class a{constructor(){this.queries=new s.a}}class c{constructor(){this.columns=Object(n.g)(),this.sortBy=Object(n.g)(),this.groupBy=Object(n.g)(),this.filters=Object(n.g)(),this.displayRepresentation=Object(n.g)()}}},iZDB:function(e,t,i){"use strict";i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return r}));var n=i("fXoL");const s="op-backlogs-page";class r{ngOnInit(){document.getElementById("projected-content").hidden=!1}}r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=n.Vb({type:r,selectors:[["op-backlogs-page"]],decls:0,vars:0,template:function(e,t){},styles:["#rb #helpers,#rb .editors,#rb .meta{display:none}#rb .ui-dialog .editor{display:block}.ui-dialog .ui-dialog-title{float:left;margin-right:0}.ui-dialog .ui-dialog-buttonpane.ui-widget-content,.ui-dialog.ui-widget-content{border:none}.subject-input{width:99%}th{font-weight:700}#toolbar .links{display:none!important}.jqplot-target{position:relative;color:#666;font-family:Trebuchet MS,Arial,Helvetica,sans-serif;font-size:1em}.jqplot-axis{font-size:.75em}.jqplot-xaxis{margin-top:10px}.jqplot-x2axis{margin-bottom:10px}.jqplot-yaxis{margin-right:10px}.jqplot-y2axis,.jqplot-y3axis,.jqplot-y4axis,.jqplot-y5axis,.jqplot-y6axis,.jqplot-y7axis,.jqplot-y8axis,.jqplot-y9axis{margin-left:10px;margin-right:10px}.jqplot-axis-tick,.jqplot-x2axis-tick,.jqplot-xaxis-tick,.jqplot-y2axis-tick,.jqplot-y3axis-tick,.jqplot-y4axis-tick,.jqplot-y5axis-tick,.jqplot-y6axis-tick,.jqplot-y7axis-tick,.jqplot-y8axis-tick,.jqplot-y9axis-tick,.jqplot-yaxis-tick{position:absolute}.jqplot-xaxis-tick{top:0;left:15px;vertical-align:top}.jqplot-x2axis-tick{bottom:0;left:15px;vertical-align:bottom}.jqplot-yaxis-tick{right:0;top:15px;text-align:right}.jqplot-y2axis-tick,.jqplot-y3axis-tick,.jqplot-y4axis-tick,.jqplot-y5axis-tick,.jqplot-y6axis-tick,.jqplot-y7axis-tick,.jqplot-y8axis-tick,.jqplot-y9axis-tick{left:0;top:15px;text-align:left}.jqplot-xaxis-label{margin-top:10px;font-size:11pt;position:absolute}.jqplot-x2axis-label{margin-bottom:10px;font-size:11pt;position:absolute}.jqplot-yaxis-label{margin-right:10px}.jqplot-y2axis-label,.jqplot-y3axis-label,.jqplot-y4axis-label,.jqplot-y5axis-label,.jqplot-y6axis-label,.jqplot-y7axis-label,.jqplot-y8axis-label,.jqplot-y9axis-label,.jqplot-yaxis-label{font-size:11pt;position:absolute}table.jqplot-cursor-legend,table.jqplot-table-legend{background-color:hsla(0,0%,100%,.6);border:1px solid #ccc;position:absolute;font-size:.75em}td.jqplot-table-legend{vertical-align:middle}td.jqplot-table-legend>div{border:1px solid #ccc;padding:.2em}div.jqplot-table-legend-swatch{width:0;height:0;border-width:.35em .6em;border-style:solid}.jqplot-title{top:0;left:0;padding-bottom:.5em;font-size:1.2em}table.jqplot-cursor-tooltip{border:1px solid #ccc;font-size:.75em}.jqplot-cursor-tooltip,.jqplot-highlighter-tooltip{border:1px solid #ccc;font-size:.75em;white-space:nowrap;background:hsla(0,0%,81.6%,.5);padding:1px}.jqplot-point-label{font-size:.75em}td.jqplot-cursor-legend-swatch{vertical-align:middle;text-align:center}div.jqplot-cursor-legend-swatch{width:1.2em;height:.7em}.score{text-align:center;width:1.5em;font-size:large;display:inline-block}.score_0{background-color:red}.score_1{background-color:#ff5300}.score_2{background-color:#ff8100}.score_3{background-color:#ffa100}.score_4{background-color:#fb0}.score_5{background-color:#ffd300}.score_6{background-color:#ffec00}.score_7{background-color:#e9fb00}.score_8{background-color:#b1f100}.score_9{background-color:#74e600}.score_10{background-color:#0c0}#rb #backlogs_container{width:100%;display:flex;flex-wrap:wrap;justify-content:space-between}#rb #owner_backlogs_container{min-width:420px;order:2;width:49%;flex:0 0 49%}#rb #sprint_backlogs_container{min-width:420px;width:49%;flex:0 0 49%;min-height:230px}#rb #owner_backlogs_container .backlog .header>.add_new_story{height:28px;line-height:31px;padding:0;position:absolute;right:10px;text-align:right;top:1px;width:100px}#rb #backlogs_container .backlog{border:1px solid #e4e4e4;display:block;margin:0 0 10px;width:100%}.controller-rb_master_backlogs .action-index #content{padding-bottom:180px}#rb #backlogs_container .backlog .header{background-color:#eee;height:30px;position:relative;width:100%}#rb .backlog .header .menu{border-right:1px solid #e4e4e4;cursor:pointer;height:30px;overflow:visible;position:absolute;top:0;right:0;width:30px}#rb .backlog .header .menu .icon-context{position:absolute;top:7px;left:12px}#rb .backlog .header .menu .icon-context:before{padding:0}#rb .backlog .header .menu .icon-context.open+.items{display:block}#rb .backlog .header .menu .items{display:none;background-color:#eee;border:1px solid #e4e4e4;position:absolute;top:30px;right:-2px;list-style:none;margin:0;padding:0;z-index:1000}#rb .backlog .header .menu .item{display:block;width:160px;height:2rem;font-size:.9rem;text-align:left;text-decoration:none;vertical-align:middle;overflow:hidden;white-space:nowrap}#rb .backlog .header .menu .item.hover,#rb .backlog .header .menu .item:hover{background-color:#999}#rb .backlog .header .menu .item a{display:block;height:100%;padding:6px;width:100%}#rb .backlog .header .menu .item.hover a,#rb .backlog .header .menu .item:hover a{color:#fff;text-decoration:none}#rb #backlogs_container .backlog .header .velocity{height:28px;line-height:31px;padding:0 3px 0 9px;position:absolute;right:25px;text-align:right;top:0;width:32px}#rb #backlogs_container .backlog .header .toggler{font-family:openproject-icon-font;height:30px;line-height:31px;padding:0;position:absolute;left:0;top:0;width:23px;cursor:pointer}#rb #backlogs_container .backlog .header .toggler:before{position:absolute;left:6px;top:10px}#rb #backlogs_container .backlog .header .toggler.closed:before{position:absolute;left:6px;top:10px}#rb #backlogs_container .backlog .header .toggler:hover{cursor:pointer;background-color:#d8d8d8}#rb #backlogs_container .backlog .sprint{background-color:transparent;cursor:pointer;display:block;height:29px;width:auto;margin-left:30px;margin-right:50px}#rb #backlogs_container .backlog .sprint.error.icon-bug{background:none;text-align:center}#rb #backlogs_container .backlog .sprint.error.icon-bug:before{position:absolute;color:red}#rb #backlogs_container .backlog .sprint .id,#rb #backlogs_container .backlog .sprint .status{display:none}#rb #backlogs_container .backlog .sprint .name{line-height:2rem;font-weight:700;overflow:hidden;white-space:nowrap;margin-left:.5em}#rb #backlogs_container .backlog .sprint .effective_date,#rb #backlogs_container .backlog .sprint .start_date{float:right;height:28px;line-height:2rem;width:6.5em;margin-left:.5em}#rb #backlogs_container .backlog .stories{list-style:none;min-height:2rem;margin:0;padding:0;z-index:500;overflow-y:auto;overflow-x:hidden}#rb #backlogs_container .backlog .stories.closed{display:none}#rb #backlogs_container .backlog .stories .error.icon.icon-bug{text-align:left}#rb #backlogs_container .stories .story{cursor:move;display:block;font-size:.9rem;margin:0;overflow:hidden;position:relative;width:100%}#rb #backlogs_container .stories .story.odd{background-color:#f6f7f8}#rb #backlogs_container .stories .story.even{background-color:#fff}#rb #backlogs_container .stories .story.error.icon-bug{background:none;text-align:center}#rb #backlogs_container .stories .story.error.icon-bug:before{position:absolute;color:red;pointer-events:none}#rb #backlogs_container .stories .story.hover,#rb #backlogs_container .stories .story:hover{background-color:#fef8a8}#rb #backlogs_container .stories .story.closed{text-decoration:line-through}#rb #backlogs_container .stories .story .id{margin-left:1em;margin-right:1em;width:4em}#rb #backlogs_container .stories .story .id,#rb #backlogs_container .stories .story .type_id .t{float:left;padding:5px 2px 4px;text-align:right;white-space:nowrap}#rb #backlogs_container .stories .story .subject{overflow:hidden;margin-left:4em;padding:5px 2px 4px;white-space:nowrap;min-height:1em}#rb #backlogs_container .stories .story .status_id{float:right;padding:5px 2px 4px;margin-left:1em;width:68px}#rb #backlogs_container .stories .story .story_points{float:right;padding:5px 1rem 4px 2px;width:3.5rem;min-height:14px;height:2rem;text-align:center}#rb #backlogs_container .stories .story .higher_item_id,#rb #backlogs_container .stories .story .id .v,#rb #backlogs_container .stories .story .status_id .v,#rb #backlogs_container .stories .story .type_id .v,#rb #backlogs_container .stories .story .version_id{display:none}.rb_dialog .burndown_chart{margin-top:20px;margin-bottom:20px;margin-left:20px}.rb_dialog #charts{overflow:hidden}.rb_dialog #charts h3{border:0}.rb_dialog #charts fieldset.burndown_control{padding-left:10px;border:none}.rb_dialog #charts .axislabel{font-weight:700}#rb #backlogs_container .sprint.editing .editors,#rb #backlogs_container .sprint.editing>.editor{display:block}#rb #backlogs_container .sprint.editing>*,#rb #backlogs_container .sprint.editing label{display:none}#rb #backlogs_container .sprint.editing+.add_new_story,#rb #backlogs_container .sprint.editing+.velocity{display:none}#rb #backlogs_container .backlog .sprint.editing .editor{font-size:.9rem;line-height:1.5rem;height:30px;margin:0;padding:0}#rb #backlogs_container .backlog .sprint.editing .editor.name{min-width:15em;width:calc(100% - 2 * 85px - 10px)}#rb #backlogs_container .backlog .sprint.editing .editor.effective_date,#rb #backlogs_container .backlog .sprint.editing .editor.start_date{width:85px}#rb #backlogs_container .stories .story.editing>*,#rb #backlogs_container .stories .story.editing>.editors label{display:none}#rb #backlogs_container .stories .story.editing .editors{display:block}#rb #backlogs_container .stories .story.editing input,#rb #backlogs_container .stories .story.editing select{display:inline-block;float:none;margin:5px 3px 4px 2px;font-size:.8rem;line-height:inherit}#rb #backlogs_container .stories .story.editing .type_id.editor{width:15%;max-width:140px}#rb #backlogs_container .stories .story.editing .subject.editor{width:55%}#rb #backlogs_container .stories .story.editing .status_id.editor{width:15%;float:right}#rb #backlogs_container .stories .story.editing .story_points.editor{float:right;width:10%}.controller-rb_master_backlogs.action-show #content,.controller-rb_master_backlogs.action-show #main,.controller-rb_master_backlogs.action-show #rb #backlogs_container .backlog .stories{overflow:visible}.controller-rb_master_backlogs.action-show div.calendar{z-index:10000}.backlog{font-size:.9rem}.controller-rb_taskboards.action-show #main{overflow:visible}#rb .task{color:#484848;line-height:inherit;white-space:inherit}#rb #taskboard{overflow-x:auto}#rb #taskboard #assigned_to_id_options{display:none}#rb #taskboard .swimlane{min-width:105px;padding:5px 0 0 5px;width:105px}#rb #taskboard #board_header{background-color:#ebebeb;border:1px solid #ccc;margin-bottom:0;margin-right:10px}#rb #taskboard #board_header td{background-color:#ebebeb;border-right:1px dotted #cfcfcf;color:#000;font-weight:700;text-align:center;vertical-align:middle;padding-top:0;padding-bottom:0;line-height:30px}#rb #taskboard #board_header td:first-child{min-width:241px;width:241px}#rb #taskboard .board{background-color:#fcfcfc;border:1px solid #ccc;border-top:none;margin-right:10px;table-layout:fixed;border-collapse:collapse;empty-cells:show}#rb #taskboard .board tr:hover{background-color:#fff}#rb #taskboard .board td{border-right:1px dotted #cfcfcf;border-bottom:1px dotted #cfcfcf;vertical-align:top}#rb #taskboard .board td:first-child{min-width:210px;padding:5px;width:210px}#rb #taskboard .board tr:last-child td{border-bottom:none}#rb #taskboard .board .add_new{margin:0;min-width:30px;padding:0;text-align:center;vertical-align:middle;width:30px}#rb #taskboard .board .add_new.clickable:hover{cursor:pointer;background-color:#ffc}#rb #taskboard .label_sprint_impediments,#rb #taskboard .story{background-color:#f8f6a5;border:none;display:block;float:left;height:80px;margin:5px;padding:5px;position:relative;width:190px}#rb #taskboard .story .subject{height:42px;line-height:13px;margin-top:0;overflow:hidden;padding:2px;width:180px}#rb #taskboard .story.closed .subject{text-decoration:line-through}#rb #taskboard .placeholder,#rb #taskboard .work_package{background-color:#afafaf;border:none;cursor:move;display:block;float:left;font-size:10px;height:80px;margin:5px;padding:5px;position:relative;width:85px}#rb #taskboard .work_package.prevent_edit{cursor:default}#rb #taskboard .placeholder{background-color:#ff0;border:1px dashed #330;height:78px;width:83px}#rb #taskboard .work_package.closed .subject.editable{text-decoration:line-through}#rb #taskboard .work_package .v{display:none}#rb #taskboard .work_package .remaining_hours.editable{border:2px solid #fff;background-color:#e00;bottom:-5px;color:#fff;font-size:9px;height:13px;padding-left:5px;padding-right:5px;position:absolute;right:-5px}#rb #taskboard .work_package .blocks,#rb #taskboard .work_package .indicator,#rb #taskboard .work_package .remaining_hours.editable.empty{display:none}#rb #taskboard .work_package.error .indicator{background:none;border:none}#rb #taskboard .work_package.error.icon-bug:before{position:absolute;top:30px;left:28px;color:red}#rb #taskboard .work_package .editors{display:none}.task_editor_dialog.ui-dialog .ui-widget-header{background:none;background-color:#fff;opacity:.5;filter:alpha(opacity=50)}.task_editor_dialog.ui-dialog .ui-dialog-title{float:right;margin-right:0;color:var(--body-font-color)}.task_editor_dialog.ui-dialog.ui-widget-content{background:none;border:none}.task_editor_dialog.ui-dialog.ui-widget-content .editor{color:var(--body-font-color)}.task_editor_dialog.ui-dialog .ui-dialog-buttonpane.ui-widget-content{background:none;background-color:none;border:none}.ui-dialog-titlebar-close{overflow:hidden}.dark #task_editor label{color:#fff}.light #task_editor label{color:#000}.dark div{color:#fff}.light div{color:#000}#task_editor label{display:block;font-size:11px;text-transform:capitalize;width:100%}#task_editor .editor{font-size:11px;margin-bottom:10px;width:100%}#task_editor .subject{height:65px;width:272px}#task_editor .blocks,#task_editor .remaining_hours{width:268px}#rb .compact .label_sprint_impediments,#rb .compact .story{height:15px}#rb .compact .story .subject{display:none}#rb .compact .work_package{height:21px;padding:0;width:21px}#rb .compact .work_package *{display:none}#rb .compact .placeholder{background-color:#ff0;border:1px dashed #330;height:19px;width:19px}#rb #impediment_template,#rb #task_template{display:none}.story .story-bar{background-color:#fff;font-size:1rem-rem-calc(5px);opacity:.8;filter:alpha(opacity=80);overflow:hidden;padding-bottom:1px;padding-right:3px;text-align:right;width:180px;clear:both}.story .story-bar .id{float:right}.story .story-bar .status{float:left}.label_sprint_impediments,.story{font-size:1rem-rem-calc(3px)}.work_package .id{background-color:#fff;font-size:1rem-rem-calc(5px);opacity:.8;filter:alpha(opacity=80);overflow:hidden;padding-bottom:1px;padding-right:3px;text-align:right;width:75px}.work_package .id a{opacity:1;filter:alpha(opacity=100)}.work_package .editable:hover{background-color:transparent}.work_package .subject.editable{font-size:1rem-rem-calc(3px);height:42px;line-height:13px;margin-top:0;overflow:hidden;padding:2px;width:81px}.story .story-footer .assigned_to_id{float:left;font-size:1rem-rem-calc(5px);width:85%;margin-top:4px;padding:0 2px 2px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.story .story-footer .story-points{margin-top:2px;float:right}.work_package .assigned_to_id.editable{float:left;font-size:1rem-rem-calc(5px);width:85%;margin-top:4px;padding:0 2px 2px}.work_package .assigned_to_id.editable .t{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}#toolbar label[for=col_width_input]{padding-top:rem-calc(20px)}#toolbar #col_width_input{max-width:60px}.controller-rb_master_backlogs .ui-dialog-titlebar-close,.controller-rb_taskboards .ui-dialog-titlebar-close{display:none}.controller-rb_master_backlogs .ui-dialog,.controller-rb_taskboards .ui-dialog{background:#fff;border:1px solid #e4e4e4}"],encapsulation:2})},"ii2/":function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("mrSG"),s=i("Mo6U"),r=i("wZYP"),a=i("/8SZ"),c=i("ZsX/"),o=i("iMRi"),l=i("Jui0"),d=i("d/TE"),u=i("LrpJ"),h=i("mMv8"),p=i("qc15"),g=i("r0MM"),f=i("CNq7");class b extends s.a{constructor(){super(...arguments),this.attachmentsBackend=!0}get ancestorIds(){return this.ancestors.map(e=>e.id)}subjectWithType(e=40){return`${this.type?this.type.name+": ":""}${this.subjectWithId(e)}`}subjectWithId(e=40){const t=this.isNew?"":` (#${this.id})`;return`${_.truncate(this.subject,{length:e})}${t}`}get isLeaf(){let e=this.$links.children;return!(e&&e.length>0)}previewPath(){return this.isNew?super.previewPath():this.apiV3Service.work_packages.id(this.id).path}getEditorTypeFor(e){return"description"===e?"full":"constrained"}isParentOf(e){var t;return(null===(t=e.parent)||void 0===t?void 0:t.$links.self.$link.href)===this.$links.self.$link.href}updateLinkedResources(...e){const t={};e.forEach(e=>{const i=this[e];t[e]=i?i.$update():Promise.reject(void 0)});const i=Promise.all(_.values(t));return i.then(()=>{this.wpCacheService.touch(this.id)}),i}$initialize(e){super.$initialize(e);let t=this.attachments||{$source:{},elements:[]};this.attachments=new a.a(this.injector,_.get(t,"$source",t),!1,this.halInitializer,"HalResource")}$linkableKeys(){return _.without(super.$linkableKeys(),"schema")}get state(){return this.states.workPackages.get(this.id)}push(e){return this.wpActivity.clear(e.id),e.parent&&this.apiV3Service.work_packages.id(e.parent).refresh(),this.apiV3Service.work_packages.cache.updateWorkPackage(e)}}Object(n.c)([Object(g.a)(),Object(n.e)("design:type",r.a)],b.prototype,"I18n",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",o.a)],b.prototype,"states",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",h.a)],b.prototype,"wpActivity",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",f.a)],b.prototype,"apiV3Service",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",d.a)],b.prototype,"NotificationsService",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",p.a)],b.prototype,"workPackageNotificationService",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",l.a)],b.prototype,"pathHelper",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",c.a)],b.prototype,"opFileUpload",void 0);const m=Object(u.a)(b)},iuLl:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("fXoL"),s=i("gh2L"),r=i("wZYP"),a=i("sjKJ"),c=i("Jui0"),o=i("ZOsW"),l=i("3Pt+"),d=i("ofXK"),u=i("ximh");const h=function(e){return{selected:e}};function p(e,t){if(1&e){const e=n.ic();n.hc(0,"div",5),n.hc(1,"ul",6),n.hc(2,"li",7),n.pc("click",(function(){n.Lc(e);return n.rc().setMode("all")})),n.cc(3,"a",8),n.gc(),n.hc(4,"li",7),n.pc("click",(function(){n.Lc(e);return n.rc().setMode("recent")})),n.cc(5,"a",8),n.gc(),n.gc(),n.gc()}if(2&e){const e=n.rc();n.Pb(2),n.wc("ngClass",n.Bc(4,h,"all"===e.mode)),n.Pb(1),n.wc("textContent",e.text.all),n.Pb(1),n.wc("ngClass",n.Bc(6,h,"recent"===e.mode)),n.Pb(1),n.wc("textContent",e.text.recent)}}function g(e,t){if(1&e&&(n.cc(0,"b",9),n.Vc(1)),2&e){const e=t.searchTerm,i=n.rc();n.wc("textContent",i.text.add_new_action),n.Pb(1),n.Xc(": ",e," ")}}function f(e,t){if(1&e&&(n.hc(0,"div",10),n.Vc(1),n.gc()),2&e){const e=t.item,i=t.searchTerm;n.wc("ngOptionHighlight",i),n.Pb(1),n.Wc(e.name)}}class b extends s.a{constructor(e,t,i,s){super(e,t,i,s),this.I18n=e,this.cdRef=t,this.currentProject=i,this.pathHelper=s,this.modeSwitch=new n.s,this.loading=!1,this.mode="all",this.text.all=this.I18n.t("js.label_all"),this.text.recent=this.I18n.t("js.label_recent")}setMode(e){e!==this.mode&&this.modeSwitch.emit(e),this.mode=e}}b.\u0275fac=function(e){return new(e||b)(n.bc(r.a),n.bc(n.i),n.bc(a.a),n.bc(c.a))},b.\u0275cmp=n.Vb({type:b,selectors:[["te-work-package-autocompleter"]],outputs:{modeSwitch:"modeSwitch"},features:[n.Mb],decls:6,vars:16,consts:[["bindLabel","name",3,"ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","appendTo","hideSelected","loading","id","ngModelChange","change","open","close","keydown"],["ngSelectComponent",""],["ng-header-tmp",""],["ng-tag-tmp",""],["ng-option-tmp",""],[1,"scrollable-tabs","-narrow"],[1,"tabrow"],[3,"ngClass","click"],["href","#",3,"textContent"],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight"]],template:function(e,t){1&e&&(n.hc(0,"ng-select",0,1),n.pc("ngModelChange",(function(e){return t.model=e}))("change",(function(e){return t.changeModel(e)}))("open",(function(){return t.opened()}))("close",(function(){return t.closed()}))("keydown",(function(e){return t.keyPressed(e)})),n.sc(2,"async"),n.Tc(3,p,6,8,"ng-template",2),n.Tc(4,g,2,2,"ng-template",3),n.Tc(5,f,2,2,"ng-template",4),n.gc()),2&e&&n.wc("ngModel",t.model)("items",t.availableValues)("ngClass",t.classes)("addTag",t.createAllowed)("virtualScroll",!0)("required",t.required)("clearable",!t.required)("disabled",t.disabled)("typeahead",t.typeahead)("clearOnBackspace",!1)("appendTo",t.appendTo)("hideSelected",t.hideSelected)("loading",n.tc(2,14,t.finishedLoading))("id",t.id)},directives:[o.a,l.m,l.p,d.n,l.x,o.g,o.l,o.c,u.a],pipes:[d.a],styles:[".ng-dropdown-panel .ng-dropdown-header{padding-bottom:0}"],encapsulation:2})},iuWW:function(e,t,i){"use strict";i.d(t,"b",(function(){return g})),i.d(t,"a",(function(){return f}));var n=i("XNiG"),s=i("GyhO"),r=i("LRne"),a=i("pLZG"),c=i("/uUt"),o=i("Kj3r"),l=i("vkgz"),d=i("eIep"),u=i("JIr8"),h=i("UXun"),p=i("1G5W");function g(e){return t=>e.handleRawError(t)}class f{constructor(e,t,i=!1,p=250){this.requestHandler=e,this.errorHandler=t,this.preFilterNull=i,this.debounceMs=p,this.input$=new n.a,this.loading$=new n.a,this.lastResult=[],this.output$=Object(s.a)(Object(r.a)([]),this.input$.pipe(Object(a.a)(e=>!i||null!=e),Object(c.a)(),Object(o.a)(p),Object(l.a)(e=>{this.lastRequestedValue=e,this.lastResult=[],this.loading$.next(!0)}),Object(d.a)(e=>this.requestHandler(e).pipe(Object(u.a)(e=>(this.errorHandler(e),Object(r.a)([]))),Object(l.a)(e=>{this.loading$.next(!1),this.lastResult=e}))),Object(h.a)(1)))}request(e){this.input$.next(e)}get hasResults(){return this.lastResult.length>0}observe(e){return this.output$.pipe(Object(p.a)(e))}}},j93F:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));class n{constructor(e,t,i){this.basePath=e,this.segment=t,this.resource=i,this.path=`${this.basePath}/${t}`}id(e){return new(this.resource||s)(this.path,e)}withOptionalId(e){return _.isNil(e)?this:this.id(e)}toString(){return this.path}toPath(){return this.path}}class s{constructor(e,t){this.basePath=e,this.segment=t;let i=t.toString().startsWith("?")?"":"/";this.path=`${this.basePath}${i}${t}`}toString(){return this.path}toPath(){return this.path}}},jEcX:function(e,t,i){"use strict";i.d(t,"b",(function(){return f})),i.d(t,"a",(function(){return b}));i("Mo6U");var n=i("kTsZ"),s=i("wZYP"),r=i("iMRi"),a=i("pLZG"),c=i("AEvm"),o=i("fXoL"),l=i("ofXK"),d=i("5mBr"),u=i("2yvi");function h(e,t){if(1&e&&o.cc(0,"attachment-list",6),2&e){const e=o.rc(2);o.wc("resource",e.resource)("destroyImmediately",e.destroyImmediately)}}function p(e,t){if(1&e&&o.cc(0,"attachments-upload",7),2&e){const e=o.rc(2);o.wc("resource",e.resource)}}function g(e,t){if(1&e&&(o.hc(0,"fieldset",1),o.hc(1,"legend",2),o.Vc(2),o.gc(),o.hc(3,"div",3),o.Tc(4,h,1,2,"attachment-list",4),o.Tc(5,p,1,1,"attachments-upload",5),o.gc(),o.gc()),2&e){const e=o.rc();o.Pb(2),o.Xc(" ",e.text.attachments," "),o.Pb(2),o.wc("ngIf",e.resource.attachments),o.Pb(1),o.wc("ngIf",e.allowUploading)}}const f="attachments";class b extends c.a{constructor(e,t,i,n){super(),this.elementRef=e,this.I18n=t,this.states=i,this.halResourceService=n,this.text={attachments:this.I18n.t("js.label_attachments")}}ngOnInit(){if(this.$element=jQuery(this.elementRef.nativeElement),!this.resource){const e=this.$element.data("resource");this.resource=this.halResourceService.createHalResource(e,!0)}this.allowUploading=this.$element.data("allow-uploading"),void 0!==this.$element.data("destroy-immediately")?this.destroyImmediately=this.$element.data("destroy-immediately"):this.destroyImmediately=!0,this.setupResourceUpdateListener()}setupResourceUpdateListener(){this.states.forResource(this.resource).changes$().pipe(this.untilDestroyed(),Object(a.a)(e=>!!e)).subscribe(e=>{this.resource=e||this.resource})}showAttachments(){return this.allowUploading||_.get(this.resource,"attachments.count",0)>0}}b.\u0275fac=function(e){return new(e||b)(o.bc(o.q),o.bc(s.a),o.bc(r.a),o.bc(n.a))},b.\u0275cmp=o.Vb({type:b,selectors:[["attachments"]],inputs:{resource:"resource"},features:[o.Mb],decls:1,vars:1,consts:[["class","form--fieldset",4,"ngIf"],[1,"form--fieldset"],[1,"form--fieldset-legend"],["id","attachments_fields"],[3,"resource","destroyImmediately",4,"ngIf"],["class","hide-when-print",3,"resource",4,"ngIf"],[3,"resource","destroyImmediately"],[1,"hide-when-print",3,"resource"]],template:function(e,t){1&e&&o.Tc(0,g,6,3,"fieldset",0),2&e&&o.wc("ngIf",t.showAttachments())},directives:[l.q,d.a,u.a],encapsulation:2})},jQQo:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("fXoL"),s=i("wZYP"),r=i("OW6k"),a=i("AEvm"),c=i("VRyK"),o=i("8OyR"),l=i("9Ejp"),d=i("ofXK"),u=i("ZOsW");const h=["ngSelectComponent"];function p(e,t){if(1&e){const e=n.ic();n.hc(0,"div",5),n.cc(1,"span",6),n.hc(2,"a",7),n.pc("click",(function(){n.Lc(e);const i=t.$implicit;return n.rc().remove(i)})),n.gc(),n.gc()}if(2&e){const e=t.$implicit;n.Pb(1),n.wc("textContent",e.name)}}class g extends a.a{constructor(e,t){super(),this.I18n=e,this.dragula=t,this.autofocus=!0,this._selected=[],this.onChange=new n.s,this.availableOptions=[],this.text={placeholder:this.I18n.t("js.label_add_columns")}}ngOnInit(){this.updateAvailableOptions(),this.columnsGroup=this.dragula.createGroup("columns",{}),this.dragula.drag("columns").pipe(this.untilDestroyed()).subscribe(()=>o.a.setBodyCursor("move","important")),Object(c.a)(this.dragula.drop("columns"),this.dragula.cancel("columns")).pipe(this.untilDestroyed()).subscribe(()=>o.a.setBodyCursor("auto"));const e=this;this.autoscroll=new r.a([document.getElementById("content-wrapper")],{margin:25,maxSpeed:10,scrollWhenOutside:!0,autoScroll:function(){return this.down&&e.columnsGroup.drake.dragging}})}ngAfterViewInit(){this.autofocus&&this.ngSelectComponent.focus()}ngOnDestroy(){super.ngOnDestroy(),this.dragula.destroy("columns")}select(e){e&&(this.selected=[...this.selected,e],this.ngSelectComponent.clearModel())}remove(e){this.selected=this.selected.filter(t=>t.id!==e.id)}get selected(){return this._selected}set selected(e){this._selected=e,this.updateAvailableOptions(),this.onChange.emit(this.selected)}opened(){setTimeout(()=>{const e=this.ngSelectComponent;e&&e.dropdownPanel&&e.dropdownPanel._updatePosition()},25)}updateAvailableOptions(){this.availableOptions=this.options.filter(e=>!this.selected.find(t=>t.id===e.id))}}g.\u0275fac=function(e){return new(e||g)(n.bc(s.a),n.bc(l.c))},g.\u0275cmp=n.Vb({type:g,selectors:[["draggable-autocompleter"]],viewQuery:function(e,t){var i;(1&e&&n.ad(h,!0),2&e)&&(n.Ic(i=n.qc())&&(t.ngSelectComponent=i.first))},inputs:{options:"options",autofocus:"autofocus",_selected:["selected","_selected"]},outputs:{onChange:"onChange"},features:[n.Mb],decls:5,vars:8,consts:[[1,"draggable-autocomplete--container"],["dragula","columns",1,"draggable-autocomplete--selected",3,"dragulaModel","dragulaModelChange"],["class","draggable-autocomplete--item",4,"ngFor","ngForOf"],["ngClass","draggable-autocomplete--input","bindLabel","name","appendTo","body",3,"items","multiple","virtualScroll","placeholder","clearSearchOnAdd","closeOnSelect","open","change"],["ngSelectComponent",""],[1,"draggable-autocomplete--item"],[1,"draggable-autocomplete--item-text",3,"textContent"],[1,"draggable-autocomplete--remove-item","icon-remove",3,"click"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.pc("dragulaModelChange",(function(e){return t.selected=e})),n.Tc(2,p,3,1,"div",2),n.gc(),n.hc(3,"ng-select",3,4),n.pc("open",(function(){return t.opened()}))("change",(function(e){return t.select(e)})),n.gc(),n.gc()),2&e&&(n.Pb(1),n.wc("dragulaModel",t.selected),n.Pb(1),n.wc("ngForOf",t.selected),n.Pb(1),n.wc("items",t.availableOptions)("multiple",!1)("virtualScroll",!0)("placeholder",t.text.placeholder)("clearSearchOnAdd",!0)("closeOnSelect",!0))},directives:[l.a,d.p,u.a,d.n],styles:[".draggable-autocomplete--selected[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;padding-bottom:1rem}.draggable-autocomplete--item[_ngcontent-%COMP%]{padding:5px;margin-right:5px;margin-bottom:5px;min-width:50px;border:1px solid #ddd;background:#f8f8f8;cursor:move;font-size:14px;display:flex;align-items:center;justify-content:space-between}.draggable-autocomplete--item[_ngcontent-%COMP%]   .draggable-autocomplete--remove-item[_ngcontent-%COMP%]{font-size:8px;color:#999;padding-left:5px}"],changeDetection:0})},jW2i:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("mrSG"),s=i("zcj1");class r{constructor(e){this.pathHelper=e,this.ifcModels=window.gon.ifc_models}getProjects(e,t){e({projects:this.ifcModels.projects})}getProject(e,t,i){t({id:e[0].id,name:e[0].name,models:this.ifcModels.models,viewerContent:{modelsLoaded:this.ifcModels.shown_models},viewerConfigs:{saoEnabled:!0}})}getMetadata(e,t,i,n){const r=this.ifcModels.metadata_attachment_ids[t];console.log("Loading model metadata for: "+r),s.a.loadJSON(this.pathHelper.attachmentContentPath(r),i,n)}getGeometry(e,t,i,n){const r=this.ifcModels.xkt_attachment_ids[t];console.log("Loading model geometry for: "+r),s.a.loadArraybuffer(this.pathHelper.attachmentContentPath(r),i,n)}}var a=i("lfyH"),c=i("2Vo4"),o=i("Jui0"),l=i("3VS2"),d=i("r0MM"),u=i("mY05"),h=i("LRne"),p=i("fXoL");class g extends a.a{constructor(e){super(e),this.injector=e,this.shouldShowViewer=!0,this.viewerVisible$=new c.a(!1)}newViewer(e,t){i.e(35).then(i.bind(null,"/vtK")).then(i=>{let n=new r(this.pathHelper),s=new i.BIMViewer(n,e);s.on("queryPicked",e=>{alert(`IFC Name = "${e.objectName}"\nIFC class = "${e.objectType}"\nIFC GUID = ${e.objectId}`)}),s.on("modelLoaded",()=>this.viewerVisible$.next(!0)),s.loadProject(t[0].id),this.viewer=s})}destroy(){this.viewerVisible$.complete(),this.viewer&&(this.viewer.destroy(),this.viewer=void 0)}get viewer(){return this._viewer}set viewer(e){this._viewer=e}setKeyboardEnabled(e){this.viewer.setKeyboardEnabled(e)}getViewpoint$(){const e=this.viewer.saveBCFViewpoint({spacesVisible:!0});return delete e.bitmaps,Object(h.a)(e)}showViewpoint(e,t){this.routeWithViewer?this.viewer&&this.viewpointsService.getViewPoint$(e,t).subscribe(e=>this.viewer.loadBCFViewpoint(e,{})):window.location.href=this.pathHelper.bimDetailsPath(e.project.idFromLink,e.id,t)}viewerVisible(){return!!this.viewer}}g.\u0275fac=function(e){return new(e||g)(p.lc(p.A))},g.\u0275prov=p.Xb({token:g,factory:g.\u0275fac}),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",o.a)],g.prototype,"pathHelper",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",l.a)],g.prototype,"bcfApi",void 0),Object(n.c)([Object(d.a)(),Object(n.e)("design:type",u.a)],g.prototype,"viewpointsService",void 0)},juWA:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("8zkO"),s=i("wZYP"),r=i("f0Wu"),a=i("fXoL");class c{constructor(e,t){this.ConfigurationService=e,this.I18n=t,this.setupLocale()}setupLocale(){r.locale(I18n.locale)}parseDatetime(e,t){var i=r.utc(e,t);return this.ConfigurationService.isTimezoneSet()&&(i.local(),i.tz(this.ConfigurationService.timezone())),i}parseDate(e,t){return r(e,t)}parseLocalDateTime(e,t){var i;return t=t||this.getTimeFormat(),(i=this.ConfigurationService.isTimezoneSet()?r.tz(e,t,this.ConfigurationService.timezone()):r(e,t)).utc(),i}parseISODatetime(e){return this.parseDatetime(e,"YYYY-MM-DDTHH:mm:ssZ")}parseISODate(e){return this.parseDate(e,"YYYY-MM-DD")}formattedDate(e){return this.parseDate(e).format(this.getDateFormat())}inThePast(e){return this.daysFromToday(e)<=-1}daysFromToday(e){const t=this.parseDate(e),i=r().startOf("day");return t.diff(i,"days")}formattedTime(e){return this.parseDatetime(e).format(this.getTimeFormat())}formattedDatetime(e){var t=this.formattedDatetimeComponents(e);return t[0]+" "+t[1]}formattedDatetimeComponents(e){var t=this.parseDatetime(e);return[t.format(this.getDateFormat()),t.format(this.getTimeFormat())]}toHours(e){return Number(r.duration(e).asHours().toFixed(2))}formattedDuration(e){return this.I18n.t("js.units.hour",{count:this.toHours(e)})}formattedISODate(e){return this.parseDate(e).format("YYYY-MM-DD")}formattedISODateTime(e){return e.format()}isValidISODate(e){return this.isValid(e,"YYYY-MM-DD")}isValidISODateTime(e){return this.isValid(e,"YYYY-MM-DDTHH:mm:ssZ")}isValid(e,t){var i=t||this.getDateFormat();return r(e,[i],!0).isValid()}getDateFormat(){return this.ConfigurationService.dateFormatPresent()?this.ConfigurationService.dateFormat():"L"}getTimeFormat(){return this.ConfigurationService.timeFormatPresent()?this.ConfigurationService.timeFormat():"LT"}}c.\u0275fac=function(e){return new(e||c)(a.lc(n.a),a.lc(s.a))},c.\u0275prov=a.Xb({token:c,factory:c.\u0275fac,providedIn:"root"})},k1Xe:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("iMRi"),s=i("Kg8T"),r=i("fXoL"),a=i("wZYP"),c=i("E2tj"),o=i("3Pt+");class l{constructor(e,t,i,n){this.states=e,this.querySpace=t,this.authorisationService=i,this.I18n=n,this.onChange=new r.s,this.text={showInMenu:this.I18n.t("js.label_star_query"),visibleForOthers:this.I18n.t("js.label_public_query"),showInMenuText:this.I18n.t("js.work_packages.query.star_text"),visibleForOthersText:this.I18n.t("js.work_packages.query.public_text")}}get canStar(){return this.isSave||this.authorisationService.can("query","star")||this.authorisationService.can("query","unstar")}get canPublish(){const e=this.querySpace.queryForm.value;return this.authorisationService.can("query","updateImmediately")&&e.schema.public.writable}updateStarred(e){this.isStarred=e,this.changed()}updatePublic(e){this.isPublic=e,this.changed()}changed(){this.onChange.emit({isStarred:!!this.isStarred,isPublic:!!this.isPublic})}}l.\u0275fac=function(e){return new(e||l)(r.bc(n.a),r.bc(c.a),r.bc(s.a),r.bc(a.a))},l.\u0275cmp=r.Vb({type:l,selectors:[["query-sharing-form"]],inputs:{isSave:"isSave",isStarred:"isStarred",isPublic:"isPublic"},outputs:{onChange:"onChange"},decls:14,vars:8,consts:[[1,"form--field"],[1,"form--field-container","-vertical"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","name","is_public","id","show-public",1,"form--check-box",3,"ngModel","disabled","ngModelChange"],[1,"form--field-instructions","-no-margin",3,"textContent"],["type","checkbox","name","show_in_menu","id","show-in-menu",1,"form--check-box",3,"ngModel","disabled","ngModelChange"]],template:function(e,t){1&e&&(r.hc(0,"div",0),r.hc(1,"div",1),r.hc(2,"label",2),r.hc(3,"div",3),r.hc(4,"input",4),r.pc("ngModelChange",(function(e){return t.updatePublic(e)})),r.gc(),r.gc(),r.Vc(5),r.gc(),r.cc(6,"div",5),r.gc(),r.gc(),r.hc(7,"div",0),r.hc(8,"div",1),r.hc(9,"label",2),r.hc(10,"div",3),r.hc(11,"input",6),r.pc("ngModelChange",(function(e){return t.updateStarred(e)})),r.gc(),r.gc(),r.Vc(12),r.gc(),r.cc(13,"div",5),r.gc(),r.gc()),2&e&&(r.Pb(4),r.wc("ngModel",t.isPublic)("disabled",!t.canPublish),r.Pb(1),r.Xc(" ",t.text.visibleForOthers," "),r.Pb(1),r.wc("textContent",t.text.visibleForOthersText),r.Pb(5),r.wc("ngModel",t.isStarred)("disabled",!t.canStar),r.Pb(1),r.Xc(" ",t.text.showInMenu," "),r.Pb(1),r.wc("textContent",t.text.showInMenuText))},directives:[o.a,o.m,o.p],encapsulation:2})},k8lp:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("fXoL"),s=i("5Mgc"),r=i("d/TE"),a=i("wZYP"),c=i("8zkO"),o=i("ofXK");const l=["opCkeditorReplacementContainer"],d=["codeMirrorPane"];function u(e,t){if(1&e&&(n.hc(0,"div",6),n.hc(1,"div",7),n.hc(2,"p"),n.cc(3,"strong",8),n.cc(4,"br"),n.cc(5,"span",8),n.gc(),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(3),n.wc("textContent",e.text.errorTitle),n.Pb(2),n.wc("textContent",e.error)}}class h{constructor(e,t,i,s,r){this.elementRef=e,this.Notifications=t,this.I18n=i,this.configurationService=s,this.ckEditorSetup=r,this.ckEditorType="full",this.onInitialized=new n.s,this.onContentChange=new n.s,this.onInitializationFailed=new n.s,this.error=null,this.allowManualMode=!1,this.manualMode=!1,this.text={errorTitle:this.I18n.t("js.editor.error_initialization_failed")},this.debouncedEmitter=_.debounce(()=>{this.getTransformedContent(!1).then(e=>{this.onContentChange.emit(e)})},1e3,{leading:!0})}getRawData(){return this.manualMode?this._content=this.codeMirrorInstance.getValue():this._content=this.ckEditorInstance.getData({trim:!1})}getTransformedContent(e=!0){if(!this.initialized)throw"Tried to access CKEditor instance before initialization.";return new Promise((t,i)=>{try{t(this.getRawData())}catch(n){console.error(`Failed to save CKEditor content: ${n}.`);let t=this.I18n.t("js.editor.error_saving_failed",{error:n||this.I18n.t("js.error.internal")});e&&this.Notifications.addError(t),i(t)}})}set content(e){if(!this.initialized)throw"Tried to access CKEditor instance before initialization.";this._content=e,this.ckEditorInstance.setData(e)}get content(){return this._content}get initialized(){return void 0!==this.ckEditorInstance}ngOnInit(){try{this.initializeEditor()}catch(e){console.error("Failed to setup CKEditor instance: "+e),this.error=e,this.onInitializationFailed.emit(e)}}initializeEditor(){this.$element=jQuery(this.elementRef.nativeElement);const e=this.ckEditorSetup.create(this.ckEditorType,this.opCkeditorReplacementContainer.nativeElement,this.context,this.content).catch(e=>{throw e}).then(e=>(this.ckEditorInstance=e,e.model.document.on("change",this.debouncedEmitter),e.on("op:source-code-enabled",()=>this.enableManualMode()),e.on("op:source-code-disabled",()=>this.disableManualMode()),this.onInitialized.emit(e),e));this.$element.data("editor",e)}disableManualMode(){const e=this.getRawData();this.ckEditorInstance.setData(e),this.codeMirrorInstance=null,this.manualMode=!1}enableManualMode(){const e=this.getRawData();Promise.all([i.e(0).then(i.t.bind(null,"VrN/",7)),i("TKcc")("./gfm/gfm.js")]).then(t=>{const i=t[0].default;this.codeMirrorInstance=i(this.$element.find(".ck-editor__source")[0],{lineNumbers:!0,smartIndent:!0,value:e,mode:""}),this.codeMirrorInstance.on("change",this.debouncedEmitter),setTimeout(()=>this.codeMirrorInstance.refresh(),100),this.manualMode=!0})}}h.\u0275fac=function(e){return new(e||h)(n.bc(n.q),n.bc(r.a),n.bc(a.a),n.bc(c.a),n.bc(s.a))},h.\u0275cmp=n.Vb({type:h,selectors:[["op-ckeditor"]],viewQuery:function(e,t){var i;(1&e&&(n.Rc(l,!0),n.ad(d,!0)),2&e)&&(n.Ic(i=n.qc())&&(t.opCkeditorReplacementContainer=i.first),n.Ic(i=n.qc())&&(t.codeMirrorPane=i.first))},inputs:{ckEditorType:"ckEditorType",context:"context",_content:["content","_content"]},outputs:{onInitialized:"onInitialized",onContentChange:"onContentChange",onInitializationFailed:"onInitializationFailed"},decls:7,vars:1,consts:[["class","notification-box -error",4,"ngIf"],[1,"op-ckeditor-source-element","document-editor"],["opCkeditorReplacementContainer",""],[1,"document-editor__toolbar"],[1,"document-editor__editable-container"],[1,"document-editor__editable"],[1,"notification-box","-error"],[1,"notification-box--content"],[3,"textContent"]],template:function(e,t){1&e&&(n.fc(0),n.Tc(1,u,6,2,"div",0),n.hc(2,"div",1,2),n.cc(4,"div",3),n.hc(5,"div",4),n.cc(6,"div",5),n.gc(),n.gc(),n.ec()),2&e&&(n.Pb(1),n.wc("ngIf",t.error))},directives:[o.q],styles:[".op-ckeditor--mode-switch[_ngcontent-%COMP%]{text-align:right}.op-ckeditor--mode-switch[_ngcontent-%COMP%]   button.button[_ngcontent-%COMP%]{margin:0 0 5px}"]})},kTg4:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("wZYP"),s=i("Jui0"),r=i("sjKJ"),a=i("iB+3"),c=i("vK8y"),o=i("fXoL");class l{constructor(e,t,i,n,s){this.I18n=e,this.$state=t,this.CurrentProject=i,this.PathHelper=n,this.CurrentUserService=s,this.text={assignee:this.I18n.t("js.work_packages.properties.assignee"),author:this.I18n.t("js.work_packages.properties.author"),created_at:this.I18n.t("js.work_packages.properties.createdAt"),updated_at:this.I18n.t("js.work_packages.properties.updatedAt"),status:this.I18n.t("js.work_packages.properties.status"),work_packages:this.I18n.t("js.label_work_package_plural"),gantt:this.I18n.t("js.timelines.gantt_chart"),latest_activity:this.I18n.t("js.work_packages.default_queries.latest_activity"),created_by_me:this.I18n.t("js.work_packages.default_queries.created_by_me"),assigned_to_me:this.I18n.t("js.work_packages.default_queries.assigned_to_me"),recently_created:this.I18n.t("js.work_packages.default_queries.recently_created"),all_open:this.I18n.t("js.work_packages.default_queries.all_open"),summary:this.I18n.t("js.work_packages.default_queries.summary")}}get all(){let e=[{identifier:"all_open",label:this.text.all_open,query_props:null},{identifier:"latest_activity",label:this.text.latest_activity,query_props:'{"c":["id","subject","type","status","assignee","updatedAt"],"hi":false,"g":"","t":"updatedAt:desc","f":[{"n":"status","o":"o","v":[]}]}'},{identifier:"gantt",label:this.text.gantt,query_props:'{"c":["id","type","subject","status","startDate","dueDate"],"tv":true,"tzl":"auto","tll":"{\\"left\\":\\"startDate\\",\\"right\\":\\"dueDate\\",\\"farRight\\":\\"subject\\"}","hi":true,"g":"","t":"startDate:asc","f":[{"n":"status","o":"o","v":[]}]}'},{identifier:"recently_created",label:this.text.recently_created,query_props:'{"c":["id","subject","type","status","assignee","createdAt"],"hi":false,"g":"","t":"createdAt:desc","f":[{"n":"status","o":"o","v":[]}]}'}];const t=this.CurrentProject.identifier;return t&&e.push({identifier:"summary",label:this.text.summary,static_link:this.PathHelper.projectWorkPackagesPath(t)+"/report"}),this.CurrentUserService.isLoggedIn&&(e=e.concat([{identifier:"created_by_me",label:this.text.created_by_me,query_props:'{"c":["id","subject","type","status","assignee","updatedAt"],"hi":false,"g":"","t":"updatedAt:desc,id:asc","f":[{"n":"status","o":"o","v":[]},{"n":"author","o":"=","v":["me"]}]}'},{identifier:"assigned_to_me",label:this.text.assigned_to_me,query_props:'{"c":["id","subject","type","status","author","updatedAt"],"hi":false,"g":"","t":"updatedAt:desc,id:asc","f":[{"n":"status","o":"o","v":[]},{"n":"assigneeOrGroup","o":"=","v":["me"]}]}'}])),e}getStaticName(e){if(this.$state.params.query_props){let e=JSON.parse(this.$state.params.query_props);delete e.pp,delete e.pa;let t=JSON.stringify(e);const i=_.find(this.all,e=>e.query_props&&e.query_props===t);if(i)return i.label}return 1===e.filters.length&&"status"===e.filters[0].id&&"o"===e.filters[0].operator.id?this.text.all_open:this.text.work_packages}}l.\u0275fac=function(e){return new(e||l)(o.lc(n.a),o.lc(a.StateService),o.lc(r.a),o.lc(s.a),o.lc(c.a))},l.\u0275prov=o.Xb({token:l,factory:l.\u0275fac})},kTsZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("mrSG"),s=i("tk/3"),r=i("lJxs"),a=i("JIr8"),c=i("z6cu"),o=i("Mo6U"),l=i("BtrP"),d=i("Ng29"),u=i("16wW"),h=i("qHU1"),p=i("PZVJ"),g=i("fXoL");class f{constructor(e,t){this.injector=e,this.http=t,this.config={}}request(e,t,i,n={}){if("get"===e)return this.get(t,i,n);const s={body:i||{},headers:n,withCredentials:!0,responseType:"json"};return this._request(e,t,s)}_request(e,t,i){return this.http.request(e,t,i).pipe(Object(r.a)(e=>this.createHalResource(e)),Object(a.a)(i=>{Object(h.c)(()=>console.error(`Failed to ${e} ${t}: ${i.name}`));const n=this.createHalResource(i.error);return n.httpError=i,Object(c.a)(n)}))}get(e,t,i){const n={headers:i,params:new s.f({encoder:new d.a,fromObject:t}),withCredentials:!0,responseType:"json"};return this._request("get",e,n)}getAllPaginated(e,t,i={},s={}){return Object(n.b)(this,void 0,void 0,(function*(){let n=0,r=1;const a=[];for(i.pageSize=t;n<t;){i.offset=r;const t=this.request("get",e,this.toEprops(i),s).toPromise(),c=yield t;if(0===c.count)throw"No more results for this query, but expected more.";a.push(c),n+=c.count,r+=1}return a}))}put(e,t,i){return this.request("put",e,t,i)}post(e,t,i){return this.request("post",e,t,i)}patch(e,t,i){return this.request("patch",e,t,i)}delete(e,t,i){return this.request("delete",e,t,i)}registerResource(e,t){this.config[e]=t}get defaultClass(){return o.a}createHalResource(e,t=!0){_.isNil(e)&&(e=o.a.getEmptyResource());const i=e._type||"HalResource";return this.createHalResourceOfType(i,e,t)}createHalResourceOfType(e,t,i=!1){return new(this.getResourceClassOfType(e))(this.injector,t,i,e=>Object(p.b)(this,e),e)}createHalResourceOfClass(e,t,i=!1){const n=t._type||"HalResource";return new e(this.injector,t,i,e=>Object(p.b)(this,e),n)}fromLink(e){const t=o.a.getEmptyResource(l.a.fromObject(this,e));return this.createHalResource(t,!1)}fromSelfLink(e){const t={_links:{self:{href:e}}};return this.createHalResource(t)}createLinkedResource(e,t,i){const n=o.a.getEmptyResource(),s=e.$halType,r=this.getResourceClassOfAttribute(s,t)||"HalResource";return n._links.self=i,this.createHalResourceOfType(r,n,!1)}getResourceClassOfType(e){const t=this.config[e];return t&&t.cls?t.cls:this.defaultClass}getResourceClassOfAttribute(e,t){const i=this.config[e];return(i&&i.attrTypes||{})[t]}toEprops(e){let t=u.deflate(JSON.stringify(e),{to:"string"});return{eprops:btoa(t)}}}f.\u0275fac=function(e){return new(e||f)(g.lc(g.A),g.lc(s.b))},f.\u0275prov=g.Xb({token:f,factory:f.\u0275fac,providedIn:"root"})},"kY/U":function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));i("ii2/");var n=i("kTsZ"),s=(i("RWlv"),i("mMv8")),r=i("SKFm"),a=i("dMmB"),c=i("/C7M"),o=i("qc15"),l=i("CNq7"),d=i("fXoL");class u{constructor(e,t,i,n,s,r,a){this.halResourceService=e,this.apiV3Service=t,this.wpSchemaCacheService=i,this.wpActivity=n,this.notificationService=s,this.halEditing=r,this.halEvents=a}fetchAction(){this.halResourceService.get(this.action.href).toPromise().then(e=>{this.action=e})}update(){let e={lockVersion:this.workPackage.lockVersion,_links:{workPackage:{href:this.workPackage.href}}};this.halResourceService.post(this.action.href+"/execute",e).subscribe(e=>{this.notificationService.showSave(e,!1),this.workPackage=e,this.wpActivity.clear(this.workPackage.id),this.apiV3Service.work_packages.cache.updateWorkPackage(e).then(()=>{this.halEditing.stopEditing(e),this.halEvents.push(e,{eventType:"updated"})})},e=>this.notificationService.handleRawError(e,this.workPackage))}onMouseEnter(){this.fetchAction()}}u.\u0275fac=function(e){return new(e||u)(d.bc(n.a),d.bc(l.a),d.bc(a.a),d.bc(s.a),d.bc(o.a),d.bc(r.a),d.bc(c.a))},u.\u0275cmp=d.Vb({type:u,selectors:[["wp-custom-action"]],hostBindings:function(e,t){1&e&&d.pc("mouseenter",(function(){return t.onMouseEnter()}))},inputs:{workPackage:"workPackage",action:"action"},decls:2,vars:2,consts:[[1,"custom-action--button","button","-narrow","hide-when-print",3,"title","click"]],template:function(e,t){1&e&&(d.hc(0,"button",0),d.pc("click",(function(){return t.update()})),d.Vc(1),d.gc()),2&e&&(d.xc("title",t.action.description?t.action.description:t.action.name),d.Pb(1),d.Xc(" ",t.action.name,"\n"))},encapsulation:2})},kZPr:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("zOhy"),s=i("fXoL"),r=i("ofXK"),a=i("711n"),c=i("XZlt"),o=i("qvi4"),l=i("1zMF"),d=i("aveh"),u=i("2bW2");const h=function(){return["status","type"]};function p(e,t){if(1&e){const e=s.ic();s.hc(0,"div",1),s.hc(1,"edit-form",2),s.pc("onSaved",(function(t){s.Lc(e);return s.rc().onSaved(t)})),s.hc(2,"div",3),s.hc(3,"div",4),s.cc(4,"wp-type-status",5),s.gc(),s.hc(5,"ul",6),s.hc(6,"li",7),s.cc(7,"zen-mode-toggle-button"),s.gc(),s.hc(8,"li",7),s.hc(9,"button",8),s.cc(10,"i",9),s.gc(),s.gc(),s.gc(),s.gc(),s.cc(11,"wp-single-view",10),s.hc(12,"wp-edit-actions-bar",11),s.pc("onCancel",(function(){s.Lc(e);return s.rc().cancelAndBackToList()})),s.gc(),s.gc(),s.gc()}if(2&e){const e=s.rc();s.Pb(1),s.wc("resource",e.newWorkPackage)("skippedFields",s.Ac(7,h))("inEditMode",!0),s.Pb(3),s.wc("workPackage",e.newWorkPackage),s.Pb(5),s.Qb("title",e.text.button_settings),s.Pb(2),s.wc("workPackage",e.newWorkPackage)("showProject",e.copying)}}class g extends n.a{constructor(){super(...arguments),this.successState="work-packages.show"}}g.\u0275fac=function(e){return f(e||g)},g.\u0275cmp=s.Vb({type:g,selectors:[["wp-new-full-view"]],hostAttrs:[1,"work-packages-page--ui-view"],features:[s.Mb],decls:1,vars:1,consts:[["class","work-package--new-state work-packages--new work-packages--show-view toolbar-container",4,"ngIf"],[1,"work-package--new-state","work-packages--new","work-packages--show-view","toolbar-container"],[3,"resource","skippedFields","inEditMode","onSaved"],[1,"toolbar"],[1,"title-container"],[3,"workPackage"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-mobile"],["id","create-wp-menu-button","wpCreateSettingsMenu","",1,"button","last","work-packages-settings-button","toolbar-icon"],[1,"button--icon","icon-show-more"],[3,"workPackage","showProject"],[3,"onCancel"]],template:function(e,t){1&e&&s.Tc(0,p,13,8,"div",0),2&e&&s.wc("ngIf",t.newWorkPackage)},directives:[r.q,a.a,c.a,o.a,l.a,d.a,u.a],encapsulation:2,changeDetection:0});const f=s.jc(g)},kgyZ:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("XNiG"),s=i("AEvm");class r extends s.a{constructor(){super(...arguments),this.onDestroy=new n.a,this._onSubmitHandlers=[]}onSubmit(){return Promise.all(this._onSubmitHandlers.map(e=>e()))}registerOnSubmit(e){this._onSubmitHandlers.push(e)}previewContext(e){}}},kor4:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("fXoL"),s=i("E5Dd");class r{constructor(){this.stopEventPropagation=!0,this.onClick=new n.s}handleClick(e){"click"!==e.type&&e.which!==s.a.ENTER&&e.which!==s.a.SPACE||(this.stopEventPropagation&&(e.preventDefault(),e.stopPropagation()),this.onClick.emit(e))}}r.\u0275fac=function(e){return new(e||r)},r.\u0275dir=n.Wb({type:r,selectors:[["","accessibleClick",""]],hostBindings:function(e,t){1&e&&n.pc("click",(function(e){return t.handleClick(e)}))("keydown",(function(e){return t.handleClick(e)}))},inputs:{stopEventPropagation:["accessibleClickStopEvent","stopEventPropagation"]},outputs:{onClick:"accessibleClick"}})},kt6C:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("8zkO"),s=i("fXoL");const r=6,a=1;class c{constructor(e){this.configuration=e,this.loadPaginationOptions()}getCachedPerPage(e){const t=this.localStoragePerPage,i=(null==e?void 0:e.length)||0;return null!==t&&t>0&&(0===i||-1!==(null==e?void 0:e.indexOf(t)))?t:i>0?e[0]:20}get localStoragePerPage(){const e=window.OpenProject.guardedLocalStorage("pagination.perPage");return void 0!==e?parseInt(e,10):null}getPaginationOptions(){return this.paginationOptions}get isPerPageKnown(){return!(!this.localStoragePerPage&&!this.paginationOptions)}getPerPage(){return this.localStoragePerPage||this.paginationOptions.perPage}getMaxVisiblePageOptions(){return _.get(this.paginationOptions,"maxVisiblePageOptions",r)}getOptionsTruncationSize(){return _.get(this.paginationOptions,"optionsTruncationSize",a)}setPerPage(e){window.OpenProject.guardedLocalStorage("pagination.perPage",e.toString()),this.paginationOptions.perPage=e}getPerPageOptions(){return this.paginationOptions.perPageOptions}setPerPageOptions(e){this.paginationOptions.perPageOptions=e}loadPaginationOptions(){return this.configuration.initialized.then(()=>(this.paginationOptions={perPage:this.getCachedPerPage(this.configuration.perPageOptions),perPageOptions:this.configuration.perPageOptions,maxVisiblePageOptions:r,optionsTruncationSize:a},this.paginationOptions))}}c.\u0275fac=function(e){return new(e||c)(s.lc(n.a))},c.\u0275prov=s.Xb({token:c,factory:c.\u0275fac})},l08T:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("FnNU"),s=i("1G5W"),r=i("fXoL");class a{constructor(){this.state=Object(n.g)(!1)}get visible(){return this.state.getValueOr(!1)}set visible(e){this.state.putValue(e)}observeUntil(e){return this.state.values$().pipe(Object(s.a)(e))}toggleVisibility(){this.state.doModify(e=>!e)}}a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=r.Xb({token:a,factory:a.\u0275fac})},"l4W+":function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("kTsZ"),s=i("fXoL");class r{constructor(e){this.halResourceService=e}restoreQuery(e,t){this.restoreFilters(e,t.payload,t.schema),this.restoreColumns(e,t.payload,t.schema),this.restoreSortBy(e,t.payload,t.schema),this.restoreGroupBy(e,t.payload,t.schema),this.restoreOtherProperties(e,t.payload)}restoreFilters(e,t,i){let n=_.map(t.filters,e=>{let t=_.find(i.filtersSchemas.elements,t=>t.filter.allowedValues[0].$href===e.filter.$href);if(!t)return null;let n=t.getFilter(),s=_.find(t.operator.allowedValues,t=>t.$href===e.operator.$href);return s&&(n.operator=s),n.values.length=0,_.each(e.values,e=>n.values.push(e)),n});n=_.compact(n),e.filters.length=0,_.each(n,t=>e.filters.push(t))}restoreColumns(e,t,i){let n=_.map(t.columns,e=>_.find(i.columns.allowedValues,t=>t.$href===e.$href));n=_.compact(n),e.columns.length=0,_.each(n,t=>e.columns.push(t))}restoreSortBy(e,t,i){let n=_.map(t.sortBy,e=>_.find(i.sortBy.allowedValues,t=>t.$href===e.$href));n=_.compact(n),e.sortBy.length=0,_.each(n,t=>e.sortBy.push(t))}restoreGroupBy(e,t,i){let n=_.find(i.groupBy.allowedValues,e=>t.groupBy&&t.groupBy.$href===e.$href);e.groupBy=n}restoreOtherProperties(e,t){_.without(Object.keys(t.$source),"_links","filters").forEach(i=>{e[i]=t[i]}),_.without(Object.keys(t.$source._links),"columns","groupBy","sortBy").forEach(i=>{e[i]=t[i]})}}r.\u0275fac=function(e){return new(e||r)(s.lc(n.a))},r.\u0275prov=s.Xb({token:r,factory:r.\u0275fac})},lJGx:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));i("ii2/");var n=i("CNq7"),s=i("AEvm"),r=i("fXoL"),a=i("ofXK"),c=i("kY/U");function o(e,t){if(1&e&&r.cc(0,"wp-custom-action",1),2&e){const e=t.$implicit,i=r.rc();r.wc("workPackage",i.workPackage)("action",e)}}class l extends s.a{constructor(e,t){super(),this.apiV3Service=e,this.cdRef=t,this.actions=[]}ngOnInit(){this.apiV3Service.work_packages.id(this.workPackage.id).requireAndStream().pipe(this.untilDestroyed()).subscribe(e=>{this.actions=e.customActions?[...e.customActions]:[],this.cdRef.detectChanges()})}}l.\u0275fac=function(e){return new(e||l)(r.bc(n.a),r.bc(r.i))},l.\u0275cmp=r.Vb({type:l,selectors:[["wp-custom-actions"]],inputs:{workPackage:"workPackage"},features:[r.Mb],decls:1,vars:1,consts:[["class","custom-action",3,"workPackage","action",4,"ngFor","ngForOf"],[1,"custom-action",3,"workPackage","action"]],template:function(e,t){1&e&&r.Tc(0,o,1,2,"wp-custom-action",0),2&e&&r.wc("ngForOf",t.actions)},directives:[a.p,c.a],encapsulation:2,changeDetection:0})},lJrL:function(e,t,i){"use strict";function n(...e){let t=document.createElement("i");return t.setAttribute("aria-hidden","true"),t.classList.add(...e),t}i.d(t,"a",(function(){return n}))},lfQJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("0lDN"),s=i("fXoL"),r=i("ofXK"),a=i("kor4"),c=i("N5AO");function o(e,t){1&e&&s.cc(0,"li",5)}function l(e,t){if(1&e&&s.cc(0,"op-icon",10),2&e){const e=s.rc(2).$implicit;s.yc("icon-classes","icon-action-menu ",e.icon,"")}}function d(e,t){if(1&e&&s.cc(0,"op-icon",11),2&e){const e=s.rc(2).$implicit;s.yc("icon-classes","icon-action-menu-post ",e.postIcon,""),s.wc("icon-title",e.postIconTitle||"")}}const u=function(e){return{inactive:e}};function h(e,t){if(1&e){const e=s.ic();s.hc(0,"li"),s.hc(1,"a",6),s.pc("accessibleClick",(function(t){s.Lc(e);const i=s.rc().$implicit;return s.rc().handleClick(i,t)})),s.Tc(2,l,1,1,"op-icon",7),s.cc(3,"span",8),s.Tc(4,d,1,2,"op-icon",9),s.gc(),s.gc()}if(2&e){const e=s.rc().$implicit;s.Pb(1),s.Rb("menu-item ",e.class,""),s.wc("ngClass",s.Bc(11,u,e.disabled))("accessibleClickStopEvent",!1),s.Qb("href",e.href||"",s.Oc)("aria-disabled",e.disabled)("aria-label",e.ariaLabel||e.linkText),s.Pb(1),s.wc("ngIf",e.icon),s.Pb(1),s.wc("textContent",e.linkText),s.Pb(1),s.wc("ngIf",e.postIcon)}}function p(e,t){if(1&e&&(s.fc(0),s.Tc(1,o,1,0,"li",3),s.Tc(2,h,5,13,"li",4),s.ec()),2&e){const e=t.$implicit;s.Pb(1),s.wc("ngIf",e.divider),s.Pb(1),s.wc("ngIf",!e.divider)}}const g=function(e){return{"-empty":e}};class f{constructor(e){this.locals=e,this.items=this.locals.items.filter(e=>!(null==e?void 0:e.hidden)),this.service=this.locals.service}handleClick(e,t){return!e.disabled&&!e.divider&&(!e.onClick(t)||(this.locals.service.close(),t.preventDefault(),t.stopPropagation(),!1))}}f.\u0275fac=function(e){return new(e||f)(s.bc(n.a))},f.\u0275cmp=s.Vb({type:f,selectors:[["ng-component"]],decls:3,vars:5,consts:[["ng-class","{'dropdown-anchor-right': locals.showAnchorRight}",1,"dropdown-relative","dropdown","-overflow-in-view"],["role","menu",1,"dropdown-menu",3,"ngClass"],[4,"ngFor","ngForOf"],["class","dropdown-divider",4,"ngIf"],[4,"ngIf"],[1,"dropdown-divider"],["tabindex","0",3,"ngClass","accessibleClickStopEvent","accessibleClick"],[3,"icon-classes",4,"ngIf"],[3,"textContent"],[3,"icon-title","icon-classes",4,"ngIf"],[3,"icon-classes"],[3,"icon-title","icon-classes"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"ul",1),s.Tc(2,p,3,2,"ng-container",2),s.gc(),s.gc()),2&e&&(s.Qb("id",t.locals.contextMenuId),s.Pb(1),s.wc("ngClass",s.Bc(3,g,0===t.items.length)),s.Pb(1),s.wc("ngForOf",t.items))},directives:[r.n,r.p,r.q,a.a,c.a],encapsulation:2})},lfyH:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("mrSG"),s=i("r0MM"),r=i("iB+3"),a=i("fXoL");class c{constructor(e){this.injector=e}get routeWithViewer(){return this.state.includes("bim.partitioned.split")}}c.\u0275fac=function(e){return new(e||c)(a.lc(a.A))},c.\u0275prov=a.Xb({token:c,factory:c.\u0275fac}),Object(n.c)([Object(s.a)(),Object(n.e)("design:type",r.StateService)],c.prototype,"state",void 0)},lmDM:function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n=i("mRSd"),s=i("wZYP"),r=i("kt6C"),a=i("Zq3F"),c=i("6yP5"),o=i("E2tj"),l=i("itXk"),d=i("fXoL"),u=i("ofXK"),h=i("kor4"),p=i("N5AO");function g(e,t){if(1&e){const e=d.ic();d.hc(0,"li",15),d.hc(1,"a",16),d.pc("accessibleClick",(function(){d.Lc(e);const i=t.$implicit;return d.rc(3).showPage(i)})),d.gc(),d.gc()}if(2&e){const e=t.$implicit;d.Pb(1),d.wc("textContent",e)}}function f(e,t){if(1&e&&(d.fc(0),d.Tc(1,g,2,1,"li",13),d.hc(2,"li",14),d.Vc(3,"\u2026"),d.gc(),d.ec()),2&e){const e=d.rc(2);d.Pb(1),d.wc("ngForOf",e.prePageNumbers)}}function b(e,t){if(1&e&&(d.hc(0,"em"),d.Vc(1),d.gc()),2&e){const e=d.rc().$implicit;d.Pb(1),d.Wc(e)}}function m(e,t){if(1&e){const e=d.ic();d.hc(0,"a",16),d.pc("accessibleClick",(function(){d.Lc(e);const t=d.rc().$implicit;return d.rc(3).showPage(t)})),d.gc()}if(2&e){const e=d.rc().$implicit;d.wc("textContent",e)}}const w=function(e){return{"-current":e}};function v(e,t){if(1&e&&(d.hc(0,"li",19),d.Tc(1,b,2,1,"em",6),d.Tc(2,m,1,1,"a",20),d.gc()),2&e){const e=t.$implicit,i=d.rc(3);d.wc("ngClass",d.Bc(3,w,e==i.pagination.page)),d.Pb(1),d.wc("ngIf",e==i.pagination.page),d.Pb(1),d.wc("ngIf",e!=i.pagination.page)}}function y(e,t){1&e&&(d.hc(0,"li",14),d.Vc(1,"\u2026"),d.gc())}function k(e,t){if(1&e&&(d.fc(0),d.Tc(1,v,3,5,"li",17),d.Tc(2,y,2,0,"li",18),d.ec()),2&e){const e=d.rc(2);d.Pb(1),d.wc("ngForOf",e.pageNumbers),d.Pb(1),d.wc("ngIf",e.postPageNumbers.length)}}function C(e,t){if(1&e){const e=d.ic();d.hc(0,"li",22),d.hc(1,"a",16),d.pc("accessibleClick",(function(){d.Lc(e);const i=t.$implicit;return d.rc(3).showPage(i)})),d.gc(),d.gc()}if(2&e){const e=t.$implicit;d.Pb(1),d.wc("textContent",e)}}function j(e,t){if(1&e&&(d.fc(0),d.Tc(1,C,2,1,"li",21),d.ec()),2&e){const e=d.rc(2);d.Pb(1),d.wc("ngForOf",e.postPageNumbers)}}function P(e,t){if(1&e&&d.cc(0,"span",23),2&e){const e=d.rc(2);d.wc("textContent",e.text.no_other_page)}}function x(e,t){if(1&e&&(d.hc(0,"li",24),d.cc(1,"op-icon",25),d.cc(2,"span",9),d.gc()),2&e){const e=d.rc(2);d.Pb(2),d.wc("textContent",e.infoText)}}function S(e,t){if(1&e){const e=d.ic();d.hc(0,"span"),d.hc(1,"a",30),d.pc("accessibleClick",(function(){d.Lc(e);const t=d.rc().$implicit;return d.rc(3).selectPerPage(t)})),d.gc(),d.gc()}if(2&e){const e=d.rc().$implicit;d.Pb(1),d.wc("textContent",e)}}function _(e,t){if(1&e&&(d.hc(0,"span"),d.Vc(1),d.gc()),2&e){const e=d.rc().$implicit;d.Pb(1),d.Wc(e)}}function O(e,t){if(1&e&&(d.hc(0,"li",29),d.Tc(1,S,2,1,"span",6),d.Tc(2,_,2,1,"span",6),d.gc()),2&e){const e=t.$implicit,i=d.rc(3);d.wc("ngClass",d.Bc(3,w,e==i.pagination.perPage)),d.Pb(1),d.wc("ngIf",e!=i.pagination.perPage),d.Pb(1),d.wc("ngIf",e==i.pagination.perPage)}}function I(e,t){if(1&e&&(d.hc(0,"div",26),d.hc(1,"ul",3),d.cc(2,"li",27),d.Tc(3,O,3,5,"li",28),d.gc(),d.gc()),2&e){const e=d.rc(2);d.Pb(2),d.xc("title",e.text.per_page),d.wc("textContent",e.text.per_page),d.Pb(1),d.wc("ngForOf",e.perPageOptions)}}function T(e,t){if(1&e){const e=d.ic();d.hc(0,"div",1),d.hc(1,"nav",2),d.hc(2,"ul",3),d.hc(3,"li",4),d.hc(4,"a",5),d.pc("accessibleClick",(function(){d.Lc(e);const t=d.rc();return t.showPage(t.pagination.page-1)})),d.Vc(5,"<"),d.gc(),d.gc(),d.Tc(6,f,4,1,"ng-container",6),d.Tc(7,k,3,2,"ng-container",6),d.Tc(8,j,2,1,"ng-container",6),d.hc(9,"li",4),d.hc(10,"a",7),d.pc("accessibleClick",(function(){d.Lc(e);const t=d.rc();return t.showPage(t.pagination.page+1)})),d.Vc(11,">"),d.gc(),d.gc(),d.hc(12,"li",8),d.cc(13,"span",9),d.Tc(14,P,1,1,"span",10),d.gc(),d.Tc(15,x,3,1,"li",11),d.gc(),d.gc(),d.Tc(16,I,4,3,"div",12),d.gc()}if(2&e){const e=d.rc();d.Pb(3),d.wc("hidden",1==e.pagination.page||!e.showPageSelections),d.Pb(1),d.Qb("aria-label",e.text.label_previous),d.Pb(2),d.wc("ngIf",e.prePageNumbers.length>0),d.Pb(1),d.wc("ngIf",e.pageNumbers.length>1),d.Pb(1),d.wc("ngIf",e.postPageNumbers.length),d.Pb(1),d.wc("hidden",!(e.pagination.total&&e.pagination.page<e.pageNumbers[e.pageNumbers.length-1])),d.Pb(1),d.Qb("aria-label",e.text.label_next),d.Pb(3),d.wc("textContent",e.currentRange),d.Pb(1),d.wc("ngIf",1===e.pageNumbers.length),d.Pb(1),d.wc("ngIf",e.infoText),d.Pb(1),d.wc("ngIf",e.showPerPageOptions())}}class R extends n.a{constructor(e,t,i,n,s,r){super(e,t,r),this.paginationService=e,this.cdRef=t,this.wpTablePagination=i,this.querySpace=n,this.wpTableSortBy=s,this.I18n=r}ngOnInit(){this.paginationService.loadPaginationOptions().then(e=>{this.perPageOptions=e.perPageOptions,this.cdRef.detectChanges()}),this.wpTablePagination.live$().pipe(this.untilDestroyed()).subscribe(e=>{this.pagination=e.current,this.update()}),Object(l.a)([this.querySpace.query.values$(),this.wpTableSortBy.live$()]).pipe(this.untilDestroyed()).subscribe(([e,t])=>{this.showPerPage=this.showPageSelections=!this.isManualSortingMode,this.infoText=this.paginationInfoText(e.results),this.update()})}selectPerPage(e){this.paginationService.setPerPage(e),this.wpTablePagination.updateFromObject({page:1,perPage:e})}showPage(e){this.wpTablePagination.updateFromObject({page:e})}get isManualSortingMode(){return this.wpTableSortBy.isManualSortingMode}paginationInfoText(e){return this.isManualSortingMode&&e.count<e.total?I18n.t("js.work_packages.limited_results",{count:e.count}):void 0}}R.\u0275fac=function(e){return new(e||R)(d.bc(r.a),d.bc(d.i),d.bc(a.a),d.bc(o.a),d.bc(c.a),d.bc(s.a))},R.\u0275cmp=d.Vb({type:R,selectors:[["wp-table-pagination"]],features:[d.Mb],decls:1,vars:1,consts:[["class","pagination",4,"ngIf"],[1,"pagination"],[1,"pagination--pages"],[1,"pagination--items"],[1,"pagination--item",3,"hidden"],["rel","prev start","id","pagination--prev-link","role","link","href","",3,"accessibleClick"],[4,"ngIf"],["rel","next","id","pagination--next-link","role","link","href","",1,"pagination--next-link",3,"accessibleClick"],[1,"pagination--range"],[3,"textContent"],["id","pagination-empty-text","tabindex","0","class","hidden-for-sighted",3,"textContent",4,"ngIf"],["class","pagination--info",4,"ngIf"],["class","pagination--options",4,"ngIf"],["class","pagination--item",4,"ngFor","ngForOf"],[1,"pagination--space"],[1,"pagination--item"],["rel","next","role","link","href","",3,"textContent","accessibleClick"],["class","pagination--item pagination-number",3,"ngClass",4,"ngFor","ngForOf"],["class","pagination--space",4,"ngIf"],[1,"pagination--item","pagination-number",3,"ngClass"],["rel","next","role","link","href","",3,"textContent","accessibleClick",4,"ngIf"],["class","pagination--item pagination-number",4,"ngFor","ngForOf"],[1,"pagination--item","pagination-number"],["id","pagination-empty-text","tabindex","0",1,"hidden-for-sighted",3,"textContent"],[1,"pagination--info"],["icon-classes","icon-info1 icon-context"],[1,"pagination--options"],[1,"pagination--label",3,"textContent","title"],["class","pagination--item",3,"ngClass",4,"ngFor","ngForOf"],[1,"pagination--item",3,"ngClass"],["role","link","href","",3,"textContent","accessibleClick"]],template:function(e,t){1&e&&d.Tc(0,T,17,11,"div",0),2&e&&d.wc("ngIf",t.pagination&&t.isVisible&&t.pagination.total)},directives:[u.q,h.a,u.p,u.n,p.a],encapsulation:2,changeDetection:0})},lmKF:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));var n=i("fXoL"),s=i("tk/3"),r=i("wZYP"),a=i("qHU1"),c=i("AEvm"),o=i("ofXK"),l=i("N5AO");const d=["progressBar"],u=["progressPercentage"];function h(e,t){1&e&&n.cc(0,"op-icon",8)}function p(e,t){1&e&&n.cc(0,"op-icon",9)}function g(e,t){if(1&e&&(n.hc(0,"span",5),n.Tc(1,h,1,0,"op-icon",6),n.Tc(2,p,1,0,"op-icon",7),n.gc()),2&e){const e=n.rc();n.Pb(1),n.wc("ngIf",e.error),n.Pb(1),n.wc("ngIf",e.completed)}}class f extends c.a{constructor(e){super(),this.I18n=e,this.onError=new n.s,this.onSuccess=new n.s,this.error=!1,this.completed=!1}set value(e){this.progressBar.nativeElement.value=e,this.progressPercentage.nativeElement.innerText=e+"%",100===e&&(this.progressBar.nativeElement.style.display="none")}ngOnInit(){this.file=this.upload[0];this.upload[1].pipe(this.untilDestroyed()).subscribe(e=>{switch(e.type){case s.e.Sent:return this.value=5,Object(a.a)(`Uploading file "${this.file.name}" of size ${this.file.size}.`);case s.e.UploadProgress:return this.updateProgress(e);case s.e.Response:return Object(a.a)(`File ${this.fileName} was fully uploaded.`),this.value=100,this.completed=!0,this.onSuccess.emit();default:return}},e=>this.handleError(e))}get fileName(){return this.file&&this.file.name}updateProgress(e){e.total?this.value=Math.round(e.loaded/e.total*100):this.value=10}handleError(e){this.error=!0,this.onError.emit(e)}}f.\u0275fac=function(e){return new(e||f)(n.bc(r.a))},f.\u0275cmp=n.Vb({type:f,selectors:[["notifications-upload-progress"]],viewQuery:function(e,t){var i;(1&e&&(n.ad(d,!0),n.ad(u,!0)),2&e)&&(n.Ic(i=n.qc())&&(t.progressBar=i.first),n.Ic(i=n.qc())&&(t.progressPercentage=i.first))},inputs:{upload:"upload"},outputs:{onError:"onError",onSuccess:"onSuccess"},features:[n.Mb],decls:8,vars:2,consts:[[1,"filename",3,"textContent"],["max","100","value","0"],["progressBar",""],["progressPercentage",""],["class","upload-completed",4,"ngIf"],[1,"upload-completed"],["icon-classes","icon-close",4,"ngIf"],["icon-classes","icon-checkmark",4,"ngIf"],["icon-classes","icon-close"],["icon-classes","icon-checkmark"]],template:function(e,t){1&e&&(n.hc(0,"li"),n.cc(1,"span",0),n.cc(2,"progress",1,2),n.hc(4,"p",null,3),n.Vc(6,"0%"),n.gc(),n.Tc(7,g,3,2,"span",4),n.gc()),2&e&&(n.Pb(1),n.wc("textContent",t.fileName),n.Pb(6),n.wc("ngIf",t.completed||t.error))},directives:[o.q,l.a],encapsulation:2})},m0WY:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("wZYP"),s=(i("ii2/"),i("1uah")),r=i("1G5W"),a=i("IzEk"),c=i("uSJ+"),o=i("AEvm"),l=i("Hg4z"),d=i("CNq7"),u=i("fXoL"),h=i("ofXK"),p=i("4fzr"),g=i("BV52"),f=i("60np");function b(e,t){if(1&e&&(u.hc(0,"div",5),u.hc(1,"div",6),u.hc(2,"div",7),u.cc(3,"h3",8),u.gc(),u.gc(),u.gc()),2&e){const e=u.rc();u.Pb(3),u.wc("textContent",e.text.relations_header)}}function m(e,t){if(1&e){const e=u.ic();u.hc(0,"div"),u.hc(1,"wp-relations-group",9),u.pc("onToggleGroupBy",(function(){u.Lc(e);return u.rc().toggleGroupBy()})),u.gc(),u.gc()}if(2&e){const e=t.$implicit,i=t.first,n=u.rc();u.Pb(1),u.wc("header",e)("groupByWorkPackageType",n.groupByWorkPackageType)("firstGroup",i)("relatedWorkPackages",n.relationGroups[e])("workPackage",n.workPackage)}}function w(e,t){if(1&e&&u.cc(0,"wp-relations-create",4),2&e){const e=u.rc();u.wc("workPackage",e.workPackage)}}class v extends o.a{constructor(e,t,i,n){super(),this.I18n=e,this.wpRelations=t,this.cdRef=i,this.apiV3Service=n,this.relationGroups={},this.relationGroupKeys=[],this.relationsPresent=!1,this.groupByWorkPackageType=!1,this.text={relations_header:this.I18n.t("js.work_packages.tabs.relations")},this.currentRelations=[]}ngOnInit(){this.canAddRelation=!!this.workPackage.addRelation,this.wpRelations.state(this.workPackage.id).values$().pipe(Object(r.a)(Object(l.b)(this))).subscribe(e=>{this.loadedRelations(e)}),this.wpRelations.require(this.workPackage.id),this.apiV3Service.work_packages.id(this.workPackage).requireAndStream().pipe(Object(r.a)(Object(l.b)(this))).subscribe(e=>{this.workPackage=e})}getRelatedWorkPackages(e){let t=e.map(e=>this.apiV3Service.work_packages.id(e).get());return Object(s.a)(...t)}getRelatedWorkPackageId(e){const t=e.ids;return e.to.href===this.workPackage.href?t.from:t.to}toggleGroupBy(){this.groupByWorkPackageType=!this.groupByWorkPackageType,this.buildRelationGroups()}buildRelationGroups(){_.isNil(this.currentRelations)||(this.relationGroups=_.groupBy(this.currentRelations,e=>{if(this.groupByWorkPackageType)return e.type.name;var t=e.relatedBy.normalizedType(this.workPackage);return this.I18n.t("js.relation_labels."+t)}),this.relationGroupKeys=_.keys(this.relationGroups),this.relationsPresent=_.size(this.relationGroups)>0,this.cdRef.detectChanges())}loadedRelations(e){var t=[],i=[];if(0===_.size(e))return this.currentRelations=[],this.buildRelationGroups();_.each(e,e=>{const n=this.getRelatedWorkPackageId(e);t.push(n),i[n]=e}),this.getRelatedWorkPackages(t).pipe(Object(a.a)(1)).subscribe(e=>{this.currentRelations=e.map(e=>(e.relatedBy=i[e.id],e)),this.buildRelationGroups()})}}v.\u0275fac=function(e){return new(e||v)(u.bc(n.a),u.bc(c.a),u.bc(u.i),u.bc(d.a))},v.\u0275cmp=u.Vb({type:v,selectors:[["wp-relations"]],inputs:{workPackage:"workPackage"},features:[u.Mb],decls:5,vars:4,consts:[["data-indicator-name","relation-groups",1,"loading-indicator--location"],["class","wp-relations-hierarchy-section",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"workPackage",4,"ngIf"],[3,"workPackage"],[1,"wp-relations-hierarchy-section"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],[3,"header","groupByWorkPackageType","firstGroup","relatedWorkPackages","workPackage","onToggleGroupBy"]],template:function(e,t){1&e&&(u.hc(0,"div",0),u.Tc(1,b,4,1,"div",1),u.Tc(2,m,2,5,"div",2),u.Tc(3,w,1,1,"wp-relations-create",3),u.cc(4,"wp-relations-hierarchy",4),u.gc()),2&e&&(u.Pb(1),u.wc("ngIf",!t.relationsPresent),u.Pb(1),u.wc("ngForOf",t.relationGroupKeys),u.Pb(1),u.wc("ngIf",t.canAddRelation),u.Pb(1),u.wc("workPackage",t.workPackage))},directives:[h.q,h.p,p.a,g.a,f.a],encapsulation:2,changeDetection:0})},m3nR:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("SKFm"),s=i("wZYP"),r=(i("ii2/"),i("fXoL")),a=i("8+xT"),c=i("P7xQ"),o=i("N5AO");class l{constructor(e,t){this.I18n=e,this.halEditing=t,this.text={button_more:this.I18n.t("js.button_more")}}}l.\u0275fac=function(e){return new(e||l)(r.bc(s.a),r.bc(n.a))},l.\u0275cmp=r.Vb({type:l,selectors:[["wp-details-toolbar"]],inputs:{workPackage:"workPackage"},decls:5,vars:5,consts:[[1,"work-packages--details-toolbar"],[3,"workPackage","showText"],["wpSingleContextMenu","",1,"button","dropdown-relative",3,"wpSingleContextMenu-workPackage"],[1,"button--text",3,"textContent"],["icon-classes","button--dropdown-indicator"]],template:function(e,t){1&e&&(r.hc(0,"div",0),r.cc(1,"wp-watcher-button",1),r.hc(2,"button",2),r.cc(3,"span",3),r.cc(4,"op-icon",4),r.gc(),r.gc()),2&e&&(r.Pb(1),r.wc("workPackage",t.workPackage)("showText",!0),r.Pb(1),r.wc("wpSingleContextMenu-workPackage",t.workPackage),r.Qb("accesskey",7),r.Pb(1),r.wc("textContent",t.text.button_more))},directives:[a.a,c.a,o.a],encapsulation:2})},mMv8:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));class n{constructor(e,t,i,n,s){this.timezoneService=e,this.isReversed=t,this.activities=i,this.activity=n,this.index=s}number(e=!1){return this.orderedIndex(this.index,e)}get date(){return this.activityDate(this.activity)}get dateOfPrevious(){if(this.index>0)return this.activityDate(this.activities[this.index-1])}get href(){return this.activity.href}get identifier(){return`${this.href}-${this.version}`}get version(){return this.activity.version}get isNextDate(){return this.date!==this.dateOfPrevious}isInitial(e=!1){var t=this.number(e);if(0!==this.activity._type.indexOf("Activity"))return!1;if(1===t)return!0;for(;--t>0;){var i=this.orderedIndex(t,e)-1,n=this.activities[i];if(!_.isNil(n)&&0===n._type.indexOf("Activity"))return!1}return!0}activityDate(e){return moment(e.createdAt).format("LL")}orderedIndex(e,t=!1){return t||this.isReversed?this.activities.length-e:e+1}}var s=i("8zkO"),r=i("hgso"),a=i("juWA"),c=i("fXoL");class o extends r.a{constructor(e,t){super(),this.ConfigurationService=e,this.timezoneService=t}get order(){return this.isReversed?"desc":"asc"}get isReversed(){return this.ConfigurationService.commentsSortedInDescendingOrder()}load(e){var t=[],i=[],n=function(e){t.push(e.elements)};return i.push(e.activities.$update().then(n)),e.revisions&&i.push(e.revisions.$update().then(n)),Promise.all(i).then(()=>this.sortedActivityList(t))}sortedActivityList(e,t="createdAt"){let i=_.sortBy(_.flatten(e),t);return this.isReversed?i.reverse():i}info(e,t,i){return new n(this.timezoneService,this.isReversed,e,t,i)}}o.\u0275fac=function(e){return new(e||o)(c.lc(s.a),c.lc(a.a))},o.\u0275prov=c.Xb({token:o,factory:o.\u0275fac})},mRSd:function(e,t,i){"use strict";i.d(t,"a",(function(){return O}));var n=i("kt6C"),s=i("U/vl"),r=i("fXoL"),a=i("wZYP"),c=i("AEvm"),o=i("ofXK"),l=i("kor4"),d=i("N5AO");function u(e,t){if(1&e){const e=r.ic();r.hc(0,"li",15),r.hc(1,"a",16),r.pc("accessibleClick",(function(){r.Lc(e);const i=t.$implicit;return r.rc(3).showPage(i)})),r.gc(),r.gc()}if(2&e){const e=t.$implicit;r.Pb(1),r.wc("textContent",e)}}function h(e,t){if(1&e&&(r.fc(0),r.Tc(1,u,2,1,"li",13),r.hc(2,"li",14),r.Vc(3,"\u2026"),r.gc(),r.ec()),2&e){const e=r.rc(2);r.Pb(1),r.wc("ngForOf",e.prePageNumbers)}}function p(e,t){if(1&e&&(r.hc(0,"em"),r.Vc(1),r.gc()),2&e){const e=r.rc().$implicit;r.Pb(1),r.Wc(e)}}function g(e,t){if(1&e){const e=r.ic();r.hc(0,"a",16),r.pc("accessibleClick",(function(){r.Lc(e);const t=r.rc().$implicit;return r.rc(3).showPage(t)})),r.gc()}if(2&e){const e=r.rc().$implicit;r.wc("textContent",e)}}const f=function(e){return{"-current":e}};function b(e,t){if(1&e&&(r.hc(0,"li",19),r.Tc(1,p,2,1,"em",6),r.Tc(2,g,1,1,"a",20),r.gc()),2&e){const e=t.$implicit,i=r.rc(3);r.wc("ngClass",r.Bc(3,f,e==i.pagination.page)),r.Pb(1),r.wc("ngIf",e==i.pagination.page),r.Pb(1),r.wc("ngIf",e!=i.pagination.page)}}function m(e,t){1&e&&(r.hc(0,"li",14),r.Vc(1,"\u2026"),r.gc())}function w(e,t){if(1&e&&(r.fc(0),r.Tc(1,b,3,5,"li",17),r.Tc(2,m,2,0,"li",18),r.ec()),2&e){const e=r.rc(2);r.Pb(1),r.wc("ngForOf",e.pageNumbers),r.Pb(1),r.wc("ngIf",e.postPageNumbers.length)}}function v(e,t){if(1&e){const e=r.ic();r.hc(0,"li",22),r.hc(1,"a",16),r.pc("accessibleClick",(function(){r.Lc(e);const i=t.$implicit;return r.rc(3).showPage(i)})),r.gc(),r.gc()}if(2&e){const e=t.$implicit;r.Pb(1),r.wc("textContent",e)}}function y(e,t){if(1&e&&(r.fc(0),r.Tc(1,v,2,1,"li",21),r.ec()),2&e){const e=r.rc(2);r.Pb(1),r.wc("ngForOf",e.postPageNumbers)}}function k(e,t){if(1&e&&r.cc(0,"span",23),2&e){const e=r.rc(2);r.wc("textContent",e.text.no_other_page)}}function C(e,t){if(1&e&&(r.hc(0,"li",24),r.cc(1,"op-icon",25),r.cc(2,"span",9),r.gc()),2&e){const e=r.rc(2);r.Pb(2),r.wc("textContent",e.infoText)}}function j(e,t){if(1&e){const e=r.ic();r.hc(0,"span"),r.hc(1,"a",30),r.pc("accessibleClick",(function(){r.Lc(e);const t=r.rc().$implicit;return r.rc(3).selectPerPage(t)})),r.gc(),r.gc()}if(2&e){const e=r.rc().$implicit;r.Pb(1),r.wc("textContent",e)}}function P(e,t){if(1&e&&(r.hc(0,"span"),r.Vc(1),r.gc()),2&e){const e=r.rc().$implicit;r.Pb(1),r.Wc(e)}}function x(e,t){if(1&e&&(r.hc(0,"li",29),r.Tc(1,j,2,1,"span",6),r.Tc(2,P,2,1,"span",6),r.gc()),2&e){const e=t.$implicit,i=r.rc(3);r.wc("ngClass",r.Bc(3,f,e==i.pagination.perPage)),r.Pb(1),r.wc("ngIf",e!=i.pagination.perPage),r.Pb(1),r.wc("ngIf",e==i.pagination.perPage)}}function S(e,t){if(1&e&&(r.hc(0,"div",26),r.hc(1,"ul",3),r.cc(2,"li",27),r.Tc(3,x,3,5,"li",28),r.gc(),r.gc()),2&e){const e=r.rc(2);r.Pb(2),r.xc("title",e.text.per_page),r.wc("textContent",e.text.per_page),r.Pb(1),r.wc("ngForOf",e.perPageOptions)}}function _(e,t){if(1&e){const e=r.ic();r.hc(0,"div",1),r.hc(1,"nav",2),r.hc(2,"ul",3),r.hc(3,"li",4),r.hc(4,"a",5),r.pc("accessibleClick",(function(){r.Lc(e);const t=r.rc();return t.showPage(t.pagination.page-1)})),r.Vc(5,"<"),r.gc(),r.gc(),r.Tc(6,h,4,1,"ng-container",6),r.Tc(7,w,3,2,"ng-container",6),r.Tc(8,y,2,1,"ng-container",6),r.hc(9,"li",4),r.hc(10,"a",7),r.pc("accessibleClick",(function(){r.Lc(e);const t=r.rc();return t.showPage(t.pagination.page+1)})),r.Vc(11,">"),r.gc(),r.gc(),r.hc(12,"li",8),r.cc(13,"span",9),r.Tc(14,k,1,1,"span",10),r.gc(),r.Tc(15,C,3,1,"li",11),r.gc(),r.gc(),r.Tc(16,S,4,3,"div",12),r.gc()}if(2&e){const e=r.rc();r.Pb(3),r.wc("hidden",1==e.pagination.page||!e.showPageSelections),r.Pb(1),r.Qb("aria-label",e.text.label_previous),r.Pb(2),r.wc("ngIf",e.prePageNumbers.length>0),r.Pb(1),r.wc("ngIf",e.pageNumbers.length>1),r.Pb(1),r.wc("ngIf",e.postPageNumbers.length),r.Pb(1),r.wc("hidden",!(e.pagination.total&&e.pagination.page<e.pageNumbers[e.pageNumbers.length-1])),r.Pb(1),r.Qb("aria-label",e.text.label_next),r.Pb(3),r.wc("textContent",e.currentRange),r.Pb(1),r.wc("ngIf",1===e.pageNumbers.length),r.Pb(1),r.wc("ngIf",e.infoText),r.Pb(1),r.wc("ngIf",e.showPerPageOptions())}}class O extends c.a{constructor(e,t,i){super(),this.paginationService=e,this.cdRef=t,this.I18n=i,this.hideForSinglePageResults=!1,this.showPerPage=!0,this.showPageSelections=!0,this.updateResults=new r.s,this.text={label_previous:this.I18n.t("js.pagination.pages.previous"),label_next:this.I18n.t("js.pagination.pages.next"),per_page:this.I18n.t("js.label_per_page"),no_other_page:this.I18n.t("js.pagination.no_other_page")},this.currentRange="",this.pageNumbers=[],this.postPageNumbers=[],this.prePageNumbers=[],this.perPageOptions=[]}ngOnInit(){this.paginationService.loadPaginationOptions().then(e=>{this.perPageOptions=e.perPageOptions,this.pagination=new s.a(1,parseInt(this.totalEntries),e.perPage),this.cdRef.detectChanges()})}update(){this.updateCurrentRangeLabel(),this.updatePageNumbers(),this.cdRef.detectChanges()}selectPerPage(e){this.pagination.perPage=e,this.paginationService.setPerPage(e),this.showPage(1)}showPage(e){this.pagination.page=e,this.updateCurrentRangeLabel(),this.updatePageNumbers(),this.onUpdatedPage(),this.cdRef.detectChanges()}onUpdatedPage(){this.updateResults.emit(this.pagination)}get isVisible(){return!this.hideForSinglePageResults||this.pagination.total>this.pagination.perPage}updateCurrentRangeLabel(){if(this.pagination.total){let e=this.pagination.total,t=this.pagination.getLowerPageBound(),i=this.pagination.getUpperPageBound(this.pagination.total);this.currentRange="("+t+"\xa0-\xa0"+i+"/"+e+")"}else this.currentRange="(0 - 0/0)"}updatePageNumbers(){if(!this.showPageSelections)return this.pageNumbers=[],void(this.postPageNumbers=[]);var e=this.paginationService.getMaxVisiblePageOptions(),t=this.paginationService.getOptionsTruncationSize(),i=[];const n=this.pagination.perPage,s=this.pagination.page;if(n){for(var r=1;r<=Math.ceil(this.pagination.total/n);r++)i.push(r);var a=s-2*t;0<=a&&a<=1?this.postPageNumbers=this.truncatePageNums(i,i.length>=e+2*t,e+t,i.length,0):(this.prePageNumbers=this.truncatePageNums(i,s>=e,0,Math.min(s-Math.ceil(e/2),i.length-e),t),this.postPageNumbers=this.truncatePageNums(i,i.length>=e+2*t,e,i.length,0))}this.pageNumbers=i}showPerPageOptions(){return this.showPerPage&&this.perPageOptions.length>0&&this.pagination.total>this.perPageOptions[0]}truncatePageNums(e,t,i,n,s){if(t){var r=this.paginationService.getOptionsTruncationSize(),a=e.splice(i,n);return a.length>=2*r&&a.splice(s,a.length-r),a}return[]}}O.\u0275fac=function(e){return new(e||O)(r.bc(n.a),r.bc(r.i),r.bc(a.a))},O.\u0275cmp=r.Vb({type:O,selectors:[["","tablePagination",""]],inputs:{totalEntries:"totalEntries",hideForSinglePageResults:"hideForSinglePageResults",showPerPage:"showPerPage",showPageSelections:"showPageSelections",infoText:"infoText"},outputs:{updateResults:"updateResults"},features:[r.Mb],attrs:["tablePagination",""],decls:1,vars:1,consts:[["class","pagination",4,"ngIf"],[1,"pagination"],[1,"pagination--pages"],[1,"pagination--items"],[1,"pagination--item",3,"hidden"],["rel","prev start","id","pagination--prev-link","role","link","href","",3,"accessibleClick"],[4,"ngIf"],["rel","next","id","pagination--next-link","role","link","href","",1,"pagination--next-link",3,"accessibleClick"],[1,"pagination--range"],[3,"textContent"],["id","pagination-empty-text","tabindex","0","class","hidden-for-sighted",3,"textContent",4,"ngIf"],["class","pagination--info",4,"ngIf"],["class","pagination--options",4,"ngIf"],["class","pagination--item",4,"ngFor","ngForOf"],[1,"pagination--space"],[1,"pagination--item"],["rel","next","role","link","href","",3,"textContent","accessibleClick"],["class","pagination--item pagination-number",3,"ngClass",4,"ngFor","ngForOf"],["class","pagination--space",4,"ngIf"],[1,"pagination--item","pagination-number",3,"ngClass"],["rel","next","role","link","href","",3,"textContent","accessibleClick",4,"ngIf"],["class","pagination--item pagination-number",4,"ngFor","ngForOf"],[1,"pagination--item","pagination-number"],["id","pagination-empty-text","tabindex","0",1,"hidden-for-sighted",3,"textContent"],[1,"pagination--info"],["icon-classes","icon-info1 icon-context"],[1,"pagination--options"],[1,"pagination--label",3,"textContent","title"],["class","pagination--item",3,"ngClass",4,"ngFor","ngForOf"],[1,"pagination--item",3,"ngClass"],["role","link","href","",3,"textContent","accessibleClick"]],template:function(e,t){1&e&&r.Tc(0,_,17,11,"div",0),2&e&&r.wc("ngIf",t.pagination&&t.isVisible&&t.pagination.total)},directives:[o.q,l.a,o.p,o.n,d.a],encapsulation:2,changeDetection:0})},mY05:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("mrSG"),s=i("r0MM"),r=i("3VS2"),a=i("lfyH"),c=i("vkgz"),o=i("eIep"),l=i("lJxs"),d=i("LRne"),u=i("cp0P"),h=i("CNq7"),p=i("fXoL");class g{constructor(e){this.injector=e}getViewPointResource(e,t){const i=e.bcfViewpoints[t].href;return this.bcfApi.parse(i)}getViewPoint$(e,t){return this.getViewPointResource(e,t).get()}deleteViewPoint$(e,t){return this.getViewPointResource(e,t).delete().pipe(Object(c.a)(()=>this.apiV3Service.work_packages.id(e).requireAndStream(!0)))}saveViewpoint$(e,t){const i=e.project.idFromLink,n=this.setBcfTopic$(e),s=t?Object(d.a)(t):this.viewerBridge.getViewpoint$();return Object(u.a)({topicUUID:n,viewpoint:s}).pipe(Object(o.a)(e=>this.bcfApi.projects.id(i).topics.id(e.topicUUID).viewpoints.post(e.viewpoint)),Object(c.a)(t=>this.apiV3Service.work_packages.id(e).requireAndStream(!0)))}setBcfTopic$(e){var t;if(this.topicUUID)return Object(d.a)(this.topicUUID);{const i=null===(t=e.bcfTopic)||void 0===t?void 0:t.href;return(i?Object(d.a)(this.bcfApi.parse(i).id):this.createBcfTopic$(e)).pipe(Object(l.a)(e=>this.topicUUID=e))}}createBcfTopic$(e){const t=e.project.idFromLink,i=e.convertBCF.payload;return this.bcfApi.projects.id(t).topics.post(i).pipe(Object(l.a)(e=>(this.topicUUID=e.guid,this.topicUUID)))}}g.\u0275fac=function(e){return new(e||g)(p.lc(p.A))},g.\u0275prov=p.Xb({token:g,factory:g.\u0275fac}),Object(n.c)([Object(s.a)(),Object(n.e)("design:type",r.a)],g.prototype,"bcfApi",void 0),Object(n.c)([Object(s.a)(),Object(n.e)("design:type",a.a)],g.prototype,"viewerBridge",void 0),Object(n.c)([Object(s.a)(),Object(n.e)("design:type",h.a)],g.prototype,"apiV3Service",void 0)},mg4W:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("fXoL"),s=i("sjKJ"),r=i("Jui0"),a=i("t8SH"),c=i("wZYP"),o=i("POAS"),l=i("CNq7"),d=i("ZOsW"),u=i("3Pt+"),h=i("ofXK"),p=i("ximh");function g(e,t){if(1&e&&(n.cc(0,"b",4),n.Vc(1)),2&e){const e=t.searchTerm,i=n.rc();n.wc("textContent",i.text.add_new_action),n.Pb(1),n.Xc(": ",e," ")}}function f(e,t){if(1&e&&(n.hc(0,"div",5),n.Vc(1),n.gc()),2&e){const e=t.item,i=t.searchTerm;n.wc("ngOptionHighlight",i),n.Pb(1),n.Wc(e.name)}}class b extends a.a{constructor(e,t,i,s,r,a){super(e,i,t,s),this.I18n=e,this.currentProject=t,this.cdRef=i,this.pathHelper=s,this.apiV3Service=r,this.halNotification=a,this.openDirectly=!1,this.onCreate=new n.s}ngAfterViewInit(){super.ngAfterViewInit(),this.canCreateNewActionElements().then(e=>{e&&(this.createAllowed=e=>this.createNewVersion(e),this.cdRef.detectChanges())})}canCreateNewActionElements(){return this.currentProject.id?this.apiV3Service.versions.available_projects.exists(this.currentProject.id).toPromise().catch(()=>!1):Promise.resolve(!1)}createNewVersion(e){this.apiV3Service.versions.post(this.getVersionPayload(e)).subscribe(e=>this.onCreate.emit(e),e=>{this.closeSelect(),this.halNotification.handleRawError(e)})}getVersionPayload(e){let t={};return t.name=e,t._links={definingProject:{href:this.apiV3Service.projects.id(this.currentProject.id).path}},t}}b.\u0275fac=function(e){return new(e||b)(n.bc(c.a),n.bc(s.a),n.bc(n.i),n.bc(r.a),n.bc(l.a),n.bc(o.a))},b.\u0275cmp=n.Vb({type:b,selectors:[["version-autocompleter"]],inputs:{openDirectly:"openDirectly"},outputs:{onCreate:"onCreate"},features:[n.Mb],decls:4,vars:14,consts:[["bindLabel","name",3,"ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","clearSearchOnAdd","appendTo","hideSelected","id","ngModelChange","change","open","close","keydown"],["ngSelectComponent",""],["ng-tag-tmp",""],["ng-option-tmp",""],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight"]],template:function(e,t){1&e&&(n.hc(0,"ng-select",0,1),n.pc("ngModelChange",(function(e){return t.model=e}))("change",(function(e){return t.changeModel(e)}))("open",(function(){return t.opened()}))("close",(function(){return t.closed()}))("keydown",(function(e){return t.keyPressed(e)})),n.Tc(2,g,2,2,"ng-template",2),n.Tc(3,f,2,2,"ng-template",3),n.gc()),2&e&&n.wc("ngModel",t.model)("items",t.availableValues)("ngClass",t.classes)("addTag",t.createAllowed)("virtualScroll",!0)("required",t.required)("clearable",!t.required)("disabled",t.disabled)("typeahead",t.typeahead)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("appendTo",t.appendTo)("hideSelected",t.hideSelected)("id",t.id)},directives:[d.a,u.m,u.p,h.n,u.x,d.l,d.c,p.a],encapsulation:2})},nbRO:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"a",(function(){return s}));const n="wp-table--group-header",s="-collapsed"},nv3t:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("4lR/"),s=i("PUHT"),r=i("wZYP"),a=i("1RU0"),c=i("fXoL");class o extends s.a{constructor(e,t,i,n){super(e,t),this.elementRef=e,this.opContextMenu=t,this.I18n=i,this.wpViewCollapsedGroups=n}open(e){this.buildItems(),this.opContextMenu.show(this,e)}get locals(){return{items:this.items,contextMenuId:"wp-group-fold-context-menu"}}buildItems(){this.items=[{disabled:this.wpViewCollapsedGroups.allGroupsAreCollapsed,linkText:this.I18n.t("js.button_collapse_all"),icon:"icon-minus2",onClick:e=>(this.wpViewCollapsedGroups.setAllGroupsCollapseStateTo(!0),!0)},{disabled:this.wpViewCollapsedGroups.allGroupsAreExpanded,linkText:this.I18n.t("js.button_expand_all"),icon:"icon-plus",onClick:e=>(this.wpViewCollapsedGroups.setAllGroupsCollapseStateTo(!1),!0)}]}}o.\u0275fac=function(e){return new(e||o)(c.bc(c.q),c.bc(n.a),c.bc(r.a),c.bc(a.a))},o.\u0275dir=c.Wb({type:o,selectors:[["","wpGroupToggleDropdown",""]],features:[c.Mb]})},o0hg:function(e,t,i){"use strict";i.d(t,"c",(function(){return c})),i.d(t,"a",(function(){return o})),i.d(t,"b",(function(){return l}));var n=i("mrSG"),s=i("j93F"),r=i("r0MM"),a=i("kTsZ");class c extends s.a{constructor(e,t,i,n){super(t,i),this.apiRoot=e,this.basePath=t,this.id=i,this.parent=n,this.injector=this.apiRoot.injector}subResource(e,t=o){return new t(this.apiRoot,this.path,e,this)}}Object(n.c)([Object(r.a)(),Object(n.e)("design:type",a.a)],c.prototype,"halResourceService",void 0);class o extends c{get(){return this.halResourceService.get(this.path)}}class l extends s.b{constructor(e,t,i,n){super(t,i,n),this.apiRoot=e,this.basePath=t,this.resource=n,this.injector=this.apiRoot.injector}id(e){let t;return t="string"==typeof e||"number"==typeof e?e.toString():e.id,new(this.resource||o)(this.apiRoot,this.path,t,this)}withOptionalId(e){return _.isNil(e)?this:this.id(e)}toString(){return this.path}toPath(){return this.path}filtered(e,t={},i){return this.subResource("?"+e.toParams(t),i)}subResource(e,t=o){return new t(this.apiRoot,this.path,e,this)}}Object(n.c)([Object(r.a)(),Object(n.e)("design:type",a.a)],l.prototype,"halResourceService",void 0)},"oJ+N":function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i("+rOU"),s=i("iB+3"),r=i("7ond"),a=i("WgCp"),c=i("ho3E"),o=i("fXoL");class l{constructor(e,t,i,n,s){this.componentFactoryResolver=e,this.FocusHelper=t,this.appRef=i,this.$transitions=n,this.injector=s}get bodyPortalHost(){if(!this._portalHostElement){const e=this._portalHostElement=document.createElement("div");e.classList.add("op-external-query-configuration--container"),document.body.appendChild(e),this._bodyPortalHost=new n.d(e,this.componentFactoryResolver,this.appRef,this.injector)}return this._bodyPortalHost}show(e){this.detach();const t=new n.c(this.externalQueryConfigurationComponent(),null,this.injectorFor(e));this.bodyPortalHost.attach(t),this._portalHostElement.style.display="block"}detach(){this.bodyPortalHost.hasAttached()&&(this.bodyPortalHost.detach(),this._portalHostElement.style.display="none")}injectorFor(e){const t=new WeakMap;return e.service=this,t.set(c.a,e),new n.f(this.injector,t)}externalQueryConfigurationComponent(){return a.a}}l.\u0275fac=function(e){return new(e||l)(o.lc(o.l),o.lc(r.a),o.lc(o.f),o.lc(s.TransitionService),o.lc(o.A))},l.\u0275prov=o.Xb({token:l,factory:l.\u0275fac})},oLh2:function(e,t,i){"use strict";i.d(t,"a",(function(){return f}));i("ii2/");var n=i("juWA"),s=i("wZYP"),r=i("CNq7"),a=i("fXoL"),c=i("ofXK"),o=i("0XIV"),l=i("u8Ab");function d(e,t){if(1&e&&a.cc(0,"user-avatar",10),2&e){const e=a.rc(2);a.Qb("data-user-name",e.userName)("data-user-id",e.userId)}}function u(e,t){if(1&e&&a.cc(0,"user-avatar",10),2&e){const e=a.rc(2);a.Qb("data-user-name",e.userName)("data-use-fallback",!0)}}function h(e,t){if(1&e&&(a.hc(0,"span",11),a.cc(1,"a",12),a.gc()),2&e){const e=a.rc(2);a.Pb(1),a.wc("textContent",e.userName),a.Qb("href",e.userPath,a.Oc)("aria-label",e.userLabel)}}function p(e,t){if(1&e&&a.cc(0,"span",13),2&e){const e=a.rc(2);a.wc("textContent",e.userName)}}function g(e,t){if(1&e&&(a.hc(0,"div",1),a.hc(1,"div",2),a.cc(2,"activity-link",3),a.gc(),a.Tc(3,d,1,2,"user-avatar",4),a.Tc(4,u,1,2,"user-avatar",4),a.Tc(5,h,2,3,"span",5),a.Tc(6,p,1,1,"span",6),a.cc(7,"span",7),a.hc(8,"span",8),a.cc(9,"span",9),a.gc(),a.gc()),2&e){const e=a.rc();a.Pb(2),a.wc("workPackage",e.workPackage)("activityNo",e.activityNo),a.Pb(1),a.wc("ngIf",e.activity.author&&e.userName),a.Pb(1),a.wc("ngIf",!e.activity.author&&e.userName),a.Pb(1),a.wc("ngIf",e.userActive),a.Pb(1),a.wc("ngIf",!e.userActive),a.Pb(1),a.wc("innerHtml",e.revisionLink,a.Mc),a.Pb(2),a.wc("innerHtml",e.message,a.Mc)}}class f{constructor(e,t,i,n){this.I18n=e,this.timezoneService=t,this.cdRef=i,this.apiV3Service=n}ngOnInit(){this.loadAuthor(),this.project=this.workPackage.project,this.revision=this.activity.identifier,this.message=this.activity.message.html;const e=this.activity.showRevision.$link.href,t=this.activity.formattedIdentifier,i=document.createElement("a");i.href=e,i.title=this.revision,i.textContent=this.I18n.t("js.label_committed_link",{revision_identifier:t}),this.revisionLink=this.I18n.t("js.label_committed_at",{committed_revision_link:i.outerHTML,date:this.timezoneService.formattedDatetime(this.activity.createdAt)})}loadAuthor(){void 0===this.activity.author?this.userName=this.activity.authorName:this.apiV3Service.users.id(this.activity.author.idFromLink).get().subscribe(e=>{this.userId=e.id,this.userName=e.name,this.userActive=e.isActive,this.userAvatar=e.avatar,this.userPath=e.showUser.href,this.userLabel=this.I18n.t("js.label_author",{user:this.userName}),this.cdRef.detectChanges()})}}f.\u0275fac=function(e){return new(e||f)(a.bc(s.a),a.bc(n.a),a.bc(a.i),a.bc(r.a))},f.\u0275cmp=a.Vb({type:f,selectors:[["revision-activity"]],inputs:{workPackage:"workPackage",activity:"activity",activityNo:"activityNo"},decls:1,vars:1,consts:[["class","work-package-details-activities-activity-contents",4,"ngIf"],[1,"work-package-details-activities-activity-contents"],[1,"comments-number"],[3,"workPackage","activityNo"],["data-class-list","avatar",4,"ngIf"],["class","user",4,"ngIf"],["class","user",3,"textContent",4,"ngIf"],[1,"revision-activity--revision-link","date",3,"innerHtml"],[1,"user-comment","wiki"],[1,"message",3,"innerHtml"],["data-class-list","avatar"],[1,"user"],[3,"textContent"],[1,"user",3,"textContent"]],template:function(e,t){1&e&&a.Tc(0,g,10,8,"div",0),2&e&&a.wc("ngIf",t.workPackage)},directives:[c.q,o.a,l.a],encapsulation:2,changeDetection:0})},oT5z:function(e,t,i){"use strict";i.d(t,"a",(function(){return st}));var n=i("fXoL"),s=i("5btT"),r=i("J30J"),a=i("V4eP"),c=i("3Pt+"),o=i("oUDv");class l extends a.a{constructor(){super(...arguments),this.shouldFocus="subject"===this.name}}l.\u0275fac=function(e){return d(e||l)},l.\u0275cmp=n.Vb({type:l,selectors:[["ng-component"]],features:[n.Mb],decls:1,vars:6,consts:[["type","text",1,"inline-edit--field",3,"focus","disabled","ngModel","id","ngModelChange","keydown","focusout"]],template:function(e,t){1&e&&(n.hc(0,"input",0),n.pc("ngModelChange",(function(e){return t.value=e}))("keydown",(function(e){return t.handler.handleUserKeydown(e)}))("focusout",(function(){return t.handler.onFocusOut()})),n.gc()),2&e&&(n.wc("focus",t.shouldFocus)("disabled",t.inFlight)("ngModel",t.value)("id",t.handler.htmlId),n.Qb("aria-required",t.required)("required",t.required))},directives:[c.c,o.a,c.x,c.m,c.p],encapsulation:2});const d=n.jc(l);class u extends a.a{constructor(){super(...arguments),this.locale=I18n.locale}}u.\u0275fac=function(e){return h(e||u)},u.\u0275cmp=n.Vb({type:u,selectors:[["ng-component"]],features:[n.Mb],decls:1,vars:6,consts:[["type","number",1,"inline-edit--field",3,"disabled","ngModel","id","ngModelChange","keydown","focusout"]],template:function(e,t){1&e&&(n.hc(0,"input",0),n.pc("ngModelChange",(function(e){return t.value=e}))("keydown",(function(e){return t.handler.handleUserKeydown(e)}))("focusout",(function(){return t.handler.onFocusOut()})),n.gc()),2&e&&(n.wc("disabled",t.inFlight)("ngModel",t.value)("id",t.handler.htmlId),n.Qb("aria-required",t.required)("required",t.required)("lang",t.locale))},directives:[c.s,c.c,c.x,c.m,c.p],encapsulation:2});const h=n.jc(u);var p=i("mrSG"),g=i("juWA"),f=i("wd/R"),b=i("r0MM");class m extends a.a{parser(e){if(!isNaN(e)){let t=parseFloat(e);return f.duration(t,"hours")}return e}formatter(e){return Number(f.duration(e).asHours().toFixed(2))}parseValue(e){if(null===e)return e;let t;return t=e.isValid()?e.toISOString():null,t}}m.\u0275fac=function(e){return w(e||m)},m.\u0275cmp=n.Vb({type:m,selectors:[["ng-component"]],features:[n.Mb],decls:1,vars:5,consts:[["type","number","step","0.01",1,"inline-edit--field",3,"ngModel","disabled","id","ngModelChange","keydown"]],template:function(e,t){1&e&&(n.hc(0,"input",0),n.pc("ngModelChange",(function(e){return t.value=t.parser(e)}))("keydown",(function(e){return t.handler.handleUserKeydown(e)})),n.gc()),2&e&&(n.wc("ngModel",t.formatter(t.value))("disabled",t.inFlight)("id",t.handler.htmlId),n.Qb("aria-required",t.required)("required",t.required))},directives:[c.s,c.c,c.m,c.p,c.x],encapsulation:2}),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",g.a)],m.prototype,"TimezoneService",void 0);const w=n.jc(m);var v=i("iHm1"),y=i("t8SH");class k{constructor(){this._fields=[]}register(e,t){this._fields.push({attribute:t,component:e})}getAutocompleterOfAttribute(e){let t=_.find(this._fields,t=>t.attribute===e);return t?t.component:void 0}}k.\u0275fac=function(e){return new(e||k)},k.\u0275prov=n.Xb({token:k,factory:k.\u0275fac,providedIn:"root"});var C=i("Cfvw"),j=i("vkgz"),P=i("lJxs"),x=i("POAS"),S=i("CS/5");const O=function(e,t,i,n,s,r,a){return{availableValues:e,appendTo:t,model:i,required:n,disabled:s,id:r,finishedLoading:!0,classes:a}};class I extends a.a{constructor(){super(...arguments),this.valuesLoaded=!1,this.appendTo=null,this.hiddenOverflowContainer=".__hidden_overflow_container",this.referenceOutputs={onCreate:e=>this.onCreate(e),onChange:e=>this.onChange(e),onKeydown:e=>this.handler.handleUserKeydown(e,!0),onOpen:()=>this.onOpen(),onClose:()=>this.onClose(),onAfterViewInit:e=>this._autocompleterComponent=e}}initialize(){this.text={requiredPlaceholder:this.I18n.t("js.placeholders.selection"),placeholder:this.I18n.t("js.placeholders.default")},this.valuesLoadingPromise=this.change.getForm().then(()=>this.initialValueLoading())}initialValueLoading(){return this.valuesLoaded=!1,this.loadValues().toPromise()}autocompleterComponent(){let e=this.schema.type;return this.selectAutocompleterRegister.getAutocompleterOfAttribute(e)||y.a}ngOnInit(){super.ngOnInit(),this.appendTo=this.overflowingSelector,this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe(()=>{this.valuesLoadingPromise.then(()=>{this._autocompleterComponent.openDirectly=!0})})}get selectedOption(){const e=this.value?this.value.$href:null;return _.find(this.valueOptions,t=>t.$href===e)}set selectedOption(e){let t=_.find(this.availableOptions,t=>t.$href===e.$href);t&&""===t.$href&&(t.$href=null),this.value=t}setValues(e){this.availableOptions=this.sortValues(e),this.addEmptyOption(),this.valueOptions=this.availableOptions.map(e=>this.mapAllowedValue(e))}loadValues(e){let t=this.schema.allowedValues;if(Array.isArray(t))this.setValues(t),this.valuesLoaded=!0;else{if(t&&!this.valuesLoaded)return this.loadValuesFromBackend(e);this.setValues([])}return Object(C.a)(Promise.resolve(this.valueOptions))}loadValuesFromBackend(e){return Object(C.a)(this.loadAllowedValues(e)).pipe(Object(j.a)(t=>{(void 0===t.count||void 0===t.total||!e&&t.total===t.count)&&(this.valuesLoaded=!0)}),Object(P.a)(t=>void 0===t.count||void 0===t.total||!e&&t.total===t.count||!this.value?t.elements:t.elements.concat([this.value])),Object(j.a)(e=>this.setValues(e)),Object(P.a)(()=>this.valueOptions))}loadAllowedValues(e){if(!e){const e=this.schema.allowedValues.$link.href;return this.change.cacheValue(e,this.fetchAllowedValueQuery.bind(this))}return this.fetchAllowedValueQuery(e)}fetchAllowedValueQuery(e){return this.schema.allowedValues.$link.$fetch(this.allowedValuesFilter(e))}addValue(e){this.availableOptions.push(e),this.valueOptions.push({name:e.name,$href:e.$href})}get currentValueInvalid(){return!!(this.value&&!_.some(this.availableOptions,e=>e.$href===this.value.$href)||!this.value&&this.schema.required)}onCreate(e){this.addValue(e),this.selectedOption={name:e.name,$href:e.$href},this.handler.handleUserSubmit()}onOpen(){jQuery(this.hiddenOverflowContainer).one("scroll",()=>{this._autocompleterComponent.closeSelect()})}onClose(){}onChange(e){if(void 0!==e)return this.selectedOption={name:e.name,$href:e.$href},void this.handler.handleUserSubmit();const t=this.getEmptyOption();t&&(this.selectedOption=t,this.handler.handleUserSubmit())}addEmptyOption(){if(this.isRequired())return;void 0===this.getEmptyOption()&&this.availableOptions.unshift({name:this.text.placeholder,$href:""})}isRequired(){return this.schema.required}sortValues(e){return this.halSorting.sort(e)}mapAllowedValue(e){return{name:e.name,$href:e.$href}}allowedValuesFilter(e){return{}}getEmptyOption(){return _.find(this.availableOptions,e=>e.name===this.text.placeholder)}}I.\u0275fac=function(e){return T(e||I)},I.\u0275cmp=n.Vb({type:I,selectors:[["ng-component"]],features:[n.Mb],decls:1,vars:11,consts:[[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"]],template:function(e,t){1&e&&n.cc(0,"ndc-dynamic",0),2&e&&n.wc("ndcDynamicComponent",t.autocompleterComponent())("ndcDynamicInputs",n.Gc(3,O,t.valueOptions,t.appendTo,t.selectedOption?t.selectedOption:"",t.required,t.inFlight,t.handler.htmlId,"inline-edit--field "+t.handler.fieldName))("ndcDynamicOutputs",t.referenceOutputs)},directives:[S.c,S.d],encapsulation:2}),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",k)],I.prototype,"selectAutocompleterRegister",void 0),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",x.a)],I.prototype,"halNotification",void 0),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",v.a)],I.prototype,"halSorting",void 0);const T=n.jc(I);var R=i("wZYP"),E=i("ZOsW"),M=i("ofXK"),F=i("32V0");function A(e,t){if(1&e){const e=n.ic();n.hc(0,"edit-field-controls",2),n.pc("onSave",(function(){n.Lc(e);return n.rc().handler.handleUserSubmit()}))("onCancel",(function(){n.Lc(e);return n.rc().handler.handleUserCancel()})),n.gc()}if(2&e){const e=n.rc();n.wc("fieldController",e.self)("saveTitle",e.text.save)("cancelTitle",e.text.cancel)}}class L extends a.a{constructor(){super(...arguments),this.availableOptions=[],this.text={requiredPlaceholder:this.I18n.t("js.placeholders.selection"),placeholder:this.I18n.t("js.placeholders.default"),save:this.I18n.t("js.inplace.button_save",{attribute:this.schema.name}),cancel:this.I18n.t("js.inplace.button_cancel",{attribute:this.schema.name})},this.appendTo=null,this.hiddenOverflowContainer=".__hidden_overflow_container",this.currentValueInvalid=!1,this.requestFocus=!1}ngOnInit(){this.nullOption={name:this.text.placeholder,$href:null},this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe(()=>{this.requestFocus=0===this.availableOptions.length,this.requestFocus||this.openAutocompleteSelectField()}),super.ngOnInit(),this.appendTo=this.overflowingSelector}get value(){const e=this.resource[this.name];return e?e[0]:e}buildSelectedOption(){const e=this.resource[this.name];return e?e.map(e=>this.findValueOption(e)):[]}get selectedOption(){return this._selectedOption}set selectedOption(e){this._selectedOption=e;let t=e=>{let t=_.find(this.availableOptions,t=>t.$href===e.$href)||this.nullOption;return t&&""===t.$href&&(t.$href=null),t};this.resource[this.name]=_.castArray(e).map(e=>t(e))}onOpen(){jQuery(this.hiddenOverflowContainer).one("scroll",()=>{this.ngSelectComponent.close()})}onClose(){}repositionDropdown(){this.ngSelectComponent&&this.ngSelectComponent.dropdownPanel&&setTimeout(()=>this.ngSelectComponent.dropdownPanel.adjustPosition(),0)}openAutocompleteSelectField(){let e=this;window.setTimeout((function(){e.ngSelectComponent.open()}),0)}findValueOption(e){let t;return e&&(t=_.find(this.valueOptions,t=>t.$href===e.$href)),t||this.nullOption}setValues(e,t=!1){t&&e.sort((function(e,t){let i=e.name.toLowerCase(),n=t.name.toLowerCase();return i<n?-1:i>n?1:0})),this.availableOptions=e||[],this.valueOptions=this.availableOptions.map(e=>({name:e.name,$href:e.$href})),this._selectedOption=this.buildSelectedOption(),this.checkCurrentValueValidity(),this.availableOptions.length>0&&this.requestFocus&&(this.openAutocompleteSelectField(),this.requestFocus=!1)}initialize(){super.initialize(),this.loadValues()}loadValues(){let e=this.schema.allowedValues;if(Array.isArray(e))this.setValues(e);else{if(this.schema.allowedValues)return this.schema.allowedValues.$load().then(e=>{e.count>0&&"Project"===e.elements[0]._type?this.setValues(e.elements,!0):this.setValues(e.elements)});this.setValues([])}return Promise.resolve()}checkCurrentValueValidity(){this.value?this.currentValueInvalid=!_.some(this.value,e=>_.some(this.availableOptions,t=>t.$href===e.$href)):this.currentValueInvalid=!!this.schema.required}}L.\u0275fac=function(e){return D(e||L)},L.\u0275cmp=n.Vb({type:L,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(E.a,!0),2&e)&&(n.Ic(i=n.qc())&&(t.ngSelectComponent=i.first))},features:[n.Mb],decls:2,vars:15,consts:[["bindLabel","name",3,"ngModel","ngClass","required","clearable","disabled","id","items","virtualScroll","clearSearchOnAdd","multiple","closeOnSelect","appendTo","dropdownPosition","hideSelected","ngModelChange","keydown","open","close","add","remove"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel",4,"ngIf"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel"]],template:function(e,t){1&e&&(n.hc(0,"ng-select",0),n.pc("ngModelChange",(function(e){return t.selectedOption=e}))("keydown",(function(e){return t.handler.handleUserKeydown(e,!0)}))("open",(function(){return t.onOpen()}))("close",(function(){return t.onClose()}))("add",(function(){return t.repositionDropdown()}))("remove",(function(){return t.repositionDropdown()})),n.gc(),n.Tc(1,A,1,3,"edit-field-controls",1)),2&e&&(n.wc("ngModel",t.selectedOption)("ngClass","inline-edit--field -multi-select")("required",t.required)("clearable",!t.required)("disabled",t.inFlight)("id",t.handler.htmlId)("items",t.valueOptions)("virtualScroll",!0)("clearSearchOnAdd",!0)("multiple",!0)("closeOnSelect",!1)("appendTo",t.appendTo)("dropdownPosition","top")("hideSelected",!0),n.Pb(1),n.wc("ngIf",!t.handler.inEditMode))},directives:[E.a,c.m,c.p,M.n,c.x,M.q,F.a],encapsulation:2}),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",R.a)],L.prototype,"I18n",void 0);const D=n.jc(L);class V extends a.a{constructor(){super(...arguments),this.locale=I18n.locale}}V.\u0275fac=function(e){return q(e||V)},V.\u0275cmp=n.Vb({type:V,selectors:[["ng-component"]],features:[n.Mb],decls:1,vars:6,consts:[["type","number","step","any",1,"inline-edit--field",3,"disabled","ngModel","id","ngModelChange","keydown","focusout"]],template:function(e,t){1&e&&(n.hc(0,"input",0),n.pc("ngModelChange",(function(e){return t.value=e}))("keydown",(function(e){return t.handler.handleUserKeydown(e)}))("focusout",(function(){return t.handler.onFocusOut()})),n.gc()),2&e&&(n.wc("disabled",t.inFlight)("ngModel",t.value)("id",t.handler.htmlId),n.Qb("aria-required",t.required)("required",t.required)("lang",t.locale))},directives:[c.s,c.c,c.x,c.m,c.p],encapsulation:2});const q=n.jc(V);class $ extends a.a{updateValue(e){this.value=e,this.handler.handleUserSubmit()}}$.\u0275fac=function(e){return N(e||$)},$.\u0275cmp=n.Vb({type:$,selectors:[["ng-component"]],features:[n.Mb],decls:1,vars:4,consts:[["type","checkbox",1,"inline-edit--field","inline-edit--boolean-field",3,"checked","disabled","id","change","keydown"]],template:function(e,t){1&e&&(n.hc(0,"input",0),n.pc("change",(function(){return t.updateValue(!t.value)}))("keydown",(function(e){return t.handler.handleUserKeydown(e)})),n.gc()),2&e&&(n.wc("checked",t.value)("disabled",t.inFlight)("id",t.handler.htmlId),n.Qb("aria-required",t.required))},encapsulation:2});const N=n.jc($);var B=i("RhL0"),z=i("iuWW"),H=i("IzEk");const Q=function(e,t,i,n,s,r,a,c,o){return{availableValues:e,appendTo:t,model:i,required:n,disabled:s,typeahead:r,id:a,finishedLoading:c,hideSelected:!0,classes:o}};class W extends I{constructor(){super(...arguments),this.requests=new z.a(e=>this.loadValues(e),Object(z.b)(this.halNotification))}initialValueLoading(){return this.valuesLoaded=!1,new Promise(e=>{this.requests.output$.pipe(Object(H.a)(1)).subscribe(t=>{e(t)}),this.requests.input$.next("")})}get typeahead(){return!this.valuesLoaded&&this.requests.input$}allowedValuesFilter(e){let t=super.allowedValuesFilter(e);if(e){let i=new B.a;i.add("subjectOrId","**",[e]),t={filters:i.toJson()}}return t}mapAllowedValue(e){if(e.id){let t=e.type?e.type.name+" ":"",i=e.subject||e.name;return{name:`${t}#${e.id} ${i}`,$href:e.$href}}return e}}W.\u0275fac=function(e){return X(e||W)},W.\u0275cmp=n.Vb({type:W,selectors:[["ng-component"]],features:[n.Mb],decls:2,vars:15,consts:[[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"]],template:function(e,t){1&e&&(n.cc(0,"ndc-dynamic",0),n.sc(1,"async")),2&e&&n.wc("ndcDynamicComponent",t.autocompleterComponent())("ndcDynamicInputs",n.Hc(5,Q,[n.tc(1,3,t.requests.output$),t.appendTo,t.selectedOption?t.selectedOption:"",t.required,t.inFlight,t.typeahead,t.handler.htmlId,t.requests.loading$,"inline-edit--field "+t.handler.fieldName]))("ndcDynamicOutputs",t.referenceOutputs)},directives:[S.c,S.d],pipes:[M.a],encapsulation:2});const X=n.jc(W);var U=i("IaZ+"),G=i("ecJW");class Y extends a.a{ngOnInit(){super.ngOnInit()}onValueSelected(e){this.value=this.parser(e),this.handler.handleUserSubmit()}onCancel(){this.handler.handleUserCancel()}parser(e){return f(e,"YYYY-MM-DD",!0).isValid()?e:null}formatter(e){if(f(e,"YYYY-MM-DD",!0).isValid()){var t=this.timezoneService.parseDate(e);return this.timezoneService.formattedISODate(t)}return null}}Y.\u0275fac=function(e){return K(e||Y)},Y.\u0275cmp=n.Vb({type:Y,selectors:[["ng-component"]],features:[n.Mb],decls:1,vars:4,consts:[["tabindex","-1","classes","inline-edit--field",3,"initialDate","required","disabled","id","onChange","onCancel"]],template:function(e,t){1&e&&(n.hc(0,"op-date-picker",0),n.pc("onChange",(function(e){return t.onValueSelected(e)}))("onCancel",(function(){return t.onCancel()})),n.gc()),2&e&&n.wc("initialDate",t.formatter(t.value))("required",t.required)("disabled",t.inFlight)("id",t.handler.htmlId)},directives:[G.a],encapsulation:2}),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",g.a)],Y.prototype,"timezoneService",void 0),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",U.b)],Y.prototype,"opModalService",void 0);const K=n.jc(Y);var Z=i("VNOR"),J=i("9oW/"),ee=i("mg4W");function te(e){return"-"+(e=ne(e)).replace(" ","-")}function ie(e,t){return e=ne(e),t.t("js.grid.widgets.project_status."+e.replace(" ","_"))}function ne(e){return e||"not set"}function se(e,t){if(1&e&&(n.cc(0,"span",3),n.hc(1,"span",4),n.Vc(2),n.gc()),2&e){const e=t.item;n.wc("ngClass",e.colorClass),n.Pb(1),n.wc("ngClass",e.colorClass),n.Pb(1),n.Wc(e.name)}}function re(e,t){if(1&e&&(n.cc(0,"span",3),n.hc(1,"span",4),n.Vc(2),n.gc()),2&e){const e=t.item;n.wc("ngClass",e.colorClass),n.Pb(1),n.wc("ngClass",e.colorClass),n.Pb(1),n.Wc(e.name)}}class ae extends a.a{constructor(){super(...arguments),this._availableStatusCodes=["not set","off track","at risk","on track"],this.currentStatusCode="not set",this.availableStatuses=this._availableStatusCodes.map(e=>({code:e,name:ie(e,this.I18n),colorClass:te(e)})),this.hiddenOverflowContainer="#content-wrapper",this.appendToContainer="body"}ngOnInit(){this.currentStatusCode=null===this.resource.status?"not set":this.resource.status;let e=this;window.setTimeout((function(){e.ngSelectComponent.open()}),0)}onChange(){this.resource.status="not set"===this.currentStatusCode?null:this.currentStatusCode,this.handler.handleUserSubmit()}onOpen(){setTimeout(()=>{const e=this.ngSelectComponent;e&&e.dropdownPanel&&e.dropdownPanel._updatePosition(),jQuery(this.hiddenOverflowContainer).one("scroll.autocompleteContainer",()=>{this.ngSelectComponent.close()})},25)}onClose(){jQuery(this.hiddenOverflowContainer).off("scroll.autocompleteContainer")}}ae.\u0275fac=function(e){return ce(e||ae)},ae.\u0275cmp=n.Vb({type:ae,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(E.a,!0),2&e)&&(n.Ic(i=n.qc())&&(t.ngSelectComponent=i.first))},features:[n.Mb],decls:3,vars:5,consts:[["bindLabel","name","bindValue","code",1,"project-status",3,"items","ngModel","appendTo","hideSelected","disabled","ngModelChange","open","close","change"],["ng-label-tmp",""],["ng-option-tmp",""],[1,"project-status--bulb",3,"ngClass"],[1,"project-status--name",3,"ngClass"]],template:function(e,t){1&e&&(n.hc(0,"ng-select",0),n.pc("ngModelChange",(function(e){return t.currentStatusCode=e}))("open",(function(){return t.onOpen()}))("close",(function(){return t.onClose()}))("change",(function(){return t.onChange()})),n.Tc(1,se,3,3,"ng-template",1),n.Tc(2,re,3,3,"ng-template",2),n.gc()),2&e&&n.wc("items",t.availableStatuses)("ngModel",t.currentStatusCode)("appendTo",t.appendToContainer)("hideSelected",!0)("disabled",t.inFlight)},directives:[E.a,c.m,c.p,E.e,E.c,M.n],styles:[""]}),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",R.a)],ae.prototype,"I18n",void 0);const ce=n.jc(ae);class oe extends a.a{constructor(){super(...arguments),this.shouldFocus=!1}get value(){if(!this.schema)return"";const e=this.resource[this.name];return e&&e.raw||""}set value(e){this.resource[this.name]={raw:e}}}oe.\u0275fac=function(e){return le(e||oe)},oe.\u0275cmp=n.Vb({type:oe,selectors:[["ng-component"]],features:[n.Mb],decls:1,vars:6,consts:[["type","text",1,"inline-edit--field",3,"focus","disabled","ngModel","id","ngModelChange","keydown","focusout"]],template:function(e,t){1&e&&(n.hc(0,"input",0),n.pc("ngModelChange",(function(e){return t.value=e}))("keydown",(function(e){return t.handler.handleUserKeydown(e)}))("focusout",(function(){return t.handler.onFocusOut()})),n.gc()),2&e&&(n.wc("focus",t.shouldFocus)("disabled",t.inFlight)("ngModel",t.value)("id",t.handler.htmlId),n.Qb("aria-required",t.required)("required",t.required))},directives:[c.c,o.a,c.x,c.m,c.p],encapsulation:2});const le=n.jc(oe);var de=i("gh2L"),ue=i("iuLl"),he=i("CNq7");const pe=function(e,t,i,n,s,r,a,c,o){return{availableValues:e,appendTo:t,model:i,required:n,disabled:s,typeahead:r,id:a,finishedLoading:c,hideSelected:!0,classes:o}};class ge extends W{initialize(){super.initialize(),this.referenceOutputs&&(this.referenceOutputs.modeSwitch=e=>{this.valuesLoaded=!1;let t=this.requests.lastRequestedValue;this.requests.input$.next('_/&"()____'),this.requests.input$.next(t)})}autocompleterComponent(){return ue.a}isRequired(){return!0}loadAllowedValues(e){return this.recentWorkPackageIds?this.fetchAllowedValueQuery(e):this.apiV3Service.time_entries.list({filters:[["user_id","=",["me"]]],sortBy:[["updated_at","desc"]],pageSize:30}).toPromise().then(t=>(this.recentWorkPackageIds=t.elements.map(e=>e.workPackage.idFromLink).filter((e,t,i)=>i.indexOf(e)===t),this.fetchAllowedValueQuery(e)))}allowedValuesFilter(e){let t=new B.a;return"recent"===this._autocompleterComponent.mode&&t.add("id","=",this.recentWorkPackageIds),e&&t.add("subjectOrId","**",[e]),{filters:t.toJson()}}sortValues(e){return"recent"===this._autocompleterComponent.mode?this.sortValuesByRecentIds(e):super.sortValues(e)}sortValuesByRecentIds(e){return e.sort((e,t)=>this.recentWorkPackageIds.indexOf(e.id)-this.recentWorkPackageIds.indexOf(t.id))}}ge.\u0275fac=function(e){return fe(e||ge)},ge.\u0275cmp=n.Vb({type:ge,selectors:[["ng-component"]],features:[n.Mb],decls:2,vars:15,consts:[[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"]],template:function(e,t){1&e&&(n.cc(0,"ndc-dynamic",0),n.sc(1,"async")),2&e&&n.wc("ndcDynamicComponent",t.autocompleterComponent())("ndcDynamicInputs",n.Hc(5,pe,[n.tc(1,3,t.requests.output$),t.appendTo,t.selectedOption?t.selectedOption:"",t.required,t.inFlight,t.typeahead,t.handler.htmlId,t.requests.loading$,"inline-edit--field "+t.handler.fieldName]))("ndcDynamicOutputs",t.referenceOutputs)},directives:[S.c,S.d],pipes:[M.a],encapsulation:2}),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",he.a)],ge.prototype,"apiV3Service",void 0);const fe=n.jc(ge);var be=i("yOxh");class me extends Y{constructor(){super(...arguments),this.dates="",this.text_no_start_date=this.I18n.t("js.label_no_start_date"),this.text_no_due_date=this.I18n.t("js.label_no_due_date")}ngOnInit(){super.ngOnInit(),this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe(()=>{this.showDatePickerModal()})}ngOnDestroy(){var e;super.ngOnDestroy(),null===(e=this.modal)||void 0===e||e.closeMe()}handleClick(){this.showDatePickerModal()}showDatePickerModal(){const e=this.modal=this.opModalService.show(be.a,this.injector,{changeset:this.change,fieldName:this.name});setTimeout(()=>{const t=jQuery(e.elementRef.nativeElement).find(".datepicker-modal"),i=jQuery(this.elementRef.nativeElement);e.reposition(t,i)}),e.onDataUpdated.subscribe(e=>{this.dates=e,this.cdRef.detectChanges()}),e.closingEvent.pipe(Object(H.a)(1)).subscribe(()=>{this.handler.handleUserSubmit()})}initialize(){super.initialize(),this.dates=`${this.currentStartDate} - ${this.currentDueDate}`}get currentStartDate(){return this.resource.startDate||this.text_no_start_date}get currentDueDate(){return this.resource.dueDate||this.text_no_due_date}}me.\u0275fac=function(e){return we(e||me)},me.\u0275cmp=n.Vb({type:me,selectors:[["ng-component"]],features:[n.Mb],decls:1,vars:1,consts:[["type","text",3,"value","click"]],template:function(e,t){1&e&&(n.hc(0,"input",0),n.pc("click",(function(){return t.handleClick()})),n.gc()),2&e&&n.wc("value",t.dates)},encapsulation:2}),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",g.a)],me.prototype,"timezoneService",void 0),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",U.b)],me.prototype,"opModalService",void 0);const we=n.jc(me);var ve=i("4rda");class ye extends ve.a{}class ke extends ve.a{get valueString(){return null==this.value?"":this.value.toLocaleString(this.I18n.locale,{useGrouping:!0,maximumFractionDigits:20})}}class Ce extends ve.a{get value(){return parseInt(this.resource[this.name])}isEmpty(){return isNaN(this.value)}}class je extends ve.a{get value(){return this.schema?this.attribute&&this.attribute.name:null}}var Pe=i("Q2x2");var xe=i("E+lO");class Se extends ve.a{render(e,t,i={}){let n=document.createElement("div");n.classList.add("read-value--html","highlight","op-uc-container","op-uc-container_reduced-headings","-multiline"),i.rtl&&n.classList.add("-rtl"),n.innerHTML=t,e.innerHTML="",e.appendChild(n),xe.a.bootstrapOptionalEmbeddable(this.appRef,n)}get isFormattable(){return!0}get value(){if(!this.schema)return null;const e=this.resource[this.name];return e&&e.html?this.unescape(e.html):""}unescape(e){return e?class{static get UNESCAPED_EXPRESSION(){return"{{"}static get ESCAPED_EXPRESSION(){return"{{ \\$root\\.DOUBLE_LEFT_CURLY_BRACE }}"}static escape(e){return e.replace(new RegExp(this.UNESCAPED_EXPRESSION,"g"),this.ESCAPED_EXPRESSION)}static unescape(e){return e.replace(new RegExp(this.ESCAPED_EXPRESSION,"g"),this.UNESCAPED_EXPRESSION)}}.unescape(e):""}}Object(p.c)([Object(b.a)(),Object(p.e)("design:type",n.f)],Se.prototype,"appRef",void 0);class _e extends ve.a{constructor(){super(...arguments),this.derivedText=this.I18n.t("js.label_value_derived_from_children")}get valueString(){return this.timezoneService.formattedDuration(this.value)}get derivedPropertyName(){return"derived"+this.name.charAt(0).toUpperCase()+this.name.slice(1)}get derivedValue(){return this.resource[this.derivedPropertyName]}get derivedValueString(){const e=this.derivedValue;return e?this.timezoneService.formattedDuration(e):this.placeholder}render(e,t){if(this.isEmpty())return void(e.textContent=this.placeholder);e.classList.add("split-time-field");let i=this.value,n=i&&this.timezoneService.toHours(i)||0;0!==n&&this.renderActual(e,t);let s=this.derivedValue;s&&0!==this.timezoneService.toHours(s)&&this.renderDerived(e,this.derivedValueString,0!==n)}renderActual(e,t){const i=document.createElement("span");i.textContent=t,i.title=this.valueString,i.classList.add("-actual-value"),e.appendChild(i)}renderDerived(e,t,i){const n=document.createElement("span");n.setAttribute("title",this.texts.empty),n.textContent="("+(i?"+":"")+t+")",n.title=`${this.derivedValueString} ${this.derivedText}`,n.classList.add("-derived-value"),i&&n.classList.add("-with-actual-value"),e.appendChild(n)}get title(){return null}isEmpty(){const e=this.value,t=this.derivedValue,i=!e||0===this.timezoneService.toHours(e),n=!t||0===this.timezoneService.toHours(t);return i&&n}}Object(p.c)([Object(b.a)(),Object(p.e)("design:type",g.a)],_e.prototype,"timezoneService",void 0);var Oe=i("ayqa");class Ie extends ve.a{get valueString(){return this.value?this.timezoneService.formattedDatetime(this.value):""}}Object(p.c)([Object(b.a)(),Object(p.e)("design:type",g.a)],Ie.prototype,"timezoneService",void 0);class Te extends ve.a{get valueString(){return this.translatedValue()}get placeholder(){return this.translatedValue()}translatedValue(){return this.value?this.I18n.t("js.general_text_yes"):this.I18n.t("js.general_text_no")}isEmpty(){return!1}}var Re=i("Nvnm");class Ee extends ve.a{constructor(){super(...arguments),this.text={none:this.I18n.t("js.filter.noneElement")}}get value(){return this.resource[this.name]}get title(){return this.isEmpty()?this.text.none:this.value.name}get wpId(){return this.isEmpty()?null:this.value.$loaded?this.value.id:this.value.href.match(/(\d+)$/)[0]}get valueString(){return`#${this.wpId} ${this.title}`}isEmpty(){return!this.value}get unknownAttribute(){return!1}}var Me=i("Jui0"),Fe=i("yQm5"),Ae=i("xQCb");class Le extends _e{constructor(){super(...arguments),this.text={linkTitle:this.I18n.t("js.work_packages.message_view_spent_time"),logTime:this.I18n.t("js.button_log_time")}}render(e,t){if(!this.value)return;const i=document.createElement("a");if(i.textContent=t,i.setAttribute("title",this.text.linkTitle),i.setAttribute("class","time-logging--value"),this.resource.project){const e=this.resource.id.toString();this.apiV3Service.projects.id(this.resource.project).get().subscribe(t=>{const n=Fe(this.PathHelper.projectTimeEntriesPath(t.identifier)).search(`fields[]=WorkPackageId&operators[WorkPackageId]=%3D&values[WorkPackageId]=${e}&set_filter=1`).toString();i.href=n})}e.innerHTML="",e.appendChild(i),this.appendTimelogLink(e)}appendTimelogLink(e){if(this.timeEntryCreateService&&this.resource.logTime){const t=document.createElement("a");t.setAttribute("class","icon icon-time"),t.setAttribute("href",""),t.setAttribute("title",this.text.logTime),e.appendChild(t),t.addEventListener("click",this.showTimelogWidget.bind(this,this.resource))}}showTimelogWidget(e){this.timeEntryCreateService.create(moment(new Date),e,!1).catch(()=>{})}}Object(p.c)([Object(b.a)(),Object(p.e)("design:type",Me.a)],Le.prototype,"PathHelper",void 0),Object(p.c)([Object(b.a)(Ae.a,null),Object(p.e)("design:type",Ae.a)],Le.prototype,"timeEntryCreateService",void 0),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",he.a)],Le.prototype,"apiV3Service",void 0);class De extends ve.a{constructor(){super(...arguments),this.text={linkTitle:this.I18n.t("js.work_packages.message_successful_show_in_fullscreen")}}get value(){return this.resource.isNew?null:this.resource[this.name]}render(e,t){this.value&&(e.textContent=t)}isEmpty(){return!1}}var Ve=i("RGDJ"),qe=i("5qbd"),$e=i("Mo6U");class Ne extends qe.a{render(e,t){super.render(e,t),this.shouldHighlight&&this.addHighlight(e)}get value(){return this.schema?this.attribute&&this.attribute.name:null}addHighlight(e){if(this.attribute instanceof $e.a){const t=Ve.a.inlineClass(this.name,this.attribute.id);e.classList.add(t)}}}class Be extends Ne{get shouldHighlight(){return!0}}var ze=i("3uR5");class He extends ve.a{get value(){return this.schema?this.attribute&&this.attribute.name:null}render(e,t){this.placeholder===t?this.renderEmpty(e):this.avatarRenderer.render(e,this.attribute)}}Object(p.c)([Object(b.a)(),Object(p.e)("design:type",ze.a)],He.prototype,"avatarRenderer",void 0);class Qe extends Pe.a{render(e,t){const i=this.value;e.innerHTML="",e.setAttribute("title",i.join(", ")),0===i.length?this.renderEmpty(e):this.renderValues(this.attribute,e)}renderValues(e,t){const i=document.createDocumentFragment(),n=document.createElement("div");if(n.classList.add(ve.b),i.appendChild(n),this.renderAbridgedValues(n,e),e.length>2){const t=document.createElement("span");t.innerHTML="... ",n.appendChild(t);const s=this.optionDiv(e.length.toString(),"badge","-secondary");i.appendChild(s)}t.appendChild(i)}renderAbridgedValues(e,t){const i=_.take(t,2);this.avatarRenderer.renderMultiple(e,i)}}Object(p.c)([Object(b.a)(),Object(p.e)("design:type",ze.a)],Qe.prototype,"avatarRenderer",void 0);var We=i("PkGb"),Xe=i("iB+3"),Ue=i("cd/7");class Ge extends De{constructor(){super(...arguments),this.uiStateBuilder=new Ue.a(this.$state,this.keepTab)}render(e,t){if(!this.value)return;let i=this.uiStateBuilder.linkToShow(this.value,t,this.value);e.appendChild(i)}}Object(p.c)([Object(b.a)(),Object(p.e)("design:type",Xe.StateService)],Ge.prototype,"$state",void 0),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",We.a)],Ge.prototype,"keepTab",void 0);class Ye extends ve.a{render(e,t){const i=this.value,n=document.createElement("span");n.classList.add("project-status--bulb",te(i));const s=document.createElement("span");if(s.classList.add("project-status--name",te(i)),s.textContent=ie(i,this.I18n),e.innerHTML="",e.appendChild(n),e.appendChild(s),this.writable){const t=document.createElement("span");t.classList.add("project-status--pulldown-icon","icon","icon-pulldown"),e.appendChild(t)}}}class Ke extends ve.a{get value(){if(!this.schema)return null;const e=this.resource[this.name];return e&&e.raw||""}}class Ze extends Ee{constructor(){super(...arguments),this.text={linkTitle:this.I18n.t("js.work_packages.message_successful_show_in_fullscreen"),none:this.I18n.t("js.filter.noneElement")},this.uiStateBuilder=new Ue.a(this.$state,this.keepTab)}render(e,t){if(this.isEmpty())return void(e.innerText=this.placeholder);let i=this.uiStateBuilder.linkToShow(this.wpId,this.text.linkTitle,this.valueString),n=document.createElement("span");n.textContent=" "+_.truncate(this.title,{length:40}),e.innerHTML="",e.appendChild(i),e.appendChild(n)}get writable(){return!1}get valueString(){return"#"+this.wpId}}Object(p.c)([Object(b.a)(),Object(p.e)("design:type",Xe.StateService)],Ze.prototype,"$state",void 0),Object(p.c)([Object(b.a)(),Object(p.e)("design:type",We.a)],Ze.prototype,"keepTab",void 0);var Je=i("TNkA");var et=i("u4T9"),tt=i("8ggW"),it=i("Xmgp"),nt=i("xRac");class st{}st.\u0275mod=n.Zb({type:st}),st.\u0275inj=n.Yb({factory:function(e){return new(e||st)},providers:[{provide:n.c,useFactory:function(e,t){return()=>{e.defaultFieldType="text",e.addFieldType(l,"text",["String"]).addFieldType(u,"integer",["Integer"]).addFieldType(m,"duration",["Duration"]).addFieldType(I,"select",["Priority","Status","Type","User","Version","TimeEntriesActivity","Category","CustomOption","Project"]).addFieldType(L,"multi-select",["[]CustomOption","[]User"]).addFieldType(V,"float",["Float"]).addFieldType(W,"workPackage",["WorkPackage"]).addFieldType($,"boolean",["Boolean"]).addFieldType(Y,"date",["Date"]).addFieldType(Z.a,"wiki-textarea",["Formattable"]).addFieldType(ae,"project_status",["ProjectStatus"]).addFieldType(J.a,"_comment",["comment"]),e.addSpecificFieldType("WorkPackage",me,"date",["combinedDate","startDate","dueDate","date"]).addSpecificFieldType("TimeEntry",oe,"comment",["comment"]).addSpecificFieldType("TimeEntry",ge,"workPackage",["WorkPackage"]),t.register(ee.a,"Version"),t.register(de.a,"WorkPackage")}},deps:[s.a,k],multi:!0},{provide:n.c,useFactory:function(e){return()=>{e.defaultFieldType="text",e.addFieldType(ye,"text",["String"]).addFieldType(ke,"float",["Float"]).addFieldType(Ce,"integer",["Integer"]).addFieldType(Ne,"highlight",["Status","Priority"]).addFieldType(Be,"type",["Type"]).addFieldType(je,"resource",["Project","TimeEntriesActivity","Version","Category","CustomOption"]).addFieldType(Pe.a,"resources",["[]CustomOption"]).addFieldType(Qe,"users",["[]User"]).addFieldType(Se,"formattable",["Formattable"]).addFieldType(_e,"duration",["Duration"]).addFieldType(Oe.a,"date",["Date"]).addFieldType(Ie,"datetime",["DateTime"]).addFieldType(Te,"boolean",["Boolean"]).addFieldType(Re.a,"progress",["percentageDone"]).addFieldType(Ze,"work_package",["WorkPackage"]).addFieldType(De,"id",["id"]).addFieldType(Ye,"project_status",["ProjectStatus"]).addFieldType(He,"user",["User"]),e.addSpecificFieldType("WorkPackage",Ge,"id",["id"]).addSpecificFieldType("WorkPackage",Le,"spentTime",["spentTime"]).addSpecificFieldType("WorkPackage",Je.a,"combinedDate",["combinedDate"]).addSpecificFieldType("TimeEntry",Ke,"comment",["comment"]).addSpecificFieldType("TimeEntry",Ee,"work_package",["workPackage"])}},deps:[r.a],multi:!0}],imports:[[et.a,nt.a,tt.a,it.a]]})},oUDv:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("7ond"),s=i("fXoL");class r{constructor(e,t){this.FocusHelper=e,this.elementRef=t,this.priority=0}ngAfterViewInit(){this.updateFocus()}updateFocus(){if(this.condition){const e=jQuery(this.elementRef.nativeElement);this.FocusHelper.focusElement(e,this.priority)}}}r.\u0275fac=function(e){return new(e||r)(s.bc(n.a),s.bc(s.q))},r.\u0275dir=s.Wb({type:r,selectors:[["","focus",""]],inputs:{condition:["focus","condition"],priority:["focusPriority","priority"]}})},"oa+u":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{forValue(e){return this.dependencies[e]}}},ooSb:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("/cHX"),s=i("lJrL"),r=i("PkGb"),a=i("cd/7"),c=i("iB+3");class o extends n.a{constructor(){super(...arguments),this.identifier="open-details-action",this.uiStatebuilder=new a.a(this.injector.get(c.StateService),this.injector.get(r.a)),this.text={button:this.I18n.t("js.button_open_details")}}buildElement(){let e=this.uiStatebuilder.linkToDetails(this.workPackage.id,this.text.button,"");return e.classList.add("wp-table--details-link",n.b,"hidden-for-mobile"),e.appendChild(Object(s.a)("icon","icon-info2")),e}}class l extends n.a{constructor(){super(...arguments),this.identifier="open-context-menu-action",this.text={linkTitle:this.I18n.t("js.label_open_context_menu")}}buildElement(){let e=document.createElement("a");return e.href="#",e.classList.add(n.c,n.b),e.title=this.text.linkTitle,e.appendChild(Object(s.a)("icon","icon-show-more-horizontal")),e}}var d=i("fXoL");class u{constructor(e){this.injector=e,this.actions=[(e,t)=>new o(e,t),(e,t)=>new l(e,t)]}setActions(...e){this.actions=e}render(e){let t=this.actions.map(t=>t(this.injector,e).buildElement());return _.compact(t)}}u.\u0275fac=function(e){return new(e||u)(d.lc(d.A))},u.\u0275prov=d.Xb({token:u,factory:u.\u0275fac})},oqKi:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){}get isEmpty(){return!this.name}setIfFirst(e,t){this.isEmpty&&e&&(this.name=e,this.params=t)}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac})},p5fp:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("xLNn"),s=i("wZYP"),r=i("l08T"),a=i("F5Dh"),c=i("Hg4z"),o=i("fXoL"),l=i("ofXK"),d=i("N5AO");function u(e,t){if(1&e&&o.cc(0,"span",4),2&e){const e=o.rc();o.wc("textContent",e.filterCount)}}const h=function(e){return{"-active":e}};class p extends n.a{constructor(e,t,i,n){super(e),this.I18n=e,this.cdRef=t,this.wpFiltersService=i,this.wpTableFilters=n,this.initialized=!1,this.buttonId="work-packages-filter-toggle-button",this.iconClass="icon-filter"}ngOnInit(){this.setupObserver()}get labelKey(){return"js.button_filter"}get textKey(){return"js.toolbar.filter"}get label(){return this.prefix+this.text.label}get filterCount(){return this.count}performAction(e){this.toggleVisibility()}toggleVisibility(){this.wpFiltersService.toggleVisibility()}setupObserver(){this.wpTableFilters.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.count=this.wpTableFilters.currentlyVisibleFilters.length,this.initialized=!0,this.cdRef.detectChanges()}),this.wpFiltersService.observeUntil(Object(c.b)(this)).subscribe(()=>{this.isActive=this.wpFiltersService.visible,this.cdRef.detectChanges()})}}p.\u0275fac=function(e){return new(e||p)(o.bc(s.a),o.bc(o.i),o.bc(r.a),o.bc(a.a))},p.\u0275cmp=o.Vb({type:p,selectors:[["wp-filter-button"]],features:[o.Mb],decls:5,vars:11,consts:[[1,"button",3,"disabled","ngClass","click"],[3,"icon-classes"],[1,"button--text"],["class","badge -secondary",3,"textContent",4,"ngIf"],[1,"badge","-secondary",3,"textContent"]],template:function(e,t){1&e&&(o.hc(0,"button",0),o.pc("click",(function(e){return t.performAction(e)})),o.cc(1,"op-icon",1),o.hc(2,"span",2),o.Vc(3),o.Tc(4,u,1,1,"span",3),o.gc(),o.gc()),2&e&&(o.wc("disabled",t.disabled)("ngClass",o.Bc(9,h,t.isActive)),o.Qb("id",t.buttonId)("accesskey",t.accessKey)("title",t.label)("aria-label",t.label),o.Pb(1),o.yc("icon-classes","",t.iconClass," button--icon"),o.Pb(2),o.Xc(" ",t.buttonText," "),o.Pb(1),o.wc("ngIf",t.initialized))},directives:[l.n,d.a,l.q],encapsulation:2,changeDetection:0})},pL6k:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("kt6C"),s=i("fXoL");class r{constructor(e){this.paginationService=e}buildQueryString(e){if(!e)return;let t=[];return _.each(e,(e,i)=>{e&&(Array.isArray(e)||(e=[e]),_.each(e,e=>{null!==e&&"object"==typeof e&&(e=JSON.stringify(e)),t.push(encodeURIComponent(i)+"="+encodeURIComponent(e))}))}),t.join("&")}encodeQueryJsonParams(e,t={}){let i={};return i=this.encodeColumns(i,e),i=this.encodeSums(i,e),i=this.encodeTimelineVisible(i,e),i=this.encodeHighlightingMode(i,e),i=this.encodeHighlightedAttributes(i,e),i.hi=!!e.showHierarchies,i.g=_.get(e.groupBy,"id",""),i=this.encodeSortBy(i,e),i=this.encodeFilters(i,e.filters),i.pa=t.page,i.pp=t.perPage,i.dr=e.displayRepresentation,JSON.stringify(i)}encodeColumns(e,t){return e.c=t.columns.map((function(e){return e.id})),e}encodeSums(e,t){return t.sums&&(e.s=t.sums),e}encodeHighlightingMode(e,t){return t.highlightingMode&&(t.persisted||"inline"!==t.highlightingMode)&&(e.hl=t.highlightingMode),e}encodeHighlightedAttributes(e,t){return"inline"===t.highlightingMode&&Array.isArray(t.highlightedAttributes)&&t.highlightedAttributes.length>0&&(e.hla=t.highlightedAttributes.map(e=>e.id)),e}encodeSortBy(e,t){return t.sortBy&&(e.t=t.sortBy.map((function(e){return e.id.replace("-",":")})).join()),e}encodeFilters(e,t){return t&&t.length>0?e.f=t.map(e=>({n:e.id,o:e.operator.id,v:_.map(e.values,e=>this.queryFilterValueToParam(e))})):e.f=[],e}encodeTimelineVisible(e,t){return t.timelineVisible?(e.tv=t.timelineVisible,_.isEmpty(t.timelineLabels)||(e.tll=JSON.stringify(t.timelineLabels)),e.tzl=t.timelineZoomLevel):e.tv=!1,e}buildV3GetQueryFromJsonParams(e){var t={pageSize:this.paginationService.getPerPage()};if(!e)return t;var i=JSON.parse(e);if(i.c&&(t["columns[]"]=i.c.map(e=>e)),i.s&&(t.showSums=i.s),t.timelineVisible=i.tv,i.tv&&(i.tll&&(t.timelineLabels=i.tll),i.tzl&&(t.timelineZoomLevel=i.tzl)),i.dr&&(t.displayRepresentation=i.dr),i.hl&&(t.highlightingMode=i.hl),i.hla&&(t["highlightedAttributes[]"]=i.hla.map(e=>e)),!1!==i.hi&&!0!==i.hi||(t.showHierarchies=i.hi),t.groupBy=_.get(i,"g",""),i.f){var n=i.f.map((function(e){var t={operator:decodeURIComponent(e.o)};if(e.v){var i=Array.isArray(e.v)?e.v:[e.v];_.extend(t,{values:i})}const n={};return n[e.n]=t,n}));t.filters=JSON.stringify(n)}return i.t&&(t.sortBy=JSON.stringify(i.t.split(",").map(e=>e.split(":")))),i.pa&&(t.offset=i.pa),i.pp&&(t.pageSize=i.pp),t}buildV3GetQueryFromQueryResource(e,t={},i={}){var n={};return n["columns[]"]=this.buildV3GetColumnsFromQueryResource(e),n.showSums=e.sums,n.timelineVisible=!!e.timelineVisible,e.timelineVisible&&(n.timelineZoomLevel=e.timelineZoomLevel,n.timelineLabels=JSON.stringify(e.timelineLabels)),e.highlightingMode&&(n.highlightingMode=e.highlightingMode),e.highlightedAttributes&&"inline"===e.highlightingMode&&(n["highlightedAttributes[]"]=e.highlightedAttributes.map(e=>e.href)),e.displayRepresentation&&(n.displayRepresentation=e.displayRepresentation),n.showHierarchies=!!e.showHierarchies,n.groupBy=_.get(e.groupBy,"id",""),n.filters=this.buildV3GetFiltersAsJson(e.filters,i),n.sortBy=this.buildV3GetSortByFromQuery(e),_.extend(t,n)}queryFilterValueToParam(e){return"boolean"==typeof e?e?"t":"f":e?e.id?e.id.toString():e.$href?e.$href.split("/").pop().toString():e.toString():""}buildV3GetColumnsFromQueryResource(e){return e.columns?e.columns.map(e=>e.id||e.idFromLink):e._links.columns?e._links.columns.map(e=>{let t=e.href;return this.idFromHref(t)}):void 0}buildV3GetFilters(e,t={}){return e.map(e=>{let i=this.buildV3GetFilterIdFromFilter(e),n=this.buildV3GetOperatorIdFromFilter(e),s=this.buildV3GetValuesFromFilter(e).map(e=>(_.each(t,(t,i)=>{e=e.replace(`{${i}}`,t)}),e));const r={};return r[i]={operator:n,values:s},r})}buildV3GetFiltersAsJson(e,t={}){return JSON.stringify(this.buildV3GetFilters(e,t))}buildV3GetFilterIdFromFilter(e){let t=e.filter?e.filter.$href:e._links.filter.href;return this.idFromHref(t)}buildV3GetOperatorIdFromFilter(e){if(e.operator)return e.operator.id||e.operator.idFromLink;{let t=e._links.operator.href;return this.idFromHref(t)}}buildV3GetValuesFromFilter(e){return e.values?_.map(e.values,e=>this.queryFilterValueToParam(e)):_.map(e._links.values,e=>this.idFromHref(e.href))}buildV3GetSortByFromQuery(e){let t=(e.sortBy?e.sortBy:e._links.sortBy).map(e=>{if(e.id)return e.id;{let t=e.href;return this.idFromHref(t)}});return JSON.stringify(t.map(e=>e.split("-")))}idFromHref(e){let t=e.substring(e.lastIndexOf("/")+1,e.length);return decodeURIComponent(t)}}r.\u0275fac=function(e){return new(e||r)(s.lc(n.a))},r.\u0275prov=s.Xb({token:r,factory:r.\u0275fac,providedIn:"root"})},pQre:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("mrSG"),s=i("iB+3"),r=i("PkGb"),a=i("r0MM"),c=i("fXoL");class o{constructor(e){this.injector=e}goToOtherState(e,t){return this.$state.go(e,t)}goBackToDetailsState(e,t){e?this.goToOtherState(t,this.backRoute.params):this.goToOtherState(t+this.keepTab.currentDetailsSubState,this.backRoute.params)}goBackNotToDetailsState(){this.backRoute.parent?this.goToOtherState(this.backRoute.name,this.backRoute.params).then(()=>{this.$state.reload()}):this.goToOtherState(this.backRoute.name,this.backRoute.params)}goBackToPreviousState(e,t){this.keepTab.isDetailsState(this.backRoute.parent)?this.goBackToDetailsState(e,t):this.goBackNotToDetailsState()}goBack(e=!1){var t;const i=(null===(t=this.backRoute)||void 0===t?void 0:t.baseRoute)||this.$state.current.data.baseRoute||"work-packages.partitioned.list";!this.backRoute&&i.includes("show")?this.$state.reload():!this.backRoute||this.backRoute.name.includes("new")?this.$state.go(i,this.$state.params):this.goBackToPreviousState(e,i)}goToBaseState(){const e=this.$state.current.data.baseRoute||"work-packages.partitioned.list";this.$state.go(e,this.$state.params)}sync(e){const t=e.from(),i=e.to();if(t.name&&t.data&&i.data&&t.data.parent!==i.data.parent){const i=Object.assign({},e.params("from"));this.backRoute={name:t.name,params:i,parent:t.data.parent,baseRoute:t.data.baseRoute}}}set backRoute(e){this._backRoute=e}get backRoute(){return this._backRoute}}o.\u0275fac=function(e){return new(e||o)(c.lc(c.A))},o.\u0275prov=c.Xb({token:o,factory:o.\u0275fac,providedIn:"root"}),Object(n.c)([Object(a.a)(),Object(n.e)("design:type",s.StateService)],o.prototype,"$state",void 0),Object(n.c)([Object(a.a)(),Object(n.e)("design:type",r.a)],o.prototype,"keepTab",void 0)},pSHE:function(e,t,i){"use strict";i.d(t,"a",(function(){return C}));var n=i("E2tj");class s{constructor(e,t){this.querySpace=e,this.injector=t}get applies(){return!0}onNewOrder(e){}canPickup(e){return!0}handleDrop(e,t){return Promise.resolve(void 0)}changeShadowElement(e,t=!1){return t?e.classList.remove("-dragged"):e.classList.add("-dragged"),!0}}var r=i("mrSG"),a=i("wyKs"),c=i("VgZ9"),o=i("CBsm"),l=i("5+Sy"),d=i("r0MM"),u=i("CNq7");class h extends s{get applies(){return this.wpTableHierarchies.isEnabled}canPickup(e){return!!e.changeParent}handleDrop(e,t){return this.determineParent(t).then(t=>this.relationHierarchyService.changeParent(e,t))}determineParent(e){let t=e.previousElementSibling,i=e.nextElementSibling,n=null;if(null!==t&&this.droppedIntoGroup(e,t,i)){if(t.className.indexOf(Object(l.e)())>=0){let e=this.findRelationRowRoot(t);if(null==e)return Promise.resolve(null);t=e}let e=t.dataset.workPackageId;if(this.isHiearchyRoot(t,e)){if(Object(l.a)(i))return this.determineParent(t);n=e}else n=this.loadParentOfWP(e)}return Promise.resolve(n)}findRelationRowRoot(e){let t=e.previousElementSibling;for(;null!==t;){if(t.className.indexOf(Object(l.e)())<0)return t;t=t.previousElementSibling}return null}droppedIntoGroup(e,t,i){const n=t.className.indexOf(Object(o.c)(""))>=0,s=t.className.indexOf(Object(o.d)(""))>=0;let r;if(n||s){const n=Array.from(e.classList).filter(e=>e.includes("__hierarchy-group-"))||[],s=Array.from(t.classList).filter(e=>e.includes("__hierarchy-group-"))||[],a=i&&Array.from(i.classList).filter(e=>e.includes("__hierarchy-group-"))||[],c=t.dataset.workPackageId,l=!a.some(e=>s.includes(e))&&!a.includes(Object(o.c)(c)),d=n.some(e=>s.includes(e))||n.includes(Object(o.c)(c));r=l&&!d}return!r&&n||s}isHiearchyRoot(e,t){return e.classList.contains(Object(o.d)(t))}loadParentOfWP(e){return this.apiV3Service.work_packages.id(e).get().toPromise().then(e=>{var t;return Promise.resolve((null===(t=e.parent)||void 0===t?void 0:t.id)||null)})}}Object(r.c)([Object(d.a)(),Object(r.e)("design:type",a.a)],h.prototype,"wpTableHierarchies",void 0),Object(r.c)([Object(d.a)(),Object(r.e)("design:type",c.a)],h.prototype,"relationHierarchyService",void 0),Object(r.c)([Object(d.a)(),Object(r.e)("design:type",u.a)],h.prototype,"apiV3Service",void 0);var p=i("AeZM"),g=i("SKFm"),f=i("nbRO"),b=i("T9ri"),m=i("POAS"),w=i("/C7M"),v=i("dMmB");class y extends s{get applies(){return this.wpTableGroupBy.isEnabled}canPickup(e){const t=this.groupedAttribute;return null!==t&&this.schemaCache.of(e).isAttributeEditable(t)}handleDrop(e,t){const i=this.halEditing.changeFor(e),n=this.getValueForGroup(t);return i.projectedResource[this.groupedAttribute]=n,this.halEditing.save(i).then(e=>this.halEvents.push(e.resource,{eventType:"updated"})).catch(t=>this.halNotification.handleRawError(t,e))}getValueForGroup(e){const t=Object(l.b)(e,"."+f.b),i=this.groups.find(e=>Object(b.c)(e)===t.dataset.groupIdentifier);if(!i)return null;if(i._links&&i._links.valueLink){const e=i._links.valueLink;return 1===e.length?e[0]:e}return i.value}get groupedAttribute(){const e=this.wpTableGroupBy.current;return e?e.id:null}get groups(){return this.querySpace.groups.value||[]}}Object(r.c)([Object(d.a)(),Object(r.e)("design:type",p.a)],y.prototype,"wpTableGroupBy",void 0),Object(r.c)([Object(d.a)(),Object(r.e)("design:type",g.a)],y.prototype,"halEditing",void 0),Object(r.c)([Object(d.a)(),Object(r.e)("design:type",w.a)],y.prototype,"halEvents",void 0),Object(r.c)([Object(d.a)(),Object(r.e)("design:type",m.a)],y.prototype,"halNotification",void 0),Object(r.c)([Object(d.a)(),Object(r.e)("design:type",v.a)],y.prototype,"schemaCache",void 0);var k=i("fXoL");class C{constructor(){this.register=[h,y]}add(e){this.register.push(e)}get(e){const t=e.get(n.a);return this.register.map(i=>new i(t,e)).find(e=>e.applies)||new s(t,e)}}C.\u0275fac=function(e){return new(e||C)},C.\u0275prov=k.Xb({token:C,factory:C.\u0275fac})},pXJr:function(e,t,i){"use strict";var n;i.d(t,"a",(function(){return n})),function(e){e.imagePath=function(e){return i.p+"assets/images/"+e}}(n||(n={}))},pXZk:function(e,t,i){"use strict";i.d(t,"c",(function(){return c})),i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return l}));var n=i("mrSG"),s=i("KEdw"),r=i("dMmB"),a=i("r0MM");const c="wp-table--cell-td",o="wp-table--cell-container";class l{constructor(e){this.injector=e,this.fieldRenderer=new s.a(this.injector,"table")}build(e,t){const i=document.createElement("td"),n=t.id;i.classList.add(c,n),"subject"===n&&i.classList.add("-max");const r=this.schemaCache.of(e).ofProperty(n);r&&"User"===r.type&&i.classList.add("-contains-avatar");const a=document.createElement("span");a.classList.add(o,s.c,n);const l=this.fieldRenderer.render(e,n,null);return a.appendChild(l),i.appendChild(a),i}refresh(e,t,i){const n=this.fieldRenderer.render(t,i,null);e.innerHTML="",e.appendChild(n)}}Object(n.c)([Object(a.a)(r.a),Object(n.e)("design:type",r.a)],l.prototype,"schemaCache",void 0)},"q/QC":function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("wZYP"),s=(i("AA01"),i("Y41n")),r=i("AEvm"),a=i("Hg4z"),c=i("fXoL"),o=i("3Pt+"),l=i("oUDv");class d extends r.a{constructor(e){super(),this.I18n=e,this.shouldFocus=!1,this.filterChanged=new s.a(Object(a.b)(this)),this.text={enter_text:this.I18n.t("js.work_packages.description_enter_text")}}get value(){return this.filter.values[0]}set value(e){e.length?this.filter.values[0]=e:this.filter.values.length=0,this.filterChanged.emit(this.filter)}}d.\u0275fac=function(e){return new(e||d)(c.bc(n.a))},d.\u0275cmp=c.Vb({type:d,selectors:[["filter-string-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[c.Mb],decls:3,vars:7,consts:[[3,"id"],["requried","true","type","text",1,"advanced-filters--text-field",3,"ngModel","focus","id","name","ngModelChange"],[1,"hidden-for-sighted",3,"for","textContent"]],template:function(e,t){1&e&&(c.hc(0,"div",0),c.hc(1,"input",1),c.pc("ngModelChange",(function(e){return t.value=e})),c.gc(),c.cc(2,"label",2),c.gc()),2&e&&(c.yc("id","div-values-",t.filter.name,""),c.Pb(1),c.yc("id","values-",t.filter.name,""),c.yc("name","v[",t.filter.name,"]"),c.wc("ngModel",t.value)("focus",t.shouldFocus),c.Pb(1),c.yc("for","values-",t.filter.name,""),c.wc("textContent",t.text.enter_text))},directives:[o.c,o.m,o.p,l.a],encapsulation:2})},qHU1:function(e,t,i){"use strict";i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return a}));var n=i("AytR");function s(e){n.a.production||e()}function r(e,...t){s(()=>console.log("[DEBUG] "+e,...t))}function a(e,t){if(n.a.production)return t();var i=performance.now(),s=t(),r=performance.now();return console.log(`%c${e} completed in ${r-i} milliseconds.`,"color:#00A093;"),s}},qc15:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("POAS"),s=i("CNq7"),r=i("fXoL");class a extends n.a{constructor(e,t){super(e),this.injector=e,this.apiV3Service=t}showSave(e,t=!1){let i={message:this.I18n.t("js.notice_successful_"+(t?"create":"update"))};this.addWorkPackageFullscreenLink(i,e),this.NotificationsService.addSuccess(i)}showCustomError(e,t){return"urn:openproject-org:api:v3:errors:UpdateConflict"===e.errorIdentifier?(this.NotificationsService.addError({message:e.message,type:"error",link:{text:this.I18n.t("js.hal.error.update_conflict_refresh"),target:()=>this.apiV3Service.work_packages.id(t).refresh()}}),!0):super.showCustomError(e,t)}addWorkPackageFullscreenLink(e,t){this.$state.includes("work-packages.show")||(e.link={target:()=>this.$state.go("work-packages.show.activity",{workPackageId:t.id}),text:this.I18n.t("js.work_packages.message_successful_show_in_fullscreen")})}}a.\u0275fac=function(e){return new(e||a)(r.lc(r.A),r.lc(s.a))},a.\u0275prov=r.Xb({token:a,factory:a.\u0275fac})},qg8y:function(e,t,i){"use strict";i.d(t,"a",(function(){return s})),i.d(t,"b",(function(){return r}));var n=i("Mo6U");const s="urn:openproject-org:api:v3:queries:directions:asc",r="urn:openproject-org:api:v3:queries:directions:desc";n.a;n.a},qs3h:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("iB+3"),s=i("wZYP"),r=i("AEvm"),a=i("CNq7"),c=i("fXoL"),o=i("ofXK"),l=i("m0WY");function d(e,t){if(1&e&&(c.hc(0,"div",1),c.hc(1,"div",2),c.cc(2,"wp-relations",3),c.gc(),c.gc()),2&e){const e=c.rc();c.Pb(2),c.wc("workPackage",e.workPackage)}}class u extends r.a{constructor(e,t,i){super(),this.I18n=e,this.$transition=t,this.apiV3Service=i}ngOnInit(){const e=this.workPackageId||this.$transition.params("to").workPackageId;this.apiV3Service.work_packages.id(e).requireAndStream().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackageId=e.id,this.workPackage=e})}}u.\u0275fac=function(e){return new(e||u)(c.bc(s.a),c.bc(n.Transition),c.bc(a.a))},u.\u0275cmp=c.Vb({type:u,selectors:[["wp-relations-tab"]],inputs:{workPackageId:"workPackageId"},features:[c.Mb],decls:1,vars:1,consts:[["class","detail-panel-description detail-panel--relations detail-panel--autocomplete-target",4,"ngIf"],[1,"detail-panel-description","detail-panel--relations","detail-panel--autocomplete-target"],[1,"detail-panel-description-content"],[3,"workPackage"]],template:function(e,t){1&e&&c.Tc(0,d,3,1,"div",0),2&e&&c.wc("ngIf",t.workPackage)},directives:[o.q,l.a],encapsulation:2})},qtzK:function(e,t,i){"use strict";i.d(t,"a",(function(){return w}));var n=i("mrSG"),s=i("Q6HB"),r=i("iMRi"),a=i("VgZ9"),c=i("eyhC"),o=i("13ri"),l=i("9+6k"),d=i("4lR/"),u=i("TM9v"),h=i("IaZ+"),p=i("UUNb"),g=i("iB+3"),f=i("r0MM"),b=i("xQCb"),m=i("2G+H");class w extends l.a{constructor(e,t,i,n={},s=!0){super(e.get(d.a)),this.injector=e,this.workPackageId=t,this.$element=i,this.additionalPositionArgs=n,this.allowSplitScreenActions=s,this.workPackage=this.states.workPackages.get(this.workPackageId).value,this.selectedWorkPackages=this.getSelectedWorkPackages(),this.permittedActions=this.WorkPackageContextMenuHelper.getPermittedActions(this.selectedWorkPackages,u.a,this.allowSplitScreenActions),this.baseRoute=this.$state.current.data.baseRoute||this.$state.current.name,this.items=this.buildItems()}get locals(){return{contextMenuId:"work-package-context-menu",items:this.items}}positionArgs(e){let t=super.positionArgs(e);return _.assign(t,this.additionalPositionArgs),t}triggerContextMenuAction(e){const t=e.link;switch(e.key){case"delete":this.deleteSelectedWorkPackages();break;case"edit":this.editSelectedWorkPackages(t);break;case"copy":this.copySelectedWorkPackages(t);break;case"relation-new-child":this.wpRelationsHierarchyService.addNewChildWp(this.baseRoute,this.workPackage);break;case"log_time":this.logTimeForSelectedWorkPackage();break;default:window.location.href=t}}deleteSelectedWorkPackages(){let e=this.getSelectedWorkPackages();this.opModalService.show(p.a,this.injector,{workPackages:e})}editSelectedWorkPackages(e){this.getSelectedWorkPackages().length>1&&(window.location.href=e)}copySelectedWorkPackages(e){let t=this.getSelectedWorkPackages();if(t.length>1)return void(window.location.href=e);let i={copiedFromWorkPackageId:t[0].id};this.$state.go(this.baseRoute+".copy",i)}logTimeForSelectedWorkPackage(){this.timeEntryCreateService.create(moment(new Date),this.workPackage).catch(()=>{})}getSelectedWorkPackages(){let e=this.wpTableSelection.getSelectedWorkPackages();return 0===e.length?[this.workPackage]:(-1===e.indexOf(this.workPackage)&&e.push(this.workPackage),e)}buildItems(){let e=this.permittedActions.map(e=>({class:void 0,disabled:!1,linkText:e.text,href:e.href,icon:null!=e.icon?e.icon:"icon-"+e.key,onClick:t=>(!e.href||!o.a.isClickedWithModifier(t))&&(this.triggerContextMenuAction(e),!0)}));return this.workPackage.isNew||(e.unshift({disabled:!1,icon:"icon-view-fullscreen",class:"openFullScreenView",href:this.$state.href("work-packages.show",{workPackageId:this.workPackageId}),linkText:I18n.t("js.button_open_fullscreen"),onClick:e=>!o.a.isClickedWithModifier(e)&&(this.$state.go("work-packages.show",{workPackageId:this.workPackageId}),!0)}),this.allowSplitScreenActions&&e.unshift({disabled:!1,icon:"icon-view-split",class:"detailsViewMenuItem",href:this.$state.href(Object(m.a)(this.$state)+".overview",{workPackageId:this.workPackageId}),linkText:I18n.t("js.button_open_details"),onClick:e=>!o.a.isClickedWithModifier(e)&&(this.$state.go(Object(m.a)(this.$state)+".overview",{workPackageId:this.workPackageId}),!0)})),e}}Object(n.c)([Object(f.a)(),Object(n.e)("design:type",r.a)],w.prototype,"states",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",a.a)],w.prototype,"wpRelationsHierarchyService",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",h.b)],w.prototype,"opModalService",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",g.StateService)],w.prototype,"$state",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",c.a)],w.prototype,"wpTableSelection",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",s.a)],w.prototype,"WorkPackageContextMenuHelper",void 0),Object(n.c)([Object(f.a)(),Object(n.e)("design:type",b.a)],w.prototype,"timeEntryCreateService",void 0)},qvi4:function(e,t,i){"use strict";i.d(t,"b",(function(){return h})),i.d(t,"a",(function(){return p}));var n=i("xLNn"),s=i("wZYP"),r=i("k7+O"),a=i("fXoL"),c=i("ofXK"),o=i("kor4"),l=i("N5AO");const d=function(e){return{"-active":e}},u=r,h="zen-mode-toggle-button";class p extends n.a{constructor(e,t){super(e),this.I18n=e,this.cdRef=t,this.buttonId="work-packages-zen-mode-toggle-button",this.buttonClass="toolbar-icon",this.iconClass="icon-zen-mode",this.activateLabel=e.t("js.zen_mode.button_activate"),this.deactivateLabel=e.t("js.zen_mode.button_deactivate");let i=this;u.enabled&&u.onchange((function(){u.isFullscreen||i.deactivateZenMode()}))}get label(){return this.isActive?this.deactivateLabel:this.activateLabel}isToggle(){return!0}deactivateZenMode(){this.isActive=p.inZenMode=!1,jQuery("body").removeClass("zen-mode"),this.disabled=!1,u.enabled&&u.isFullscreen&&u.exit(),this.cdRef.detectChanges()}activateZenMode(){this.isActive=p.inZenMode=!0,jQuery("body").addClass("zen-mode"),u.enabled&&u.request(),this.cdRef.detectChanges()}performAction(e){return p.inZenMode?this.deactivateZenMode():this.activateZenMode(),e.preventDefault(),!1}}p.inZenMode=!1,p.\u0275fac=function(e){return new(e||p)(a.bc(s.a),a.bc(a.i))},p.\u0275cmp=a.Vb({type:p,selectors:[["zen-mode-toggle-button"]],features:[a.Mb],decls:2,vars:11,consts:[["type","button",3,"ngClass","disabled","accessibleClick"],[3,"icon-classes"]],template:function(e,t){1&e&&(a.hc(0,"button",0),a.pc("accessibleClick",(function(e){return t.performAction(e)})),a.cc(1,"op-icon",1),a.gc()),2&e&&(a.Rb("button ",t.buttonClass,""),a.wc("ngClass",a.Bc(9,d,t.isActive))("disabled",t.disabled||!t.isToggle()&&t.isActive),a.Qb("id",t.buttonId)("title",t.label)("accesskey",t.accessKey),a.Pb(1),a.yc("icon-classes","",t.iconClass," button--icon"))},directives:[c.n,o.a,l.a],encapsulation:2,changeDetection:0})},r0MM:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));i("mNvP");var n=i("qHU1");function s(e,t=null){return(i,s)=>{delete i[s]&&Object.defineProperty(i,s,{get:function(){if(e)return this.injector.get(e,t);{const e=Reflect.getMetadata("design:type",i,s);return this.injector.get(e)}},set:function(e){Object(n.a)("Trying to set InjectField property "+s)}})}}},r76g:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("wZYP"),s=i("8zkO"),r=i("JY8V"),a=i("fbLK"),c=i("fXoL"),o=i("jQQo"),l=i("ofXK"),d=i("xFOf");function u(e,t){if(1&e&&c.cc(0,"enterprise-banner",5),2&e){const e=c.rc();c.wc("linkMessage",e.text.upsaleCheckOutLink)("textMessage",e.text.upsaleRelationColumns)}}class h{constructor(e,t,i,n,s){this.injector=e,this.I18n=t,this.wpTableColumns=i,this.ConfigurationService=n,this.bannerService=s,this.availableColumnsOptions=this.wpTableColumns.all.map(e=>this.column2Like(e)),this.availableColumns=this.wpTableColumns.all,this.availableColumnsMap=_.keyBy(this.availableColumns,e=>e.id),this.selectedColumns=this.wpTableColumns.getColumns().map(e=>this.column2Like(e)),this.selectedColumnMap={},this.eeShowBanners=!1,this.text={columnsHelp:this.I18n.t("js.work_packages.table_configuration.columns_help_text"),columnsLabel:this.I18n.t("js.label_columns"),selectedColumns:this.I18n.t("js.description_selected_columns"),multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect"),upsaleRelationColumns:this.I18n.t("js.work_packages.table_configuration.upsale.relation_columns"),upsaleCheckOutLink:this.I18n.t("js.work_packages.table_configuration.upsale.check_out_link")}}onSave(){this.wpTableColumns.setColumnsById(this.selectedColumns.map(e=>e.id))}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners,this.selectedColumns.forEach(e=>{this.selectedColumnMap[e.id]=!0})}column2Like(e){return{id:e.id,name:e.name}}updateSelected(e){this.selectedColumns=e}}h.\u0275fac=function(e){return new(e||h)(c.bc(c.A),c.bc(n.a),c.bc(r.a),c.bc(s.a),c.bc(a.a))},h.\u0275cmp=c.Vb({type:h,selectors:[["ng-component"]],decls:5,vars:5,consts:[[1,"columns-modal--content"],[1,"hidden-for-sighted",3,"textContent"],[3,"options","selected","onChange"],[1,"form--inline-instructions",3,"textContent"],["class","ee-relation-columns-upsale","opReferrer","wp-list-columns#relations",3,"linkMessage","textMessage",4,"ngIf"],["opReferrer","wp-list-columns#relations",1,"ee-relation-columns-upsale",3,"linkMessage","textMessage"]],template:function(e,t){1&e&&(c.hc(0,"div",0),c.cc(1,"label",1),c.hc(2,"draggable-autocompleter",2),c.pc("onChange",(function(e){return t.updateSelected(e)})),c.gc(),c.cc(3,"p",3),c.gc(),c.Tc(4,u,1,2,"enterprise-banner",4)),2&e&&(c.Pb(1),c.wc("textContent",t.text.selectedColumns),c.Pb(1),c.wc("options",t.availableColumnsOptions)("selected",t.selectedColumns),c.Pb(1),c.wc("textContent",t.text.columnsHelp),c.Pb(1),c.wc("ngIf",t.eeShowBanners))},directives:[o.a,l.q,d.a],encapsulation:2})},rJ6b:function(e,t,i){"use strict";i.d(t,"a",(function(){return R}));var n=i("iB+3"),s=i("eyhC"),r=i("rOco"),a=i("LRne"),c=i("POAS"),o=i("qc15"),l=i("fXoL"),d=i("ofXK"),u=i("711n"),h=i("2orT"),p=i("DLfB"),g=i("ZAVI"),f=i("2TbE"),b=i("qvi4"),m=i("P7xQ"),w=i("N5AO"),v=i("aveh"),y=i("oUDv"),k=i("0loS"),C=i("S2zE"),j=i("f24R"),P=i("8+xT"),x=i("9pt+");function S(e,t){if(1&e&&(l.hc(0,"li",30),l.cc(1,"wp-watcher-button",31),l.gc()),2&e){const e=l.rc(2);l.Pb(1),l.wc("workPackage",e.workPackage)("showText",!1)}}const _=function(e){return{workPackageId:e}};function O(e,t){if(1&e&&(l.hc(0,"li",32),l.cc(1,"a",23),l.cc(2,"wp-watchers-count",25),l.gc()),2&e){const e=l.rc(2);l.wc("uiParams",l.Bc(3,_,e.workPackage.id)),l.Pb(1),l.wc("textContent",e.text.tabs.watchers),l.Pb(1),l.wc("wpId",e.workPackage.id)}}const I=function(){return["work_package.addChild","work_package.copy"]};function T(e,t){if(1&e&&(l.hc(0,"div",1),l.cc(1,"wp-breadcrumb",2),l.hc(2,"div",3),l.hc(3,"div",4),l.hc(4,"div",5),l.cc(5,"back-button",6),l.hc(6,"div",7),l.cc(7,"wp-subject"),l.gc(),l.gc(),l.hc(8,"ul",8),l.hc(9,"li",9),l.cc(10,"wp-create-button",10),l.gc(),l.Tc(11,S,2,2,"li",11),l.hc(12,"li",9),l.cc(13,"zen-mode-toggle-button"),l.gc(),l.hc(14,"li",12),l.hc(15,"button",13),l.cc(16,"op-icon",14),l.gc(),l.gc(),l.gc(),l.gc(),l.gc(),l.hc(17,"div",15),l.hc(18,"div",16),l.hc(19,"div",17),l.cc(20,"wp-single-view",2),l.gc(),l.gc(),l.hc(21,"div",18),l.hc(22,"div",17),l.cc(23,"span",19),l.hc(24,"div",20),l.hc(25,"ul",21),l.hc(26,"li",22),l.cc(27,"a",23),l.gc(),l.hc(28,"li",24),l.cc(29,"a",23),l.cc(30,"wp-relations-count",25),l.gc(),l.Tc(31,O,3,5,"li",26),l.gc(),l.gc(),l.cc(32,"div",27),l.gc(),l.hc(33,"div",28),l.cc(34,"wp-resizer",29),l.gc(),l.gc(),l.gc(),l.gc()),2&e){const e=l.rc();l.wc("resource",e.workPackage),l.Pb(1),l.wc("workPackage",e.workPackage),l.Pb(9),l.wc("allowed",l.Ac(17,I))("stateName$",e.stateName$),l.Pb(1),l.wc("ngIf",e.displayWatchButton),l.Pb(4),l.wc("wpSingleContextMenu-workPackage",e.workPackage),l.Qb("title",e.text.full_view.button_more),l.Pb(5),l.wc("workPackage",e.workPackage),l.Pb(3),l.wc("textContent",e.focusAnchorLabel),l.Pb(3),l.wc("uiParams",l.Bc(18,_,e.workPackage.id)),l.Pb(1),l.wc("textContent",e.text.tabs.activity),l.Pb(1),l.wc("uiParams",l.Bc(20,_,e.workPackage.id)),l.Pb(1),l.wc("textContent",e.text.tabs.relations),l.Pb(1),l.wc("wpId",e.workPackage.id),l.Pb(1),l.wc("ngIf",e.canViewWorkPackageWatchers()),l.Pb(3),l.wc("elementClass","work-packages-full-view--split-right")("localStorageKey","openProject-fullViewFlexBasis")}}class R extends r.a{constructor(e,t,i){super(e,i.params.workPackageId),this.injector=e,this.wpTableSelection=t,this.$state=i,this.stateName$=Object(a.a)("work-packages.new")}ngOnInit(){this.observeWorkPackage()}initializeTexts(){super.initializeTexts(),this.text.full_view={button_more:this.I18n.t("js.button_more")}}init(){super.init(),this.wpTableFocus.updateFocus(this.workPackage.id),this.setWorkPackageScopeProperties(this.workPackage)}setWorkPackageScopeProperties(e){this.isWatched=e.hasOwnProperty("unwatch"),this.displayWatchButton=e.hasOwnProperty("unwatch")||e.hasOwnProperty("watch"),e.watchers&&(this.watchers=e.watchers.elements)}}R.\u0275fac=function(e){return new(e||R)(l.bc(l.A),l.bc(s.a),l.bc(n.StateService))},R.\u0275cmp=l.Vb({type:R,selectors:[["wp-full-view-entry"]],hostAttrs:[1,"work-packages-page--ui-view"],features:[l.Ob([{provide:c.a,useExisting:o.a}]),l.Mb],decls:1,vars:1,consts:[["edit-form","","class","work-packages--show-view",3,"resource",4,"ngIf"],["edit-form","",1,"work-packages--show-view",3,"resource"],[3,"workPackage"],[1,"toolbar-container"],["id","toolbar"],[1,"wp-show--header-container"],["linkClass","work-packages-back-button"],[1,"subject-header"],["id","toolbar-items",1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-mobile"],[3,"allowed","stateName$"],["class","toolbar-item",4,"ngIf"],["id","action-show-more-dropdown-menu",1,"toolbar-item","action_menu_main"],["wpSingleContextMenu","",1,"button","dropdown-relative","toolbar-icon",3,"wpSingleContextMenu-workPackage"],["icon-classes","button--icon icon-show-more"],[1,"work-packages-full-view--split-container"],[1,"work-packages-full-view--split-left"],[1,"work-packages--panel-inner"],[1,"work-packages-full-view--split-right","work-packages-tab-view--overflow"],["tabindex","-1","focus","",1,"hidden-for-sighted",3,"textContent"],["id","tabs"],[1,"tabrow"],["uiSref","work-packages.show.activity","uiSrefActive","selected",3,"uiParams"],["href","",3,"textContent"],["uiSref","work-packages.show.relations","uiSrefActive","selected",3,"uiParams"],[3,"wpId"],["uiSref","work-packages.show.watchers","uiSrefActive","selected",3,"uiParams",4,"ngIf"],["ui-view","",1,"tabcontent"],[1,"work-packages-full-view--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"],[1,"toolbar-item"],[3,"workPackage","showText"],["uiSref","work-packages.show.watchers","uiSrefActive","selected",3,"uiParams"]],template:function(e,t){1&e&&l.Tc(0,T,35,22,"div",0),2&e&&l.wc("ngIf",t.workPackage)},directives:[d.q,u.a,h.a,p.a,g.a,f.a,b.a,m.a,w.a,v.a,y.a,k.UISref,k.UISrefActive,k.UISrefStatus,C.a,k.UIView,j.a,P.a,x.a],encapsulation:2})},rOco:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i("mrSG"),s=i("fXoL"),r=i("wZYP"),a=i("Jui0"),c=i("Y/CA"),o=i("dfy/"),l=i("Kg8T"),d=i("iMRi"),u=i("PkGb"),h=i("SKFm"),p=i("qc15"),g=i("r0MM"),f=i("AEvm"),b=i("CNq7");class m extends f.a{constructor(e,t){super(),this.injector=e,this.workPackageId=t,this.text={},this.initializeTexts()}observeWorkPackage(){this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackage=e,this.init(),this.cdRef.detectChanges()},e=>this.notificationService.handleRawError(e))}initializeTexts(){this.text.tabs={},["overview","activity","relations","watchers"].forEach(e=>{this.text.tabs[e]=this.I18n.t("js.work_packages.tabs."+e)})}init(){this.apiV3Service.projects.id(this.workPackage.project).requireAndStream().subscribe(()=>{this.projectIdentifier=this.workPackage.project.identifier,this.cdRef.detectChanges()}),this.authorisationService.initModelAuth("work_package",this.workPackage.$links),this.titleService.setFirstPart(this.workPackage.subjectWithType(20)),this.showStaticPagePath=this.PathHelper.workPackagePath(this.workPackageId),this.keepTab.observable.pipe(this.untilDestroyed()).subscribe(e=>{this.updateFocusAnchorLabel(e.active)})}updateFocusAnchorLabel(e){const t=this.I18n.t("js.label_work_package_details_you_are_here",{tab:this.I18n.t("js.work_packages.tabs."+e),type:this.workPackage.type.name,subject:this.workPackage.subject});return this.focusAnchorLabel=t}canViewWorkPackageWatchers(){return!(!this.workPackage||!this.workPackage.watchers)}}Object(n.c)([Object(g.a)(),Object(n.e)("design:type",d.a)],m.prototype,"states",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",r.a)],m.prototype,"I18n",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",u.a)],m.prototype,"keepTab",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",a.a)],m.prototype,"PathHelper",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",h.a)],m.prototype,"halEditing",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",c.a)],m.prototype,"wpTableFocus",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",p.a)],m.prototype,"notificationService",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",l.a)],m.prototype,"authorisationService",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",s.i)],m.prototype,"cdRef",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",o.a)],m.prototype,"titleService",void 0),Object(n.c)([Object(g.a)(),Object(n.e)("design:type",b.a)],m.prototype,"apiV3Service",void 0)},"s/U8":function(e,t,i){"use strict";i.d(t,"a",(function(){return $}));i("ii2/");var n=i("uSJ+"),s=i("Jui0"),r=i("NawS"),a=i("wZYP"),c=i("/C7M"),o=i("qc15"),l=i("AEvm"),d=i("CNq7"),u=i("fXoL"),h=i("ofXK"),p=i("th4C"),g=i("/Rze"),f=i("N5AO"),b=i("kor4"),m=i("3Pt+"),w=i("oUDv"),v=i("0loS"),y=i("711n"),k=i("80WE"),C=i("32V0");const j=["relationDescriptionTextarea"];function P(e,t){if(1&e&&u.cc(0,"span",17),2&e){const e=u.rc(3);u.wc("textContent",e.normalizedRelationType)}}function x(e,t){if(1&e&&u.cc(0,"span",17),2&e){const e=u.rc(3);u.wc("textContent",e.relatedWorkPackage.type.name)}}function S(e,t){if(1&e){const e=u.ic();u.hc(0,"span",14),u.pc("accessibleClick",(function(){u.Lc(e);return u.rc(2).activateRelationTypeEdit()})),u.Tc(1,P,1,1,"span",15),u.Tc(2,x,1,1,"span",15),u.cc(3,"span",16),u.gc()}if(2&e){const e=u.rc(2);u.Pb(1),u.wc("ngIf",e.groupByWorkPackageType),u.Pb(1),u.wc("ngIf",!e.groupByWorkPackageType),u.Pb(1),u.wc("textContent",e.text.updateRelation)}}function O(e,t){if(1&e&&u.cc(0,"option",21),2&e){const e=t.$implicit;u.wc("textContent",e.label)("ngValue",e)}}function I(e,t){if(1&e){const e=u.ic();u.hc(0,"div",18),u.hc(1,"select",19),u.pc("ngModelChange",(function(t){u.Lc(e);return u.rc(2).selectedRelationType=t}))("change",(function(){u.Lc(e);return u.rc(2).saveRelationType()}))("keydown.escape",(function(t){u.Lc(e);return u.rc(2).cancelRelationTypeEditOnEscape(t)})),u.Tc(2,O,1,2,"option",20),u.gc(),u.gc()}if(2&e){const e=u.rc(2);u.Pb(1),u.wc("ngModel",e.selectedRelationType),u.Pb(1),u.wc("ngForOf",e.availableRelationTypes)}}const T=function(e){return{workPackageId:e}};function R(e,t){if(1&e&&(u.hc(0,"div",22),u.cc(1,"a",23),u.gc()),2&e){const e=u.rc(2);u.Pb(1),u.wc("uiParams",u.Bc(3,T,e.relatedWorkPackage.id))("textContent",e.relatedWorkPackage.subjectWithId()),u.Qb("aria-label",e.normalizedRelationType+" "+e.relatedWorkPackage.subjectWithId())}}function E(e,t){if(1&e&&(u.hc(0,"edit-form",24),u.cc(1,"editable-attribute-field",25),u.gc()),2&e){const e=u.rc(2);u.wc("resource",e.relatedWorkPackage),u.Pb(1),u.wc("resource",e.relatedWorkPackage)}}function M(e,t){if(1&e){const e=u.ic();u.hc(0,"accessible-by-keyboard",26),u.pc("execute",(function(){u.Lc(e);const t=u.rc(2);return t.removeRelation(t.relation)})),u.cc(1,"op-icon",27),u.gc()}if(2&e){const e=u.rc(2);u.wc("linkAriaLabel",e.text.removeButton)("linkTitle",e.text.removeButton),u.Pb(1),u.wc("icon-title",e.text.removeButton)}}const F=function(e){return{"-placeholder":e}};function A(e,t){if(1&e){const e=u.ic();u.hc(0,"div",31),u.pc("accessibleClick",(function(){u.Lc(e);return u.rc(3).startDescriptionEdit()})),u.gc()}if(2&e){const e=u.rc(3);u.wc("ngClass",u.Bc(2,F,!e.relation.description))("textContent",e.relation.description||e.text.placeholder.description)}}function L(e,t){if(1&e){const e=u.ic();u.hc(0,"div",32),u.hc(1,"textarea",33,34),u.pc("keyup",(function(t){u.Lc(e);return u.rc(3).handleDescriptionKey(t)}))("ngModelChange",(function(t){u.Lc(e);return u.rc(3).userInputs.newRelationText=t})),u.gc(),u.hc(3,"edit-field-controls",35),u.pc("onSave",(function(){u.Lc(e);return u.rc(3).saveDescription()}))("onCancel",(function(){u.Lc(e);return u.rc(3).cancelDescriptionEdit()})),u.gc(),u.gc()}if(2&e){const e=u.rc(3);u.Pb(1),u.wc("ngModel",e.userInputs.newRelationText),u.Pb(2),u.wc("fieldController",e.fieldController)("saveTitle",e.text.save)("cancelTitle",e.text.cancel)}}function D(e,t){if(1&e&&(u.hc(0,"div",28),u.Tc(1,A,1,4,"div",29),u.Tc(2,L,4,4,"div",30),u.gc()),2&e){const e=u.rc(2);u.Pb(1),u.wc("ngIf",!e.userInputs.showDescriptionEditForm),u.Pb(1),u.wc("ngIf",e.userInputs.showDescriptionEditForm)}}const V=function(e){return{"-visible":e}};function q(e,t){if(1&e){const e=u.ic();u.hc(0,"div",1),u.hc(1,"div",2),u.hc(2,"div",3),u.Tc(3,S,4,3,"span",4),u.Tc(4,I,3,2,"div",5),u.gc(),u.Tc(5,R,2,5,"div",6),u.hc(6,"div",7),u.Tc(7,E,2,2,"edit-form",8),u.gc(),u.hc(8,"div",9),u.hc(9,"accessible-by-keyboard",10),u.pc("execute",(function(){u.Lc(e);const t=u.rc();return t.userInputs.showRelationInfo=!t.userInputs.showRelationInfo})),u.cc(10,"op-icon",11),u.gc(),u.Tc(11,M,2,3,"accessible-by-keyboard",12),u.gc(),u.gc(),u.Tc(12,D,3,2,"div",13),u.gc()}if(2&e){const e=u.rc();u.Rb("relation-row relation-row-",e.relatedWorkPackage.id,""),u.Pb(3),u.wc("ngIf",!e.userInputs.showRelationTypesForm),u.Pb(1),u.wc("ngIf",e.userInputs.showRelationTypesForm),u.Pb(1),u.wc("ngIf",e.relatedWorkPackage),u.Pb(2),u.wc("ngIf",e.relatedWorkPackage),u.Pb(2),u.wc("linkAriaLabel",e.text.description_label)("linkTitle",e.text.description_label)("ngClass",u.Bc(12,V,e.showDescriptionInfo)),u.Pb(2),u.wc("ngIf",e.relation.delete),u.Pb(1),u.wc("ngIf",e.userInputs.showRelationInfo)}}class $ extends l.a{constructor(e,t,i,n,s,r,a){super(),this.apiV3Service=e,this.notificationService=t,this.wpRelations=i,this.halEvents=n,this.I18n=s,this.cdRef=r,this.PathHelper=a,this.showRelationInfo=!1,this.showEditForm=!1,this.userInputs={newRelationText:"",showDescriptionEditForm:!1,showRelationTypesForm:!1,showRelationInfo:!1},this.fieldController={handler:{active:!0},required:!1},this.text={cancel:this.I18n.t("js.button_cancel"),save:this.I18n.t("js.button_save"),removeButton:this.I18n.t("js.relation_buttons.remove"),description_label:this.I18n.t("js.relation_buttons.update_description"),toggleDescription:this.I18n.t("js.relation_buttons.toggle_description"),updateRelation:this.I18n.t("js.relation_buttons.update_relation"),placeholder:{description:this.I18n.t("js.placeholders.relation_description")}}}ngOnInit(){this.relation=this.relatedWorkPackage.relatedBy,this.userInputs.newRelationText=this.relation.description||"",this.availableRelationTypes=r.a.LOCALIZED_RELATION_TYPES(!1),this.selectedRelationType=_.find(this.availableRelationTypes,{name:this.relation.normalizedType(this.workPackage)}),this.apiV3Service.work_packages.id(this.relatedWorkPackage).requireAndStream().pipe(this.untilDestroyed()).subscribe(e=>{this.relatedWorkPackage=e})}get normalizedRelationType(){var e=this.relation.normalizedType(this.workPackage);return this.I18n.t("js.relation_labels."+e)}get relationReady(){return this.relatedWorkPackage&&this.relatedWorkPackage.$loaded}startDescriptionEdit(){this.userInputs.showDescriptionEditForm=!0,setTimeout(()=>{const e=jQuery(this.relationDescriptionTextarea.nativeElement),t=e.val().length;e.focus(),e.prop("selectionStart",t),e.prop("selectionEnd",t)})}handleDescriptionKey(e){27===e.which&&this.cancelDescriptionEdit()}cancelDescriptionEdit(){this.userInputs.showDescriptionEditForm=!1,this.userInputs.newRelationText=this.relation.description||""}saveDescription(){this.wpRelations.updateRelation(this.relation,{description:this.userInputs.newRelationText}).then(e=>{this.relation=e,this.relatedWorkPackage.relatedBy=e,this.userInputs.showDescriptionEditForm=!1,this.notificationService.showSave(this.relatedWorkPackage),this.cdRef.detectChanges()})}get showDescriptionInfo(){return this.userInputs.showRelationInfo||this.relation.description}activateRelationTypeEdit(){this.groupByWorkPackageType&&(this.userInputs.showRelationTypesForm=!0)}cancelRelationTypeEditOnEscape(e){this.userInputs.showRelationTypesForm=!1}saveRelationType(){this.wpRelations.updateRelationType(this.workPackage,this.relatedWorkPackage,this.relation,this.selectedRelationType.name).then(e=>{this.notificationService.showSave(this.relatedWorkPackage),this.relatedWorkPackage.relatedBy=e,this.relation=e,this.userInputs.showRelationTypesForm=!1,this.cdRef.detectChanges()}).catch(e=>this.notificationService.handleRawError(e,this.workPackage))}toggleUserDescriptionForm(){this.userInputs.showDescriptionEditForm=!this.userInputs.showDescriptionEditForm}removeRelation(){this.wpRelations.removeRelation(this.relation).then(()=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:null,relationType:this.relation.normalizedType(this.workPackage)}),this.apiV3Service.work_packages.cache.updateWorkPackage(this.relatedWorkPackage),this.notificationService.showSave(this.relatedWorkPackage)}).catch(e=>this.notificationService.handleRawError(e,this.relatedWorkPackage))}}$.\u0275fac=function(e){return new(e||$)(u.bc(d.a),u.bc(o.a),u.bc(n.a),u.bc(c.a),u.bc(a.a),u.bc(u.i),u.bc(s.a))},$.\u0275cmp=u.Vb({type:$,selectors:[["wp-relation-row"]],viewQuery:function(e,t){var i;(1&e&&u.ad(j,!0),2&e)&&(u.Ic(i=u.qc())&&(t.relationDescriptionTextarea=i.first))},inputs:{workPackage:"workPackage",relatedWorkPackage:"relatedWorkPackage",groupByWorkPackageType:"groupByWorkPackageType"},features:[u.Mb],decls:1,vars:1,consts:[["focus-within","'.wp-relations-controls-section accessible-by-keyboard'",3,"class",4,"ngIf"],["focus-within","'.wp-relations-controls-section accessible-by-keyboard'"],[1,"grid-block","hierarchy-item"],[1,"grid-content","medium-2","collapse"],["class","relation-row--type","tabindex","0",3,"accessibleClick",4,"ngIf"],["class","inline-edit--container inplace-edit",4,"ngIf"],["class","grid-content medium-5 collapse",4,"ngIf"],[1,"grid-content","medium-3","collapse","wp-relations-status-field"],[3,"resource",4,"ngIf"],["ng-class","{'-expanded': userInputs.showRelationInfo }",1,"grid-content","medium-2","collapse","wp-relations-controls-section"],["linkClass","wp-relations--description-btn",3,"linkAriaLabel","linkTitle","ngClass","execute"],["icon-classes","icon-info1 -padded wp-relations--icon wp-relations--description-icon","icon-title","text.toggleDescription"],["aria-hidden","false","linkClass","relation-row--remove-btn",3,"linkAriaLabel","linkTitle","execute",4,"ngIf"],["class","grid-block hierarchy-item description-container",4,"ngIf"],["tabindex","0",1,"relation-row--type",3,"accessibleClick"],[3,"textContent",4,"ngIf"],[1,"hidden-for-sighted",3,"textContent"],[3,"textContent"],[1,"inline-edit--container","inplace-edit"],["role","listbox","focus","",1,"inline-edit--field","form--select",3,"ngModel","ngModelChange","change","keydown.escape"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],[3,"textContent","ngValue"],[1,"grid-content","medium-5","collapse"],["uiSref","work-packages.show.relations",1,"wp-relations--subject-field",3,"uiParams","textContent"],[3,"resource"],["fieldName","status",3,"resource"],["aria-hidden","false","linkClass","relation-row--remove-btn",3,"linkAriaLabel","linkTitle","execute"],["icon-classes","icon-remove -padded wp-relations--icon",3,"icon-title"],[1,"grid-block","hierarchy-item","description-container"],["class","wp-relation--description-read-value",3,"ngClass","textContent","accessibleClick",4,"ngIf"],["class","wp-relation--description-wrapper textarea-wrapper",4,"ngIf"],[1,"wp-relation--description-read-value",3,"ngClass","textContent","accessibleClick"],[1,"wp-relation--description-wrapper","textarea-wrapper"],["autofocus","","name","description",1,"wp-relation--description-textarea",3,"ngModel","keyup","ngModelChange"],["relationDescriptionTextarea",""],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel"]],template:function(e,t){1&e&&u.Tc(0,q,13,14,"div",0),2&e&&u.wc("ngIf",t.workPackage&&t.relatedWorkPackage)},directives:[h.q,p.a,g.a,h.n,f.a,b.a,m.y,w.a,m.m,m.p,h.p,m.r,m.B,v.AnchorUISref,v.UISref,y.a,k.a,m.c,C.a],encapsulation:2})},sBdf:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("mrSG"),s=i("sjKJ"),r=i("Jui0"),a=i("PHo6"),c=i("kTsZ"),o=i("wZYP"),l=i("d/TE"),d=i("CNq7"),u=i("fXoL");class h{constructor(e,t,i,n,s,r){this.CurrentProject=e,this.pathHelper=t,this.apiV3Service=i,this.halResourceService=n,this.notifications=s,this.I18n=r,this.v3=this.pathHelper.api.v3}create(e,t){let i=JSON.stringify(t);return this.apiV3Service.queries.form.loadWithParams({pageSize:0,filters:i},void 0,this.CurrentProject.identifier,this.buildQueryRequest(e)).toPromise().then(([e,t])=>{if(e.schema.public.writable)return this.apiV3Service.queries.post(t,e).toPromise();throw new Error(this.I18n.t("js.boards.error_permission_missing"))})}addFreeQuery(e,t){const i=this.freeBoardQueryFilter();return this.addQuery(e,t,[i])}addQuery(e,t,i){return Object(n.b)(this,void 0,void 0,(function*(){const n=e.queries.length;try{let s={_type:"GridWidget",identifier:"work_package_query",startRow:1,endRow:2,startColumn:n+1,endColumn:n+2,options:{queryId:(yield this.create(t,i)).id,filters:i}},r=this.halResourceService.createHalResourceOfClass(a.a,s);e.addQuery(r)}catch(s){this.notifications.addError(s),console.error(s)}return e}))}buildQueryRequest(e){return Object.assign({hidden:!0,public:!0,_links:{sortBy:[{href:this.v3.apiV3Base+"/queries/sort_bys/manualSorting-asc"},{href:this.v3.apiV3Base+"/queries/sort_bys/id-asc"}]}},e)}freeBoardQueryFilter(){return{manualSort:{operator:"ow",values:[]}}}}h.\u0275fac=function(e){return new(e||h)(u.lc(s.a),u.lc(r.a),u.lc(d.a),u.lc(c.a),u.lc(l.a),u.lc(o.a))},h.\u0275prov=u.Xb({token:h,factory:h.\u0275fac,providedIn:"root"})},saRB:function(e,t,i){"use strict";i.d(t,"b",(function(){return r})),i.d(t,"a",(function(){return a}));var n=i("fXoL"),s=i("CVKj");const r="macro.embedded-table";class a{constructor(e){this.elementRef=e,this.configuration={actionsColumnEnabled:!1,columnMenuEnabled:!1,contextMenuEnabled:!1}}ngOnInit(){const e=this.elementRef.nativeElement;this.queryProps=JSON.parse(e.dataset.queryProps)}}a.\u0275fac=function(e){return new(e||a)(n.bc(n.q))},a.\u0275cmp=n.Vb({type:a,selectors:[["macro",8,"embedded-table"]],attrs:["class","embedded-table"],decls:1,vars:2,consts:[[3,"queryProps","configuration"]],template:function(e,t){1&e&&n.cc(0,"wp-embedded-table-entry",0),2&e&&n.wc("queryProps",t.queryProps)("configuration",t.configuration)},directives:[s.a],encapsulation:2})},sjKJ:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("Jui0"),s=i("CNq7"),r=i("fXoL");class a{constructor(e,t){this.PathHelper=e,this.apiV3Service=t,this.detect()}get inProjectContext(){return void 0!==this.current}get path(){return this.current?this.PathHelper.projectPath(this.current.identifier):null}get apiv3Path(){return this.current?this.apiV3Service.projects.id(this.current.id).toString():null}get id(){return this.getCurrent("id")}get name(){return this.getCurrent("name")}get identifier(){return this.getCurrent("identifier")}getCurrent(e){return this.current&&this.current[e]?this.current[e].toString():null}detect(){const e=document.querySelector("meta[name=current_project]");e&&(this.current={id:e.dataset.projectId,name:e.dataset.projectName,identifier:e.dataset.projectIdentifier})}}a.\u0275fac=function(e){return new(e||a)(r.lc(n.a),r.lc(s.a))},a.\u0275prov=r.Xb({token:a,factory:a.\u0275fac,providedIn:"root"})},sl7t:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("/cHX"),s=i("lJrL");class r extends n.a{constructor(e,t,i,n,s,r){super(e,t),this.injector=e,this.workPackage=t,this.identifier=i,this.title=n,this.applicable=s,this.onClick=r}static factoryFor(e,t,i,n=(()=>!0)){return(s,a)=>new r(s,a,e,t,n,i)}buildElement(){if(!this.applicable(this.workPackage))return null;let e=document.createElement("a");return e.title=this.title,e.href="#",e.classList.add(n.b,"wp-table-action--unlink"),e.dataset.workPackageId=this.workPackage.id,e.appendChild(Object(s.a)("icon","icon-close")),jQuery(e).click(e=>{e.preventDefault(),this.onClick(this.workPackage)}),e}}},sngl:function(e,t,i){"use strict";i.d(t,"b",(function(){return x})),i.d(t,"a",(function(){return S}));var n=i("fXoL"),s=i("8zkO"),r=i("JY8V"),a=i("SqdZ"),c=i("tN7n"),o=i("H3ou"),l=i("+oAL"),d=i("E2tj"),u=i("Y0Nk"),h=i("wZYP"),p=i("IaZ+"),g=i("qc15"),f=i("CNq7"),b=i("ofXK"),m=i("CS/5");const w=["tabContentOutlet"];function v(e,t){1&e&&n.dc(0)}function y(e,t){if(1&e&&(n.fc(0),n.Tc(1,v,1,0,"ng-container",13),n.ec()),2&e){const e=n.rc();n.Pb(1),n.wc("ngComponentOutlet",e.prependModalComponent)("ngComponentOutletInjector",e.injector)}}const k=function(e,t){return{selected:e,"-disabled":t}},C=function(e){return{selected:e}};function j(e,t){if(1&e){const e=n.ic();n.hc(0,"li",17),n.hc(1,"a",18),n.pc("click",(function(){n.Lc(e);const i=t.$implicit;return n.rc(2).switchTo(i.name)})),n.gc(),n.gc()}if(2&e){const e=t.$implicit,i=n.rc(2);n.wc("ngClass",n.Cc(4,k,i.currentTab&&e.name===i.currentTab.name,null!=e.disableBecause)),n.Pb(1),n.wc("ngClass",n.Bc(7,C,i.currentTab&&e.name===i.currentTab.name))("textContent",e.title),n.Qb("title",e.disableBecause||e.title)}}function P(e,t){if(1&e&&(n.hc(0,"div",14),n.hc(1,"ul",15),n.Tc(2,j,2,9,"li",16),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("ngForOf",e.availableTabs)}}const x=new n.z("WpTableConfigurationModalPrependComponent");class S extends a.a{constructor(e,t,i,s,r,a,o,l,d,u,h,p,g,f,b){super(e,g,b),this.locals=e,this.prependModalComponent=t,this.I18n=i,this.injector=s,this.appRef=r,this.componentFactoryResolver=a,this.loadingIndicator=o,this.querySpace=l,this.wpStatesInitialization=d,this.apiV3Service=u,this.notificationService=h,this.wpTableColumns=p,this.cdRef=g,this.ConfigurationService=f,this.elementRef=b,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={title:this.I18n.t("js.work_packages.table_configuration.modal_title"),closePopup:this.I18n.t("js.close_popup_title"),columnsLabel:this.I18n.t("js.label_columns"),selectedColumns:this.I18n.t("js.description_selected_columns"),multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel"),upsaleRelationColumns:this.I18n.t("js.modals.upsale_relation_columns"),upsaleRelationColumnsLink:this.I18n.t("js.modals.upsale_relation_columns_link")},this.onDataUpdated=new n.s,this.selectedColumnMap={},this.wpTableConfigurationService=this.injector.get(c.a,new c.a(this.I18n))}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.tabPortalHost=new o.a(this.wpTableConfigurationService.tabs,this.tabContentOutlet.nativeElement,this.componentFactoryResolver,this.appRef,this.injector),this.loadingIndicator.indicator("modal").promise=this.loadForm().then(()=>{const e=this.locals.initialTab||this.availableTabs[0].name;this.switchTo(e)})}ngOnDestroy(){this.onDataUpdated.complete(),this.tabPortalHost.dispose()}get availableTabs(){return this.tabPortalHost.availableTabs}get currentTab(){return this.tabPortalHost.currentTab}switchTo(e){this.tabPortalHost.switchTo(e)}saveChanges(){this.tabPortalHost.activeComponents.forEach(e=>{e.onSave()}),this.onDataUpdated.emit(),this.service.close()}onClose(){return this.afterFocusOn.focus(),!0}get afterFocusOn(){return this.$element}loadForm(){const e=this.querySpace.query.value;return this.apiV3Service.queries.form.load(e).toPromise().then(([t,i])=>(this.wpStatesInitialization.updateStatesFromForm(e,t),t)).catch(e=>this.notificationService.handleRawError(e))}}S.\u0275fac=function(e){return new(e||S)(n.bc(p.a),n.bc(x,8),n.bc(h.a),n.bc(n.A),n.bc(n.f),n.bc(n.l),n.bc(u.a),n.bc(d.a),n.bc(l.a),n.bc(f.a),n.bc(g.a),n.bc(r.a),n.bc(n.i),n.bc(s.a),n.bc(n.q))},S.\u0275cmp=n.Vb({type:S,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(w,!0),2&e)&&(n.Ic(i=n.qc())&&(t.tabContentOutlet=i.first))},features:[n.Mb],decls:13,vars:6,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","-wide","wp-table--configuration-modal","loading-indicator--location"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[4,"ngIf"],["class","content--tabs scrollable-tabs",4,"ngIf"],[1,"tab-content"],["tabContentOutlet",""],[1,"modal--form-actions"],[1,"button","-highlight",3,"textContent","click"],[1,"button",3,"textContent","click"],[4,"ngComponentOutlet","ngComponentOutletInjector"],[1,"content--tabs","scrollable-tabs"],[1,"tabrow"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["role","button","href","",1,"tab-show",3,"ngClass","textContent","click"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.cc(3,"h3",3),n.hc(4,"a",4),n.hc(5,"i",5),n.pc("click",(function(e){return t.closeMe(e)})),n.gc(),n.gc(),n.gc(),n.Tc(6,y,2,2,"ng-container",6),n.Tc(7,P,3,1,"div",7),n.cc(8,"div",8,9),n.hc(10,"div",10),n.hc(11,"button",11),n.pc("click",(function(){return t.saveChanges()})),n.gc(),n.hc(12,"button",12),n.pc("click",(function(e){return t.closeMe(e)})),n.gc(),n.gc(),n.gc(),n.gc()),2&e&&(n.Pb(3),n.wc("textContent",t.text.title),n.Pb(2),n.Qb("title",t.text.closePopup),n.Pb(1),n.wc("ngIf",!!t.prependModalComponent),n.Pb(1),n.wc("ngIf",!!t.tabPortalHost),n.Pb(4),n.wc("textContent",t.text.applyButton),n.Pb(1),n.wc("textContent",t.text.cancelButton))},directives:[b.q,b.o,m.a,b.p,b.n],encapsulation:2})},"t+3x":function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("wZYP"),s=i("Jui0"),r=(i("ii2/"),i("pL6k")),a=i("VgZ9"),c=i("sl7t"),o=i("FDFi"),l=i("Rky/"),d=i("f9kS"),u=i("pLZG"),h=(i("B4Ei"),i("/C7M")),p=i("CNq7"),g=i("fXoL"),f=i("ofXK"),b=i("72oW");function m(e,t){if(1&e&&(g.hc(0,"div",4),g.hc(1,"div",5),g.cc(2,"h3",6),g.gc(),g.gc()),2&e){const e=g.rc(2);g.Pb(2),g.wc("textContent",e.group.name)}}const w=function(e){return{actionsColumnEnabled:!0,hierarchyToggleEnabled:!1,inlineCreateEnabled:!0,compactTableStyle:!0,columnMenuEnabled:!1,contextMenuEnabled:!1,projectIdentifier:e,projectContext:!1}};function v(e,t){if(1&e){const e=g.ic();g.fc(0),g.Tc(1,m,3,1,"div",1),g.hc(2,"wp-embedded-table",2,3),g.pc("onQueryLoaded",(function(t){g.Lc(e);return g.rc().handleQueryLoaded(t)})),g.gc(),g.ec()}if(2&e){const e=g.rc();g.Pb(1),g.wc("ngIf",e.group),g.Pb(1),g.wc("initialLoadingIndicator",!1)("queryProps",e.queryProps)("tableActions",e.tableActions)("configuration",g.Bc(5,w,e.workPackage.project.idFromLink))}}class y extends l.a{constructor(e,t,i,n,s,r,a){super(r),this.wpRelationsHierarchyService=e,this.PathHelper=t,this.wpInlineCreate=i,this.halEvents=n,this.apiV3Service=s,this.queryUrlParamsHelper=r,this.I18n=a,this.addExistingChildEnabled=!1,this.tableActions=[c.a.factoryFor("remove-child-action",this.I18n.t("js.relation_buttons.remove_child"),e=>{this.embeddedTable.loadingIndicator=this.wpRelationsHierarchyService.removeChild(e)},e=>!!e.changeParent)]}ngOnInit(){this.wpInlineCreate.referenceTarget=this.workPackage,this.queryProps=this.buildQueryProps(),this.wpInlineCreate.newInlineWorkPackageCreated.pipe(this.untilDestroyed()).subscribe(e=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:e,relationType:"child"})}),this.apiV3Service.work_packages.id(this.workPackage).observe().pipe(Object(u.a)(()=>this.embeddedTable&&this.embeddedTable.isInitialized),this.untilDestroyed()).subscribe(()=>this.refreshTable())}}y.\u0275fac=function(e){return new(e||y)(g.bc(a.a),g.bc(s.a),g.bc(o.a),g.bc(h.a),g.bc(p.a),g.bc(r.a),g.bc(n.a))},y.\u0275cmp=g.Vb({type:y,selectors:[["wp-children-query"]],inputs:{workPackage:"workPackage",query:"query",group:"group",addExistingChildEnabled:"addExistingChildEnabled"},features:[g.Ob([{provide:o.a,useClass:d.a}]),g.Mb],decls:1,vars:1,consts:[[4,"ngIf"],["class","attributes-group--header",4,"ngIf"],[3,"initialLoadingIndicator","queryProps","tableActions","configuration","onQueryLoaded"],["embeddedTable",""],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function(e,t){1&e&&g.Tc(0,v,4,7,"ng-container",0),2&e&&g.wc("ngIf",!t.hidden)},directives:[f.q,b.a],encapsulation:2})},t7qP:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("iB+3"),s=i("4lR/"),r=i("PUHT"),a=i("SKFm"),c=(i("ii2/"),i("RGDJ")),o=i("wZYP"),l=i("d/TE"),d=i("/C7M"),u=i("qc15"),h=i("fXoL");class p extends r.a{constructor(e,t,i,n,s,r,a,c){super(e,t),this.elementRef=e,this.opContextMenu=t,this.$state=i,this.workPackageNotificationService=n,this.halEditing=s,this.notificationService=r,this.I18n=a,this.halEvents=c}open(e){const t=this.halEditing.changeFor(this.workPackage);t.getForm().then(i=>{const n=i.schema.status.allowedValues;this.buildItems(n);t.schema.status.writable?this.opContextMenu.show(this,e):this.notificationService.addError(this.I18n.t("js.work_packages.message_work_package_status_blocked"))})}get locals(){return{items:this.items,contextMenuId:"wp-status-context-menu"}}updateStatus(e){const t=this.halEditing.changeFor(this.workPackage);t.projectedResource.status=e,this.workPackage.isNew||this.halEditing.save(t).then(()=>{this.workPackageNotificationService.showSave(this.workPackage)})}buildItems(e){this.items=e.map(e=>({disabled:!1,linkText:e.name,postIcon:e.isReadonly?"icon-locked":null,postIconTitle:this.I18n.t("js.work_packages.message_work_package_read_only"),class:c.a.inlineClass("status",e.id),onClick:()=>(this.updateStatus(e),!0)}))}}p.\u0275fac=function(e){return new(e||p)(h.bc(h.q),h.bc(s.a),h.bc(n.StateService),h.bc(u.a),h.bc(a.a),h.bc(l.a),h.bc(o.a),h.bc(d.a))},p.\u0275dir=h.Wb({type:p,selectors:[["","wpStatusDropdown",""]],inputs:{workPackage:["wpStatusDropdown-workPackage","workPackage"]},features:[h.Mb]})},t8SH:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("fXoL"),s=i("wZYP"),r=i("sjKJ"),a=i("Jui0"),c=i("ZOsW"),o=i("3Pt+"),l=i("ofXK"),d=i("ximh");const u=["ngSelectComponent"];function h(e,t){if(1&e&&(n.cc(0,"b",4),n.Vc(1)),2&e){const e=t.searchTerm,i=n.rc();n.wc("textContent",i.text.add_new_action),n.Pb(1),n.Xc(": ",e," ")}}function p(e,t){if(1&e&&(n.hc(0,"div",5),n.Vc(1),n.gc()),2&e){const e=t.item,i=t.searchTerm;n.wc("ngOptionHighlight",i),n.Pb(1),n.Wc(e.name)}}class g{constructor(e,t,i,s){this.I18n=e,this.cdRef=t,this.currentProject=i,this.pathHelper=s,this.required=!1,this.disabled=!1,this.finishedLoading=!1,this.id="",this.classes="",this.hideSelected=!1,this.onChange=new n.s,this.onKeydown=new n.s,this.onOpen=new n.s,this.onClose=new n.s,this.onAfterViewInit=new n.s,this.text={add_new_action:this.I18n.t("js.label_create")},this.createAllowed=!1,this._openDirectly=!1}ngAfterViewInit(){this.onAfterViewInit.emit(this)}openSelect(){this.ngSelectComponent&&(this.ngSelectComponent.open(),this.openDirectly=!1)}closeSelect(){this.ngSelectComponent&&this.ngSelectComponent.close()}changeModel(e){this.onChange.emit(e)}opened(){setTimeout(()=>{const e=this.ngSelectComponent;e&&e.dropdownPanel&&e.dropdownPanel._updatePosition()},25),this.onOpen.emit()}closed(){this.openDirectly=!1,this.onClose.emit()}keyPressed(e){this.onKeydown.emit(e)}get openDirectly(){return this._openDirectly}set openDirectly(e){this._openDirectly=e,e&&this.openSelect()}focusInputField(){this.ngSelectComponent&&this.ngSelectComponent.focus()}}g.\u0275fac=function(e){return new(e||g)(n.bc(s.a),n.bc(n.i),n.bc(r.a),n.bc(a.a))},g.\u0275cmp=n.Vb({type:g,selectors:[["create-autocompleter"]],viewQuery:function(e,t){var i;(1&e&&n.ad(u,!0),2&e)&&(n.Ic(i=n.qc())&&(t.ngSelectComponent=i.first))},inputs:{availableValues:"availableValues",appendTo:"appendTo",model:"model",required:"required",disabled:"disabled",finishedLoading:"finishedLoading",id:"id",classes:"classes",typeahead:"typeahead",hideSelected:"hideSelected"},outputs:{onChange:"onChange",onKeydown:"onKeydown",onOpen:"onOpen",onClose:"onClose",onAfterViewInit:"onAfterViewInit"},decls:4,vars:14,consts:[["bindLabel","name",3,"ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","clearSearchOnAdd","appendTo","hideSelected","id","ngModelChange","change","open","close","keydown"],["ngSelectComponent",""],["ng-tag-tmp",""],["ng-option-tmp",""],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight"]],template:function(e,t){1&e&&(n.hc(0,"ng-select",0,1),n.pc("ngModelChange",(function(e){return t.model=e}))("change",(function(e){return t.changeModel(e)}))("open",(function(){return t.opened()}))("close",(function(){return t.closed()}))("keydown",(function(e){return t.keyPressed(e)})),n.Tc(2,h,2,2,"ng-template",2),n.Tc(3,p,2,2,"ng-template",3),n.gc()),2&e&&n.wc("ngModel",t.model)("items",t.availableValues)("ngClass",t.classes)("addTag",t.createAllowed)("virtualScroll",!0)("required",t.required)("clearable",!t.required)("disabled",t.disabled)("typeahead",t.typeahead)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("appendTo",t.appendTo)("hideSelected",t.hideSelected)("id",t.id)},directives:[c.a,o.m,o.p,l.n,o.x,c.l,c.c,d.a],encapsulation:2})},tN7n:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("wZYP"),s=i("Uprc"),r=i("r76g"),a=i("byj5"),c=i("YO9K"),o=i("hj8t"),l=i("yUKD"),d=i("fXoL");class u{constructor(e){this.I18n=e,this._tabs=[{name:"columns",title:this.I18n.t("js.label_columns"),componentClass:r.a},{name:"filters",title:this.I18n.t("js.work_packages.query.filters"),componentClass:a.a},{name:"sort-by",title:this.I18n.t("js.label_sort_by"),componentClass:c.a},{name:"display-settings",title:this.I18n.t("js.work_packages.table_configuration.display_settings"),componentClass:s.a},{name:"highlighting",title:this.I18n.t("js.work_packages.table_configuration.highlighting"),componentClass:l.a},{name:"timelines",title:this.I18n.t("js.timelines.gantt_chart"),componentClass:o.a}]}get tabs(){return this._tabs}}u.\u0275fac=function(e){return new(e||u)(d.lc(n.a))},u.\u0275prov=d.Xb({token:u,factory:u.\u0275fac})},th4C:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("2Vo4"),s=i("3UWI"),r=i("AEvm"),a=i("fXoL");class c extends r.a{constructor(e){super(),this.elementRef=e}ngOnInit(){let e=jQuery(this.elementRef.nativeElement),t=new n.a(!1);t.pipe(this.untilDestroyed(),Object(s.a)(50)).subscribe(t=>{e.toggleClass("-focus",t)});e[0].addEventListener("focus",(function(){t.next(!0)}),!0);e[0].addEventListener("blur",(function(){t.next(!1)}),!0),setTimeout(()=>{e.addClass("focus-within--trigger"),e.find(this.selector).addClass("focus-within--depending")},0)}}c.\u0275fac=function(e){return new(e||c)(a.bc(a.q))},c.\u0275dir=a.Wb({type:c,selectors:[["","focus-within",""]],inputs:{selector:"selector"},features:[a.Mb]})},tmNb:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("mrSG"),s=i("ofXK"),r=i("OW6k"),a=i("99YG"),c=i("fXoL");class o{constructor(e,t){this.document=e,this.injector=t,this.drake=null,this.members=[],this.escapeListener=e=>{this.drake&&"Escape"===e.key&&this.drake.cancel(!0)},this.document.documentElement.addEventListener("keydown",this.escapeListener)}ngOnDestroy(){this.document.documentElement.removeEventListener("keydown",this.escapeListener),this.autoscroll&&this.autoscroll.destroy(),this.drake&&this.drake.destroy()}remove(e){this.initialized&&(_.remove(this.drake.containers,t=>t===e),_.remove(this.members,t=>t.dragContainer===e))}member(e){return _.find(this.members,t=>t.dragContainer===e)}get initialized(){return null!==this.drake}register(e){this.members.push(e);const t=e.scrollContainers;this.autoscroll?this.autoscroll.add(t):this.setupAutoscroll(t);const i=e.dragContainer;null===this.drake?this.initializeDrake([i]):this.drake.containers.push(i)}addScrollContainer(e){this.autoscroll?this.autoscroll.add(e):this.setupAutoscroll([e]),this.autoscroll.setOuterScrollContainer(e)}setupAutoscroll(e){this.autoscroll=new r.a(e,{margin:100,maxSpeed:10,scrollWhenOutside:!0,autoScroll:()=>this.drake&&this.drake.dragging})}getMember(e){return this.members.find(t=>t.dragContainer===e)}initializeDrake(e){this.drake=dragula(e,{moves:(e,t,i,n)=>{const s=this.getMember(t);return!!s&&s.moves(e,t,i,n)},accepts:(e,t)=>{const i=this.getMember(t);return!i||!i.accepts||i.accepts(e,t)},invalid:()=>!1,direction:"vertical",copy:!1,revertOnSpill:!0,removeOnSpill:!1,mirrorContainer:document.body,ignoreInputTextSelection:!0}),this.drake.on("drag",(e,t)=>{e.dataset.sourceIndex=a.a.findIndex(e).toString()}),this.drake.on("over",(e,t)=>{const i=t.closest(".drop-zone");i&&i.classList.add("-dragged-over")}),this.drake.on("out",(e,t)=>{const i=t.closest(".drop-zone");i&&i.classList.remove("-dragged-over")}),this.drake.on("cloned",(e,t)=>{const i=this.member(t.parentElement);i&&i.onCloned&&i.onCloned(e,t)}),this.drake.on("drop",(e,t,i,s)=>Object(n.b)(this,void 0,void 0,(function*(){try{yield this.handleDrop(e,t,i,s)}catch(n){console.error("Failed to handle drop of %O, %O",e,n)}}))),this.drake.on("shadow",(e,t)=>{const i=this.member(t);i&&i.onShadowInserted&&i.onShadowInserted(e)}),this.drake.on("cancel",(e,t,i)=>{const n=this.member(t);n&&n.onCancel&&n.onCancel(e)})}handleDrop(e,t,i,s){return Object(n.b)(this,void 0,void 0,(function*(){const n=this.member(t),r=this.member(i);if(!n||!r)return;if(n===r)return n.onMoved(e,t,i,s);(yield n.onAdded(e,t,i,s))?r.onRemoved(e,t,i,s):a.a.reinsert(e,e.dataset.sourceIndex||-1,i)}))}}o.\u0275fac=function(e){return new(e||o)(c.lc(s.d),c.lc(c.A))},o.\u0275prov=c.Xb({token:o,factory:o.\u0275fac})},"u/Nd":function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("DhiE"),s=i("iMRi"),r=i("POAS"),a=i("d/TE"),c=i("SqdZ"),o=i("IaZ+"),l=i("wZYP"),d=i("E2tj"),u=i("fXoL"),h=i("k1Xe");class p extends c.a{constructor(e,t,i,n,s,r,a,c,o){super(t,r,e),this.elementRef=e,this.locals=t,this.I18n=i,this.states=n,this.querySpace=s,this.cdRef=r,this.wpListService=a,this.halNotification=c,this.notificationsService=o,this.isStarred=!1,this.isPublic=!1,this.isBusy=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text"),save_as:this.I18n.t("js.label_save_as"),label_name:this.I18n.t("js.modals.label_name"),label_visibility_settings:this.I18n.t("js.label_visibility_settings"),button_save:this.I18n.t("js.modals.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")}}ngOnInit(){super.ngOnInit(),this.query=this.querySpace.query.value,this.isStarred=this.query.starred,this.isPublic=this.query.public}setValues(e){this.isStarred=e.isStarred,this.isPublic=e.isPublic}get afterFocusOn(){return jQuery("#work-packages-settings-button")}saveQuery(e){if(this.isBusy)return;this.isBusy=!0;let t=[];this.query.public!==this.isPublic&&(this.query.public=this.isPublic,t.push(this.wpListService.save(this.query))),this.query.starred!==this.isStarred&&t.push(this.wpListService.toggleStarred(this.query)),Promise.all(t).then(()=>{this.closeMe(e),this.isBusy=!1}).catch(()=>{this.notificationsService.addError(this.I18n.t("js.errors.query_saving")),this.isBusy=!1})}}p.\u0275fac=function(e){return new(e||p)(u.bc(u.q),u.bc(o.a),u.bc(l.a),u.bc(s.a),u.bc(d.a),u.bc(u.i),u.bc(n.a),u.bc(r.a),u.bc(a.a))},p.\u0275cmp=u.Vb({type:p,selectors:[["ng-component"]],features:[u.Mb],decls:10,vars:8,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","wp-table--configuration-modal","loading-indicator--location"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[3,"isSave","isStarred","isPublic","onChange"],[1,"form--space"],[1,"button","-highlight","-with-icon","icon-checkmark",3,"textContent","click"],[1,"button","-with-icon","icon-cancel",3,"textContent","disabled","click"]],template:function(e,t){1&e&&(u.hc(0,"div",0),u.hc(1,"div",1),u.hc(2,"div",2),u.cc(3,"h3",3),u.hc(4,"a",4),u.hc(5,"i",5),u.pc("click",(function(e){return t.closeMe(e)})),u.gc(),u.gc(),u.gc(),u.hc(6,"query-sharing-form",6),u.pc("onChange",(function(e){return t.setValues(e)})),u.gc(),u.hc(7,"div",7),u.hc(8,"button",8),u.pc("click",(function(e){return t.saveQuery(e)})),u.gc(),u.hc(9,"button",9),u.pc("click",(function(e){return t.closeMe(e)})),u.gc(),u.gc(),u.gc(),u.gc()),2&e&&(u.Pb(3),u.wc("textContent",t.text.label_visibility_settings),u.Pb(2),u.Qb("title",t.text.close_popup),u.Pb(1),u.wc("isSave",!1)("isStarred",t.isStarred)("isPublic",t.isPublic),u.Pb(2),u.wc("textContent",t.text.button_save),u.Pb(1),u.wc("textContent",t.text.button_cancel)("disabled",t.isBusy))},directives:[h.a],encapsulation:2})},u4T9:function(e,t,i){"use strict";i.d(t,"a",(function(){return j}));var n=i("3Pt+"),s=i("8ggW"),r=i("HN1l"),a=i("g1AQ"),c=i("iB+3"),o=i("0loS"),l=i("+rOU"),d=i("ofXK"),u=i("5+WD"),h=i("CS/5"),p=i("mg4W"),g=i("t8SH"),f=i("ZOsW"),b=i("ximh"),m=i("sjKJ"),w=i("vK8y"),v=i("gh2L"),y=i("iuLl"),k=i("9Ejp"),C=i("fXoL");class j{constructor(e){!function(e){const t=e.get(m.a),i=e.get(w.a),n=e.get(c.StateService);window.ErrorReporter.addContext(e=>{i.isLoggedIn&&e.setUser({name:i.name,id:i.userId,email:i.mail}),t.inProjectContext&&e.setTag("project",t.identifier),e.setExtra("router state",n.current.name)}),e.get(a.a).register("openProjectAngularBootstrap",()=>[r.b])}(e)}}j.\u0275mod=C.Zb({type:j}),j.\u0275inj=C.Yb({factory:function(e){return new(e||j)(C.lc(C.A))},imports:[[o.UIRouterModule,d.b,n.i,l.g,u.g,k.b,s.a,f.b,b.b,h.f.withComponents([p.a,v.a,y.a,g.a])],o.UIRouterModule,d.b,n.i,l.g,u.g,s.a,f.b,b.b,h.f]})},u8Ab:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return c}));i("y2Tr");var n=i("Jui0"),s=i("3uR5"),r=i("fXoL");const a="user-avatar";class c{constructor(e,t,i){this.elementRef=e,this.avatarRenderer=t,this.pathHelper=i}ngAfterViewInit(){const e=this.elementRef.nativeElement;let t=this.user||{name:e.dataset.userName,id:e.dataset.userId};this.avatarRenderer.render(e,t,!1,e.dataset.classList)}}c.\u0275fac=function(e){return new(e||c)(r.bc(r.q),r.bc(s.a),r.bc(n.a))},c.\u0275cmp=r.Vb({type:c,selectors:[["user-avatar"]],inputs:{user:"user"},decls:0,vars:0,template:function(e,t){},encapsulation:2,changeDetection:0})},uIAU:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("bXa3"),s=i("GwdO"),r=i("Mo6U");class a extends n.a{static extractPayload(e,t=null){if(e instanceof r.a&&t){let i=e,n=s.a.extractPayloadFromSchema(i,t);return n.widgets&&(n.widgets=i.widgets.map(e=>({id:e.id,startRow:e.startRow,endRow:e.endRow,startColumn:e.startColumn,endColumn:e.endColumn,identifier:e.identifier,options:e.options}))),n}return e||{}}extractPayload(e,t=null){return a.extractPayload(e,t)}}},"uSJ+":function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("Jui0"),s=i("FnNU"),r=i("kTsZ"),a=i("CNq7"),c=i("HKNX"),o=i("IzEk"),l=i("lJxs"),d=i("fXoL");class u extends s.b{constructor(){super(),this.name="WP-Relations",this.relations=Object(s.h)(),this.initializeMembers()}}class h extends c.a{constructor(e,t,i){super((new u).relations),this.PathHelper=e,this.apiV3Service=t,this.halResource=i}require(e,t=!1){return this.requireAndStream(e,t).pipe(Object(o.a)(1)).toPromise()}requireAndStream(e,t=!1){return(this.stale(e)||t)&&this.clearAndLoad(e,this.load(e)),this.state(e).values$()}load(e){return this.apiV3Service.work_packages.id(e).relations.get().pipe(Object(l.a)(t=>this.relationsStateValue(e,t.elements)))}requireAll(e){return new Promise((t,i)=>{this.apiV3Service.relations.loadInvolved(e).toPromise().then(i=>{this.clearSome(...e),this.accumulateRelationsFromInvolved(e,i),t()}).catch(i)})}find(e,t,i){const n=this.state(e.id).value;if(n)return _.find(n,n=>{const s=n.denormalized(e);return s.target.id===t.id&&s.relationType===i})}removeRelation(e){return e.delete().then(()=>{this.removeFromStates(e)})}updateRelationType(e,t,i,n){const s={_links:{from:{href:e.href},to:{href:t.href}},type:n};return this.updateRelation(i,s)}updateRelation(e,t){return e.updateImmediately(t).then(e=>(this.insertIntoStates(e),e))}addCommonRelation(e,t,i){const n={_links:{from:{href:this.apiV3Service.work_packages.id(e).toString()},to:{href:this.apiV3Service.work_packages.id(i).toString()}},type:t},s=this.apiV3Service.work_packages.id(e).relations.toString();return this.halResource.post(s,n).toPromise().then(e=>(this.insertIntoStates(e),e))}insertIntoStates(e){_.values(e.ids).forEach(t=>{this.multiState.get(t).doModify(t=>(t[e.id]=e,t),()=>{let t={};return t[e.id]=e,t})})}removeFromStates(e){_.values(e.ids).forEach(t=>{this.multiState.get(t).doModify(t=>(delete t[e.id],t),()=>({}))})}relationsStateValue(e,t){return _.keyBy(t,e=>e.id)}accumulateRelationsFromInvolved(e,t){e.forEach(e=>{const i=t.filter(t=>t.isInvolved(e)),n=this.relationsStateValue(e,i);this.updateValue(e,n)})}}h.\u0275fac=function(e){return new(e||h)(d.lc(n.a),d.lc(a.a),d.lc(r.a))},h.\u0275prov=d.Xb({token:h,factory:h.\u0275fac})},uhGA:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("mrSG"),s=i("Mo6U"),r=i("PHo6"),a=i("LrpJ");class c extends s.a{constructor(){super(...arguments),this.attachmentsBackend=!0}$initialize(e){super.$initialize(e),this.widgets=this.widgets.map(e=>{let t=new r.a(this.injector,e,!0,this.halInitializer,"GridWidget");return t.grid=this,t})}updateAttachments(){return Object(n.b)(this,void 0,void 0,(function*(){return this.attachments.$update().then(()=>(this.states.forResource(this).putValue(this),this.attachments))}))}}const o=Object(a.a)(c)},ul8C:function(e,t,i){"use strict";i.d(t,"a",(function(){return h}));var n=i("xLNn"),s=i("wZYP"),r=i("PtkW"),a=i("fXoL"),c=i("ofXK"),o=i("N5AO");function l(e,t){if(1&e){const e=a.ic();a.hc(0,"li"),a.hc(1,"button",2),a.pc("click",(function(){a.Lc(e);return a.rc().enableAutoZoom()})),a.cc(2,"op-icon",3),a.gc(),a.gc()}if(2&e){const e=a.rc();a.Pb(1),a.wc("ngClass",e.getAutoZoomToggleClass()),a.Qb("title",e.text.zoomAuto)}}function d(e,t){if(1&e){const e=a.ic();a.hc(0,"li"),a.hc(1,"button",4),a.pc("click",(function(){a.Lc(e);return a.rc().updateZoomWithDelta(1)})),a.cc(2,"op-icon",5),a.gc(),a.gc()}if(2&e){const e=a.rc();a.Pb(1),a.wc("disabled",e.isMaxLevel),a.Qb("title",e.text.zoomOut)}}function u(e,t){if(1&e){const e=a.ic();a.hc(0,"li"),a.hc(1,"button",6),a.pc("click",(function(){a.Lc(e);return a.rc().updateZoomWithDelta(-1)})),a.cc(2,"op-icon",7),a.gc(),a.gc()}if(2&e){const e=a.rc();a.Pb(1),a.wc("disabled",e.isMinLevel),a.Qb("title",e.text.zoomIn)}}class h extends n.a{constructor(e,t,i){super(e),this.I18n=e,this.cdRef=t,this.wpTableTimeline=i,this.buttonId="work-packages-timeline-toggle-button",this.iconClass="icon-view-timeline",this.minZoomLevel="days",this.maxZoomLevel="years",this.isAutoZoom=!1,this.isMaxLevel=!1,this.isMinLevel=!1,this.activateLabel=e.t("js.timelines.button_activate"),this.deactivateLabel=e.t("js.timelines.button_deactivate"),this.text.zoomIn=e.t("js.timelines.zoom.in"),this.text.zoomOut=e.t("js.timelines.zoom.out"),this.text.zoomAuto=e.t("js.timelines.zoom.auto")}ngOnInit(){this.wpTableTimeline.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.isAutoZoom=this.wpTableTimeline.isAutoZoom(),this.isActive=this.wpTableTimeline.isVisible,this.cdRef.detectChanges()}),this.wpTableTimeline.appliedZoomLevel$.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.isMaxLevel=e===this.maxZoomLevel,this.isMinLevel=e===this.minZoomLevel,this.cdRef.detectChanges()})}get label(){return this.isActive?this.deactivateLabel:this.activateLabel}isToggle(){return!0}updateZoomWithDelta(e){this.wpTableTimeline.updateZoomWithDelta(e)}performAction(e){this.toggleTimeline()}toggleTimeline(){this.wpTableTimeline.toggle()}enableAutoZoom(){this.wpTableTimeline.enableAutozoom()}getAutoZoomToggleClass(){return this.isAutoZoom?"-disabled":""}}h.\u0275fac=function(e){return new(e||h)(a.bc(s.a),a.bc(a.i),a.bc(r.a))},h.\u0275cmp=a.Vb({type:h,selectors:[["wp-timeline-toggle-button"]],features:[a.Mb],decls:4,vars:3,consts:[["id","work-packages-timeline-mode-selection",1,"toolbar-button-group"],[4,"ngIf"],["id","work-packages-timeline-zoom-auto-button",1,"button","timeline-toolbar--button","toolbar-icon",3,"ngClass","click"],["icon-classes","icon-zoom-auto button--icon"],["id","work-packages-timeline-zoom-out-button",1,"button","timeline-toolbar--button","toolbar-icon",3,"disabled","click"],["icon-classes","icon-zoom-out button--icon"],["id","work-packages-timeline-zoom-in-button",1,"button","timeline-toolbar--button","toolbar-icon",3,"disabled","click"],["icon-classes","icon-zoom-in button--icon"]],template:function(e,t){1&e&&(a.hc(0,"ul",0),a.Tc(1,l,3,2,"li",1),a.Tc(2,d,3,2,"li",1),a.Tc(3,u,3,2,"li",1),a.gc()),2&e&&(a.Pb(1),a.wc("ngIf",t.isActive),a.Pb(1),a.wc("ngIf",t.isActive),a.Pb(1),a.wc("ngIf",t.isActive))},directives:[c.q,c.n,o.a],styles:[".toolbar-button-group[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:last-child{margin-right:10px}"],changeDetection:0})},upbp:function(e,t,i){"use strict";i.d(t,"a",(function(){return d}));var n=i("fXoL"),s=i("ofXK");const r=["scrollContainer"],a=["scrollPane"],c=["scrollRightBtn"],o=["scrollLeftBtn"];function l(e,t){if(1&e){const e=n.ic();n.hc(0,"li"),n.hc(1,"a",11),n.pc("click",(function(){n.Lc(e);const i=t.$implicit;return n.rc().clickTab(i.id)})),n.gc(),n.gc()}if(2&e){const e=t.$implicit,i=n.rc();n.Tb("selected",e.id===i.currentTabId),n.Qb("tab-id",e.id),n.Pb(1),n.wc("href",e.path,n.Oc)("textContent",e.name)}}class d{constructor(){this.currentTabId="",this.tabs=[],this.classes=["scrollable-tabs"],this.hideLeftButton=!0,this.hideRightButton=!0}ngAfterViewInit(){this.container=this.scrollContainer.nativeElement,this.pane=this.scrollPane.nativeElement,this.determineScrollButtonVisibility(),this.scrollIntoVisibleArea(this.currentTabId)}clickTab(e){this.currentTabId=e}onScroll(e){this.determineScrollButtonVisibility()}determineScrollButtonVisibility(){this.hideLeftButton=this.pane.scrollLeft<=0,this.hideRightButton=this.pane.scrollWidth-this.pane.scrollLeft<=this.container.clientWidth}scrollRight(){this.pane.scrollLeft+=this.container.clientWidth}scrollLeft(){this.pane.scrollLeft-=this.container.clientWidth}scrollIntoVisibleArea(e){const t=jQuery(this.pane).find(`[tab-id=${e}]`),i=t.position().left+Number(t.outerWidth());this.pane.scrollLeft+this.container.clientWidth<i&&(this.pane.scrollLeft=i-this.container.clientWidth+40)}}d.\u0275fac=function(e){return new(e||d)},d.\u0275cmp=n.Vb({type:d,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&(n.Rc(r,!0),n.Rc(a,!0),n.Rc(c,!0),n.Rc(o,!0)),2&e)&&(n.Ic(i=n.qc())&&(t.scrollContainer=i.first),n.Ic(i=n.qc())&&(t.scrollPane=i.first),n.Ic(i=n.qc())&&(t.scrollRightBtn=i.first),n.Ic(i=n.qc())&&(t.scrollLeftBtn=i.first))},decls:11,vars:4,consts:[[3,"ngClass"],["scrollContainer",""],[1,"tabrow",3,"scroll"],["scrollPane",""],[3,"selected",4,"ngFor","ngForOf"],[1,"scrollable-tabs--button","-left",3,"hidden","click"],["scrollLeftBtn",""],[1,"icon-arrow-left2"],[1,"scrollable-tabs--button","-right",3,"hidden","click"],["scrollRightBtn",""],[1,"icon-arrow-right2"],[3,"href","textContent","click"]],template:function(e,t){1&e&&(n.hc(0,"div",0,1),n.hc(2,"ul",2,3),n.pc("scroll",(function(e){return t.onScroll(e)})),n.Tc(4,l,2,5,"li",4),n.gc(),n.hc(5,"div",5,6),n.pc("click",(function(){return t.scrollLeft()})),n.cc(7,"span",7),n.gc(),n.hc(8,"div",8,9),n.pc("click",(function(){return t.scrollRight()})),n.cc(10,"span",10),n.gc(),n.gc()),2&e&&(n.wc("ngClass",t.classes),n.Pb(4),n.wc("ngForOf",t.tabs),n.Pb(1),n.wc("hidden",t.hideLeftButton),n.Pb(3),n.wc("hidden",t.hideRightButton))},directives:[s.n,s.p],encapsulation:2})},"v9+U":function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i("fXoL"),s=i("8OyR"),r=i("ofXK");function a(e,t){if(1&e&&n.cc(0,"div",1),2&e){const e=n.rc();n.wc("ngClass",e.resizerClass)}}class c{constructor(){this.resizing=!1,this.end=new n.s,this.start=new n.s,this.move=new n.s,this.customHandler=!1,this.cursorClass="nwse-resize",this.resizerClass="resizer"}ngOnDestroy(){this.removeEventListener()}startResize(e){e.preventDefault(),e.stopPropagation(),1!==e.buttons&&1!==e.which&&0!==e.which||(this.oldX=this.startX=e.clientX||e.pageX||e.touches[0].clientX,this.oldY=this.startY=e.clientY||e.pageY||e.touches[0].clientY,this.newX=e.clientX||e.pageX||e.touches[0].clientX,this.newY=e.clientY||e.pageY||e.touches[0].clientY,this.resizing=!0,this.setResizeCursor(),this.bindEventListener(e),this.start.emit(this.buildDelta(e)))}onMouseUp(e){this.setAutoCursor(),this.removeEventListener(),this.end.emit(this.buildDelta(e))}onMouseMove(e){e.preventDefault(),e.stopPropagation(),this.oldX=this.newX,this.oldY=this.newY,this.newX=e.clientX||e.pageX||e.touches[0].clientX,this.newY=e.clientY||e.pageY||e.touches[0].clientX,this.move.emit(this.buildDelta(e))}bindEventListener(e){this.mouseMoveHandler=this.onMouseMove.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this),window.addEventListener("mousemove",this.mouseMoveHandler),window.addEventListener("touchmove",this.mouseMoveHandler),window.addEventListener("mouseup",this.mouseUpHandler),window.addEventListener("touchend",this.mouseUpHandler)}removeEventListener(){window.removeEventListener("touchmove",this.mouseMoveHandler),window.removeEventListener("mousemove",this.mouseMoveHandler),window.removeEventListener("mouseup",this.mouseUpHandler),window.removeEventListener("touchend",this.mouseUpHandler)}setResizeCursor(){s.a.setBodyCursor(this.cursorClass,"important")}setAutoCursor(){s.a.setBodyCursor("auto")}buildDelta(e){return{origin:e,absolute:{x:this.newX-this.startX,y:this.newY-this.startY},relative:{x:this.newX-this.oldX,y:this.newY-this.oldX}}}}c.\u0275fac=function(e){return new(e||c)},c.\u0275cmp=n.Vb({type:c,selectors:[["resizer"]],hostBindings:function(e,t){1&e&&n.pc("mousedown",(function(e){return t.startResize(e)}))("touchstart",(function(e){return t.startResize(e)}))},inputs:{customHandler:"customHandler",cursorClass:"cursorClass",resizerClass:"resizerClass"},outputs:{end:"end",start:"start",move:"move"},ngContentSelectors:["*"],decls:2,vars:1,consts:[[3,"ngClass",4,"ngIf"],[3,"ngClass"]],template:function(e,t){1&e&&(n.vc(),n.Tc(0,a,1,1,"div",0),n.uc(1)),2&e&&n.wc("ngIf",!t.customHandler)},directives:[r.q,r.n],encapsulation:2})},vK8y:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{get isLoggedIn(){return this.userMeta.length>0}get userId(){return this.userMeta.data("id")}get href(){return"/api/v3/users/"+this.userId}get name(){return this.userMeta.data("name")}get mail(){return this.userMeta.data("mail")}get language(){return I18n.locale||"en"}get userMeta(){return jQuery("meta[name=current_user]")}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac,providedIn:"root"})},vZpQ:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t){this.schema=e,this.resource=t}static create(e,t){return new Proxy(e,new this(e,t))}get(e,t,i){switch(t){case"ofProperty":return this.proxyMethod(this.ofProperty);case"isAttributeEditable":return this.proxyMethod(this.isAttributeEditable);case"mappedName":return this.proxyMethod(this.mappedName);case"isEditable":return this.isEditable;default:return Reflect.get(e,t,i)}}ofProperty(e){let t=this.schema[this.mappedName(e)];return t?Object.assign({},t,{writable:this.isEditable&&t&&t.writable}):null}isAttributeEditable(e){let t=this.ofProperty(e);return!!t&&t.writable}get isEditable(){return this.resource.isNew||!!this.resource.$links.update}mappedName(e){return e}proxyMethod(e){const t=this;return new Proxy(e,{apply:function(i,n,s){return e.apply(t,[s[0]])}})}}},vd15:function(e,t,i){"use strict";i.d(t,"a",(function(){return x}));var n=i("mrSG"),s=(i("ii2/"),i("XZsv")),r=i("mMv8"),a=i("Y0Nk"),c=i("RuUM"),o=i("fXoL"),l=i("8zkO"),d=i("d/TE"),u=i("wZYP"),h=i("2Uhg"),p=i("qc15"),g=i("CNq7"),f=i("ofXK"),b=i("7MH/"),m=i("/Rze"),w=i("N5AO");const v=["commentContainer"];function y(e,t){if(1&e&&o.dc(0,4),2&e){const e=o.rc();o.wc("ngTemplateOutlet",e.template)}}function k(e,t){if(1&e&&o.cc(0,"edit-form-portal",10),2&e){const e=o.rc(2);o.wc("schemaInput",e.schema)("changeInput",e.change)("editFieldHandler",e.handler)}}function C(e,t){if(1&e){const e=o.ic();o.hc(0,"div",11),o.pc("dragover",(function(t){o.Lc(e);return o.rc(2).startDragOverActivation(t)})),o.hc(1,"accessible-by-keyboard",12),o.pc("execute",(function(){o.Lc(e);return o.rc(2).activate()})),o.hc(2,"span",13),o.cc(3,"span",14),o.gc(),o.hc(4,"span",15),o.cc(5,"op-icon",16),o.gc(),o.gc(),o.gc()}if(2&e){const e=o.rc(2);o.Pb(1),o.wc("linkAriaLabel",e.text.editTitle),o.Pb(2),o.wc("textContent",e.text.placeholder),o.Pb(2),o.wc("icon-title",e.text.editTitle)}}function j(e,t){if(1&e&&(o.hc(0,"div",5,6),o.hc(2,"div",7),o.Tc(3,k,1,3,"edit-form-portal",8),o.Tc(4,C,6,3,"div",9),o.gc(),o.gc()),2&e){const e=o.rc();o.Pb(3),o.wc("ngIf",e.active),o.Pb(1),o.wc("ngIf",!e.active)}}function P(e,t){if(1&e&&o.dc(0,4),2&e){const e=o.rc();o.wc("ngTemplateOutlet",e.template)}}class x extends h.a{constructor(e,t,i,n,s,r,a,c,o,l,d){super(e,t),this.elementRef=e,this.injector=t,this.commentService=i,this.wpLinkedActivities=n,this.ConfigurationService=s,this.loadingIndicator=r,this.apiV3Service=a,this.workPackageNotificationService=c,this.NotificationsService=o,this.cdRef=l,this.I18n=d,this.text={editTitle:this.I18n.t("js.label_add_comment_title"),addComment:this.I18n.t("js.label_add_comment"),cancelTitle:this.I18n.t("js.label_cancel_comment"),placeholder:this.I18n.t("js.label_add_comment_title")},this.fieldLabel=this.text.editTitle,this.inFlight=!1}ngOnInit(){super.ngOnInit(),this.canAddComment=!!this.workPackage.addComment,this.showAbove=this.ConfigurationService.commentsSortedInDescendingOrder(),this.commentService.quoteEvents.pipe(this.untilDestroyed()).subscribe(e=>{this.activate(e),this.commentContainer.nativeElement.scrollIntoView()})}startDragOverActivation(e){return!!this.active||(this.activate(),e.preventDefault(),!1)}get htmlId(){return"wp-comment-field"}activate(e){super.activate(e),this.showAbove||this.scrollToBottom(),this.cdRef.detectChanges()}deactivate(e){e&&this.focus(),this.active=!1,this.cdRef.detectChanges()}handleUserSubmit(){return Object(n.b)(this,void 0,void 0,(function*(){if(this.inFlight||!this.rawComment)return Promise.resolve();return this.inFlight=!0,yield this.onSubmit(),this.loadingIndicator.wpDetails.promise=this.commentService.createComment(this.workPackage,this.commentValue).then(()=>{this.active=!1,this.NotificationsService.addSuccess(this.I18n.t("js.work_packages.comment_added")),this.wpLinkedActivities.require(this.workPackage,!0),this.apiV3Service.work_packages.id(this.workPackage.id).refresh(),this.inFlight=!1,this.deactivate(!0)}).catch(e=>{this.inFlight=!1,e instanceof s.a?this.workPackageNotificationService.showError(e,this.workPackage):this.NotificationsService.addError(this.I18n.t("js.work_packages.comment_send_failed"))})}))}scrollToBottom(){const e=jQuery(this.elementRef.nativeElement).scrollParent()[0];e&&setTimeout(()=>{e.scrollTop=e.scrollHeight},400)}setErrors(e){}}x.\u0275fac=function(e){return new(e||x)(o.bc(o.q),o.bc(o.A),o.bc(c.a),o.bc(r.a),o.bc(l.a),o.bc(a.a),o.bc(g.a),o.bc(p.a),o.bc(d.a),o.bc(o.i),o.bc(u.a))},x.\u0275cmp=o.Vb({type:x,selectors:[["work-package-comment"]],contentQueries:function(e,t,i){var n;(1&e&&o.Ub(i,o.Z,!0),2&e)&&(o.Ic(n=o.qc())&&(t.template=n.first))},viewQuery:function(e,t){var i;(1&e&&o.ad(v,!0),2&e)&&(o.Ic(i=o.qc())&&(t.commentContainer=i.first))},inputs:{workPackage:"workPackage"},features:[o.Mb],decls:5,vars:3,consts:[["id","work-package-activites-container"],["id","work-package-comment-container"],[3,"ngTemplateOutlet",4,"ngIf"],["class","work-package--details--long-field work-packages--activity--add-comment hide-when-print",4,"ngIf"],[3,"ngTemplateOutlet"],[1,"work-package--details--long-field","work-packages--activity--add-comment","hide-when-print"],["commentContainer",""],[1,"inline-edit--container","inplace-edit"],[3,"schemaInput","changeInput","editFieldHandler",4,"ngIf"],["class","inplace-edit--read",3,"dragover",4,"ngIf"],[3,"schemaInput","changeInput","editFieldHandler"],[1,"inplace-edit--read",3,"dragover"],["spanClass","inplace-editing--container inline-edit--display-field","linkClass","inplace-editing--trigger-link",1,"inplace-editing--trigger-container",3,"linkAriaLabel","execute"],[1,"inplace-editing--trigger-text","inline-edit--formattable-display-text","-default"],[3,"textContent"],[1,"inplace-editing--trigger-icon"],["icon-classes","icon-edit",3,"icon-title"]],template:function(e,t){1&e&&(o.hc(0,"div",0),o.hc(1,"div",1),o.Tc(2,y,1,1,"ng-container",2),o.Tc(3,j,5,2,"div",3),o.Tc(4,P,1,1,"ng-container",2),o.gc(),o.gc()),2&e&&(o.Pb(2),o.wc("ngIf",!t.showAbove),o.Pb(1),o.wc("ngIf",t.canAddComment),o.Pb(1),o.wc("ngIf",t.showAbove))},directives:[f.q,f.x,b.a,m.a,w.a],encapsulation:2,changeDetection:0})},w6CH:function(e,t,i){"use strict";i.d(t,"a",(function(){return G}));var n=i("fXoL"),s=i("u4T9"),r=i("XGsO"),a=i("J30J"),c=i("mrSG"),o=i("4rda"),l=i("r0MM"),d=i("07mJ");class u extends o.a{render(e,t){const i=this.resource.bcfViewpoints;if(i&&i.length>0){const t=i[0];e.innerHTML=`\n        <img src="${this.bcfPathHelper.snapshotPath(t)}" class="thumbnail">\n      `}else e.innerHTML=""}}Object(c.c)([Object(l.a)(),Object(c.e)("design:type",d.a)],u.prototype,"bcfPathHelper",void 0);var h=i("tk/3"),p=i("HGdY"),g=i("ofXK");class f{constructor(e){this.documentElement=e}get isBcfActivated(){return this.hasBodyClass("bcf-activated")}hasBodyClass(e){return this.documentElement.body.classList.contains(e)}}f.\u0275fac=function(e){return new(e||f)(n.lc(g.d))},f.\u0275prov=n.Xb({token:f,factory:f.\u0275fac});var b=i("mY05"),m=i("jW2i"),w=i("lfyH"),v=i("g1AQ"),y=i("iB+3"),k=(i("ii2/"),i("wZYP")),C=i("AEvm"),j=i("d/TE"),P=i("4n9w"),x=i("FnNU"),S=i("3VS2"),_=i("lJxs"),O=i("IzEk");class I{constructor(e){this.bcfApi=e,this.authorizationMap=Object(x.h)()}authorized$(e,t,i){const n=this.authorizationMap.get(e);return n.putFromPromiseIfPristine(()=>this.bcfApi.projects.id(e).extensions.get().toPromise()),n.values$().pipe(Object(_.a)(e=>e[t]&&e[t].includes(i)))}isAllowedTo(e,t,i){return this.authorized$(e,t,i).pipe(Object(O.a)(1)).toPromise().catch(()=>!1)}}I.\u0275fac=function(e){return new(e||I)(n.lc(S.a))},I.\u0275prov=n.Xb({token:I,factory:I.\u0275fac,providedIn:"root"});var T=i("CNq7"),R=i("N5AO");function E(e,t){if(1&e){const e=n.ic();n.hc(0,"div",7),n.hc(1,"ngx-gallery",8),n.pc("change",(function(t){n.Lc(e);return n.rc(2).onGalleryChanged(t)}))("imagesReady",(function(){n.Lc(e);return n.rc(2).selectViewpointInGallery()}))("previewOpen",(function(){n.Lc(e);return n.rc(2).galleryPreviewOpen()}))("previewClose",(function(){n.Lc(e);return n.rc(2).galleryPreviewClose()})),n.gc(),n.gc()}if(2&e){const e=n.rc(2);n.Pb(1),n.wc("options",e.galleryOptions)("images",e.galleryImages)}}function M(e,t){if(1&e){const e=n.ic();n.hc(0,"a",9),n.pc("click",(function(){n.Lc(e);const t=n.rc(2);return t.saveViewpoint(t.workPackage)})),n.cc(1,"op-icon",10),n.hc(2,"span",11),n.Vc(3),n.gc(),n.gc()}if(2&e){const e=n.rc(2);n.wc("title",e.text.add_viewpoint),n.Pb(3),n.Xc(" ",e.text.viewpoint," ")}}function F(e,t){if(1&e&&(n.fc(0),n.hc(1,"div",1),n.hc(2,"div",2),n.hc(3,"div",3),n.cc(4,"h3",4),n.gc(),n.gc(),n.Tc(5,E,2,2,"div",5),n.Tc(6,M,4,2,"a",6),n.gc(),n.ec()),2&e){const e=n.rc();n.Pb(4),n.wc("textContent",e.text.bcf),n.Pb(1),n.wc("ngIf",e.galleryImages.length>0),n.Pb(1),n.wc("ngIf",e.viewerVisible&&e.createAllowed)}}class A extends C.a{constructor(e,t,i,n,s,r,a,c,o){super(),this.state=e,this.bcfAuthorization=t,this.viewerBridge=i,this.apiV3Service=n,this.wpCreate=s,this.notifications=r,this.cdRef=a,this.I18n=c,this.viewpointsService=o,this.text={bcf:this.I18n.t("js.bcf.label_bcf"),viewpoint:this.I18n.t("js.bcf.viewpoint"),add_viewpoint:this.I18n.t("js.bcf.add_viewpoint"),show_viewpoint:this.I18n.t("js.bcf.show_viewpoint"),delete_viewpoint:this.I18n.t("js.bcf.delete_viewpoint"),text_are_you_sure:this.I18n.t("js.text_are_you_sure"),notice_successful_create:this.I18n.t("js.notice_successful_create"),notice_successful_delete:this.I18n.t("js.notice_successful_delete")},this.galleryOptions=[{width:"100%",height:"400px",startIndex:0,image:!1,thumbnailsColumns:1,thumbnailsAutoHide:!1,thumbnailSize:"contain",imageAnimation:"",previewAnimation:!1,previewCloseOnEsc:!0,previewKeyboardNavigation:!0,imageSize:"contain",imageArrowsAutoHide:!0,thumbnailsMargin:5,thumbnailMargin:5,previewDownload:!0,previewCloseOnClick:!0,arrowPrevIcon:"icon-arrow-left2",arrowNextIcon:"icon-arrow-right2",closeIcon:"icon-close",downloadIcon:"icon-download",thumbnailActions:this.actions(),actions:this.actions()},{breakpoint:800,width:"100%",height:"400px",imagePercent:80,thumbnailsPercent:20,thumbnailsMargin:5,thumbnailMargin:5},{breakpoint:680,height:"200px",thumbnailsColumns:3,thumbnailsMargin:5,thumbnailMargin:5}],this.viewpoints=[],this.galleryImages=[],this.viewAllowed=!1,this.createAllowed=!1,this.viewerVisible=!1}ngAfterViewInit(){this.observeChanges()}ngOnInit(){this.viewerBridge.viewerVisible$.subscribe(e=>{this.viewerVisible=!!e,this.cdRef.detectChanges()})}observeChanges(){this.apiV3Service.work_packages.id(this.workPackage).requireAndStream().pipe(this.untilDestroyed()).subscribe(e=>Object(c.b)(this,void 0,void 0,(function*(){this.workPackage=e,this.projectId||(yield this.initialize(this.workPackage)),e.bcfViewpoints&&this.refreshViewpoints(e.bcfViewpoints)})))}initialize(e){return Object(c.b)(this,void 0,void 0,(function*(){this.projectId=e.project.idFromLink,this.viewAllowed=yield this.bcfAuthorization.isAllowedTo(this.projectId,"project_actions","viewTopic"),this.createAllowed=yield this.bcfAuthorization.isAllowedTo(this.projectId,"topic_actions","createViewpoint"),this.loadViewpointFromRoute(e),this.cdRef.detectChanges()}))}refreshViewpoints(e){this.viewpoints=e.map(e=>({href:e.href,snapshotURL:e.href+"/snapshot"})),this.setViewpointsOnGallery(this.viewpoints)}showViewpoint(e,t){this.viewerBridge.showViewpoint(e,t)}deleteViewpoint(e,t){window.confirm(this.text.text_are_you_sure)&&this.viewpointsService.deleteViewPoint$(e,t).subscribe(e=>{this.notifications.addSuccess(this.text.notice_successful_delete),this.gallery.preview.close()})}saveViewpoint(e){this.viewpointsService.saveViewpoint$(e).subscribe(e=>{this.notifications.addSuccess(this.text.notice_successful_create),this.showIndex=this.viewpoints.length})}loadViewpointFromRoute(e){if("number"==typeof this.state.params.viewpoint){const t=this.state.params.viewpoint;this.showViewpoint(e,t),this.showIndex=t,this.selectViewpointInGallery(),this.state.go(".",Object.assign(Object.assign({},this.state.params),{viewpoint:void 0}),{reload:!1})}}shouldShowGroup(){return this.viewAllowed&&(this.viewpoints.length>0||this.createAllowed&&this.viewerVisible)}actions(){return[{icon:"icon-view-model",onClick:(e,t)=>{this.showViewpoint(this.workPackage,t),this.gallery.preview.close()},titleText:this.text.show_viewpoint},{icon:"icon-delete",onClick:(e,t)=>this.deleteViewpoint(this.workPackage,t),titleText:this.text.delete_viewpoint}]}galleryPreviewOpen(){jQuery("#top-menu").addClass("-no-z-index")}galleryPreviewClose(){jQuery("#top-menu").removeClass("-no-z-index")}selectViewpointInGallery(){setTimeout(()=>{var e;return null===(e=this.gallery)||void 0===e?void 0:e.show(this.showIndex)},250)}onGalleryChanged(e){this.showIndex=e.index}set showIndex(e){const t=[...this.galleryOptions];t[0].startIndex=e,this.galleryOptions=t}get showIndex(){return this.galleryOptions[0].startIndex}setViewpointsOnGallery(e){const t=e.length;this.setThumbnailProperties(t),this.showIndex<0||t<1?this.showIndex=0:this.showIndex>=t&&(this.showIndex=t-1),this.galleryImages=e.map(e=>({small:e.snapshotURL,medium:e.snapshotURL,big:e.snapshotURL})),this.cdRef.detectChanges()}setThumbnailProperties(e){const t=[...this.galleryOptions];t[0].thumbnailsColumns=e<5?e:4,t[1].thumbnailsColumns=e<5?e:4,t[2].thumbnailsColumns=e<4?e:3,t[0].height=this.dynamicThumbnailHeight(e)+"px",t[1].height=this.dynamicThumbnailHeight(e)+"px",t[2].height=this.dynamicThumbnailHeight(e)+"px",this.galleryOptions=t}dynamicThumbnailHeight(e){return Math.max(Math.round(300/e),120)}}A.\u0275fac=function(e){return new(e||A)(n.bc(y.StateService),n.bc(I),n.bc(w.a),n.bc(T.a),n.bc(P.a),n.bc(j.a),n.bc(n.i),n.bc(k.a),n.bc(b.a))},A.\u0275cmp=n.Vb({type:A,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.ad(r.a,!0),2&e)&&(n.Ic(i=n.qc())&&(t.gallery=i.first))},inputs:{workPackage:"workPackage"},features:[n.Ob([b.a]),n.Mb],decls:1,vars:1,consts:[[4,"ngIf"],[1,"attributes-group","description-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],["class","bcf--viewpoints",4,"ngIf"],["class","button",3,"title","click",4,"ngIf"],[1,"bcf--viewpoints"],[3,"options","images","change","imagesReady","previewOpen","previewClose"],[1,"button",3,"title","click"],["icon-classes","button--icon icon-add"],[1,"button--text"]],template:function(e,t){1&e&&n.Tc(0,F,7,3,"ng-container",0),2&e&&n.wc("ngIf",t.shouldShowGroup())},directives:[g.q,r.a,R.a],styles:[".bcf--viewpoints[_ngcontent-%COMP%]{clear:both}ngx-gallery[_ngcontent-%COMP%]{display:inline-block}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-thumbnails .ngx-gallery-arrow{color:var(--content-link-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-arrow.ngx-gallery-disabled{display:none}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper{background:hsla(0,0%,100%,.5);padding:5px}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper .ngx-gallery-icon{margin-top:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper ngx-gallery-action:last-of-type .ngx-gallery-icon{margin-right:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail.ngx-gallery-clickable .ngx-gallery-icon{font-size:1.25rem;color:var(--content-link-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-active, ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{border:1px solid #e7e7e7!important}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-preview-img{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview{background:rgba(0,0,0,.8)!important}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview a:hover{color:#fff}"],changeDetection:0});var L=i("eIep"),D=i("cp0P");function V(e,t){if(1&e){const e=n.ic();n.hc(0,"div",7),n.hc(1,"ngx-gallery",8),n.pc("change",(function(t){n.Lc(e);return n.rc(2).onGalleryChanged(t)}))("imagesReady",(function(){n.Lc(e);return n.rc(2).selectViewpointInGallery()}))("previewOpen",(function(){n.Lc(e);return n.rc(2).galleryPreviewOpen()}))("previewClose",(function(){n.Lc(e);return n.rc(2).galleryPreviewClose()})),n.gc(),n.gc()}if(2&e){const e=n.rc(2);n.Pb(1),n.wc("options",e.galleryOptions)("images",e.galleryImages)}}function q(e,t){if(1&e){const e=n.ic();n.hc(0,"a",9),n.pc("click",(function(){n.Lc(e);const t=n.rc(2);return t.saveViewpoint(t.workPackage)})),n.cc(1,"op-icon",10),n.hc(2,"span",11),n.Vc(3),n.gc(),n.gc()}if(2&e){const e=n.rc(2);n.wc("title",e.text.add_viewpoint),n.Pb(3),n.Xc(" ",e.text.viewpoint," ")}}function $(e,t){if(1&e&&(n.fc(0),n.hc(1,"div",1),n.hc(2,"div",2),n.hc(3,"div",3),n.cc(4,"h3",4),n.gc(),n.gc(),n.Tc(5,V,2,2,"div",5),n.Tc(6,q,4,2,"a",6),n.gc(),n.ec()),2&e){const e=n.rc();n.Pb(4),n.wc("textContent",e.text.bcf),n.Pb(1),n.wc("ngIf",e.galleryImages.length>0),n.Pb(1),n.wc("ngIf",e.viewerVisible&&e.createAllowed)}}class N extends A{constructor(){super(...arguments),this.galleryViewpoints=[]}ngAfterViewInit(){this.viewerVisible&&(super.ngAfterViewInit(),this.workPackage.isNew&&this.observeCreation())}observeCreation(){this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed(),Object(O.a)(1),Object(L.a)(e=>this.viewpointsService.setBcfTopic$(e),e=>e),Object(L.a)(e=>{this.workPackage=e;const t=this.galleryViewpoints.filter(e=>!e.href&&e.viewpoint).map(e=>this.viewpointsService.saveViewpoint$(this.workPackage,e.viewpoint));return Object(D.a)(t)})).subscribe(e=>{this.showIndex=this.galleryViewpoints.length-1})}showViewpoint(e,t){}deleteViewpoint(e,t){this.galleryViewpoints=this.galleryViewpoints.filter((e,i)=>i!==t),this.setViewpointsOnGallery(this.galleryViewpoints)}saveViewpoint(){this.viewerBridge.getViewpoint$().subscribe(e=>{const t={snapshotURL:e.snapshot.snapshot_data,viewpoint:e};this.galleryViewpoints=[...this.galleryViewpoints,t],this.setViewpointsOnGallery(this.galleryViewpoints),this.showIndex=this.galleryViewpoints.length-1,this.selectViewpointInGallery()})}shouldShowGroup(){return this.createAllowed&&this.viewerVisible}actions(){return super.actions().filter(e=>"icon-delete"===e.icon)}}N.\u0275fac=function(e){return B(e||N)},N.\u0275cmp=n.Vb({type:N,selectors:[["ng-component"]],features:[n.Mb],decls:1,vars:1,consts:[[4,"ngIf"],[1,"attributes-group","description-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],["class","bcf--viewpoints",4,"ngIf"],["class","button",3,"title","click",4,"ngIf"],[1,"bcf--viewpoints"],[3,"options","images","change","imagesReady","previewOpen","previewClose"],[1,"button",3,"title","click"],["icon-classes","button--icon icon-add"],[1,"button--text"]],template:function(e,t){1&e&&n.Tc(0,$,7,3,"ng-container",0),2&e&&n.wc("ngIf",t.shouldShowGroup())},directives:[g.q,r.a,R.a],styles:[".bcf--viewpoints[_ngcontent-%COMP%]{clear:both}ngx-gallery[_ngcontent-%COMP%]{display:inline-block}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-thumbnails .ngx-gallery-arrow{color:var(--content-link-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-arrow.ngx-gallery-disabled{display:none}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper{background:hsla(0,0%,100%,.5);padding:5px}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper .ngx-gallery-icon{margin-top:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper ngx-gallery-action:last-of-type .ngx-gallery-icon{margin-right:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail.ngx-gallery-clickable .ngx-gallery-icon{font-size:1.25rem;color:var(--content-link-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-active, ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{border:1px solid #e7e7e7!important}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-preview-img{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview{background:rgba(0,0,0,.8)!important}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview a:hover{color:#fff}"],changeDetection:0});const B=n.jc(N);var z=i("2Vo4"),H=i("XNiG"),Q=i("/uUt"),W=i("pLZG"),X=i("SxV6");class U extends w.a{constructor(e){super(e),this.injector=e,this.shouldShowViewer=!1,this.viewerVisible$=new z.a(!1),this.revitMessageReceivedSource=new H.a,this.trackingIdNumber=0,this.revitMessageReceived$=this.revitMessageReceivedSource.asObservable(),window.RevitBridge?this.hookUpRevitListener():window.addEventListener("revit.plugin.ready",()=>{this.hookUpRevitListener()},{once:!0})}viewerVisible(){return this.viewerVisible$.getValue()}getViewpoint$(){const e=this.newTrackingId();return this.sendMessageToRevit("ViewpointGenerationRequest",e,""),this.revitMessageReceived$.pipe(Object(Q.a)(),Object(W.a)(t=>"ViewpointData"===t.messageType&&t.trackingId===e),Object(X.a)()).pipe(Object(_.a)(e=>{let t=e.messagePayload;return t.snapshot={snapshot_type:"png",snapshot_data:t.snapshot},t}))}showViewpoint(e,t){this.viewpointsService.getViewPoint$(e,t).subscribe(e=>this.sendMessageToRevit("ShowViewpoint",this.newTrackingId(),JSON.stringify(e)))}sendMessageToRevit(e,t,i){if(!this.viewerVisible())return;const n=null!=i?JSON.stringify(i):null;window.RevitBridge.sendMessageToRevit(e,t,n)}hookUpRevitListener(){window.RevitBridge.sendMessageToOpenProject=e=>{const t=JSON.parse(e),i=t.messageType,n=t.trackingId,s=JSON.parse(t.messagePayload);this.revitMessageReceivedSource.next({messageType:i,trackingId:n,messagePayload:s})},this.viewerVisible$.next(!0)}newTrackingId(){return this.trackingIdNumber=this.trackingIdNumber+1,String(this.trackingIdNumber)}}U.\u0275fac=function(e){return new(e||U)(n.lc(n.A))},U.\u0275prov=n.Xb({token:U,factory:U.\u0275fac}),Object(c.c)([Object(l.a)(),Object(c.e)("design:type",b.a)],U.prototype,"viewpointsService",void 0);class G{constructor(e){G.bootstrap(e)}static bootstrap(e){if(this.bootstrapCalled)return;this.bootstrapCalled=!0;e.get(a.a).addFieldType(u,"bcfThumbnail",["BCF Thumbnail"]);e.get(v.a).register("prependedAttributeGroups",e=>{if(window.OpenProject.isBimEdition)return e.isNew?N:A})}}G.bootstrapCalled=!1,G.\u0275mod=n.Zb({type:G}),G.\u0275inj=n.Yb({factory:function(e){return new(e||G)(n.lc(n.A))},providers:[{provide:h.a,useClass:p.a,multi:!0},{provide:w.a,useFactory:e=>window.navigator.userAgent.search("Revit")>-1?new U(e):e.get(m.a,new m.a(e)),deps:[n.A]},f,d.a,b.a],imports:[[s.a,r.b]]})},wOIT:function(e,t,i){"use strict";i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return u}));var n=i("wZYP"),s=i("fXoL"),r=i("3Pt+"),a=i("ofXK"),c=i("ecJW");function o(e,t){if(1&e&&s.cc(0,"option",6),2&e){const e=t.$implicit;s.wc("textContent",e.label)("ngValue",e)}}function l(e,t){if(1&e){const e=s.ic();s.hc(0,"span",7),s.hc(1,"op-date-picker",8),s.pc("onChange",(function(t){s.Lc(e);return s.rc().updateField(t)})),s.gc(),s.gc()}if(2&e){const e=s.rc();s.Pb(1),s.wc("id",e.fieldId+"_visible")("name",e.fieldId+"_input")("initialDate",e.fieldValue)}}const d="custom-date-action-admin";class u{constructor(e,t,i,n){this.elementRef=e,this.cdRef=t,this.appRef=i,this.I18n=n,this.valueVisible=!1,this.onKey="on",this.currentKey="current",this.currentFieldValue="%CURRENT_DATE%",this.operators=[{key:this.onKey,label:this.I18n.t("js.custom_actions.date.specific")},{key:this.currentKey,label:this.I18n.t("js.custom_actions.date.current_date")}]}ngOnInit(){const e=this.elementRef.nativeElement;this.fieldName=e.dataset.fieldName,this.fieldValue=e.dataset.fieldValue,this.fieldValue===this.currentFieldValue?this.selectedOperator=this.operators[1]:(this.selectedOperator=this.operators[0],this.visibleValue=this.fieldValue),this.toggleValueVisibility()}toggleValueVisibility(){this.valueVisible=this.selectedOperator.key===this.onKey,this.fieldValue===this.currentFieldValue&&(this.fieldValue=""),this.updateDbValue()}updateDbValue(){this.selectedOperator.key===this.currentKey&&(this.fieldValue=this.currentFieldValue)}get fieldId(){return this.fieldName.replace(/\[|\]/g,"_").replace("__","_").replace(/_$/,"")}updateField(e){this.fieldValue=e,this.cdRef.detectChanges()}}u.\u0275fac=function(e){return new(e||u)(s.bc(s.q),s.bc(s.i),s.bc(s.f),s.bc(n.a))},u.\u0275cmp=s.Vb({type:u,selectors:[["custom-date-action-admin"]],decls:6,vars:6,consts:[[1,"form--field-container"],[1,"form--select-container"],[1,"form--select",3,"ngModel","ngModelChange","change"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],["class","form--text-field-container -slim",4,"ngIf"],["type","hidden",3,"name","value"],[3,"textContent","ngValue"],[1,"form--text-field-container","-slim"],["classes","form--text-field",3,"id","name","initialDate","onChange"]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"span",1),s.hc(2,"select",2),s.pc("ngModelChange",(function(e){return t.selectedOperator=e}))("change",(function(){return t.toggleValueVisibility()})),s.Tc(3,o,1,2,"option",3),s.gc(),s.gc(),s.Tc(4,l,2,3,"span",4),s.cc(5,"input",5),s.gc()),2&e&&(s.Pb(2),s.wc("ngModel",t.selectedOperator),s.Qb("id",t.fieldId),s.Pb(1),s.wc("ngForOf",t.operators),s.Pb(1),s.wc("ngIf",t.valueVisible),s.Pb(1),s.wc("name",t.fieldName)("value",t.fieldValue))},directives:[r.y,r.m,r.p,a.p,a.q,r.r,r.B,c.a],encapsulation:2})},wZYP:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this._i18n=window.I18n,this.toNumber=this._i18n.toNumber.bind(this._i18n),this.toPercentage=this._i18n.toPercentage.bind(this._i18n),this.toCurrency=this._i18n.toCurrency.bind(this._i18n),this.strftime=this._i18n.strftime.bind(this._i18n),this.toHumanSize=this._i18n.toHumanSize.bind(this._i18n)}get locale(){return this._i18n.locale}t(e,t){return this._i18n.t(e,t)}lookup(e){return this._i18n.lookup(e)}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac,providedIn:"root"})},wyKs:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i("zqrF");class s{constructor(e){this.isVisible=!1,this.last=null,this.collapsed={},this.isVisible=e}}var r=i("fXoL");class a extends n.a{valueFromQuery(e){const t=new s(e.showHierarchies),i=this.current;return i&&(t.collapsed=i.collapsed),t}hasChanged(e){return e.showHierarchies!==this.isEnabled}applyToQuery(e){return e.showHierarchies=this.isEnabled,this.isEnabled}get isEnabled(){return!(!this.current||!this.current.isVisible)}setEnabled(e=!0){const t=Object.assign(Object.assign({},this.current),{isVisible:e,last:null});this.update(t)}toggleState(){return this.setEnabled(!this.isEnabled),this.isEnabled}collapsed(e){return this.current.collapsed[e]}collapse(e){this.setState(e,!0)}expand(e){this.setState(e,!1)}toggle(e){this.setState(e,!this.collapsed(e))}setState(e,t){const i=Object.assign(Object.assign({},this.current),{last:e});i.collapsed[e]=t,this.update(i)}get current(){const e=this.lastUpdatedState.value;return void 0===e?this.initialState:(e.collapsed||(e.collapsed={}),e)}get initialState(){return new s(!1)}}a.\u0275fac=function(e){return c(e||a)},a.\u0275prov=r.Xb({token:a,factory:a.\u0275fac});const c=r.jc(a)},x5It:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("fXoL");class s{constructor(){this.causedUpdates=[]}includes(e){return this.causedUpdates.includes(this.cacheValue(e))}add(e){this.causedUpdates.length>100&&this.causedUpdates.splice(0,90),this.causedUpdates.push(this.cacheValue(e))}cacheValue(e){return e.updatedAt+e.$href}}s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n.Xb({token:s,factory:s.\u0275fac})},xFOf:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("Qs0b"),s=i("wZYP"),r=i("fXoL"),a=i("ofXK");const c=function(e){return{"-left-margin":e}};class o{constructor(e){this.I18n=e,this.leftMargin=!1,this.text={enterpriseFeature:this.I18n.t("js.upsale.ee_only")}}eeLink(){return this.opReferrer?n.b+"&op_referrer="+this.opReferrer:n.b}}o.\u0275fac=function(e){return new(e||o)(r.bc(s.a))},o.\u0275cmp=r.Vb({type:o,selectors:[["enterprise-banner"]],inputs:{leftMargin:"leftMargin",textMessage:"textMessage",linkMessage:"linkMessage",opReferrer:"opReferrer"},decls:5,vars:7,consts:[[1,"notification-box","-ee-upsale",3,"ngClass"],[1,"notification-box--content"],[1,"-bold",3,"textContent"],[3,"textContent"],["target","blank",3,"href","textContent"]],template:function(e,t){1&e&&(r.hc(0,"div",0),r.hc(1,"div",1),r.cc(2,"p",2),r.cc(3,"p",3),r.cc(4,"a",4),r.gc(),r.gc()),2&e&&(r.wc("ngClass",r.Bc(5,c,t.leftMargin)),r.Pb(2),r.wc("textContent",t.text.enterpriseFeature),r.Pb(1),r.wc("textContent",t.textMessage),r.Pb(1),r.wc("href",t.eeLink(),r.Oc)("textContent",t.linkMessage))},directives:[a.n],styles:[".notification-box.-left-margin[_ngcontent-%COMP%]{margin-left:1.25rem}.notification-box[_ngcontent-%COMP%]   .notification-box--content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:10px}"]})},xLNn:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("AEvm");class s extends n.a{constructor(e){super(),this.I18n=e,this.isActive=!1,this.text={activate:this.I18n.t("js.label_activate"),deactivate:this.I18n.t("js.label_deactivate"),label:this.labelKey?this.I18n.t(this.labelKey):"",buttonText:this.textKey?this.I18n.t(this.textKey):""}}get label(){return this.text.label}get buttonText(){return this.text.buttonText}get labelKey(){return""}get textKey(){return""}get activationPrefix(){return this.isActive?"":this.text.activate+" "}get deactivationPrefix(){return this.isActive?this.text.deactivate+" ":""}get prefix(){return this.activationPrefix||this.deactivationPrefix}isToggle(){return!1}}},xQCb:function(e,t,i){"use strict";i.d(t,"a",(function(){return y}));var n=i("IaZ+"),s=i("kTsZ"),r=i("wZYP"),a=i("IzEk"),c=i("SKFm"),o=i("xkGU"),l=i("fXoL"),d=i("Zb8V"),u=i("ofXK"),h=i("N5AO");function p(e,t){if(1&e){const e=l.ic();l.hc(0,"button",12),l.pc("click",(function(){l.Lc(e);return l.rc().saveEntry()})),l.cc(1,"op-icon",13),l.cc(2,"span",14),l.gc()}if(2&e){const e=l.rc();l.wc("disabled",e.formInFlight),l.Qb("title",e.saveText),l.Pb(2),l.wc("textContent",e.saveText)}}function g(e,t){if(1&e){const e=l.ic();l.hc(0,"button",15),l.pc("click",(function(t){l.Lc(e);return l.rc().closeMe(t)})),l.cc(1,"op-icon",16),l.cc(2,"span",14),l.gc()}if(2&e){const e=l.rc();l.Qb("title",e.text.cancel),l.Pb(2),l.wc("textContent",e.text.cancel)}}function f(e,t){if(1&e){const e=l.ic();l.hc(0,"button",15),l.pc("click",(function(){l.Lc(e);return l.rc().destroy()})),l.cc(1,"op-icon",17),l.cc(2,"span",14),l.gc()}if(2&e){const e=l.rc();l.Qb("title",e.text.delete),l.Pb(2),l.wc("textContent",e.text.delete)}}class b extends o.a{get deleteAllowed(){return!1}setModifiedEntry(e){this.createdEntry=e.savedResource,this.reloadWorkPackageAndClose()}get saveText(){return this.i18n.t("js.label_create")}}b.\u0275fac=function(e){return m(e||b)},b.\u0275cmp=l.Vb({type:b,selectors:[["ng-component"]],features:[l.Ob([c.a]),l.Mb],decls:13,vars:7,consts:[[1,"op-modal--portal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","confirm-dialog--modal","loading-indicator--location"],[1,"op-modal--modal-header"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[1,"icon-context","icon-log_time",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[3,"changeset","showWorkPackageField","modifiedEntry"],["editForm",""],[1,"op-modal--modal-footer"],["class","button -highlight",3,"disabled","click",4,"ngIf"],["class","button",3,"click",4,"ngIf"],[1,"button","-highlight",3,"disabled","click"],["icon-classes","button--icon icon-checkmark"],["aria-hidden","true",1,"button--text",3,"textContent"],[1,"button",3,"click"],["icon-classes","button--icon icon-close"],["icon-classes","button--icon icon-delete"]],template:function(e,t){1&e&&(l.hc(0,"div",0),l.hc(1,"div",1),l.hc(2,"div",2),l.hc(3,"a",3),l.hc(4,"i",4),l.pc("click",(function(e){return t.closeMe(e)})),l.gc(),l.gc(),l.cc(5,"h3",5),l.gc(),l.hc(6,"div",6),l.hc(7,"te-form",7,8),l.pc("modifiedEntry",(function(e){return t.setModifiedEntry(e)})),l.gc(),l.gc(),l.hc(9,"div",9),l.Tc(10,p,3,3,"button",10),l.Tc(11,g,3,2,"button",11),l.Tc(12,f,3,2,"button",11),l.gc(),l.gc(),l.gc()),2&e&&(l.Pb(4),l.Qb("title",t.text.close),l.Pb(1),l.wc("textContent",t.text.title),l.Pb(2),l.wc("changeset",t.changeset)("showWorkPackageField",t.showWorkPackageField),l.Pb(3),l.wc("ngIf",t.saveAllowed),l.Pb(1),l.wc("ngIf",t.saveAllowed),l.Pb(1),l.wc("ngIf",t.deleteAllowed))},directives:[d.a,u.q,h.a],styles:[".op-modal--modal-container[_ngcontent-%COMP%]{max-width:90vw;width:800px}.icon-log_time[_ngcontent-%COMP%]:before{padding-right:6px}"],changeDetection:0});const m=l.jc(b);var w=i("dMmB"),v=i("CNq7");class y{constructor(e,t,i,n,s,r,a){this.opModalService=e,this.injector=t,this.halResource=i,this.apiV3Service=n,this.schemaCache=s,this.halEditing=r,this.i18n=a}create(e,t,i=!0){return new Promise((n,s)=>{this.createNewTimeEntry(e,t).then(e=>{const t=this.opModalService.show(b,this.injector,{changeset:e,showWorkPackageField:i});t.closingEvent.pipe(Object(a.a)(1)).subscribe(()=>{t.createdEntry?n({entry:t.createdEntry,action:"create"}):s()})})})}createNewTimeEntry(e,t){let i={spentOn:e.format("YYYY-MM-DD")};return t&&(i._links={workPackage:{href:t.href}}),this.apiV3Service.time_entries.form.post(i).toPromise().then(e=>this.fromCreateForm(e))}fromCreateForm(e){let t=this.initializeNewResource(e);return this.halEditing.edit(t,e)}initializeNewResource(e){let t=this.halResource.createHalResourceOfType("TimeEntry",e.payload.$plain());return t.$links.schema={href:"new"},t._type="TimeEntry",t.id="new",t.hours="PT1H",t.update=t.$links.update=e.$links.self,t.updateImmediately=t.$links.updateImmediately=e=>this.apiV3Service.time_entries.post(e).toPromise(),t.state.putValue(t),this.schemaCache.update(t,e.schema),t}}y.\u0275fac=function(e){return new(e||y)(l.lc(n.b),l.lc(l.A),l.lc(s.a),l.lc(v.a),l.lc(w.a),l.lc(c.a),l.lc(r.a))},y.\u0275prov=l.Xb({token:y,factory:y.\u0275fac})},xRac:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i("u4T9"),s=i("fXoL");class r{}r.\u0275mod=s.Zb({type:r}),r.\u0275inj=s.Yb({factory:function(e){return new(e||r)},imports:[[n.a]]})},"xV+i":function(e,t,i){"use strict";i.d(t,"c",(function(){return l})),i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return u}));var n=i("mrSG"),s=i("6XbZ"),r=i("iMRi"),a=i("CBsm"),c=i("wyKs"),o=i("r0MM");const l="-hierarchy-collapsed",d="wp-table--hierarchy-aditional-row";class u extends s.a{constructor(e,t){super(e,t),this.injector=e,this.workPackageTable=t,this.text={leaf:e=>this.I18n.t("js.work_packages.hierarchy.leaf",{level:e}),expanded:e=>this.I18n.t("js.work_packages.hierarchy.children_expanded",{level:e}),collapsed:e=>this.I18n.t("js.work_packages.hierarchy.children_collapsed",{level:e})}}refreshRow(e,t){const i=super.refreshRow(e,t);return i.find(".wp-table--hierarchy-span").remove(),this.appendHierarchyIndicator(e,i),i}buildEmpty(e){let[t,i]=super.buildEmpty(e),[n,s]=this.ancestorRowData(e);return t.classList.add(...n),this.appendHierarchyIndicator(e,jQuery(t)),[t,s]}ancestorRowData(e){const t=this.wpTableHierarchies.current,i=[];let n=!1;return this.parentsWithVisibleChildren[e.id]&&i.push(Object(a.d)(e.id)),_.isArray(e.ancestors)&&e.ancestors.forEach(e=>{i.push(Object(a.c)(e.id)),t.collapsed[e.id]&&(n=!0,i.push(Object(a.b)(e.id)))}),[i,n]}buildAncestorRow(e,t,i){const n=this.states.workPackages.get(e.id).value,[s,r]=this.buildEmpty(n);return s.classList.add(d),[s,r]}appendHierarchyIndicator(e,t,i){const n=void 0===i?e.ancestors.length:i,s=this.buildHierarchyIndicator(e,t,n);t.find("td.subject").addClass("-with-hierarchy").prepend(s),t.find("td.subject").css("minWidth",125+20*n+"px"),t.find("td.subject .wp-table--cell-container").css("width","calc(100% - 25px - "+20*n+"px)")}buildHierarchyIndicator(e,t,i){const n=document.createElement("span"),s=this.wpTableHierarchies.collapsed(e.id),r=25+20*i+"px";if(n.classList.add("wp-table--hierarchy-span"),n.style.width=r,n.dataset.indentation=r,this.parentsWithVisibleChildren[e.id]){const e=s?l:"";n.innerHTML=`\n            <a href tabindex="0" role="button" class="wp-table--hierarchy-indicator ${e}">\n              <span class="wp-table--hierarchy-indicator-icon" aria-hidden="true"></span>\n              <span class="wp-table--hierarchy-indicator-expanded hidden-for-sighted">${this.text.expanded(i)}</span>\n              <span class="wp-table--hierarchy-indicator-collapsed hidden-for-sighted">${this.text.collapsed(i)}</span>\n            </a>\n        `}else n.innerHTML=`\n            <span tabindex="0" class="wp-table--leaf-indicator">\n              <span class="hidden-for-sighted">${this.text.leaf(i)}</span>\n            </span>\n        `;return n}}Object(n.c)([Object(o.a)(),Object(n.e)("design:type",c.a)],u.prototype,"wpTableHierarchies",void 0),Object(n.c)([Object(o.a)(),Object(n.e)("design:type",r.a)],u.prototype,"states",void 0)},xiBa:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i("wZYP"),s=i("sjKJ"),r=i("07mJ"),a=i("fXoL"),c=i("N5AO");class o{constructor(e,t,i){this.I18n=e,this.currentProject=t,this.bcfPathHelper=i,this.text={import:this.I18n.t("js.bcf.import"),import_hover:this.I18n.t("js.bcf.import_bcf_xml_file")}}handleClick(){var e=this.currentProject.identifier;if(e){var t=this.bcfPathHelper.projectImportIssuePath(e);window.location.href=t}}}o.\u0275fac=function(e){return new(e||o)(a.bc(n.a),a.bc(s.a),a.bc(r.a))},o.\u0275cmp=a.Vb({type:o,selectors:[["bcf-import-button"]],decls:4,vars:2,consts:[[1,"button","import-bcf-button",3,"title","click"],["icon-classes","button--icon icon-import"],[1,"button--text"]],template:function(e,t){1&e&&(a.hc(0,"a",0),a.pc("click",(function(){return t.handleClick()})),a.cc(1,"op-icon",1),a.hc(2,"span",2),a.Vc(3),a.gc(),a.gc()),2&e&&(a.wc("title",t.text.import_hover),a.Pb(3),a.Xc(" ",t.text.import," "))},directives:[c.a],encapsulation:2})},xkGU:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i("mrSG"),s=i("SqdZ"),r=i("IaZ+"),a=i("wZYP"),c=(i("Zb8V"),i("r0MM")),o=i("CNq7"),l=i("fXoL");const d=["editForm"];class u extends s.a{constructor(e,t,i,n,s){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.i18n=n,this.injector=s,this.text={title:this.i18n.t("js.time_entry.title"),cancel:this.i18n.t("js.button_cancel"),close:this.i18n.t("js.button_close"),delete:this.i18n.t("js.button_delete"),areYouSure:this.i18n.t("js.text_are_you_sure")},this.closeOnEscape=!1,this.closeOnOutsideClick=!1}get changeset(){return this.locals.changeset}get entry(){return this.changeset.projectedResource}get showWorkPackageField(){return void 0===this.locals.showWorkPackageField||this.locals.showWorkPackageField}saveEntry(){this.formInFlight=!0,this.editForm.save().then(()=>this.reloadWorkPackageAndClose()).catch(()=>{this.formInFlight=!1,this.cdRef.detectChanges()})}get saveText(){return this.i18n.t("js.button_save")}get saveAllowed(){return!0}get deleteAllowed(){return!0}reloadWorkPackageAndClose(){this.entry.workPackage&&this.apiV3Service.work_packages.id(this.entry.workPackage).refresh(),this.service.close(),this.formInFlight=!1,this.cdRef.detectChanges()}}u.\u0275fac=function(e){return new(e||u)(l.bc(l.q),l.bc(r.a),l.bc(l.i),l.bc(a.a),l.bc(l.A))},u.\u0275dir=l.Wb({type:u,viewQuery:function(e,t){var i;(1&e&&l.Rc(d,!0),2&e)&&(l.Ic(i=l.qc())&&(t.editForm=i.first))},features:[l.Mb]}),Object(n.c)([Object(c.a)(),Object(n.e)("design:type",o.a)],u.prototype,"apiV3Service",void 0)},y2Tr:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i("Mo6U");class s extends n.a{static get active_user_statuses(){return["active","registered"]}get state(){return this.states.users.get(this.href)}get showUserPath(){return this.showUser?this.showUser.$link.href:null}get isActive(){return s.active_user_statuses.indexOf(this.status)>=0}}},yCBR:function(e,t,i){"use strict";i.d(t,"b",(function(){return w})),i.d(t,"a",(function(){return v}));var n=i("XV4z"),s=i("4EDS"),r=i("K018"),a=i("lJxs"),c=i("sjKJ"),o=i("AEvm"),l=i("CNq7"),d=i("fXoL"),u=i("ofXK"),h=i("0loS");const p=function(){return{reload:!0}},g=function(e,t){return{board_id:e,query_props:"",projects:"projects",projectPath:t}},f=function(e){return{selected:e}};function b(e,t){if(1&e&&(d.hc(0,"li"),d.cc(1,"a",3),d.gc()),2&e){const e=t.$implicit,i=d.rc(2);d.Pb(1),d.wc("textContent",e.name)("uiOptions",d.Ac(4,p))("uiParams",d.Cc(5,g,e.id,i.currentProjectIdentifier))("ngClass",d.Bc(8,f,i.selectedBoardId===e.id))}}function m(e,t){if(1&e&&(d.hc(0,"div"),d.hc(1,"ul",1),d.Tc(2,b,2,10,"li",2),d.gc(),d.gc()),2&e){const e=t.ngIf,i=d.rc();d.Pb(2),d.wc("ngForOf",e)("ngForTrackBy",i.trackById)}}const w="boards-menu";class v extends o.a{constructor(e,t,i,n){super(),this.boardService=e,this.apiV3Service=t,this.currentProject=i,this.mainMenuService=n,this.trackById=s.a.compareByAttribute("id"),this.currentProjectIdentifier=this.currentProject.identifier,this.boards$=this.apiV3Service.boards.observeAll().pipe(Object(a.a)(e=>e.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}))))}ngOnInit(){this.mainMenuService.onActivate("board_view").subscribe(()=>{this.focusBackArrow(),this.boardService.loadAllBoards()}),this.boardService.currentBoard$.pipe(this.untilDestroyed()).subscribe(e=>{this.selectedBoardId=e||""})}focusBackArrow(){jQuery('*[data-name="board_view"] .main-menu--arrow-left-to-project').focus()}}v.\u0275fac=function(e){return new(e||v)(d.bc(n.a),d.bc(l.a),d.bc(c.a),d.bc(r.a))},v.\u0275cmp=d.Vb({type:v,selectors:[["boards-menu"]],features:[d.Mb],decls:2,vars:3,consts:[[4,"ngIf"],[1,"main-menu--children","boards--menu-items"],[4,"ngFor","ngForOf","ngForTrackBy"],["uiSref","boards.partitioned.show",1,"main-menu--children-sub-item","ellipsis",3,"textContent","uiOptions","uiParams","ngClass"]],template:function(e,t){1&e&&(d.Tc(0,m,3,2,"div",0),d.sc(1,"async")),2&e&&d.wc("ngIf",d.tc(1,1,t.boards$))},directives:[u.q,u.p,h.AnchorUISref,h.UISref,u.n],pipes:[u.a],encapsulation:2})},yOxh:function(e,t,i){"use strict";i.d(t,"a",(function(){return I}));var n=i("mrSG"),s=i("fXoL"),r=i("SqdZ"),a=i("r0MM"),c=i("wZYP"),o=i("IaZ+"),l=i("juWA"),d=i("PBJw"),u=i("SKFm");class h{mappedDate(e){return""===e?null:e}parseDate(e){return e instanceof Date?new Date(e.setHours(0,0,0,0)):""===e?"":new Date(new Date(e).setHours(0,0,0,0))}validDate(e){return e instanceof Date||""===e||!!new Date(e).valueOf()}sortDates(e){return e.sort((function(e,t){return e.getTime()-t.getTime()}))}areDatesEqual(e,t){let i=this.parseDate(e),n=this.parseDate(t);return"string"!=typeof i&&"string"!=typeof n&&i.getTime()===n.getTime()}setCurrentActivatedField(e){this.currentlyActivatedDateField=e}toggleCurrentActivatedField(e,t){this.currentlyActivatedDateField="start"===this.currentlyActivatedDateField?"end":"start",this.setDatepickerRestrictions(e,t)}isStateOfCurrentActivatedField(e){return this.currentlyActivatedDateField===e}setDates(e,t,i){let n=t.datepickerInstance.currentMonth,s=t.datepickerInstance.currentYear;t.setDates(e),i?(t.datepickerInstance.currentMonth=i.getMonth(),t.datepickerInstance.currentYear=i.getFullYear()):(t.datepickerInstance.currentMonth=n,t.datepickerInstance.currentYear=s),t.datepickerInstance.redraw()}setDatepickerRestrictions(e,t){if(!e.start&&!e.end)return;let i=e=>!1;this.isStateOfCurrentActivatedField("start")&&e.end?i=t=>t.getTime()>new Date(e.end).setHours(0,0,0,0):this.isStateOfCurrentActivatedField("end")&&e.start&&(i=t=>t.getTime()<new Date(e.start).setHours(0,0,0,0)),t.datepickerInstance.set("disable",[i])}setRangeClasses(e){if(e.start&&e.end&&e.start!==e.end){var t=document.getElementsByClassName("dayContainer");for(let i=0;i<t.length;i++)this.highlightRangeInSingleMonth(t[i],e)}}highlightRangeInSingleMonth(e,t){var i=jQuery(e).find(".flatpickr-day.selected");if(2===i.length)i[0].classList.add("startRange"),i[1].classList.add("endRange"),this.selectRangeFromUntil(i[0],i[1]);else if(1===i.length){if(this.datepickerShowsDate(t.start,i[0]))i[0].classList.add("startRange"),this.selectRangeFromUntil(i[0],"");else if(this.datepickerShowsDate(t.end,i[0])){let t=jQuery(e).find(".flatpickr-day")[0];i[0].classList.add("endRange"),t.classList.add("inRange"),this.selectRangeFromUntil(t,i[0])}}else this.datepickerIsInDateRange(e,t)&&jQuery(e).find(".flatpickr-day").addClass("inRange")}datepickerShowsDate(e,t){return new Date(t.getAttribute("aria-label")).toDateString()===new Date(e).toDateString()}datepickerIsInDateRange(e,t){var i=jQuery(e).find(".flatpickr-day:not(.hidden)")[0],n=new Date(i.getAttribute("aria-label"));return n<=new Date(t.end)&&n>=new Date(t.start)}selectRangeFromUntil(e,t){jQuery(e).nextUntil(t).addClass("inRange")}}h.\u0275fac=function(e){return new(e||h)},h.\u0275prov=s.Xb({token:h,factory:h.\u0275fac,providedIn:"root"});var p=i("buwf"),g=i("8zkO"),f=i("3Pt+"),b=i("ofXK");const m=["modalContainer"],w=function(e){return{"-current":e}};function v(e,t){if(1&e){const e=s.ic();s.fc(0),s.hc(1,"div",15),s.cc(2,"label",16),s.hc(3,"div",8),s.hc(4,"div",17),s.hc(5,"input",18),s.pc("ngModelChange",(function(t){s.Lc(e);return s.rc().updateDate("date",t)}))("click",(function(){s.Lc(e);return s.rc().datepickerHelper.setCurrentActivatedField("date")})),s.gc(),s.gc(),s.hc(6,"a",19),s.pc("click",(function(){s.Lc(e);return s.rc().clear("date")})),s.cc(7,"span",20),s.gc(),s.gc(),s.hc(8,"div",21),s.hc(9,"a",22),s.pc("click",(function(){s.Lc(e);return s.rc().setToday("date")})),s.gc(),s.gc(),s.gc(),s.ec()}if(2&e){const e=s.rc();s.Pb(2),s.wc("textContent",e.text.date),s.Pb(3),s.wc("ngClass",s.Bc(5,w,e.datepickerHelper.isStateOfCurrentActivatedField("date")))("ngModel",e.dates.date),s.Pb(1),s.wc("title",e.text.clear),s.Pb(3),s.wc("textContent",e.text.today)}}function y(e,t){if(1&e){const e=s.ic();s.hc(0,"a",19),s.pc("click",(function(){s.Lc(e);return s.rc(2).clear("start")})),s.cc(1,"span",20),s.gc()}if(2&e){const e=s.rc(2);s.wc("title",e.text.clear)}}function k(e,t){if(1&e){const e=s.ic();s.hc(0,"a",22),s.pc("click",(function(){s.Lc(e);return s.rc(2).setToday("start")})),s.gc()}if(2&e){const e=s.rc(2);s.wc("textContent",e.text.today)}}function C(e,t){if(1&e){const e=s.ic();s.hc(0,"a",19),s.pc("click",(function(){s.Lc(e);return s.rc(2).clear("end")})),s.cc(1,"span",20),s.gc()}if(2&e){const e=s.rc(2);s.wc("title",e.text.clear)}}function j(e,t){if(1&e){const e=s.ic();s.hc(0,"a",22),s.pc("click",(function(){s.Lc(e);return s.rc(2).setToday("end")})),s.gc()}if(2&e){const e=s.rc(2);s.wc("textContent",e.text.today)}}function P(e,t){if(1&e){const e=s.ic();s.fc(0),s.hc(1,"div",15),s.cc(2,"label",16),s.hc(3,"div",8),s.hc(4,"div",17),s.hc(5,"input",23),s.pc("ngModelChange",(function(t){s.Lc(e);return s.rc().updateDate("start",t)}))("click",(function(){s.Lc(e);return s.rc().setCurrentActivatedField("start")})),s.gc(),s.gc(),s.Tc(6,y,2,1,"a",24),s.gc(),s.hc(7,"div",21),s.Tc(8,k,1,1,"a",25),s.gc(),s.gc(),s.hc(9,"div",15),s.cc(10,"label",16),s.hc(11,"div",8),s.hc(12,"div",17),s.hc(13,"input",26),s.pc("ngModelChange",(function(t){s.Lc(e);return s.rc().updateDate("end",t)}))("click",(function(){s.Lc(e);return s.rc().setCurrentActivatedField("end")})),s.gc(),s.gc(),s.Tc(14,C,2,1,"a",24),s.gc(),s.hc(15,"div",21),s.Tc(16,j,1,1,"a",25),s.gc(),s.gc(),s.ec()}if(2&e){const e=s.rc();s.Pb(2),s.wc("textContent",e.text.startDate),s.Pb(3),s.wc("ngClass",s.Bc(12,w,e.datepickerHelper.isStateOfCurrentActivatedField("start")))("ngModel",e.dates.start)("disabled",!e.isSchedulable),s.Pb(1),s.wc("ngIf",e.isSchedulable),s.Pb(2),s.wc("ngIf",e.showTodayLink("start")),s.Pb(2),s.wc("textContent",e.text.endDate),s.Pb(3),s.wc("ngClass",s.Bc(14,w,e.datepickerHelper.isStateOfCurrentActivatedField("end")))("ngModel",e.dates.end)("disabled",!e.isSchedulable),s.Pb(1),s.wc("ngIf",e.isSchedulable),s.Pb(2),s.wc("ngIf",e.showTodayLink("end"))}}function x(e,t){if(1&e&&(s.fc(0),s.cc(1,"p",29),s.ec()),2&e){const e=s.rc(2);s.Pb(1),s.wc("textContent",e.text.isParent)}}function S(e,t){if(1&e&&(s.fc(0),s.cc(1,"p",29),s.ec()),2&e){const e=s.rc(2);s.Pb(1),s.wc("textContent",e.text.isSwitchedFromManualToAutomatic)}}function _(e,t){if(1&e&&(s.fc(0),s.hc(1,"div",27),s.hc(2,"div",28),s.Tc(3,x,2,1,"ng-container",6),s.Tc(4,S,2,1,"ng-container",6),s.gc(),s.gc(),s.ec()),2&e){const e=s.rc();s.Pb(3),s.wc("ngIf",e.isParent),s.Pb(1),s.wc("ngIf",e.isSwitchedFromManualToAutomatic&&!e.isParent)}}function O(e,t){1&e&&(s.fc(0),s.cc(1,"input",30),s.ec())}class I extends r.a{constructor(e,t,i,n,r){super(t,i,n),this.injector=e,this.locals=t,this.cdRef=i,this.elementRef=n,this.configurationService=r,this.text={save:this.I18n.t("js.button_save"),cancel:this.I18n.t("js.button_cancel"),clear:this.I18n.t("js.work_packages.button_clear"),manualScheduling:this.I18n.t("js.scheduling.manual"),date:this.I18n.t("js.work_packages.properties.date"),startDate:this.I18n.t("js.work_packages.properties.startDate"),endDate:this.I18n.t("js.work_packages.properties.dueDate"),placeholder:this.I18n.t("js.placeholders.default"),today:this.I18n.t("js.label_today"),isParent:this.I18n.t("js.work_packages.scheduling.is_parent"),isSwitchedFromManualToAutomatic:this.I18n.t("js.work_packages.scheduling.is_switched_from_manual_to_automatic")},this.onDataUpdated=new s.s,this.singleDate=!1,this.scheduleManually=!1,this.htmlId="",this.dates={date:"",start:"",end:""},this.changeset=t.changeset,this.htmlId="wp-datepicker-"+t.fieldName,this.singleDate=this.changeset.isWritable("date"),this.scheduleManually=this.changeset.value("scheduleManually"),this.singleDate?(this.dates.date=this.changeset.value("date"),this.datepickerHelper.setCurrentActivatedField("date")):(this.dates.start=this.changeset.value("startDate"),this.dates.end=this.changeset.value("dueDate"),this.datepickerHelper.setCurrentActivatedField(this.initialActivatedField()))}ngAfterViewInit(){this.isSchedulable&&this.showDateSelection(),this.onDataChange()}changeSchedulingMode(){this.scheduleManually=!this.scheduleManually,this.cdRef.detectChanges(),this.scheduleManually?this.showDateSelection():this.isParent&&this.removeDateSelection()}save(){this.isSavable&&(this.changeset.setValue("scheduleManually",this.scheduleManually),this.isSchedulable&&(this.singleDate?this.changeset.setValue("date",this.datepickerHelper.mappedDate(this.dates.date)):(this.changeset.setValue("startDate",this.datepickerHelper.mappedDate(this.dates.start)),this.changeset.setValue("dueDate",this.datepickerHelper.mappedDate(this.dates.end)))),this.closeMe())}cancel(){this.closeMe()}clear(e){this.dates[e]="",this.enforceManualChangesToDatepicker()}updateDate(e,t){(t.length>=8||0===t.length)&&(this.dates[e]=t,this.datepickerHelper.validDate(t)&&this.datePickerInstance&&this.enforceManualChangesToDatepicker(!1))}setToday(e){let t=this.datepickerHelper.parseDate(new Date);this.dates[e]=this.timezoneService.formattedISODate(t),t instanceof Date?this.enforceManualChangesToDatepicker(!0,t):this.enforceManualChangesToDatepicker()}reposition(e,t){e.position({my:"left top",at:"left bottom",of:t,collision:"flipfit"})}setCurrentActivatedField(e){this.datepickerHelper.setCurrentActivatedField(e),this.datepickerHelper.setDatepickerRestrictions(this.dates,this.datePickerInstance),this.datepickerHelper.setRangeClasses(this.dates)}showTodayLink(e){return!!this.isSchedulable&&("start"===e?this.datepickerHelper.parseDate(new Date)<=this.datepickerHelper.parseDate(this.dates.end):this.datepickerHelper.parseDate(new Date)>=this.datepickerHelper.parseDate(this.dates.start))}get isSchedulable(){return this.scheduleManually||!this.isParent&&!this.isSwitchedFromManualToAutomatic}get isSavable(){return this.isSchedulable||this.isSwitchedFromManualToAutomatic}get isParent(){return this.changeset.projectedResource.$links.children&&this.changeset.projectedResource.$links.children.length>0}get isSwitchedFromManualToAutomatic(){return!this.scheduleManually&&this.changeset.value("scheduleManually")}showDateSelection(){this.initializeDatepicker(),this.datepickerHelper.setDatepickerRestrictions(this.dates,this.datePickerInstance),this.datepickerHelper.setRangeClasses(this.dates)}removeDateSelection(){this.datePickerInstance.destroy()}initializeDatepicker(){var e;null===(e=this.datePickerInstance)||void 0===e||e.destroy(),this.datePickerInstance=new d.a("#flatpickr-input",this.singleDate?this.dates.date:[this.dates.start,this.dates.end],{mode:this.singleDate?"single":"multiple",showMonths:this.browserDetector.isMobile?1:2,inline:!0,onChange:e=>{this.handleDatePickerChange(e),this.onDataChange()},onMonthChange:()=>{this.datepickerHelper.setRangeClasses(this.dates)},onYearChange:()=>{this.datepickerHelper.setRangeClasses(this.dates)}},void 0,this.configurationService)}enforceManualChangesToDatepicker(e=!0,t){if(this.singleDate){let e=this.datepickerHelper.parseDate(this.dates.date);this.datepickerHelper.setDates(e,this.datePickerInstance,t)}else{let i=[this.datepickerHelper.parseDate(this.dates.start),this.datepickerHelper.parseDate(this.dates.end)];this.datepickerHelper.setDates(i,this.datePickerInstance,t),this.setRangeClassesAndToggleActiveField(e)}}handleDatePickerChange(e){switch(e.length){case 0:(this.dates.start||this.dates.end)&&this.setDateAndToggleActiveField(this.dates.start||this.dates.end);break;case 1:if(this.singleDate)this.dates.date=this.timezoneService.formattedISODate(e[0]);else if(this.dates.start&&this.dates.end){if(this.dates.start===this.dates.end)return;if(this.datepickerHelper.isStateOfCurrentActivatedField("start")&&this.datepickerHelper.areDatesEqual(this.dates.start,e[0])||this.datepickerHelper.isStateOfCurrentActivatedField("end")&&this.datepickerHelper.areDatesEqual(this.dates.end,e[0])){let e=this.datepickerHelper.isStateOfCurrentActivatedField("start")?"end":"start";this.setDateAndToggleActiveField(this.dates[e])}else this.enforceManualChangesToDatepicker(!0)}else this.setDateAndToggleActiveField(this.timezoneService.formattedISODate(e[0]),!1);break;case 2:if(!this.dates.end&&this.datepickerHelper.isStateOfCurrentActivatedField("start")||!this.dates.start&&this.datepickerHelper.isStateOfCurrentActivatedField("end"))this.overwriteDatePickerWithNewDates([e[1]]);else{e[0]>e[1]&&(e=this.datepickerHelper.sortDates(e),this.datepickerHelper.setDates(e,this.datePickerInstance));let t=this.datepickerHelper.isStateOfCurrentActivatedField("start")?0:1;this.dates[this.datepickerHelper.currentlyActivatedDateField]=this.timezoneService.formattedISODate(e[t]),this.setRangeClassesAndToggleActiveField()}break;default:this.datepickerHelper.isStateOfCurrentActivatedField("start")?this.overwriteDatePickerWithNewDates([e[2],e[1]]):this.overwriteDatePickerWithNewDates([e[0],e[2]])}this.cdRef.detectChanges()}overwriteDatePickerWithNewDates(e){this.datepickerHelper.setDates(e,this.datePickerInstance),this.handleDatePickerChange(e)}setDateAndToggleActiveField(e,t=!0){this.dates[this.datepickerHelper.currentlyActivatedDateField]=e,t&&this.datepickerHelper.setDates([this.datepickerHelper.parseDate(e)],this.datePickerInstance),this.datepickerHelper.toggleCurrentActivatedField(this.dates,this.datePickerInstance)}setRangeClassesAndToggleActiveField(e=!0){e&&this.datepickerHelper.toggleCurrentActivatedField(this.dates,this.datePickerInstance),this.datepickerHelper.setRangeClasses(this.dates)}onDataChange(){let e=this.dates.date||"",t=this.dates.start||"",i=this.dates.end||"",n=this.singleDate?e:t+" - "+i;this.onDataUpdated.emit(n)}initialActivatedField(){return"dueDate"===this.locals.fieldName||this.dates.start&&!this.dates.end?"end":"start"}}I.\u0275fac=function(e){return new(e||I)(s.bc(s.A),s.bc(o.a),s.bc(s.i),s.bc(s.q),s.bc(g.a))},I.\u0275cmp=s.Vb({type:I,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&s.ad(m,!0),2&e)&&(s.Ic(i=s.qc())&&(t.modalContainer=i.first))},features:[s.Mb],decls:19,vars:10,consts:[[1,"op-modal--portal","-transparent"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","datepicker-modal","loading-indicator--location"],["modalContainer",""],[1,"op-modal--modal-body"],[1,"form","-vertical"],[1,"datepicker-modal--dates-container"],[4,"ngIf"],[1,"form--field","datepicker-modal--scheduling-action-container"],[1,"form--field-container"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","name","scheduling",1,"form--check-box","datepicker-modal--scheduling-action",3,"ngModel","ngModelChange"],[1,"datepicker-modal--actions-container"],[1,"datepicker-modal--action","button",3,"textContent","click"],[1,"datepicker-modal--action","button","-highlight",3,"textContent","click"],[1,"form--field"],[1,"form--label",3,"textContent"],[1,"form--text-field-container","-xslim"],["type","text","name","date",1,"form--date-field",3,"ngClass","ngModel","ngModelChange","click"],[1,"form--field-inline-action",3,"title","click"],[1,"icon2","icon-small","icon-cancel"],[1,"form--field-extra-actions"],[3,"textContent","click"],["type","text","name","startDate",1,"form--date-field",3,"ngClass","ngModel","disabled","ngModelChange","click"],["class","form--field-inline-action",3,"title","click",4,"ngIf"],[3,"textContent","click",4,"ngIf"],["type","text","name","endDate",1,"form--date-field",3,"ngClass","ngModel","disabled","ngModelChange","click"],[1,"notification-box","-info"],[1,"notification-box--content"],[3,"textContent"],["id","flatpickr-input","hidden",""]],template:function(e,t){1&e&&(s.hc(0,"div",0),s.hc(1,"div",1,2),s.hc(3,"div",3),s.hc(4,"form",4),s.hc(5,"div",5),s.Tc(6,v,10,7,"ng-container",6),s.Tc(7,P,17,16,"ng-container",6),s.hc(8,"div",7),s.hc(9,"div",8),s.hc(10,"label",9),s.hc(11,"div",10),s.hc(12,"input",11),s.pc("ngModelChange",(function(){return t.changeSchedulingMode()})),s.gc(),s.gc(),s.Vc(13),s.gc(),s.gc(),s.gc(),s.gc(),s.gc(),s.Tc(14,_,5,2,"ng-container",6),s.Tc(15,O,2,0,"ng-container",6),s.hc(16,"div",12),s.hc(17,"button",13),s.pc("click",(function(){return t.cancel()})),s.gc(),s.hc(18,"button",14),s.pc("click",(function(){return t.save()})),s.gc(),s.gc(),s.gc(),s.gc(),s.gc()),2&e&&(s.Pb(1),s.Qb("id",t.htmlId),s.Pb(5),s.wc("ngIf",t.singleDate),s.Pb(1),s.wc("ngIf",!t.singleDate),s.Pb(5),s.wc("ngModel",t.scheduleManually),s.Pb(1),s.Xc(" ",t.text.manualScheduling," "),s.Pb(1),s.wc("ngIf",!t.isSchedulable),s.Pb(1),s.wc("ngIf",t.isSchedulable),s.Pb(2),s.wc("textContent",t.text.cancel),s.Pb(1),s.wc("textContent",t.text.save),s.Qb("disabled",!t.isSavable||void 0))},directives:[f.C,f.n,f.o,b.q,f.a,f.m,f.p,f.c,b.n],styles:[".datepicker-modal{position:relative;z-index:500;width:auto;max-width:700px;box-shadow:0 0 5px 2px rgba(0,0,0,.25);padding:5px 0 0}.datepicker-modal .op-modal--modal-body{overflow:hidden;margin-bottom:0}.datepicker-modal .grid-block{align-items:center}.datepicker-modal--dates-container{display:grid;grid-template-columns:170px 1fr auto;margin:0 1.5rem}.datepicker-modal--dates-container .form--date-field{margin:2px!important}.datepicker-modal--dates-container .form--date-field.-current,.datepicker-modal--dates-container .form--date-field.-current:hover{outline:2px solid var(--primary-color)}.datepicker-modal--dates-container .datepicker-modal--scheduling-action-container{margin-top:28px}.datepicker-modal--dates-container .datepicker-modal--scheduling-action-container .form--label-with-check-box{padding:0}.datepicker-modal--dates-container .form--field-inline-action .icon-small:before{vertical-align:text-bottom}.datepicker-modal--dates-container .form--field-inline-action:focus,.datepicker-modal--dates-container .form--field-inline-action:hover{text-decoration:none}.datepicker-modal--actions-container{display:flex;justify-content:flex-end;padding:15px 1.5rem 0;border-top:1px solid #ddd;background:#f8f8f8}.datepicker-modal--actions-container .datepicker-modal--action[disabled]{color:var(--gray-dark);cursor:not-allowed}.datepicker-modal--actions-container .datepicker-modal--action[disabled]:hover{text-decoration:none}","@media screen and (max-width:679px){.datepicker-modal--dates-container{grid-template-columns:1fr 1fr;grid-template-rows:75px 40px}.datepicker-modal--dates-container .datepicker-modal--scheduling-action-container{margin:10px 0}}"],encapsulation:2,changeDetection:0}),Object(n.c)([Object(a.a)(),Object(n.e)("design:type",c.a)],I.prototype,"I18n",void 0),Object(n.c)([Object(a.a)(),Object(n.e)("design:type",l.a)],I.prototype,"timezoneService",void 0),Object(n.c)([Object(a.a)(),Object(n.e)("design:type",u.a)],I.prototype,"halEditing",void 0),Object(n.c)([Object(a.a)(),Object(n.e)("design:type",h)],I.prototype,"datepickerHelper",void 0),Object(n.c)([Object(a.a)(),Object(n.e)("design:type",p.a)],I.prototype,"browserDetector",void 0)},yUKD:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("2Qcm"),s=i("wZYP"),r=i("iMRi"),a=i("fbLK"),c=i("E2tj"),o=i("fXoL"),l=i("ofXK"),d=i("3Pt+"),u=i("ZOsW"),h=i("xFOf");const p=["highlightedAttributesNgSelect"],g=["rowHighlightNgSelect"];function f(e,t){if(1&e&&o.cc(0,"enterprise-banner",13),2&e){const e=o.rc();o.wc("linkMessage",e.text.upsaleCheckOutLink)("textMessage",e.text.upsaleAttributeHighlighting)}}class b{constructor(e,t,i,n,s,r){this.injector=e,this.I18n=t,this.states=i,this.querySpace=n,this.Banners=s,this.wpTableHighlight=r,this.highlightingMode="inline",this.entireRowMode=!1,this.lastEntireRowAttribute="status",this.eeShowBanners=!1,this.availableInlineHighlightedAttributes=[],this.selectedAttributes=[],this.availableRowHighlightedAttributes=[],this.text={title:this.I18n.t("js.work_packages.table_configuration.highlighting"),highlighting_mode:{description:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.description"),none:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.none"),inline:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.inline"),inline_all_attributes:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.inline_all"),status:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.status"),type:this.I18n.t("js.work_packages.properties.type"),priority:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.priority"),entire_row_by:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.entire_row_by")},upsaleAttributeHighlighting:this.I18n.t("js.work_packages.table_configuration.upsale.attribute_highlighting"),upsaleCheckOutLink:this.I18n.t("js.work_packages.table_configuration.upsale.check_out_link")}}ngOnInit(){this.availableInlineHighlightedAttributes=this.availableHighlightedAttributes,this.availableRowHighlightedAttributes=[{name:this.text.highlighting_mode.status,value:"status"},{name:this.text.highlighting_mode.priority,value:"priority"}],this.setSelectedValues(),this.eeShowBanners=this.Banners.eeShowBanners,this.updateMode(this.wpTableHighlight.current.mode),this.eeShowBanners&&this.updateMode("none")}onSave(){let e=this.highlightingMode;this.wpTableHighlight.update({mode:e,selectedAttributes:this.selectedAttributes})}updateMode(e){this.highlightingMode="entire-row"===e?this.lastEntireRowAttribute:e,-1!==["status","priority"].indexOf(this.highlightingMode)?(this.lastEntireRowAttribute=this.highlightingMode,this.entireRowMode=!0):this.entireRowMode=!1}updateHighlightingAttributes(e){this.selectedAttributes=e}disabledValue(e){return e?"disabled":null}get availableHighlightedAttributes(){return this.querySpace.queryForm.value.schema.highlightedAttributes.allowedValues}onOpen(e){setTimeout(()=>{e.dropdownPanel&&e.dropdownPanel._updatePosition()},25)}setSelectedValues(){const e=this.wpTableHighlight.current.selectedAttributes;this.selectedAttributes=void 0===e?this.availableInlineHighlightedAttributes:e}}b.\u0275fac=function(e){return new(e||b)(o.bc(o.A),o.bc(s.a),o.bc(r.a),o.bc(c.a),o.bc(a.a),o.bc(n.a))},b.\u0275cmp=o.Vb({type:b,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&(o.ad(p,!0),o.ad(g,!0)),2&e)&&(o.Ic(i=o.qc())&&(t.highlightedAttributesNgSelect=i.first),o.Ic(i=o.qc())&&(t.rowHighlightNgSelect=i.first))},decls:25,vars:22,consts:[["class","ee-attribute-highlighting-upsale","opReferrer","wp-attribute-highlighting#attribute-highlighting",3,"linkMessage","textMessage",4,"ngIf"],[3,"textContent"],[1,"form--field"],[1,"form--label"],["type","radio","value","inline","name","highlighting_mode_switch",3,"ngModel","ngModelChange","change"],[1,"form--field-container"],[1,"form--select-container"],["bindLabel","name","name","highlighting_attributes","appendTo","body",1,"form--select-field","-multi-select",3,"items","ngModel","multiple","disabled","clearable","closeOnSelect","ngModelChange","open","change"],["highlightedAttributesNgSelect",""],["type","radio","name","entire_row_switch",3,"ngModel","value","ngModelChange","change"],["bindLabel","name","bindValue","value","name","selected_attribute","appendTo","body","id","selected_attribute",1,"form--select-field",3,"items","ngModel","disabled","clearable","ngModelChange","open","change"],["rowHighlightNgSelect",""],["type","radio","value","none","name","highlighting_mode_switch",3,"ngModel","ngModelChange","change"],["opReferrer","wp-attribute-highlighting#attribute-highlighting",1,"ee-attribute-highlighting-upsale",3,"linkMessage","textMessage"]],template:function(e,t){if(1&e){const e=o.ic();o.hc(0,"div"),o.Tc(1,f,1,2,"enterprise-banner",0),o.hc(2,"form"),o.cc(3,"p",1),o.hc(4,"div",2),o.hc(5,"label",3),o.hc(6,"input",4),o.pc("ngModelChange",(function(e){return t.highlightingMode=e}))("change",(function(e){return t.updateMode(e.target.value)})),o.gc(),o.cc(7,"span",1),o.Vc(8,"\xa0 "),o.gc(),o.hc(9,"div",5),o.hc(10,"div",6),o.hc(11,"ng-select",7,8),o.pc("ngModelChange",(function(e){return t.selectedAttributes=e}))("open",(function(){o.Lc(e);const i=o.Jc(12);return t.onOpen(i)}))("change",(function(e){return t.updateHighlightingAttributes(e)})),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(13,"div",2),o.hc(14,"label",3),o.hc(15,"input",9),o.pc("ngModelChange",(function(e){return t.entireRowMode=e}))("change",(function(){return t.updateMode("entire-row")})),o.gc(),o.cc(16,"span",1),o.gc(),o.hc(17,"div",5),o.hc(18,"div",6),o.hc(19,"ng-select",10,11),o.pc("ngModelChange",(function(e){return t.lastEntireRowAttribute=e}))("open",(function(){o.Lc(e);const i=o.Jc(20);return t.onOpen(i)}))("change",(function(e){return t.updateMode(e.value)})),o.gc(),o.gc(),o.gc(),o.gc(),o.hc(21,"div",2),o.hc(22,"label",3),o.hc(23,"input",12),o.pc("ngModelChange",(function(e){return t.highlightingMode=e}))("change",(function(e){return t.updateMode(e.target.value)})),o.gc(),o.cc(24,"span",1),o.gc(),o.gc(),o.gc(),o.gc()}2&e&&(o.Pb(1),o.wc("ngIf",t.eeShowBanners),o.Pb(2),o.wc("textContent",t.text.highlighting_mode.description),o.Pb(3),o.wc("ngModel",t.highlightingMode),o.Qb("disabled",t.disabledValue(t.eeShowBanners)),o.Pb(1),o.wc("textContent",t.text.highlighting_mode.inline),o.Pb(4),o.wc("items",t.availableInlineHighlightedAttributes)("ngModel",t.selectedAttributes)("multiple",!0)("disabled","inline"!==t.highlightingMode)("clearable",!1)("closeOnSelect",!1),o.Pb(4),o.wc("ngModel",t.entireRowMode)("value",!0),o.Qb("disabled",t.disabledValue(t.eeShowBanners)),o.Pb(1),o.wc("textContent",t.text.highlighting_mode.entire_row_by),o.Pb(3),o.wc("items",t.availableRowHighlightedAttributes)("ngModel",t.lastEntireRowAttribute)("disabled",t.disabledValue(t.eeShowBanners))("clearable",!1),o.Pb(4),o.wc("ngModel",t.highlightingMode),o.Qb("disabled",t.disabledValue(t.eeShowBanners)),o.Pb(1),o.wc("textContent",t.text.highlighting_mode.none))},directives:[l.q,d.C,d.n,d.o,d.u,d.c,d.m,d.p,u.a,h.a],encapsulation:2})},ylTo:function(e,t,i){"use strict";i.d(t,"a",(function(){return b}));var n=i("iB+3"),s=i("Y0Nk"),r=i("wZYP"),a=i("VFHb"),c=i("Jui0"),o=i("4EDS"),l=i("qc15"),d=i("AEvm"),u=i("CNq7"),h=i("fXoL");function p(e,t){if(1&e&&(h.hc(0,"div",8),h.hc(1,"div",9),h.cc(2,"p",10),h.gc(),h.gc()),2&e){const e=h.rc();h.Pb(2),h.wc("textContent",e.text.loadingError)}}function g(e,t){if(1&e&&h.cc(0,"wp-watcher-entry",11),2&e){const e=t.$implicit;h.wc("watcher",e)}}const f=function(e){return{"-read-only":e}};class b extends d.a{constructor(e,t,i,n,s,r,a,c,l){super(),this.I18n=e,this.elementRef=t,this.wpWatchersService=i,this.$transition=n,this.notificationService=s,this.loadingIndicator=r,this.cdRef=a,this.pathHelper=c,this.apiV3Service=l,this.trackByHref=o.a.trackByHref,this.error=!1,this.noResults=!1,this.allowedToView=!1,this.allowedToAdd=!1,this.allowedToRemove=!1,this.watching=[],this.text={loading:this.I18n.t("js.watchers.label_loading"),loadingError:this.I18n.t("js.watchers.label_error_loading"),autocomplete:{placeholder:this.I18n.t("js.watchers.typeahead_placeholder")}}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.workPackageId=this.$transition.params("to").workPackageId,this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe(e=>{this.workPackage=e,this.loadCurrentWatchers()}),this.availableWatchersPath=this.apiV3Service.work_packages.id(this.workPackageId).available_watchers.path}loadCurrentWatchers(){this.error=!1,this.allowedToView=!!this.workPackage.watchers,this.allowedToAdd=!!this.workPackage.addWatcher,this.allowedToRemove=!!this.workPackage.removeWatcher,this.allowedToView?this.wpWatchersService.require(this.workPackage).then(e=>{this.watching=e,this.cdRef.detectChanges()}).catch(e=>{this.notificationService.showError(e,this.workPackage)}):this.error=!0}set loadingPromise(e){this.loadingIndicator.wpDetails.promise=e}addWatcher(e){this.loadingPromise=this.workPackage.addWatcher.$link.$fetch({user:{href:e.href}}).then(()=>{this.wpWatchersService.require(this.workPackage,!0),this.apiV3Service.work_packages.id(this.workPackage).refresh(),this.cdRef.detectChanges()}).catch(e=>this.notificationService.showError(e,this.workPackage))}removeWatcher(e){this.workPackage.removeWatcher.$link.$prepare({user_id:e.id})().then(()=>{_.remove(this.watching,t=>t.href===e.href),this.wpWatchersService.require(this.workPackage,!0),this.apiV3Service.work_packages.id(this.workPackage).refresh(),this.cdRef.detectChanges()}).catch(e=>this.notificationService.showError(e,this.workPackage))}}b.\u0275fac=function(e){return new(e||b)(h.bc(r.a),h.bc(h.q),h.bc(a.a),h.bc(n.Transition),h.bc(l.a),h.bc(s.a),h.bc(h.i),h.bc(c.a),h.bc(u.a))},b.\u0275cmp=h.Vb({type:b,selectors:[["wp-watchers-tab"]],features:[h.Mb],decls:8,vars:10,consts:[["id","detail-panel-watchers"],["class","notification-box -error",4,"ngIf"],[3,"hidden"],[1,"work-package--watchers","form--selected-value--list",3,"ngClass"],[3,"watcher",4,"ngFor","ngForOf","ngForTrackBy"],[1,"work-package--watchers-lookup","hide-when-print",3,"hidden"],["name","watcherForm","novalidate",""],[1,"wp-watcher--autocomplete",3,"clearAfterSelection","url","onChange"],[1,"notification-box","-error"],[1,"notification-box--content"],[3,"textContent"],[3,"watcher"]],template:function(e,t){1&e&&(h.hc(0,"div",0),h.Tc(1,p,3,1,"div",1),h.hc(2,"div",2),h.hc(3,"div",3),h.Tc(4,g,1,1,"wp-watcher-entry",4),h.gc(),h.hc(5,"div",5),h.hc(6,"form",6),h.hc(7,"user-autocompleter",7),h.pc("onChange",(function(e){return t.addWatcher(e)})),h.gc(),h.gc(),h.gc(),h.gc(),h.gc()),2&e&&(h.Pb(1),h.wc("ngIf",t.error),h.Pb(1),h.wc("hidden",t.error),h.Pb(1),h.wc("ngClass",h.Bc(8,f,!t.allowedToRemove)),h.Pb(1),h.wc("ngForOf",t.watching)("ngForTrackBy",t.trackByHref),h.Pb(1),h.wc("hidden",!t.allowedToAdd),h.Pb(2),h.wc("clearAfterSelection",!0)("url",t.availableWatchersPath))},encapsulation:2,changeDetection:0})},zOhy:function(e,t,i){"use strict";i.d(t,"a",(function(){return v}));var n=i("iB+3"),s=i("Jui0"),r=i("iMRi"),a=i("4n9w"),c=i("GJmQ"),o=i("dfy/"),l=i("wZYP"),d=i("F5Dh"),u=i("Y/CA"),h=i("711n"),p=i("qc15"),g=i("yQm5"),f=i("AEvm"),b=i("2G+H"),m=i("CNq7"),w=(i("Mo6U"),i("fXoL"));class v extends f.a{constructor(e,t,i,n,s,r,a,c,o,l,d,u,h){super(),this.injector=e,this.$transition=t,this.$state=i,this.I18n=n,this.titleService=s,this.notificationService=r,this.states=a,this.wpCreate=c,this.wpViewFocus=o,this.wpTableFilters=l,this.pathHelper=d,this.apiV3Service=u,this.cdRef=h,this.successState=Object(b.a)(this.$state),this.cancelState=this.$state.current.data.baseRoute,this.copying=!1,this.stateParams=this.$transition.params("to"),this.text={button_settings:this.I18n.t("js.button_settings")},this.destroyed=!1}ngOnInit(){this.closeEditFormWhenNewWorkPackageSaved(),this.showForm()}ngOnDestroy(){super.ngOnDestroy()}switchToFullscreen(){this.$state.go("work-packages.new",this.$state.params)}onSaved(e){var t;let{savedResource:i,isInitial:n}=e;null===(t=this.editForm)||void 0===t||t.cancel(!1),this.successState&&this.$state.go(this.successState,{workPackageId:i.id}).then(()=>{this.wpViewFocus.updateFocus(i.id),this.notificationService.showSave(i,n)})}showForm(){this.createdWorkPackage().then(e=>{this.change=e,this.newWorkPackage=e.pristineResource,this.cdRef.detectChanges(),this.setTitle(),this.stateParams.parent_id&&e.setValue("parent",{href:this.apiV3Service.work_packages.id(this.stateParams.parent_id).path}),this.stateParams.parent_id&&this.apiV3Service.work_packages.id(this.stateParams.parent_id).get().pipe(this.untilDestroyed()).subscribe(e=>{this.parentWorkPackage=e,this.cdRef.detectChanges()})}).catch(e=>{"urn:openproject-org:api:v3:errors:MissingPermission"===e.errorIdentifier&&(this.apiV3Service.root.get().subscribe(e=>{if(!e.user){let e=g(this.pathHelper.loginPath());e.search({back_url:e}),window.location.href=e.toString()}}),this.notificationService.handleRawError(e))})}setTitle(){this.titleService.setFirstPart(this.I18n.t("js.work_packages.create.title"))}cancelAndBackToList(){this.wpCreate.cancelCreation(),this.$state.go(this.cancelState,this.$state.params)}createdWorkPackage(){let e={_links:{}};const t=this.stateParams.type?parseInt(this.stateParams.type):void 0,i=this.stateParams.parent_id?parseInt(this.stateParams.parent_id):void 0,n=this.stateParams.projectPath;return t&&(e._links.type={href:this.apiV3Service.types.id(t).path}),i&&(e._links.parent={href:this.apiV3Service.work_packages.id(i).path}),this.wpCreate.createOrContinueWorkPackage(n,t,e)}closeEditFormWhenNewWorkPackageSaved(){this.wpCreate.onNewWorkPackage().pipe(Object(c.a)(()=>!this.componentDestroyed)).subscribe(e=>{this.onSaved({savedResource:e,isInitial:!0})})}}v.\u0275fac=function(e){return new(e||v)(w.bc(w.A),w.bc(n.Transition),w.bc(n.StateService),w.bc(l.a),w.bc(o.a),w.bc(p.a),w.bc(r.a),w.bc(a.a),w.bc(u.a),w.bc(d.a),w.bc(s.a),w.bc(m.a),w.bc(w.i))},v.\u0275dir=w.Wb({type:v,viewQuery:function(e,t){var i;(1&e&&w.ad(h.a,!0),2&e)&&(w.Ic(i=w.qc())&&(t.editForm=i.first))},features:[w.Mb]})},zTuL:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i("wZYP"),s=i("sjKJ"),r=i("07mJ"),a=i("E2tj"),c=i("pL6k"),o=i("iB+3"),l=i("AEvm"),d=i("F3Jm"),u=i("IaZ+"),h=i("fXoL"),p=i("N5AO");class g extends l.a{constructor(e,t,i,n,s,r,a,c){super(),this.I18n=e,this.currentProject=t,this.bcfPathHelper=i,this.querySpace=n,this.queryUrlParamsHelper=s,this.opModalService=r,this.injector=a,this.state=c,this.text={export:this.I18n.t("js.bcf.export"),export_hover:this.I18n.t("js.bcf.export_bcf_xml_file")}}ngOnInit(){this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.query=e;let t=this.currentProject.identifier,i=this.queryUrlParamsHelper.buildV3GetFilters(this.query.filters);this.exportLink=this.bcfPathHelper.projectExportIssuesPath(t,JSON.stringify(i))})}showDelayedExport(e){this.opModalService.show(d.a,this.injector,{link:this.exportLink}),e.preventDefault()}}g.\u0275fac=function(e){return new(e||g)(h.bc(n.a),h.bc(s.a),h.bc(r.a),h.bc(a.a),h.bc(c.a),h.bc(u.b),h.bc(h.A),h.bc(o.StateService))},g.\u0275cmp=h.Vb({type:g,selectors:[["bcf-export-button"]],features:[h.Mb],decls:4,vars:3,consts:[[1,"button","export-bcf-button",3,"title","click"],["icon-classes","button--icon icon-export"],[1,"button--text"]],template:function(e,t){1&e&&(h.hc(0,"a",0),h.pc("click",(function(e){return t.showDelayedExport(e)})),h.cc(1,"op-icon",1),h.hc(2,"span",2),h.Vc(3),h.gc(),h.gc()),2&e&&(h.wc("title",t.text.export_hover),h.Qb("href",t.exportLink,h.Oc),h.Pb(3),h.Xc(" ",t.text.export," "))},directives:[p.a],encapsulation:2})},zUnb:function(e,t,i){"use strict";i.r(t);var n=i("fXoL"),s=i("EVdn"),r=i("AytR"),a=i("1Wj6");var c=i("qHU1"),o=i("FnNU"),l=i("3Pt+"),d=i("8VVp"),u=i("iMRi"),h=i("kt6C"),p=i("DvFC"),g=i("oT5z"),f=i("u4T9"),b=i("RuUM"),m=i("g1AQ"),w=i("mrSG"),v=i("d/TE"),y=i("wZYP"),k=i("oJ+N"),C=i("kTsZ"),j=i("8aTQ");const P=["passwordConfirmationField"];class x extends j.a{constructor(){super(...arguments),this.password_confirmation=null}ngOnInit(){super.ngOnInit(),this.text.title=I18n.t("js.password_confirmation.title"),this.text.field_description=I18n.t("js.password_confirmation.field_description"),this.text.confirm_button=I18n.t("js.button_confirm"),this.text.password=I18n.t("js.label_password"),this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.showClose=!1}confirmAndClose(e){this.passwordValuePresent()&&super.confirmAndClose(e)}onOpen(e){super.onOpen(e),this.passwordConfirmationField.nativeElement.focus()}passwordValuePresent(){return null!==this.password_confirmation&&this.password_confirmation.length>0}}x.\u0275fac=function(e){return S(e||x)},x.\u0275cmp=n.Vb({type:x,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(P,!0),2&e)&&(n.Ic(i=n.qc())&&(t.passwordConfirmationField=i.first))},features:[n.Mb],decls:16,vars:8,consts:[[1,"op-modal--portal","confirm-form-submit--modal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","password-confirm-dialog--modal","loading-indicator--location"],[1,"op-modal--modal-header"],[1,"icon-context","icon-locked",3,"textContent"],[1,"op-modal--modal-body"],[1,"request-for-confirmation--form","form","-vertical",3,"submit"],[1,"form--field","-required"],["for","request_for_confirmation_password",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--text-field-container"],["type","password","id","request_for_confirmation_password","name","request_for_confirmation_password",1,"form--text-field",3,"ngModel","ngModelChange"],["passwordConfirmationField",""],[1,"form--field-instructions",3,"textContent"],[1,"op-modal--modal-footer"],[1,"confirm-form-submit--continue","button",3,"textContent","disabled","click"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.cc(3,"h3",3),n.gc(),n.hc(4,"div",4),n.hc(5,"form",5),n.pc("submit",(function(e){return t.confirmAndClose(e)})),n.hc(6,"div",6),n.cc(7,"label",7),n.hc(8,"div",8),n.hc(9,"div",9),n.hc(10,"input",10,11),n.pc("ngModelChange",(function(e){return t.password_confirmation=e})),n.gc(),n.gc(),n.gc(),n.cc(12,"div",12),n.gc(),n.gc(),n.gc(),n.hc(13,"div",13),n.hc(14,"button",14),n.pc("click",(function(e){return t.confirmAndClose(e)})),n.Vc(15,' [attr.title]="text.button_cancel"> '),n.gc(),n.gc(),n.gc(),n.gc()),2&e&&(n.Pb(3),n.wc("textContent",t.text.title),n.Pb(4),n.wc("textContent",t.text.password),n.Qb("aria-label",t.text.field_description),n.Pb(3),n.wc("ngModel",t.password_confirmation),n.Pb(2),n.wc("textContent",t.text.field_description),n.Pb(2),n.wc("textContent",t.text.confirm_button)("disabled",!t.passwordValuePresent()),n.Qb("title",t.text.confirm_button))},directives:[l.C,l.n,l.o,l.c,l.m,l.p],encapsulation:2});const S=n.jc(x);var O=i("IaZ+"),I=i("SqdZ");class T extends I.a{constructor(e,t,i,n){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.I18n=n,this.closeOnOutsideClick=!1}ngOnInit(){super.ngOnInit(),this.$element.find(".dynamic-content-modal--wrapper").addClass(this.locals.modalClassName).append(this.locals.modalBody),jQuery(document.body).on("click.opdynamicmodal",".dynamic-content-modal--close-button",e=>{this.closeMe(e)})}ngOnDestroy(){jQuery(document.body).off("click.opdynamicmodal"),super.ngOnDestroy()}}T.\u0275fac=function(e){return new(e||T)(n.bc(n.q),n.bc(O.a),n.bc(n.i),n.bc(y.a))},T.\u0275cmp=n.Vb({type:T,selectors:[["ng-component"]],features:[n.Mb],decls:2,vars:0,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","dynamic-content-modal--wrapper","loading-indicator--location"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.cc(1,"div",1),n.gc())},encapsulation:2});var R=i("4rda"),E=i("Mo6U"),M=i("J30J"),F=i("5btT"),A=i("ZsX/"),L=i("Tac9"),D=i("jhN1");class V{constructor(e){this.sanitizer=e}sanitize(e){return this.sanitizer.sanitize(n.V.HTML,e)||""}}V.\u0275fac=function(e){return new(e||V)(n.lc(D.b))},V.\u0275prov=n.Xb({token:V,factory:V.\u0275fac,providedIn:"root"});var q=i("Jui0"),$=i("E+lO"),N=i("GLdX"),B=i("CK39"),z=i("r0MM"),H=i("CNq7"),Q=i("8zkO");class W{constructor(e){this.injector=e,this._knownHookNames=["workPackageTableContextMenu","workPackageSingleContextMenu","workPackageNewInitialization"],this.services={confirmDialog:this.injector.get(p.a),externalQueryConfiguration:this.injector.get(k.a),externalRelationQueryConfiguration:this.injector.get(B.a),halResource:this.injector.get(C.a),hooks:this.injector.get(m.a),i18n:this.injector.get(y.a),notifications:this.injector.get(v.a),opModalService:this.injector.get(O.b),opFileUpload:this.injector.get(A.a),displayField:this.injector.get(M.a),editField:this.injector.get(F.a),macros:this.injector.get(L.a),htmlSanitizeService:this.injector.get(V),ckEditorPreview:this.injector.get(N.a),pathHelperService:this.injector.get(q.a),states:this.injector.get(u.a),apiV3Service:this.injector.get(H.a),configurationService:this.injector.get(Q.a)},this.classes={modals:{passwordConfirmation:x,dynamicContent:T},HalResource:E.a,DisplayField:R.a},this.hooks={},this._knownHookNames.forEach(e=>{this.hooks[e]=t=>this.services.hooks.register(e,t)})}runInZone(e){this.zone.run(e)}bootstrap(e){$.a.bootstrapOptionalEmbeddable(this.injector.get(n.f),e)}}Object(w.c)([Object(z.a)(),Object(w.e)("design:type",n.K)],W.prototype,"zone",void 0);class X{constructor(e){Object(c.a)("Registering OpenProject plugin context");const t=new W(e);window.OpenProject.pluginContext.putValue(t)}}X.\u0275mod=n.Zb({type:X}),X.\u0275inj=n.Yb({factory:function(e){return new(e||X)(n.lc(n.A))},providers:[m.a]});var U=i("fFIw"),G=i("LrpJ");class Y extends E.a{}const K=Object(G.a)(Y);class Z{constructor(){jQuery("costs-subform").each((e,t)=>{let i=jQuery(t);const n=i.find(".subform-container"),s=i.find(".subform-row-template");s.detach();const r=s[0].outerHTML;let a=parseInt(i.attr("item-count"));i.on("click",".delete-row-button,.delete-budget-item",e=>(jQuery(e.target).closest(".subform-row").remove(),!1)),i.find(".add-row-button,.wp-inline-create--add-link").click(e=>{e.preventDefault();let t=jQuery(r.replace(/INDEX/g,a.toString()));return t.show(),t.removeClass("subform-row-template"),t.find("input.costs-date-picker").prop("required",!0),t.find('input[id^="cost_type_new_rate_attributes"]').prop("required",!0),n.append(t),a+=1,n.find(".subform-row:last-child input:first").focus(),!1})})}}Z.\u0275fac=function(e){return new(e||Z)},Z.\u0275prov=n.Xb({token:Z,factory:Z.\u0275fac});class J{constructor(e){this.$element=e,this.objId=this.$element.attr("obj-id"),this.objName=this.$element.attr("obj-name"),this.obj=jQuery(`#${this.objId}_costs`),this.placeholder=this.$element.data("placeholder"),this.makeEditable()}static listen(){jQuery(document).on("click",".costs--edit-planned-costs-btn",e=>{const t=jQuery(e.target).closest("cost-unit-subform");new J(t)})}makeEditable(){this.edit_and_focus()}edit_and_focus(){this.edit(),jQuery("#"+this.objId+"_costs_edit").trigger("focus"),jQuery("#"+this.objId+"_costs_edit").trigger("select")}getCurrency(){return jQuery("#"+this.objId+"_currency").val()}getValue(){return jQuery("#"+this.objId+"_cost_value").val()}edit(){this.obj.hide();let e=this.obj[0].id,t=this.getCurrency(),i=this.getValue(),n=this.objName,s=this.placeholder;jQuery(`\n      <section class="form--section" id="${e}_section">\n        <div class="form--field">\n          <div class="form--field-container">\n            <div id="${e}_cancel" class="form--field-affix -transparent icon icon-close"></div>\n            <div id="${e}_editor" class="form--text-field-container">\n                <input id="${e}_edit"\n                       class="form--text-field"\n                       name="${n}"\n                       value="${i}"\n                       placeholder="${s}"\n                       class="currency"\n                       type="text" />\n            </div>\n            <div class="form--field-affix" id="${e}_affix">${t}</div>\n          </div>\n        </div>\n      </section>\n    `).insertAfter(this.obj);let r=this;jQuery("#"+e+"_cancel").on("click",(function(){return jQuery("#"+e+"_section").remove(),r.obj.show(),!1}))}}var ee=i("POAS"),te=i("tk/3");class ie{constructor(e,t){this.halNotification=e,this.http=t}listen(){jQuery("costs-budget-subform").each((e,t)=>{let i=jQuery(t);const n=i.find(".budget-item-container"),s=i.find(".budget-row-template");s.detach();const r=s[0].outerHTML;let a=parseInt(i.attr("item-count"));i.on("change",".budget-item-value",e=>{let t=jQuery(e.target).closest(".cost_entry");this.refreshRow(i,t.attr("id"))}),i.on("click",".delete-budget-item",e=>(e.preventDefault(),jQuery(e.target).closest(".cost_entry").remove(),!1)),i.find(".budget-add-row").click(e=>{e.preventDefault();let t=jQuery(r.replace(/INDEX/g,a.toString()));return t.show(),t.removeClass("budget-row-template"),n.append(t),a+=1,!1})})}refreshRow(e,t){let i=e.find("#"+t),n=this.buildRefreshRequest(i,t);this.http.post(e.attr("update-url"),n,{headers:{Accept:"application/json"},withCredentials:!0}).subscribe(e=>{_.each(e,(e,t)=>{let i=document.getElementById(t);i instanceof HTMLInputElement?i.value=e:i&&(i.textContent=e)})},e=>this.halNotification.handleRawError(e))}buildRefreshRequest(e,t){let i={element_id:t,fixed_date:jQuery("#budget_fixed_date").val()};return e.find(".budget-item-value").each((e,t)=>{let n=jQuery(t);i[n.data("requestKey")]=n.val()||"0"}),i}}ie.\u0275fac=function(e){return new(e||ie)(n.lc(ee.a),n.lc(te.b))},ie.\u0275prov=n.Xb({token:ie,factory:ie.\u0275fac});class ne{constructor(e){!function(e){window.OpenProject.getPluginContext().then(t=>{t.services.editField.extendFieldType("select",["Budget"]),t.services.displayField.extendFieldType("resource",["Budget"]),t.services.halResource.registerResource("Budget",{cls:K}),t.services.states.add("budgets",Object(o.h)()),new Z,J.listen(),e.get(ie).listen()})}(e)}}ne.\u0275mod=n.Zb({type:ne}),ne.\u0275inj=n.Yb({factory:function(e){return new(e||ne)(n.lc(n.A))},providers:[ie]});class se extends R.a{apply(e,t){super.apply(e,t),this.loadIfNecessary()}loadIfNecessary(){this.value&&!1===this.value.$loaded&&this.value.$load().then(()=>{"WorkPackage"===this.resource.$source._type&&this.apiV3Service.work_packages.cache.touch(this.resource.id)})}get title(){return""}render(e,t){this.isEmpty()?e.textContent=this.placeholder:this.value.elements.forEach((t,i)=>{this.resource.showCosts?this.renderCostAsLink(t,e,i):this.renderCostAsText(t,e,i)})}isEmpty(){return!this.value||!this.value.elements||0===this.value.elements.length}renderCostAsLink(e,t,i){const n=this.resource.showCosts,s=document.createElement("a");s.href=n.href+"&unit="+e.costType.id,s.setAttribute("target","_blank"),s.textContent=e.spentUnits+" "+e.costType.name,t.appendChild(s),this.addSeparator(t,i)}renderCostAsText(e,t,i){const n=document.createElement("span");n.textContent=e.spentUnits+" "+e.costType.name,t.appendChild(n),this.addSeparator(t,i)}addSeparator(e,t){if(t<this.value.elements.length-1){const t=document.createElement("span");t.textContent=", ",e.appendChild(t)}}}Object(w.c)([Object(z.a)(),Object(w.e)("design:type",H.a)],se.prototype,"apiV3Service",void 0);class re extends R.a{isEmpty(){return!this.value||!parseFloat(this.value.match(/\d+/g)[0])}}class ae{constructor(e){window.OpenProject.getPluginContext().then(e=>{let t=e.services.displayField;t.addFieldType(se,"costs",["costsByType"]),t.addFieldType(re,"currency",["laborCosts","materialCosts","overallCosts"]),e.hooks.workPackageSingleContextMenu((function(e){return{key:"log_costs",icon:"icon-projects",indexBy:function(e){let t=_.findIndex(e,{key:"log_time"});return-1!==t?t+1:e.length},resource:"workPackage",link:"logCosts"}})),e.hooks.workPackageTableContextMenu((function(e){return{key:"log_costs",icon:"icon-projects",link:"logCosts",indexBy:function(e){let t=_.findIndex(e,{link:"logTime"});return-1!==t?t+1:e.length},text:I18n.t("js.button_log_costs")}}))})}}ae.\u0275mod=n.Zb({type:ae}),ae.\u0275inj=n.Yb({factory:function(e){return new(e||ae)(n.lc(n.A))},providers:[]});var ce,oe=i("ofXK");!function(e){function t(e,t){const n=document.createElement("canvas"),s=n.getContext("2d");let r=t.width,a=t.height;r>a?r>e&&(a*=e/r,r=e):a>e&&(r*=e/a,a=e),n.width=r,n.height=a,s.drawImage(t,0,0,r,a);let c=n.toDataURL("image/jpeg");return[c,i(c)]}function i(e){const t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],n=t.length,s=new Uint8Array(n);for(var r=0;r<n;r++)s[r]=t.charCodeAt(r);return new Blob([s],{type:i})}e.resizeFile=function(e,i){return new Promise((n,s)=>{const r=new FileReader;r.onload=i=>{const s=new Image;s.onload=()=>n(t(e,s)),s.src=i.target.result},r.readAsDataURL(i)})},e.resizeImage=t}(ce||(ce={}));const le=["avatarFilePicker"];function de(e,t){if(1&e&&n.cc(0,"span",6),2&e){const e=n.rc();n.wc("textContent",e.text.wrong_file_format)}}function ue(e,t){if(1&e&&(n.hc(0,"fieldset",11),n.cc(1,"legend",12),n.cc(2,"img",13),n.gc()),2&e){const e=n.rc();n.Pb(1),n.wc("textContent",e.text.preview),n.Pb(1),n.wc("src",e.avatarPreviewUrl,n.Oc)}}const he=function(e){return{"-error":e}};class pe{constructor(e,t,i,n){this.I18n=e,this.elementRef=t,this.notificationsService=i,this.opFileUpload=n,this.busy=!1,this.fileInvalid=!1,this.text={label_choose_avatar:this.I18n.t("js.avatars.label_choose_avatar"),upload_instructions:this.I18n.t("js.avatars.text_upload_instructions"),error_too_large:this.I18n.t("js.avatars.error_image_too_large"),wrong_file_format:this.I18n.t("js.avatars.wrong_file_format"),button_update:this.I18n.t("js.button_update"),uploading:this.I18n.t("js.avatars.uploading_avatar"),preview:this.I18n.t("js.label_preview")}}ngOnInit(){const e=this.elementRef.nativeElement;this.target=e.getAttribute("target"),this.method=e.getAttribute("method")}onFilePickerChanged(e){const t=Array.from(this.avatarFilePicker.nativeElement.files);if(0===t.length)return;const i=t[0];-1!==["image/jpeg","image/png","image/gif"].indexOf(i.type)?ce.resizeFile(128,i).then(([e,t])=>{t.name=i.name,this.avatarFile=t,this.avatarPreviewUrl=e}):this.fileInvalid=!0}uploadAvatar(e){e.preventDefault(),this.busy=!0;const t=this.opFileUpload.uploadSingle(this.target,this.avatarFile,this.method,"text");this.notificationsService.addAttachmentUpload(this.text.uploading,[t]),t[1].subscribe(e=>{switch(e.type){case 0:return;case 4:return this.avatarFile.progress=100,this.busy=!1,void window.location.reload();default:return}},e=>{this.notificationsService.addError(e.error),this.busy=!1})}}pe.\u0275fac=function(e){return new(e||pe)(n.bc(y.a),n.bc(n.q),n.bc(v.a),n.bc(A.a))},pe.\u0275cmp=n.Vb({type:pe,selectors:[["avatar-upload-form"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(le,!0),2&e)&&(n.Ic(i=n.qc())&&(t.avatarFilePicker=i.first))},decls:11,vars:9,consts:[[1,"form--field"],["for","avatar_file_input",1,"form--label",3,"ngClass","textContent"],[1,"form--field-container"],["type","file","accept","image/jpeg,image/png,image/gif","id","avatar_file_input","name","avatar_file_input",3,"change"],["avatarFilePicker",""],[1,"form--field-instructions"],[3,"textContent"],[1,"avatars--error-pane"],[3,"textContent",4,"ngIf"],["class","preview",4,"ngIf"],["type","submit",1,"button","-highlight","-with-icon","icon-checkmark",3,"textContent","click"],[1,"preview"],[1,"preview--legend",3,"textContent"],[1,"avatars--local-avatar-preview",3,"src"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.cc(1,"label",1),n.hc(2,"div",2),n.hc(3,"input",3,4),n.pc("change",(function(e){return t.onFilePickerChanged(e)})),n.gc(),n.gc(),n.hc(5,"div",5),n.cc(6,"span",6),n.hc(7,"div",7),n.Tc(8,de,1,1,"span",8),n.gc(),n.gc(),n.gc(),n.Tc(9,ue,3,2,"fieldset",9),n.hc(10,"button",10),n.pc("click",(function(e){return t.uploadAvatar(e)})),n.gc()),2&e&&(n.Pb(1),n.wc("ngClass",n.Bc(7,he,t.fileInvalid))("textContent",t.text.label_choose_avatar),n.Pb(5),n.wc("textContent",t.text.upload_instructions),n.Pb(2),n.wc("ngIf",t.fileInvalid),n.Pb(1),n.wc("ngIf",t.avatarPreviewUrl),n.Pb(1),n.wc("textContent",t.text.button_update),n.Qb("disabled",!t.avatarFile||t.busy||void 0))},directives:[oe.n,oe.q],encapsulation:2});class ge{constructor(e){e.get(m.a).register("openProjectAngularBootstrap",()=>[{selector:"avatar-upload-form",cls:pe}])}}ge.\u0275mod=n.Zb({type:ge}),ge.\u0275inj=n.Yb({factory:function(e){return new(e||ge)(n.lc(n.A))},imports:[[oe.b]]});class fe extends E.a{constructor(){super(...arguments),this.attachmentsBackend=!1}}const be=Object(G.a)(fe);class me{constructor(){window.OpenProject.getPluginContext().then(e=>{e.services.halResource.registerResource("Document",{cls:be}),e.services.states.add("documents",Object(o.h)())})}}me.\u0275mod=n.Zb({type:me}),me.\u0275inj=n.Yb({factory:function(e){return new(e||me)}});class we{}we.\u0275mod=n.Zb({type:we}),we.\u0275inj=n.Yb({factory:function(e){return new(e||we)},imports:[[ne,ae,ge,me]]});var ve=i("VpST"),ye=i("xRac"),ke=i("Xmgp"),Ce=i("CS/5"),je=i("5+WD"),Pe=i("CejQ"),xe=i("sjKJ");class Se{constructor(e,t,i,n){this.startRow=e,this.endRow=t,this.startColumn=i,this.endColumn=n}get gridStartRow(){return 2*this.startRow}get gridEndRow(){return 2*this.endRow-1}get gridStartColumn(){return 2*this.startColumn}get gridEndColumn(){return 2*this.endColumn-1}get guid(){return this.storedGuid||(this.storedGuid=this.newGuid()),this.storedGuid}newGuid(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}}class _e extends Se{constructor(e){super(e.startRow,e.endRow,e.startColumn,e.endColumn),this.widget=e}reset(){this.startRow=this.widget.startRow,this.endRow=this.widget.endRow,this.startColumn=this.widget.startColumn,this.endColumn=this.widget.endColumn}moveRight(){this.startColumn++,this.endColumn++}moveLeft(){this.startColumn--,this.endColumn--}growColumn(){this.endColumn++}overlaps(e){return this.rowOverlaps(e)&&this.columnOverlaps(e)}rowOverlaps(e){return this.startRow<e.endRow&&this.endRow>=e.endRow||this.startRow<=e.startRow&&this.endRow>e.startRow||this.startRow>e.startRow&&this.endRow<e.endRow}columnOverlaps(e){return this.startColumn<e.endColumn&&this.endColumn>=e.endColumn||this.startColumn<=e.startColumn&&this.endColumn>e.startColumn||this.startColumn>e.startColumn&&this.endColumn<e.endColumn}startColumnOverlaps(e){return this.startColumn<e.startColumn&&this.endColumn>e.startColumn&&this.rowOverlaps(e)}get unchangedSize(){return this.startColumn===this.widget.startColumn&&this.endColumn===this.widget.endColumn&&this.startRow===this.widget.startRow&&this.endRow===this.widget.endRow}writeAreaChangeToWidget(){this.widget.startRow=this.startRow,this.widget.endRow=this.endRow,this.widget.startColumn=this.startColumn,this.widget.endColumn=this.endColumn}copyDimensionsTo(e){e.startRow=this.startRow,e.startColumn=this.startColumn,e.endRow=this.endRow,e.endColumn=this.endColumn}}class Oe extends Se{constructor(e,t,i,n,s){super(e,t,i,n),this.type=s}get gridStartRow(){return this.isRow?2*this.startRow-1:2*this.startRow}get gridEndRow(){return this.isRow?2*this.endRow-2:2*this.endRow-1}get gridStartColumn(){return this.isRow?2*this.startColumn:2*this.startColumn-1}get gridEndColumn(){return this.isRow?2*this.endColumn-1:2*this.endColumn-2}get isRow(){return"row"===this.type}get isColumn(){return"column"===this.type}}var Ie=i("2Vo4"),Te=i("uIAU");class Re{constructor(e,t,i){this.apiV3Service=e,this.notification=t,this.i18n=i,this.numColumns=0,this.numRows=0,this.mousedOverArea=null,this.$mousedOverArea=new Ie.a(this.mousedOverArea),this.helpMode=!1}set gridResource(e){this.resource=e,this.fetchSchema(),this.numRows=this.resource.rowCount,this.numColumns=this.resource.columnCount,this.buildAreas(!0)}get gridResource(){return this.resource}setMousedOverArea(e){this.mousedOverArea=e,this.$mousedOverArea.next(e)}cleanupUnusedAreas(){let e=_.range(this.numRows,0,-1);this.widgetAreas.forEach(t=>{e=e.filter(e=>e!==t.startRow)}),e.forEach(e=>{this.numRows>1&&this.removeRow(e)});let t=_.range(this.numColumns,0,-1);this.widgetAreas.forEach(e=>{t=t.filter(t=>t!==e.startColumn)}),t.forEach(e=>{this.numColumns>1&&this.removeColumn(e)})}buildAreas(e=!1){this.gridAreas=this.buildGridAreas(),this.gridGaps=this.buildGridGaps(),this.gridAreaIds=this.buildGridAreaIds(),e&&(this.widgetAreas=this.buildGridWidgetAreas())}rebuildAndPersist(){this.persist(),this.buildAreas(!1)}persist(){this.resource.rowCount=this.numRows=(this.widgetAreas.map(e=>e.endRow).sort((e,t)=>e-t).pop()||2)-1,this.resource.columnCount=this.numColumns,this.writeAreaChangesToWidgets(),this.saveGrid(this.resource,this.schema)}saveWidgetChangeset(e){let t=Te.a.extractPayload(this.resource,this.schema),i=t.widgets.find(t=>t.id===e.pristineResource.id);Object.assign(i,e.changes),t.id=this.resource.id,this.saveGrid(t)}isGap(e){return e instanceof Oe}get isSingleCell(){return 1===this.numRows&&1===this.numColumns&&0===this.widgetResources.length}get inHelpMode(){return this.helpMode||this.isSingleCell}toggleHelpMode(){this.helpMode=!this.helpMode}scrollPlaceholderIntoView(){let e=jQuery(".grid--area.-placeholder");e[0].scrollIntoViewIfNeeded&&setTimeout(()=>e[0].scrollIntoViewIfNeeded())}saveGrid(e,t){this.apiV3Service.grids.id(e).patch(e,t).subscribe(e=>{this.assignAreasWidget(e),this.notification.addSuccess(this.i18n.t("js.notice_successful_update"))})}assignAreasWidget(e){this.resource.widgets=e.widgets;let t=this.widgetAreas.map(e=>e.widget.id);this.widgetAreas.forEach(i=>{let n;n=i.widget.id?e.widgets.find(e=>e.id===i.widget.id):e.widgets.find(e=>!t.includes(e.id)&&e.identifier===i.widget.identifier&&e.startRow===i.widget.startRow&&e.startColumn===i.widget.startColumn),i.widget=n})}buildGridAreas(){let e=[];for(let t=1;t<=this.numRows+1;t++)e.push(...this.buildGridAreasRow(t));return e}buildGridGaps(){let e=[];if(this.isSingleCell)return e;for(let t=1;t<=this.numRows+1;t++)e.push(...this.buildGridGapRow(t));return e}buildGridAreasRow(e){let t=[];for(let i=1;i<=this.numColumns;i++){let n=new Se(e,e+1,i,i+1);t.push(n)}return t}buildGridGapRow(e){let t=[];for(let i=1;i<=this.numColumns;i++)t.push(new Oe(e,e+1,i,i+1,"row"));if(e<=this.numRows)for(let i=1;i<=this.numColumns+1;i++)t.push(new Oe(e,e+1,i,i+1,"column"));return t}buildGridWidgetAreas(){return this.widgetResources.map(e=>new _e(e))}writeAreaChangesToWidgets(){this.widgetAreas.forEach(e=>{e.writeAreaChangeToWidget()})}addColumn(e,t){this.numColumns++;let i=[];for(let n=1;n<=this.numRows;n++){if(n===t)continue;let s=this.rowWidgets(n).sort((e,t)=>e.startColumn-t.startColumn).find(i=>!(i.startRow<t&&i.endRow>t)&&(i.startColumn===e+1||i.endColumn===e+1||i.startColumn<=e&&i.endColumn>e));s&&(i.push(s),s.endColumn++)}this.moveSubsequentRowWidgets(this.widgetAreas.filter(e=>!i.includes(e)),e)}addRow(e,t){this.numRows++;let i=[];for(let n=1;n<=this.numColumns;n++){if(n===t)continue;let s=this.columnWidgets(n).sort((e,t)=>e.startRow-t.startRow).find(i=>!(i.startColumn<t&&i.endColumn>t)&&(i.startRow===e+1||i.endRow===e+1||i.startRow<=e&&i.endRow>e));s&&(i.push(s),s.endRow++)}this.moveSubsequentColumnWidgets(this.widgetAreas.filter(e=>!i.includes(e)),e)}removeColumn(e){this.numColumns--,this.widgetAreas.forEach(t=>{t.startColumn<=e&&t.endColumn>=e+1&&t.endColumn--}),this.widgetAreas.filter(t=>t.startColumn>e).forEach(e=>{e.startColumn--,e.endColumn--})}removeRow(e){this.numRows--,this.widgetAreas.forEach(t=>{t.startRow<=e&&t.endRow>=e+1&&t.endRow--}),this.widgetAreas.filter(t=>t.startRow>e).forEach(e=>{e.startRow--,e.endRow--})}resetAreas(e=null){this.widgetAreas.filter(t=>!e||t.guid!==e.guid).forEach(e=>e.reset()),this.numRows=this.resource.rowCount,this.numColumns=this.resource.columnCount}get isEditable(){return void 0!==this.gridResource.updateImmediately}buildGridAreaIds(){return this.gridAreas.filter(e=>!this.isGap(e)).map(e=>e.guid)}fetchSchema(){this.apiV3Service.grids.id(this.resource).form.post({}).subscribe(e=>this.schema=e.schema)}removeWidget(e){let t=this.resource.widgets.findIndex(t=>t.id===e.id);this.resource.widgets.splice(t,1),t=this.widgetAreas.findIndex(t=>t.widget.id===e.id),this.widgetAreas.splice(t,1),this.cleanupUnusedAreas(),this.rebuildAndPersist()}get widgetResources(){return this.resource&&this.resource.widgets||[]}rowWidgets(e){return this.widgetAreas.filter(t=>t.startRow===e)}moveSubsequentRowWidgets(e,t){e.forEach(e=>{e.startColumn>t&&(e.startColumn++,e.endColumn++)})}columnWidgets(e){return this.widgetAreas.filter(t=>t.startColumn===e)}moveSubsequentColumnWidgets(e,t){e.forEach(e=>{e.startRow>t&&(e.startRow++,e.endRow++)})}}Re.\u0275fac=function(e){return new(e||Re)(n.lc(H.a),n.lc(v.a),n.lc(y.a))},Re.\u0275prov=n.Xb({token:Re,factory:Re.\u0275fac});var Ee=i("CV67");const Me=[[["","slot","prepend"]],[["","slot","menu"]]],Fe=function(e){return{"-editable":e}};class Ae{constructor(e){this.layout=e,this.editable=!0,this.onRenamed=new n.s}renamed(e){this.onRenamed.emit(e)}get isRenameable(){return this.editable&&this.layout.isEditable}}Ae.\u0275fac=function(e){return new(e||Ae)(n.bc(Re))},Ae.\u0275cmp=n.Vb({type:Ae,selectors:[["widget-header"]],inputs:{name:"name",editable:"editable"},outputs:{onRenamed:"onRenamed"},ngContentSelectors:["[slot=prepend]","[slot=menu]"],decls:4,vars:5,consts:[[1,"widget-box--header",3,"ngClass"],[1,"widget-box--header-title",3,"title","editable","onSave"]],template:function(e,t){1&e&&(n.vc(Me),n.hc(0,"h3",0),n.uc(1),n.hc(2,"editable-toolbar-title",1),n.pc("onSave",(function(e){return t.renamed(e)})),n.gc(),n.uc(3,1),n.gc()),2&e&&(n.wc("ngClass",n.Bc(3,Fe,t.isRenameable)),n.Pb(2),n.wc("title",t.name)("editable",t.isRenameable))},directives:[oe.n,Ee.a],styles:[".widget-box--header.-editable[_ngcontent-%COMP%]{margin-top:0}.widget-box--header-title[_ngcontent-%COMP%]{padding-right:5px}"],changeDetection:0});i("PHo6");class Le{constructor(e){this.layout=e}area(e){this.widget(e.widget)}widget(e){this.layout.removeWidget(e)}}Le.\u0275fac=function(e){return new(e||Le)(n.lc(Re))},Le.\u0275prov=n.Xb({token:Le,factory:Le.\u0275fac});class De{constructor(e,t,i){this.i18n=e,this.remove=t,this.layout=i,this.menuItemList=[this.removeItem]}get menuItems(){return()=>Object(w.b)(this,void 0,void 0,(function*(){return this.menuItemList}))}get removeItem(){return{linkText:this.i18n.t("js.grid.remove"),onClick:()=>(this.remove.widget(this.resource),!0)}}get hasMenu(){return this.layout.isEditable}}De.\u0275fac=function(e){return new(e||De)(n.bc(y.a),n.bc(Le),n.bc(Re))},De.\u0275dir=n.Wb({type:De,inputs:{resource:"resource"}});var Ve=i("AdL0");function qe(e,t){if(1&e&&n.cc(0,"icon-triggered-context-menu",1),2&e){const e=n.rc();n.wc("menu-items",e.menuItems)}}class $e extends De{}$e.\u0275fac=function(e){return Ne(e||$e)},$e.\u0275cmp=n.Vb({type:$e,selectors:[["widget-menu"]],features:[n.Mb],decls:1,vars:1,consts:[[3,"menu-items",4,"ngIf"],[3,"menu-items"]],template:function(e,t){1&e&&n.Tc(0,qe,1,1,"icon-triggered-context-menu",0),2&e&&n.wc("ngIf",t.hasMenu)},directives:[oe.q,Ve.a],styles:["[_nghost-%COMP%]{align-self:center}"]});const Ne=n.jc($e);var Be=i("HEQ6"),ze=i("IvIE"),He=i("E2tj"),Qe=i("F5Dh"),We=i("wd/R"),Xe=i("DhiE"),Ue=i("iB+3"),Ge=i("W6hW"),Ye=i("dfy/"),Ke=i("PN1e"),Ze=i("XNiG"),Je=i("Kj3r"),et=i("IzEk"),tt=i("AEvm"),it=i("dMmB");const nt=["ucCalendar"];function st(e,t){if(1&e&&n.cc(0,"full-calendar",3,4),2&e){const e=n.rc();n.wc("options",e.calendarOptions)}}function rt(e,t){if(1&e&&n.cc(0,"div",5),2&e){const e=n.rc();n.wc("textContent",e.tooManyResultsText)}}class at extends tt.a{constructor(e,t,i,n,s,r,a,c,o,l,d,u,h){super(),this.states=e,this.$state=t,this.wpTableFilters=i,this.wpListService=n,this.querySpace=s,this.wpListChecksumService=r,this.schemaCache=a,this.titleService=c,this.element=o,this.i18n=l,this.notificationsService=d,this.sanitizer=u,this.configuration=h,this.resizeSubject=new Ze.a,this.static=!1,this.alreadyLoaded=!1}set container(e){e&&(this.ucCalendar=e,this.ucCalendar.getApi().setOption("eventDidMount",e=>{this.addTooltip(e)}),this.ucCalendar.getApi().setOption("eventClick",e=>{this.toWPFullView(e)}))}set ucCalendarElement(e){e&&(this.resizeObserver||(this.resizeObserver=new ResizeObserver(()=>this.resizeSubject.next())),this.resizeObserver.observe(e.nativeElement))}ngOnInit(){this.resizeSubject.pipe(Object(Je.a)(50)).subscribe(()=>{this.ucCalendar.getApi().updateSize()}),this.querySpace.stopAllSubscriptions.next(),this.setupWorkPackagesListener(),this.initializeCalendar()}calendarEventsFunction(e,t,i){if(this.alreadyLoaded){this.alreadyLoaded=!1;let e=this.updateResults(this.querySpace.results.value);t(e)}else this.querySpace.results.values$().pipe(Object(et.a)(1)).subscribe(e=>{let i=this.updateResults(e);t(i)});this.updateTimeframe(e)}initializeCalendar(){this.configuration.initialized.then(()=>{this.calendarOptions={editable:!1,locale:this.i18n.locale,fixedWeekCount:!1,firstDay:this.configuration.startOfWeek(),events:this.calendarEventsFunction.bind(this),plugins:[Ke.b],initialView:(()=>this.static?"dayGridWeek":void 0)(),height:this.calendarHeight(),headerToolbar:this.buildHeader()}})}updateTimeframe(e){let t=this.wpTableFilters.isEmpty;if(t&&this.querySpace.query.value)return;let i=We(e.start).format("YYYY-MM-DD"),n=We(e.end).format("YYYY-MM-DD");if(t){let e=this.defaultQueryProps(i,n);this.$state.params.query_props&&(e=decodeURIComponent(this.$state.params.query_props||"")),this.wpListService.fromQueryParams({query_props:e},this.projectIdentifier).toPromise()}else{this.$state.params;this.wpTableFilters.modify("datesInterval",e=>{e.values[0]=i,e.values[1]=n})}}addTooltip(e){jQuery(e.el).tooltip({content:this.tooltipContentString(e.event.extendedProps.workPackage),items:".fc-event",close:function(){jQuery(".ui-helper-hidden-accessible").remove()},track:!0})}toWPFullView(e){let t=e.event.extendedProps.workPackage;e.el&&this.removeTooltip(e.el),this.wpListChecksumService.clear(),window.history.pushState({},this.titleService.current,window.location.href),this.$state.go("work-packages.show",{workPackageId:t.id},{inherit:!1})}get calendarElement(){return jQuery(this.element.nativeElement).find(".wp-calendar--container")}calendarHeight(){if(this.static){let e=jQuery(this.element.nativeElement);for(;!e.height()&&e.parent();)e=e.parent();let t=jQuery(this.element.nativeElement).position().top,i=e.position().top;return e.height()-(t-i)}return jQuery(window).height()-this.calendarElement.offset().top-12}buildHeader(){return!this.static&&{right:"dayGridMonth,dayGridWeek",center:"title",left:"prev,next today"}}setCalendarsDate(){const e=this.querySpace.query.value;if(!e)return;let t=_.find(e.filters||[],{id:"datesInterval"}),i=null,n="dayGridMonth";if(t){let e=We(t.values[0]),s=We(t.values[1]).diff(e,"days");i=e.add(s/2,"days"),7===s&&(n="dayGridWeek")}i?this.ucCalendar.getApi().changeView(n,i.toDate()):this.ucCalendar.getApi().changeView(n)}setupWorkPackagesListener(){this.querySpace.results.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.alreadyLoaded=!0,this.setCalendarsDate(),this.ucCalendar.getApi().refetchEvents()})}updateResults(e){return this.warnOnTooManyResults(e),this.mapToCalendarEvents(e.elements)}mapToCalendarEvents(e){return e.map(e=>{let t=this.eventDate(e,"start"),i=this.eventDate(e,"due"),n=We(i).add(1,"days").format("YYYY-MM-DD");return{title:e.subject,start:t,end:n,allDay:!0,className:"__hl_background_type_"+e.type.id,workPackage:e}})}warnOnTooManyResults(e){e.count<e.total?this.tooManyResultsText=this.i18n.t("js.calendar.too_many",{count:e.total,max:at.MAX_DISPLAYED}):this.tooManyResultsText=null,this.tooManyResultsText&&!this.static&&this.notificationsService.addNotice(this.tooManyResultsText)}defaultQueryProps(e,t){let i={c:["id"],t:"id:asc",f:[{n:"status",o:"o",v:[]},{n:"datesInterval",o:"<>d",v:[e,t]}],pp:at.MAX_DISPLAYED};return JSON.stringify(i)}eventDate(e,t){return this.schemaCache.of(e).isMilestone?e.date:e[t+"Date"]}tooltipContentString(e){return`\n        ${this.sanitizedValue(e,"type")} #${e.id}: ${this.sanitizedValue(e,"subject",null)}\n        <ul class="tooltip--map">\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.work_packages.properties.projectName")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e,"project")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.work_packages.properties.status")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e,"status")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.work_packages.properties.startDate")}:</span>\n            <span class="tooltip--map--value">${this.eventDate(e,"start")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.work_packages.properties.dueDate")}:</span>\n            <span class="tooltip--map--value">${this.eventDate(e,"due")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.work_packages.properties.assignee")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e,"assignee")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.work_packages.properties.priority")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e,"priority")}</span>\n          </li>\n        </ul>\n        `}sanitizedValue(e,t,i="name"){let s=e[t];return s=i&&s?s[i]:s,s=s||this.i18n.t("js.placeholders.default"),this.sanitizer.sanitize(n.V.HTML,s)}removeTooltip(e){jQuery(e).tooltip({close:function(){jQuery(".ui-helper-hidden-accessible").remove()},disabled:!0})}}at.MAX_DISPLAYED=100,at.\u0275fac=function(e){return new(e||at)(n.bc(u.a),n.bc(Ue.StateService),n.bc(Qe.a),n.bc(Xe.a),n.bc(He.a),n.bc(Ge.a),n.bc(it.a),n.bc(Ye.a),n.bc(n.q),n.bc(y.a),n.bc(v.a),n.bc(D.b),n.bc(Q.a))},at.\u0275cmp=n.Vb({type:at,selectors:[["wp-calendar"]],viewQuery:function(e,t){var i;(1&e&&(n.ad(ze.a,!0),n.ad(nt,!0,n.q)),2&e)&&(n.Ic(i=n.qc())&&(t.container=i.first),n.Ic(i=n.qc())&&(t.ucCalendarElement=i.first))},inputs:{projectIdentifier:"projectIdentifier",static:"static"},features:[n.Mb],decls:3,vars:3,consts:[[1,"wp-calendar--container","loading-indicator--location",2,"position","relative"],[3,"options",4,"ngIf"],["class","wp-calendar--notification",3,"textContent",4,"ngIf"],[3,"options"],["ucCalendar",""],[1,"wp-calendar--notification",3,"textContent"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.Tc(1,st,2,1,"full-calendar",1),n.Tc(2,rt,1,1,"div",2),n.gc()),2&e&&(n.Qb("data-indicator-name","table"),n.Pb(1),n.wc("ngIf",t.calendarOptions),n.Pb(1),n.wc("ngIf",t.static))},directives:[oe.q,ze.a],styles:[".wp-calendar--container[_ngcontent-%COMP%]{min-height:200px}.wp-calendar--notification[_ngcontent-%COMP%]{font-style:italic;margin-top:.5rem}"]});class ct extends Pe.a{constructor(e,t,i){super(e,t),this.i18n=e,this.injector=t,this.currentProject=i}get projectIdentifier(){return this.currentProject.identifier}}ct.\u0275fac=function(e){return new(e||ct)(n.bc(y.a),n.bc(n.A),n.bc(xe.a))},ct.\u0275cmp=n.Vb({type:ct,selectors:[["ng-component"]],features:[n.Mb],decls:4,vars:4,consts:[[3,"name","onRenamed"],["slot","menu",3,"resource"],["wp-isolated-query-space",""],[3,"static","projectIdentifier"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.pc("onRenamed",(function(e){return t.renameWidget(e)})),n.cc(1,"widget-menu",1),n.gc(),n.fc(2,2),n.cc(3,"wp-calendar",3),n.ec()),2&e&&(n.wc("name",t.widgetName),n.Pb(1),n.wc("resource",t.resource),n.Pb(2),n.wc("static",!0)("projectIdentifier",t.projectIdentifier))},directives:[Ae,$e,Be.a,at],encapsulation:2});var ot=i("juWA"),lt=i("Y0Nk"),dt=i("qc15");function ut(e,t){if(1&e){const e=n.ic();n.hc(0,"div",11),n.cc(1,"label",12),n.hc(2,"span",13),n.hc(3,"span",14),n.hc(4,"input",15),n.pc("ngModelChange",(function(i){n.Lc(e);const s=t.index;return n.rc().days[s]=i})),n.gc(),n.gc(),n.gc(),n.gc()}if(2&e){const e=t.$implicit,i=t.index,s=n.rc();n.Pb(1),n.wc("textContent",e)("htmlFor","day_"+i),n.Pb(3),n.wc("id","day_"+i)("ngModel",s.days[i])}}class ht extends I.a{constructor(e,t,i,n,s,r,a,c,o){super(e,a,o),this.locals=e,this.I18n=t,this.injector=i,this.appRef=n,this.loadingIndicator=s,this.notificationService=r,this.cdRef=a,this.configuration=c,this.elementRef=o,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.text={displayedDays:this.I18n.t("js.grid.widgets.time_entries_current_user.displayed_days"),closePopup:this.I18n.t("js.close_popup_title"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel"),weekdays:moment.weekdays()},this.firstDayOffset=this.configuration.startOfWeek()}ngOnInit(){this.days=this.locals.options.days||Array.from({length:7},()=>!0);let e=1+moment.localeData().firstDayOfWeek()%7;this.text.weekdays=moment.localeData().weekdays().slice(e).concat(moment.localeData().weekdays().slice(0,e))}saveChanges(){this.options={days:this.days},this.service.close()}}function pt(e,t){if(1&e&&n.cc(0,"icon-triggered-context-menu",1),2&e){const e=n.rc();n.wc("menu-items",e.menuItems)}}ht.\u0275fac=function(e){return new(e||ht)(n.bc(O.a),n.bc(y.a),n.bc(n.A),n.bc(n.f),n.bc(lt.a),n.bc(dt.a),n.bc(n.i),n.bc(Q.a),n.bc(n.q))},ht.\u0275cmp=n.Vb({type:ht,selectors:[["ng-component"]],features:[n.Mb],decls:11,vars:5,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container"],[1,"op-modal--modal-header"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[3,"textContent"],["class","form--field -trailing-label",4,"ngFor","ngForOf"],[1,"tab-content"],[1,"modal--form-actions"],[1,"button","-highlight",3,"textContent","click"],[1,"button",3,"textContent","click"],[1,"form--field","-trailing-label"],[1,"form--label",3,"textContent","htmlFor"],[1,"form--field-container"],[1,"form--check-box-container"],["type","checkbox","name","days",1,"form--check-box",3,"id","ngModel","ngModelChange"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.hc(3,"a",3),n.hc(4,"i",4),n.pc("click",(function(e){return t.closeMe(e)})),n.gc(),n.gc(),n.cc(5,"h3",5),n.gc(),n.Tc(6,ut,5,4,"div",6),n.cc(7,"div",7),n.hc(8,"div",8),n.hc(9,"button",9),n.pc("click",(function(){return t.saveChanges()})),n.gc(),n.hc(10,"button",10),n.pc("click",(function(e){return t.closeMe(e)})),n.gc(),n.gc(),n.gc(),n.gc()),2&e&&(n.Pb(4),n.Qb("title",t.text.closePopup),n.Pb(1),n.wc("textContent",t.text.displayedDays),n.Pb(1),n.wc("ngForOf",t.text.weekdays),n.Pb(3),n.wc("textContent",t.text.applyButton),n.Pb(1),n.wc("textContent",t.text.cancelButton))},directives:[oe.p,l.a,l.m,l.p],encapsulation:2});class gt extends De{constructor(e,t,i,s,r){super(i,s,r),this.injector=e,this.opModalService=t,this.i18n=i,this.remove=s,this.layout=r,this.onConfigured=new n.s,this.menuItemList=[this.removeItem,this.configureItem]}get configureItem(){return{linkText:this.i18n.t("js.grid.configure"),onClick:()=>(this.opModalService.show(ht,this.injector,this.locals).closingEvent.subscribe(e=>{e.options&&this.onConfigured.emit(e.options)}),!0)}}get locals(){return{options:this.resource.options}}}gt.\u0275fac=function(e){return new(e||gt)(n.bc(n.A),n.bc(O.b),n.bc(y.a),n.bc(Le),n.bc(Re))},gt.\u0275cmp=n.Vb({type:gt,selectors:[["widget-time-entries-current-user-menu"]],outputs:{onConfigured:"onConfigured"},features:[n.Mb],decls:1,vars:1,consts:[[3,"menu-items",4,"ngIf"],[3,"menu-items"]],template:function(e,t){1&e&&n.Tc(0,pt,1,1,"icon-triggered-context-menu",0),2&e&&n.wc("ngIf",t.hasMenu)},directives:[oe.q,Ve.a],encapsulation:2});var ft=i("PjKf"),bt=i("ogxq"),mt=i("SKFm"),wt=i("xkGU"),vt=i("Zb8V"),yt=i("N5AO");function kt(e,t){if(1&e){const e=n.ic();n.hc(0,"button",12),n.pc("click",(function(){n.Lc(e);return n.rc().saveEntry()})),n.cc(1,"op-icon",13),n.cc(2,"span",14),n.gc()}if(2&e){const e=n.rc();n.wc("disabled",e.formInFlight),n.Qb("title",e.saveText),n.Pb(2),n.wc("textContent",e.saveText)}}function Ct(e,t){if(1&e){const e=n.ic();n.hc(0,"button",15),n.pc("click",(function(t){n.Lc(e);return n.rc().closeMe(t)})),n.cc(1,"op-icon",16),n.cc(2,"span",14),n.gc()}if(2&e){const e=n.rc();n.Qb("title",e.text.cancel),n.Pb(2),n.wc("textContent",e.text.cancel)}}function jt(e,t){if(1&e){const e=n.ic();n.hc(0,"button",15),n.pc("click",(function(){n.Lc(e);return n.rc().destroy()})),n.cc(1,"op-icon",17),n.cc(2,"span",14),n.gc()}if(2&e){const e=n.rc();n.Qb("title",e.text.delete),n.Pb(2),n.wc("textContent",e.text.delete)}}class Pt extends wt.a{setModifiedEntry(e){this.modifiedEntry=e.savedResource,this.reloadWorkPackageAndClose()}get saveAllowed(){return!!this.entry.update}get deleteAllowed(){return!!this.entry.delete}destroy(){window.confirm(this.text.areYouSure)&&(this.destroyedEntry=this.entry,this.service.close())}}Pt.\u0275fac=function(e){return xt(e||Pt)},Pt.\u0275cmp=n.Vb({type:Pt,selectors:[["ng-component"]],features:[n.Ob([mt.a]),n.Mb],decls:13,vars:7,consts:[[1,"op-modal--portal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","confirm-dialog--modal","loading-indicator--location"],[1,"op-modal--modal-header"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[1,"icon-context","icon-log_time",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],[3,"changeset","showWorkPackageField","modifiedEntry"],["editForm",""],[1,"op-modal--modal-footer"],["class","button -highlight",3,"disabled","click",4,"ngIf"],["class","button",3,"click",4,"ngIf"],[1,"button","-highlight",3,"disabled","click"],["icon-classes","button--icon icon-checkmark"],["aria-hidden","true",1,"button--text",3,"textContent"],[1,"button",3,"click"],["icon-classes","button--icon icon-close"],["icon-classes","button--icon icon-delete"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.hc(3,"a",3),n.hc(4,"i",4),n.pc("click",(function(e){return t.closeMe(e)})),n.gc(),n.gc(),n.cc(5,"h3",5),n.gc(),n.hc(6,"div",6),n.hc(7,"te-form",7,8),n.pc("modifiedEntry",(function(e){return t.setModifiedEntry(e)})),n.gc(),n.gc(),n.hc(9,"div",9),n.Tc(10,kt,3,3,"button",10),n.Tc(11,Ct,3,2,"button",11),n.Tc(12,jt,3,2,"button",11),n.gc(),n.gc(),n.gc()),2&e&&(n.Pb(4),n.Qb("title",t.text.close),n.Pb(1),n.wc("textContent",t.text.title),n.Pb(2),n.wc("changeset",t.changeset)("showWorkPackageField",t.showWorkPackageField),n.Pb(3),n.wc("ngIf",t.saveAllowed),n.Pb(1),n.wc("ngIf",t.saveAllowed),n.Pb(1),n.wc("ngIf",t.deleteAllowed))},directives:[vt.a,oe.q,yt.a],styles:[".op-modal--modal-container[_ngcontent-%COMP%]{max-width:90vw;width:800px}.icon-log_time[_ngcontent-%COMP%]:before{padding-right:6px}"],changeDetection:0});const xt=n.jc(Pt);class St{constructor(e,t,i,n,s,r){this.opModalService=e,this.injector=t,this.apiV3Service=i,this.halResource=n,this.halEditing=s,this.i18n=r}edit(e){return new Promise((t,i)=>{this.createChangeset(e).then(e=>{const n=this.opModalService.show(Pt,this.injector,{changeset:e});n.closingEvent.pipe(Object(et.a)(1)).subscribe(()=>{n.destroyedEntry?n.destroyedEntry.delete().then(()=>{t({entry:n.destroyedEntry,action:"destroy"})}):n.modifiedEntry?t({entry:n.modifiedEntry,action:"update"}):i()})})})}createChangeset(e){return this.apiV3Service.time_entries.id(e).form.post(e).toPromise().then(t=>this.halEditing.edit(e,t))}}St.\u0275fac=function(e){return new(e||St)(n.lc(O.b),n.lc(n.A),n.lc(H.a),n.lc(C.a),n.lc(mt.a),n.lc(y.a))},St.\u0275prov=n.Xb({token:St,factory:St.\u0275fac});var _t=i("xQCb"),Ot=i("PvNn"),It=i("buwf");function Tt(e,t){if(1&e){const e=n.ic();n.hc(0,"button",4),n.pc("click",(function(){n.Lc(e);return n.rc().addEventToday()})),n.cc(1,"op-icon",5),n.cc(2,"span",6),n.gc()}if(2&e){const e=n.rc();n.Qb("aria-label",e.text.logTime),n.Pb(2),n.wc("textContent",e.text.logTime)}}const Rt="te-calendar--time-entry",Et="te-calendar--add-entry",Mt="-prohibited";class Ft{constructor(e,t,i,s,r,a,c,o,l,d,u,h,p,g,f){this.states=e,this.apiV3Service=t,this.$state=i,this.element=s,this.i18n=r,this.injector=a,this.notifications=c,this.sanitizer=o,this.configuration=l,this.timezone=d,this.timeEntryEdit=u,this.timeEntryCreate=h,this.schemaCache=p,this.colors=g,this.browserDetector=f,this.static=!1,this.entries=new n.s,this.minHour=1,this.maxHour=12,this.labelIntervalHours=2,this.scaleRatio=1,this.memoizedCreateAllowed=!1,this.hiddenDays=[],this.text={logTime:this.i18n.t("js.button_log_time")},this.calendarOptions={editable:!1,locale:this.i18n.locale,fixedWeekCount:!1,headerToolbar:{right:"",center:"title",left:"prev,next today"},initialView:"timeGridWeek",firstDay:this.configuration.startOfWeek(),hiddenDays:[],contentHeight:605,slotEventOverlap:!1,slotLabelInterval:this.labelIntervalHours+":00:00",slotLabelFormat:e=>((this.maxHour-e.date.hour)/this.scaleRatio).toString(),allDaySlot:!1,displayEventTime:!1,slotMinTime:this.minHour-1+":00:00",slotMaxTime:this.maxHour+":00:00",events:this.calendarEventsFunction.bind(this),eventOverlap:e=>!e.classNames.includes(Rt),plugins:[ft.a,bt.a]}}set displayedDays(e){this.setHiddenDays(e)}ngAfterViewInit(){this.ucCalendar.getApi().setOption("eventDidMount",e=>{this.alterEventEntry(e)}),this.ucCalendar.getApi().setOption("eventWillUnmount",e=>{this.beforeEventRemove(e)}),this.ucCalendar.getApi().setOption("eventClick",e=>{this.dispatchEventClick(e)}),this.ucCalendar.getApi().setOption("eventDrop",e=>{this.moveEvent(e)})}calendarEventsFunction(e,t,i){this.fetchTimeEntries(e.start,e.end).then(i=>{this.entries.emit(i),t(this.buildEntries(i.elements,e))})}fetchTimeEntries(e,t){if(!this.memoizedTimeEntries||this.memoizedTimeEntries.start.getTime()!==e.getTime()||this.memoizedTimeEntries.end.getTime()!==t.getTime()){let i=this.apiV3Service.time_entries.list({filters:this.dmFilters(e,t),pageSize:500}).toPromise().then(e=>(this.memoizedCreateAllowed=!!e.createTimeEntry,e));this.memoizedTimeEntries={start:e,end:t,entries:i}}return this.memoizedTimeEntries.entries}buildEntries(e,t){return this.setRatio(e),this.buildTimeEntryEntries(e).concat(this.buildAuxEntries(e,t))}setRatio(e){let t=this.calculateDateSums(e),i=Math.max(...Object.values(t),0),n=this.scaleRatio;i>this.maxHour-this.minHour?this.scaleRatio=this.smallerSuitableRatio((this.maxHour-this.minHour)/i):this.scaleRatio=1,n!==this.scaleRatio&&this.ucCalendar.getApi().setOption("slotLabelFormat",e=>((this.maxHour-e.date.hour)/this.scaleRatio).toString())}buildTimeEntryEntries(e){let t={};return e.map(e=>{let i,n,s=this.timezone.toHours(e.hours)*this.scaleRatio;t[e.spentOn]?(i=t[e.spentOn].clone().subtract(s,"h"),n=t[e.spentOn].clone()):(i=We(e.spentOn).add(this.maxHour-s,"h"),n=We(e.spentOn).add(this.maxHour,"h")),t[e.spentOn]=i;this.colors.toHsl(this.entryName(e));return this.timeEntry(e,s,i,n)})}buildAuxEntries(e,t){let i=this.calculateDateSums(e),n=[];for(let s=We(t.start);s.diff(t.end,"days")<=0;s.add(1,"days")){let e=i[s.format("YYYY-MM-DD")]||0;n.push(this.sumEntry(s,e)),this.memoizedCreateAllowed&&n.push(this.addEntry(s,e))}return n}calculateDateSums(e){let t={};return e.forEach(e=>{let i=this.timezone.toHours(e.hours);t[e.spentOn]?t[e.spentOn]+=i:t[e.spentOn]=i}),t}timeEntry(e,t,i,n){const s=this.colors.toHsl(this.entryName(e));let r=[Rt],a=n.diff(i,"m");return a<40&&r.push("-no-fadeout"),{title:a<20?"":this.entryName(e),startEditable:!!e.update,start:i.format(),end:n.format(),backgroundColor:s,borderColor:s,classNames:r,entry:e}}sumEntry(e,t){return{start:e.clone().add(this.maxHour-Math.min(t*this.scaleRatio,this.maxHour-.5)-.5,"h").format(),end:e.clone().add(this.maxHour-Math.min((t+.05)*this.scaleRatio,this.maxHour-.5),"h").format(),classNames:"te-calendar--day-sum",rendering:"background",startEditable:!1,sum:this.i18n.t("js.units.hour",{count:this.formatNumber(t)})}}addEntry(e,t){let i=[Et];return t>=24&&i.push(Mt),{start:e.clone().format(),end:e.clone().add(this.maxHour-Math.min(t*this.scaleRatio,this.maxHour-1)-.5,"h").format(),rendering:"background",classNames:i}}dmFilters(e,t){return[["spentOn","<>d",[We(e).format("YYYY-MM-DD"),We(t).subtract(1,"d").format("YYYY-MM-DD")]],["user_id","=",["me"]]]}dispatchEventClick(e){e.event.extendedProps.entry?this.editEvent(e.event.extendedProps.entry):e.el.classList.contains(Et)&&!e.el.classList.contains(Mt)&&this.addEvent(We(e.event.start))}editEvent(e){this.timeEntryEdit.edit(e).then(e=>{this.updateEventSet(e.entry,e.action)}).catch(()=>{})}moveEvent(e){let t=e.event.extendedProps.entry;t.spentOn=We(e.event.end).format("YYYY-MM-DD"),this.schemaCache.ensureLoaded(t).then(i=>{this.apiV3Service.time_entries.id(t).patch(t,i).subscribe(e=>this.updateEventSet(e,"update"),t=>{this.notifications.handleRawError(t),e.revert()})})}addEventToday(){this.addEvent(We(new Date))}addEvent(e){this.memoizedCreateAllowed&&this.timeEntryCreate.create(e).then(e=>{this.updateEventSet(e.entry,e.action)}).catch(()=>{})}updateEventSet(e,t){this.memoizedTimeEntries.entries.then(i=>{let n=i.elements.findIndex(t=>t.id===e.id);switch(t){case"update":i.elements[n]=e;break;case"destroy":i.elements.splice(n,1);break;case"create":this.apiV3Service.time_entries.cache.updateFor(e),i.elements.push(e)}this.ucCalendar.getApi().refetchEvents()})}alterEventEntry(e){this.appendAddIcon(e),this.appendSum(e),e.event.extendedProps.entry&&(this.addTooltip(e),this.prependDuration(e),this.appendFadeout(e))}appendAddIcon(e){if(!e.el.classList.contains(Et))return;let t=document.createElement("div");t.classList.add("te-calendar--add-icon"),t.innerText="+",e.el.append(t)}appendSum(e){e.event.extendedProps.sum&&(e.el.innerHTML=e.event.extendedProps.sum)}addTooltip(e){this.browserDetector.isMobile||jQuery(e.el).tooltip({content:this.tooltipContentString(e.event.extendedProps.entry),items:".fc-event",close:function(){jQuery(".ui-helper-hidden-accessible").remove()},track:!0})}removeTooltip(e){jQuery(e.el).tooltip("disable")}prependDuration(e){let t=e.event.extendedProps.entry;if(this.timezone.toHours(t.hours)<.5)return;let i=this.timezone.formattedDuration(t.hours);jQuery(e.el).find(".fc-event-title").prepend(`<div class="fc-duration">${i}</div>`)}appendFadeout(e){let t=e.event.extendedProps.entry;if(this.timezone.toHours(t.hours)<.5)return;let i=jQuery(e.el),n=jQuery('<div class="fc-fadeout"></div>'),s=this.colors.toHsla(this.entryName(t),0),r=this.colors.toHsla(this.entryName(t),100);n.css("background",`-webkit-linear-gradient(${s} 0%, ${r} 100%`),["-moz-linear-gradient","-o-linear-gradient","linear-gradient","-ms-linear-gradient"].forEach(e=>{n.css("background-image",`${e}(${s} 0%, ${r} 100%`)}),i.append(n)}beforeEventRemove(e){e.event.extendedProps.entry&&this.removeTooltip(e)}entryName(e){let t=e.project.name;return e.workPackage&&(t+=" - "+this.workPackageName(e)),t||"-"}workPackageName(e){return`#${e.workPackage.idFromLink}: ${e.workPackage.name}`}tooltipContentString(e){return`\n        <ul class="tooltip--map">\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.project")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e.project.name)}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.work_package")}:</span>\n            <span class="tooltip--map--value">${e.workPackage?this.sanitizedValue(this.workPackageName(e)):this.i18n.t("js.placeholders.default")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.activity")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(e.activity.name)}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.hours")}:</span>\n            <span class="tooltip--map--value">${this.timezone.formattedDuration(e.hours)}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.comment")}:</span>\n            <span class="tooltip--map--value">${e.comment.raw||this.i18n.t("js.placeholders.default")}</span>\n          </li>\n        `}sanitizedValue(e){return this.sanitizer.sanitize(n.V.HTML,e)}formatNumber(e){return this.i18n.toNumber(e,{precision:2})}smallerSuitableRatio(e){for(let t=this.labelIntervalHours+1;t<100;t++){let i=this.labelIntervalHours/t;if(e>=i)return i}return 1}setHiddenDays(e){let t=Array.from(e,(e,t)=>e?null:(t+1)%7).filter(e=>null!==e);this.calendarOptions=Object.assign(Object.assign({},this.calendarOptions),{hiddenDays:t})}}Ft.\u0275fac=function(e){return new(e||Ft)(n.bc(u.a),n.bc(H.a),n.bc(Ue.StateService),n.bc(n.q),n.bc(y.a),n.bc(n.A),n.bc(ee.a),n.bc(D.b),n.bc(Q.a),n.bc(ot.a),n.bc(St),n.bc(_t.a),n.bc(it.a),n.bc(Ot.a),n.bc(It.a))},Ft.\u0275cmp=n.Vb({type:Ft,selectors:[["te-calendar"]],viewQuery:function(e,t){var i;(1&e&&n.ad(ze.a,!0),2&e)&&(n.Ic(i=n.qc())&&(t.ucCalendar=i.first))},inputs:{projectIdentifier:"projectIdentifier",static:"static",displayedDays:"displayedDays"},outputs:{entries:"entries"},features:[n.Ob([St,_t.a,mt.a])],decls:4,vars:3,consts:[[1,"te-calendar--container","loading-indicator--location",2,"position","relative"],["class","button te-calendar--create-button",3,"click",4,"ngIf"],[3,"options"],["ucCalendar",""],[1,"button","te-calendar--create-button",3,"click"],["icon-classes","button--icon icon-log_time"],["aria-hidden","true",1,"button--text",3,"textContent"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.Tc(1,Tt,3,2,"button",1),n.cc(2,"full-calendar",2,3),n.gc()),2&e&&(n.Qb("data-indicator-name","table"),n.Pb(1),n.wc("ngIf",t.memoizedCreateAllowed),n.Pb(1),n.wc("options",t.calendarOptions))},directives:[oe.q,ze.a,yt.a],styles:["te-calendar full-calendar{overflow-x:auto}te-calendar full-calendar .fc-view{min-width:800px}te-calendar full-calendar thead{display:table-footer-group}te-calendar full-calendar th.fc-day,te-calendar full-calendar th.fc-timegrid-axis{border-bottom:none}te-calendar full-calendar table.fc-scrollgrid.fc-scrollgrid-liquid{border-left:none}te-calendar full-calendar .fc-bgevent,te-calendar full-calendar .fc-event{border-radius:0;margin-right:8px;margin-left:8px}te-calendar full-calendar .fc-head-container{border-color:#fff}te-calendar full-calendar .fc-day-header{padding-top:5px}te-calendar full-calendar .fc-widget-content{border-left-color:#fff}te-calendar full-calendar .fc-widget-content .fc-day{border-left:0;border-right:0}te-calendar full-calendar .fc-timeGrid-view .fc-day-grid .fc-row{min-height:1em}te-calendar full-calendar .fc-timeGrid-view .fc-day-grid .fc-row .fc-content-skeleton{padding-bottom:0}te-calendar full-calendar .fc-timegrid-slot.fc-timegrid-slot-minor{border-top:0}te-calendar full-calendar .te-calendar--day-sum{border:none;background-color:initial;color:#000;text-align:center;font-size:.875em;font-weight:700;line-height:22px;opacity:1;cursor:default}te-calendar full-calendar .te-calendar--add-entry{text-align:center;font-weight:700;opacity:0;background:none;border:none;display:flex;align-items:center}te-calendar full-calendar .te-calendar--add-entry:hover{opacity:1;transition:opacity 1s ease;background:#eaeaea}te-calendar full-calendar .te-calendar--add-entry .te-calendar--add-icon{color:#000;width:100%;font-weight:400;font-size:1.5rem}te-calendar full-calendar .te-calendar--add-entry.-prohibited{cursor:not-allowed}te-calendar full-calendar .te-calendar--add-entry.-prohibited .te-calendar--add-icon{display:none}te-calendar full-calendar .te-calendar--time-entry .fc-content{height:100%}te-calendar full-calendar .te-calendar--time-entry .fc-fadeout{position:relative;bottom:2em;height:2em;z-index:5}te-calendar full-calendar .te-calendar--time-entry.-no-fadeout .fc-fadeout{display:none}te-calendar full-calendar .fc-duration{border-right:1px solid #fff;border-bottom:1px solid #fff;margin-left:-1px;padding-left:1px;display:inline-block;margin-right:5px;padding-right:5px;font-weight:700}te-calendar .te-calendar--create-button{position:absolute;right:0;top:6px;margin-right:0}"],encapsulation:2,changeDetection:0});class At extends Pe.a{constructor(e,t,i,n,s){super(i,e),this.injector=e,this.timezone=t,this.i18n=i,this.pathHelper=n,this.cdr=s,this.entries=[]}ngOnInit(){this.displayedDays=this.resource.options.days}updateEntries(e){this.entries=e.elements,this.cdr.detectChanges()}get total(){let e=this.entries.reduce((e,t)=>e+this.timezone.toHours(t.hours),0);return e>0?this.i18n.t("js.units.hour",{count:this.formatNumber(e)}):this.i18n.t("js.placeholders.default")}get isEditable(){return!1}updateConfiguration(e){this.resourceChanged.emit(this.setChangesetOptions(e)),this.displayedDays=[...e.days]}formatNumber(e){return this.i18n.toNumber(e,{precision:2})}}At.\u0275fac=function(e){return new(e||At)(n.bc(n.A),n.bc(ot.a),n.bc(y.a),n.bc(q.a),n.bc(n.i))},At.\u0275cmp=n.Vb({type:At,selectors:[["ng-component"]],features:[n.Mb],decls:8,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource","onConfigured"],[3,"displayedDays","entries"],[1,"total-hours"],[3,"textContent"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.hc(1,"widget-time-entries-current-user-menu",1),n.pc("onConfigured",(function(e){return t.updateConfiguration(e)})),n.gc(),n.gc(),n.hc(2,"te-calendar",2),n.pc("entries",(function(e){return t.updateEntries(e)})),n.gc(),n.fc(3),n.hc(4,"div",3),n.hc(5,"p"),n.Vc(6,"Total: "),n.cc(7,"span",4),n.gc(),n.gc(),n.ec()),2&e&&(n.wc("name",t.widgetName)("editable",t.isEditable),n.Pb(1),n.wc("resource",t.resource),n.Pb(1),n.wc("displayedDays",t.displayedDays),n.Pb(5),n.wc("textContent",t.total))},directives:[Ae,gt,Ft],encapsulation:2,changeDetection:0});class Lt{constructor(e){this.Hook=e}get registered(){let e=[];return _.each(this.Hook.call("gridWidgets"),t=>{e=e.concat(t)}),e}}Lt.\u0275fac=function(e){return new(e||Lt)(n.lc(m.a))},Lt.\u0275prov=n.Xb({token:Lt,factory:Lt.\u0275fac});var Dt=i("Dp3K"),Vt=i("p5fp"),qt=i("qvi4"),$t=i("eaMR");class Nt extends Dt.a{set loadingIndicator(e){this.loadingIndicatorService.indicator("calendar-entry").promise=e}refresh(e,t){return this.loadingIndicator=this.wpListService.loadCurrentQueryFromParams(this.projectIdentifier)}}Nt.\u0275fac=function(e){return Bt(e||Nt)},Nt.\u0275cmp=n.Vb({type:Nt,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(at,!0),2&e)&&(n.Ic(i=n.qc())&&(t.calendarElement=i.first))},features:[n.Mb],decls:13,vars:2,consts:[["data-indicator-name","calendar-entry",1,"work-packages-calendar-view--container","loading-indicator--location"],[1,"toolbar-container","-editable"],[1,"toolbar"],[1,"title-container"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-mobile"],[3,"projectIdentifier"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.hc(3,"div",3),n.hc(4,"h2"),n.Vc(5),n.gc(),n.gc(),n.hc(6,"ul",4),n.hc(7,"li",5),n.cc(8,"wp-filter-button"),n.gc(),n.hc(9,"li",5),n.cc(10,"zen-mode-toggle-button"),n.gc(),n.gc(),n.gc(),n.gc(),n.cc(11,"filter-container"),n.cc(12,"wp-calendar",6),n.gc()),2&e&&(n.Pb(5),n.Xc(" ",t.I18n.t("js.calendar.title")," "),n.Pb(7),n.wc("projectIdentifier",t.projectIdentifier))},directives:[Vt.a,qt.a,$t.a,at],encapsulation:2});const Bt=n.jc(Nt);var zt=i("0loS");class Ht{}Ht.\u0275mod=n.Zb({type:Ht}),Ht.\u0275inj=n.Yb({factory:function(e){return new(e||Ht)},providers:[St],imports:[[f.a,g.a]]});const Qt=[{name:"work-packages.calendar",url:"/calendar",component:Nt,reloadOnSearch:!1,data:{bodyClasses:"router--work-packages-calendar",menuItem:"calendar-menu-item",parent:"work-packages"}}];class Wt{}Wt.\u0275mod=n.Zb({type:Wt}),Wt.\u0275inj=n.Yb({factory:function(e){return new(e||Wt)},imports:[[f.a,zt.UIRouterModule.forChild({states:Qt}),ve.a,Ht,g.a,ze.b]]});var Xt=i("8h6p");function Ut(e,t){if(1&e&&n.cc(0,"no-results",5),2&e){const e=n.rc();n.wc("title",e.text.noResults)}}function Gt(e,t){if(1&e&&(n.fc(0),n.hc(1,"h4",6),n.cc(2,"a",7),n.gc(),n.hc(3,"p",8),n.cc(4,"em",9),n.gc(),n.cc(5,"div",10),n.ec()),2&e){const e=t.$implicit,i=n.rc();n.Pb(2),n.wc("href",i.documentPath(e),n.Oc)("textContent",e.title),n.Pb(2),n.wc("textContent",i.documentCreated(e)),n.Pb(1),n.wc("innerHtml",i.documentDescription(e),n.Mc)}}class Yt extends Pe.a{constructor(e,t,i,n,s,r,a,c,o){super(n,a),this.halResource=e,this.pathHelper=t,this.apiV3Service=i,this.i18n=n,this.timezone=s,this.domSanitizer=r,this.injector=a,this.currentProject=c,this.cdr=o,this.text={noResults:this.i18n.t("js.grid.widgets.documents.no_results")},this.entries=[],this.entriesLoaded=!1}ngOnInit(){this.halResource.get(this.documentsUrl).toPromise().then(e=>{this.entries=e.elements,this.entriesLoaded=!0,this.cdr.detectChanges()})}get isEditable(){return!1}documentPath(e){return`${this.pathHelper.appBasePath}/documents/${e.id}`}documentCreated(e){return this.timezone.formattedDatetime(e.createdAt)}documentDescription(e){return this.domSanitizer.sanitize(n.V.HTML,e.description.html)}get noEntries(){return!this.entries.length&&this.entriesLoaded}get documentsUrl(){let e=JSON.stringify([["updated_at","desc"]]),t=this.apiV3Service.documents.toPath()+`?sortBy=${e}&pageSize=10`;if(this.currentProject.id){t=t+"&filters="+JSON.stringify([{project_id:{operator:"=",values:[this.currentProject.id.toString()]}}])}return t}}Yt.\u0275fac=function(e){return new(e||Yt)(n.bc(C.a),n.bc(q.a),n.bc(H.a),n.bc(y.a),n.bc(ot.a),n.bc(D.b),n.bc(n.A),n.bc(xe.a),n.bc(n.i))},Yt.\u0275cmp=n.Vb({type:Yt,selectors:[["ng-component"]],features:[n.Mb],decls:5,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"title"],[1,"document-category-elements--header"],[3,"href","textContent"],[1,"document-category-elements--date"],[3,"textContent"],[1,"wiki","grid--widget-limited-text","op-uc-container",3,"innerHtml"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.cc(1,"widget-menu",1),n.gc(),n.hc(2,"div",2),n.Tc(3,Ut,1,1,"no-results",3),n.Tc(4,Gt,6,4,"ng-container",4),n.gc()),2&e&&(n.wc("name",t.widgetName)("editable",t.isEditable),n.Pb(1),n.wc("resource",t.resource),n.Pb(2),n.wc("ngIf",t.noEntries),n.Pb(1),n.wc("ngForOf",t.entries))},directives:[Ae,$e,oe.q,oe.p,Xt.a],encapsulation:2,changeDetection:0});var Kt=i("u8Ab");function Zt(e,t){if(1&e&&n.cc(0,"no-results",6),2&e){const e=n.rc();n.wc("title",e.text.noResults)}}function Jt(e,t){if(1&e&&n.cc(0,"user-avatar",13),2&e){const e=n.rc().$implicit;n.wc("user",e.author)}}function ei(e,t){if(1&e&&(n.hc(0,"div",14),n.cc(1,"span",15),n.gc()),2&e){const e=n.rc().$implicit,t=n.rc();n.Pb(1),n.wc("innerHTML",t.text.addedBy(e),n.Mc)}}function ti(e,t){if(1&e&&n.cc(0,"p",16),2&e){const e=n.rc().$implicit;n.wc("textContent",e.summary)}}function ii(e,t){if(1&e&&(n.hc(0,"li",7),n.hc(1,"div",8),n.Tc(2,Jt,1,1,"user-avatar",9),n.hc(3,"div"),n.cc(4,"a",10),n.Vc(5,": "),n.cc(6,"a",10),n.gc(),n.Tc(7,ei,2,1,"div",11),n.hc(8,"div"),n.Tc(9,ti,1,1,"p",12),n.gc(),n.gc(),n.gc()),2&e){const e=t.$implicit,i=n.rc();n.Pb(2),n.wc("ngIf",e.author),n.Pb(2),n.wc("href",i.newsProjectPath(e),n.Oc)("textContent",i.newsProjectName(e)),n.Pb(2),n.wc("href",i.newsPath(e),n.Oc)("textContent",e.title),n.Pb(1),n.wc("ngIf",e.author),n.Pb(2),n.wc("ngIf",e.summary)}}class ni extends Pe.a{constructor(e,t,i,n,s,r,a){super(t,i),this.pathHelper=e,this.i18n=t,this.injector=i,this.timezone=n,this.currentProject=s,this.apiV3Service=r,this.cdr=a,this.text={at:this.i18n.t("js.grid.widgets.news.at"),noResults:this.i18n.t("js.grid.widgets.news.no_results"),addedBy:e=>this.i18n.t("js.label_added_time_by",{author:this.newsAuthorName(e),age:this.newsCreated(e),authorLink:this.newsAuthorPath(e)})},this.entries=[],this.entriesLoaded=!1}ngOnInit(){this.apiV3Service.news.list(this.newsDmParams).subscribe(e=>this.setupNews(e.elements))}setupNews(e){this.entries=e,this.entriesLoaded=!0,this.cdr.detectChanges()}get isEditable(){return!1}newsPath(e){return this.pathHelper.newsPath(e.id)}newsProjectPath(e){var t;return this.pathHelper.projectPath(null===(t=e.project)||void 0===t?void 0:t.idFromLink)}newsProjectName(e){var t;return null===(t=e.project)||void 0===t?void 0:t.name}newsAuthorName(e){var t;return null===(t=e.author)||void 0===t?void 0:t.name}newsAuthorPath(e){var t;return this.pathHelper.userPath(null===(t=e.author)||void 0===t?void 0:t.id)}newsCreated(e){return this.timezone.formattedDatetime(e.createdAt)}get noEntries(){return!this.entries.length&&this.entriesLoaded}get newsDmParams(){let e={sortBy:[["created_at","desc"]],pageSize:3};return this.currentProject.id&&(e.filters=[["project_id","=",[this.currentProject.id]]]),e}}ni.\u0275fac=function(e){return new(e||ni)(n.bc(q.a),n.bc(y.a),n.bc(n.A),n.bc(ot.a),n.bc(xe.a),n.bc(H.a),n.bc(n.i))},ni.\u0275cmp=n.Vb({type:ni,selectors:[["ng-component"]],features:[n.Mb],decls:6,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[1,"widget-box--arrow-links"],["class","-widget-box--arrow-multiline",4,"ngFor","ngForOf"],[3,"title"],[1,"-widget-box--arrow-multiline"],[1,"news-project"],["data-class-list","avatar news-author-avatar hidden-for-mobile",3,"user",4,"ngIf"],[3,"href","textContent"],["class","news-author",4,"ngIf"],["class","widget-box--additional-info",3,"textContent",4,"ngIf"],["data-class-list","avatar news-author-avatar hidden-for-mobile",3,"user"],[1,"news-author"],[3,"innerHTML"],[1,"widget-box--additional-info",3,"textContent"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.cc(1,"widget-menu",1),n.gc(),n.hc(2,"div",2),n.Tc(3,Zt,1,1,"no-results",3),n.hc(4,"ul",4),n.Tc(5,ii,10,7,"li",5),n.gc(),n.gc()),2&e&&(n.wc("name",t.widgetName)("editable",t.isEditable),n.Pb(1),n.wc("resource",t.resource),n.Pb(2),n.wc("ngIf",t.noEntries),n.Pb(2),n.wc("ngForOf",t.entries))},directives:[Ae,$e,oe.q,oe.p,Xt.a,Kt.a],encapsulation:2,changeDetection:0});var si=i("eIep");class ri{constructor(e,t){this.apiV3Service=e,this.halResourceService=t}initialize(e){return this.apiV3Service.grids.list({filters:[["scope","=",[e]]]}).toPromise().then(t=>0===t.total?this.myPageForm(e):t.elements[0])}myPageForm(e){let t={_links:{scope:{href:e}}};return this.apiV3Service.grids.form.post(t).pipe(Object(si.a)(e=>{let t=e.payload.$source,i=this.halResourceService.createHalResource(t);return 0===i.widgets.length&&(i.rowCount=1,i.columnCount=1),this.apiV3Service.grids.post(i,e.schema)})).toPromise()}}ri.\u0275fac=function(e){return new(e||ri)(n.lc(H.a),n.lc(C.a))},ri.\u0275prov=n.Xb({token:ri,factory:ri.\u0275fac});const ai=["tabInner"];class ci{onSave(){this.tabInner.onSave()}}ci.\u0275fac=function(e){return new(e||ci)},ci.\u0275cmp=n.Vb({type:ci,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(ai,!0),2&e)&&(n.Ic(i=n.qc())&&(t.tabInner=i.first))},decls:3,vars:0,consts:[["wp-isolated-query-space",""],["tabInner",""]],template:function(e,t){1&e&&(n.fc(0,0),n.cc(1,"settings-tab-inner",null,1),n.ec())},encapsulation:2});const oi=["tabInner"];class li{onSave(){this.tabInner.onSave()}}li.\u0275fac=function(e){return new(e||li)},li.\u0275cmp=n.Vb({type:li,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(oi,!0),2&e)&&(n.Ic(i=n.qc())&&(t.tabInner=i.first))},decls:3,vars:0,consts:[["wp-isolated-query-space",""],["tabInner",""]],template:function(e,t){1&e&&(n.fc(0,0),n.cc(1,"filters-tab-inner",null,1),n.ec())},encapsulation:2});class di{constructor(e,t,i){this.queryParams=e,this.chartOptions=t,this.chartType=i,this.queries=[],this.chartType=this.chartType||"horizontalBar"}static queryCreationParams(e,t){return{hidden:!0,public:t,name:e.t("js.grid.widgets.work_packages_graph.title"),showHierarchies:!1,_links:{groupBy:{href:"/api/v3/queries/group_bys/status"}}}}}class ui{constructor(e,t,i,n){this.I18n=e,this.apiv3Service=t,this.notificationService=i,this.currentProject=n,this._forms={}}persistAndReload(){return new Promise((e,t)=>{this.persistChanges().then(()=>{this.reloadQueries().then(()=>e())})})}persistChanges(){let e=this.queries.map(e=>this.saveQuery(e));return Promise.all(e)}get datasets(){return this.queries.map(e=>({groups:e.results.groups,queryProps:"",label:e.name}))}reloadQueries(){return this.configuration.queries.length=0,this.loadQueries()}ensureQueryAndLoad(){return 0===this.queryParams.length?this.createInitial().then(e=>(this.queryParams.push({id:e.id}),this.loadQueries())):this.loadQueries()}createInitial(){return this.apiv3Service.queries.form.loadWithParams({pageSize:0},void 0,this.currentProject.identifier,di.queryCreationParams(this.I18n,!!this.currentProject.identifier)).toPromise().then(([e,t])=>this.apiv3Service.queries.post(t,e).toPromise())}loadQueries(){let e=this.queryParams.map(e=>this.loadQuery(e));return Promise.all(e)}loadQuery(e){return this.apiv3Service.queries.find(Object.assign({pageSize:0},e.props),e.id,this.currentProject.identifier).toPromise().then(t=>{e.name&&(t.name=e.name),this.configuration.queries.push(t)})}saveQuery(e){return Object(w.b)(this,void 0,void 0,(function*(){return this.formFor(e).then(t=>this.apiv3Service.queries.id(e).patch(e,t).toPromise())}))}get configuration(){return this._configuration}set configuration(e){this._configuration=e,this._formsPromise=null}formFor(e){return Object(w.b)(this,void 0,void 0,(function*(){return this.loadForms().then(()=>this._forms[e.id])}))}get tabs(){let e=[{name:"graph-settings",title:this.I18n.t("js.chart.tabs.graph_settings"),componentClass:ci}],t=this.configuration.queries.map(e=>({name:e.id,title:this.I18n.t("js.work_packages.query.filters"),componentClass:li}));return e.concat(t)}loadForms(){if(!this._formsPromise){let e=this.configuration.queries.map(e=>this.apiv3Service.queries.form.load(e).toPromise().then(([t,i])=>{this._forms[e.id]=t}).catch(e=>this.notificationService.handleRawError(e)));this._formsPromise=Promise.all(e)}return this._formsPromise}get chartType(){return this._configuration.chartType}set chartType(e){this._configuration.chartType=e}get queries(){return this._configuration.queries}get chartOptions(){return this._configuration.chartOptions}get queryParams(){return this._configuration.queryParams}}ui.\u0275fac=function(e){return new(e||ui)(n.lc(y.a),n.lc(H.a),n.lc(dt.a),n.lc(xe.a))},ui.\u0275prov=n.Xb({token:ui,factory:ui.\u0275fac});var hi=i("H3ou");const pi=["tabContentOutlet"];function gi(e,t){1&e&&n.dc(0)}function fi(e,t){if(1&e&&(n.fc(0),n.Tc(1,gi,1,0,"ng-container",13),n.ec()),2&e){const e=n.rc();n.Pb(1),n.wc("ngComponentOutlet",e.prependModalComponent)("ngComponentOutletInjector",e.injector)}}const bi=function(e,t){return{selected:e,"-disabled":t}},mi=function(e){return{selected:e}};function wi(e,t){if(1&e){const e=n.ic();n.hc(0,"li",17),n.hc(1,"a",18),n.pc("click",(function(){n.Lc(e);const i=t.$implicit;return n.rc(2).switchTo(i.name)})),n.gc(),n.gc()}if(2&e){const e=t.$implicit,i=n.rc(2);n.wc("ngClass",n.Cc(4,bi,i.currentTab&&e.name===i.currentTab.name,null!=e.disableBecause)),n.Pb(1),n.wc("ngClass",n.Bc(7,mi,i.currentTab&&e.name===i.currentTab.name))("textContent",e.title),n.Qb("title",e.disableBecause||e.title)}}function vi(e,t){if(1&e&&(n.hc(0,"div",14),n.hc(1,"ul",15),n.Tc(2,wi,2,9,"li",16),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("ngForOf",e.availableTabs)}}const yi=new n.z("WpTableConfigurationModalPrependComponent");class ki extends I.a{constructor(e,t,i,n,s,r,a,c,o,l,d,u){super(e,o,d),this.locals=e,this.prependModalComponent=t,this.I18n=i,this.injector=n,this.appRef=s,this.componentFactoryResolver=r,this.loadingIndicator=a,this.notificationService=c,this.cdRef=o,this.ConfigurationService=l,this.elementRef=d,this.graphConfiguration=u,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={title:this.I18n.t("js.chart.modal_title"),closePopup:this.I18n.t("js.close_popup_title"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel")}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.loadingIndicator.indicator("modal").promise=this.graphConfiguration.loadForms().then(()=>{this.tabPortalHost=new hi.a(this.graphConfiguration.tabs,this.tabContentOutlet.nativeElement,this.componentFactoryResolver,this.appRef,this.injector);const e=this.locals.initialTab||this.availableTabs[0].name;this.switchTo(e)})}ngOnDestroy(){this.tabPortalHost.dispose()}get availableTabs(){return this.tabPortalHost.availableTabs}get currentTab(){return this.tabPortalHost.currentTab}switchTo(e){this.tabPortalHost.switchTo(e)}saveChanges(){this.tabPortalHost.activeComponents.forEach(e=>{e.onSave()}),this.configuration=this.graphConfiguration.configuration,this.service.close()}onClose(){return this.afterFocusOn.focus(),!0}get afterFocusOn(){return this.$element}}ki.\u0275fac=function(e){return new(e||ki)(n.bc(O.a),n.bc(yi,8),n.bc(y.a),n.bc(n.A),n.bc(n.f),n.bc(n.l),n.bc(lt.a),n.bc(dt.a),n.bc(n.i),n.bc(Q.a),n.bc(n.q),n.bc(ui))},ki.\u0275cmp=n.Vb({type:ki,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(pi,!0),2&e)&&(n.Ic(i=n.qc())&&(t.tabContentOutlet=i.first))},features:[n.Mb],decls:13,vars:6,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","-wide","wp-table--configuration-modal","loading-indicator--location"],[1,"op-modal--modal-header"],[3,"textContent"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[4,"ngIf"],["class","content--tabs scrollable-tabs",4,"ngIf"],[1,"tab-content"],["tabContentOutlet",""],[1,"modal--form-actions"],[1,"button","-highlight",3,"textContent","click"],[1,"button",3,"textContent","click"],[4,"ngComponentOutlet","ngComponentOutletInjector"],[1,"content--tabs","scrollable-tabs"],[1,"tabrow"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["role","button","href","",1,"tab-show",3,"ngClass","textContent","click"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.cc(3,"h3",3),n.hc(4,"a",4),n.hc(5,"i",5),n.pc("click",(function(e){return t.closeMe(e)})),n.gc(),n.gc(),n.gc(),n.Tc(6,fi,2,2,"ng-container",6),n.Tc(7,vi,3,1,"div",7),n.cc(8,"div",8,9),n.hc(10,"div",10),n.hc(11,"button",11),n.pc("click",(function(){return t.saveChanges()})),n.gc(),n.hc(12,"button",12),n.pc("click",(function(e){return t.closeMe(e)})),n.gc(),n.gc(),n.gc(),n.gc()),2&e&&(n.Pb(3),n.wc("textContent",t.text.title),n.Pb(2),n.Qb("title",t.text.closePopup),n.Pb(1),n.wc("ngIf",!!t.prependModalComponent),n.Pb(1),n.wc("ngIf",!!t.tabPortalHost),n.Pb(4),n.wc("textContent",t.text.applyButton),n.Pb(1),n.wc("textContent",t.text.cancelButton))},directives:[oe.q,oe.o,Ce.a,oe.p,oe.n],encapsulation:2});class Ci extends De{constructor(e,t,i,s,r){super(i,s,r),this.injector=e,this.opModalService=t,this.i18n=i,this.remove=s,this.layout=r,this.onConfigured=new n.s,this.menuItemList=[this.removeItem,this.configureItem]}get configureItem(){return{linkText:this.i18n.t("js.toolbar.settings.configure_view"),onClick:()=>(this.opModalService.show(this.configurationComponent,this.injector,this.locals).closingEvent.subscribe(e=>{this.onConfigured.emit(e.configuration)}),!0)}}get locals(){return{}}}function ji(e,t){if(1&e&&n.cc(0,"icon-triggered-context-menu",1),2&e){const e=n.rc();n.wc("menu-items",e.menuItems)}}Ci.\u0275fac=function(e){return new(e||Ci)(n.bc(n.A),n.bc(O.b),n.bc(y.a),n.bc(Le),n.bc(Re))},Ci.\u0275dir=n.Wb({type:Ci,outputs:{onConfigured:"onConfigured"},features:[n.Mb]});class Pi extends Ci{constructor(){super(...arguments),this.configurationComponent=ki}}Pi.\u0275fac=function(e){return xi(e||Pi)},Pi.\u0275cmp=n.Vb({type:Pi,selectors:[["widget-wp-graph-menu"]],features:[n.Mb],decls:1,vars:1,consts:[[3,"menu-items",4,"ngIf"],[3,"menu-items"]],template:function(e,t){1&e&&n.Tc(0,ji,1,1,"icon-triggered-context-menu",0),2&e&&n.wc("ngIf",t.hasMenu)},directives:[oe.q,Ve.a],encapsulation:2});const xi=n.jc(Pi);var Si=i("LPYB");function _i(e,t){if(1&e&&n.cc(0,"canvas",4),2&e){const e=n.rc();n.wc("datasets",e.chartData)("labels",e.chartLabels)("chartType",e.chartType)("options",e.chartOptions)}}function Oi(e,t){if(1&e&&n.cc(0,"no-results",5),2&e){const e=n.rc();n.wc("title",e.text.noResults)}}const Ii=function(e){return{height:e}};class Ti{constructor(e){this.i18n=e,this.chartType="horizontalBar",this.error=null,this.chartHeight="100%",this.chartLabels=[],this.chartData=[],this.initialized=!1,this.text={noResults:this.i18n.t("js.work_packages.no_results.title")}}ngOnChanges(e){e.datasets?(this.setChartOptions(),this.updateChartData(),e.datasets.firstChange||(this.initialized=!0)):e.chartType&&this.setChartOptions()}updateChartData(){let e=_.uniq(this.datasets.reduce((e,t)=>{let i=(t.groups||[]).map(e=>e.value);return e.concat(i)},[])),t=this.datasets.map(t=>{let i=(t.groups||[]).reduce((e,t)=>(e[t.value]=t.count,e),{});return{label:t.label,data:e.map(e=>i[e]||0)}});e=e.map(e=>e||this.i18n.t("js.placeholders.default")),this.setHeight(),this.chartLabels.length=0,this.chartLabels.push(...e),this.chartData.length=0,this.chartData.push(...t)}setChartOptions(){let e={responsive:!0,maintainAspectRatio:!1,legend:{display:this.datasets.length>1},plugins:{datalabels:{align:"bar"===this.chartType?"top":"center"}}},t={scales:{}};"horizontalBar"!==this.chartType&&"bar"!==this.chartType||this.setChartAxesValues(t),this.chartOptions=Object.assign({},e,t,this.inputChartOptions)}get hasDataToDisplay(){return this.chartData.length>0&&this.chartData.some(e=>e.data.length>0)}setHeight(){if("horizontalBar"===this.chartType&&this.datasets&&this.datasets[0]){let e=[];this.datasets.forEach(t=>t.groups.forEach(t=>{e.includes(t.value)||e.push(t.value)}));let t=40*e.length;this.datasets.length>1&&(t+=40),t+=40,this.chartHeight=t+"px"}else this.chartHeight="100%"}setChartAxesValues(e){let t=[{stacked:!0,ticks:{callback:e=>Math.floor(e)===e?e:null}}],i=[{stacked:!0}];e.scales&&("bar"===this.chartType?(e.scales.yAxes=t,e.scales.xAxes=i):"horizontalBar"===this.chartType&&(e.scales.xAxes=t,e.scales.yAxes=i))}}Ti.\u0275fac=function(e){return new(e||Ti)(n.bc(y.a))},Ti.\u0275cmp=n.Vb({type:Ti,selectors:[["wp-embedded-graph"]],inputs:{datasets:"datasets",inputChartOptions:["chartOptions","inputChartOptions"],chartType:"chartType"},features:[n.Nb],decls:4,vars:5,consts:[[1,"work-packages-embedded-view--container","loading-indicator--location",3,"ngStyle"],["graphContainer",""],["baseChart","",3,"datasets","labels","chartType","options",4,"ngIf"],[3,"title",4,"ngIf"],["baseChart","",3,"datasets","labels","chartType","options"],[3,"title"]],template:function(e,t){1&e&&(n.hc(0,"div",0,1),n.Tc(2,_i,1,4,"canvas",2),n.Tc(3,Oi,1,1,"no-results",3),n.gc()),2&e&&(n.wc("ngStyle",n.Bc(3,Ii,t.chartHeight)),n.Pb(2),n.wc("ngIf",t.hasDataToDisplay),n.Pb(1),n.wc("ngIf",!t.hasDataToDisplay&&t.initialized))},directives:[oe.t,oe.q,Si.a,Xt.a],styles:[".work-packages-embedded-view--container[_ngcontent-%COMP%]{height:100%;max-height:500px;position:relative}"]});class Ri extends Pe.a{constructor(e,t,i,n){super(e,t),this.i18n=e,this.injector=t,this.cdr=i,this.graphConfiguration=n,this.datasets=[]}ngOnInit(){this.initializeConfiguration(),this.loadQueriesInitially()}set chartType(e){this.resource.options.chartType=e}updateGraph(e){this.graphConfiguration.persistAndReload().then(()=>{if(this.repaint(),this.resource.options.chartType!==this.graphConfiguration.chartType){let e=this.setChangesetOptions({chartType:this.graphConfiguration.chartType});this.resourceChanged.emit(e)}})}repaint(){this.datasets=this.graphConfiguration.datasets,this.cdr.detectChanges()}initializeConfiguration(){let e=[];this.resource.options.queryId&&e.push({id:this.resource.options.queryId}),this.graphConfiguration.configuration=new di(e,this.resource.options.chartOptions,this.resource.options.chartType)}loadQueriesInitially(){this.graphConfiguration.ensureQueryAndLoad().then(()=>{if(!this.resource.options.queryId){let e=this.setChangesetOptions({queryId:this.graphConfiguration.queryParams[0].id});this.resourceChanged.emit(e)}this.repaint()})}get chartOptions(){return this.graphConfiguration.chartOptions}get chartType(){return this.graphConfiguration.chartType}}Ri.\u0275fac=function(e){return new(e||Ri)(n.bc(y.a),n.bc(n.A),n.bc(n.i),n.bc(ui))},Ri.\u0275cmp=n.Vb({type:Ri,selectors:[["widget-wp-graph"]],features:[n.Ob([ui]),n.Mb],decls:3,vars:4,consts:[[3,"name","onRenamed"],["slot","menu",3,"resource","onConfigured"],[1,"grid--widget-content","-no-overflow",3,"datasets","chartType"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.pc("onRenamed",(function(e){return t.renameWidget(e)})),n.hc(1,"widget-wp-graph-menu",1),n.pc("onConfigured",(function(e){return t.updateGraph(e)})),n.gc(),n.gc(),n.cc(2,"wp-embedded-graph",2)),2&e&&(n.wc("name",t.widgetName),n.Pb(1),n.wc("resource",t.resource),n.Pb(1),n.wc("datasets",t.datasets)("chartType",t.chartType))},directives:[Ae,Pi,Ti],styles:["wp-embedded-table[_ngcontent-%COMP%]{overflow:auto}"],changeDetection:0});var Ei=i("pL6k"),Mi=i("zP0r"),Fi=i("sngl");function Ai(e,t){if(1&e&&n.cc(0,"icon-triggered-context-menu",1),2&e){const e=n.rc();n.wc("menu-items",e.menuItems)}}class Li extends Ci{constructor(){super(...arguments),this.configurationComponent=Fi.a}}Li.\u0275fac=function(e){return Di(e||Li)},Li.\u0275cmp=n.Vb({type:Li,selectors:[["widget-wp-table-menu"]],features:[n.Mb],decls:1,vars:1,consts:[[3,"menu-items",4,"ngIf"],[3,"menu-items"]],template:function(e,t){1&e&&n.Tc(0,Ai,1,1,"icon-triggered-context-menu",0),2&e&&n.wc("ngIf",t.hasMenu)},directives:[oe.q,Ve.a],encapsulation:2});const Di=n.jc(Li);var Vi=i("72oW");function qi(e,t){if(1&e&&n.cc(0,"wp-embedded-table",3),2&e){const e=n.rc();n.wc("queryId",e.queryId)("configuration",e.configuration)}}class $i extends Pe.a{constructor(e,t,i,n,s,r){super(e,t),this.i18n=e,this.injector=t,this.urlParamsHelper=i,this.state=n,this.querySpace=s,this.apiV3Service=r,this.inFlight=!1,this.configuration={actionsColumnEnabled:!1,columnMenuEnabled:!1,hierarchyToggleEnabled:!0,contextMenuEnabled:!1}}ngOnInit(){this.resource.options.queryId?this.queryId=this.resource.options.queryId:this.createInitial().then(e=>{let t=this.setChangesetOptions({queryId:e.id});this.resourceChanged.emit(t),this.queryId=e.id}),this.query$=this.querySpace.query.values$(),this.query$.pipe(Object(Mi.a)(2),this.untilDestroyed()).subscribe(e=>{this.ensureFormAndSaveQuery(e)})}get widgetName(){return this.resource.options.name}static get identifier(){return"work_packages_table"}ensureFormAndSaveQuery(e){this.queryForm?this.saveQuery(e,this.queryForm):this.apiV3Service.queries.form.load(e).subscribe(([t,i])=>{this.queryForm=t,this.saveQuery(e,t)})}saveQuery(e,t){this.inFlight=!0,this.apiV3Service.queries.id(e).patch(e,this.queryForm).subscribe(()=>this.inFlight=!1,()=>this.inFlight=!1)}createInitial(){const e=this.state.params.projectPath;let t=this.resource.options.queryProps,i=Object.assign({pageSize:0},t);return this.apiV3Service.queries.form.loadWithParams(i,void 0,e,this.queryCreationParams()).toPromise().then(([e,t])=>this.apiV3Service.queries.post(t,e).toPromise().then(e=>(delete this.resource.options.queryProps,e)))}queryCreationParams(){return{hidden:!0,public:!!this.state.params.projectPath}}}$i.\u0275fac=function(e){return new(e||$i)(n.bc(y.a),n.bc(n.A),n.bc(Ei.a),n.bc(Ue.StateService),n.bc(He.a),n.bc(H.a))},$i.\u0275cmp=n.Vb({type:$i,selectors:[["widget-wp-table"]],features:[n.Mb],decls:3,vars:3,consts:[[3,"name","onRenamed"],["slot","menu",3,"resource"],[3,"queryId","configuration",4,"ngIf"],[3,"queryId","configuration"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.pc("onRenamed",(function(e){return t.renameWidget(e)})),n.cc(1,"widget-wp-table-menu",1),n.gc(),n.Tc(2,qi,1,2,"wp-embedded-table",2)),2&e&&(n.wc("name",t.widgetName),n.Pb(1),n.wc("resource",t.resource),n.Pb(1),n.wc("ngIf",t.queryId))},directives:[Ae,Li,oe.q,Vi.a],styles:["wp-embedded-table[_ngcontent-%COMP%]{overflow:auto}"],changeDetection:0});class Ni extends Pe.a{onResourceChanged(e){this.resourceChanged.emit(e)}}Ni.\u0275fac=function(e){return Bi(e||Ni)},Ni.\u0275cmp=n.Vb({type:Ni,selectors:[["ng-component"]],features:[n.Mb],decls:2,vars:1,consts:[["wp-isolated-query-space",""],[3,"resource","resourceChanged"]],template:function(e,t){1&e&&(n.fc(0,0),n.hc(1,"widget-wp-table",1),n.pc("resourceChanged",(function(e){return t.onResourceChanged(e)})),n.gc(),n.ec()),2&e&&(n.Pb(1),n.wc("resource",t.resource))},directives:[Be.a,$i],styles:["widget-wp-table[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}"]});const Bi=n.jc(Ni);var zi=i("l08T"),Hi=i("+oAL");class Qi{constructor(e,t,i){this.I18n=e,this.wpStatesInitialization=t,this.wpGraphConfiguration=i}initializeQuerySpace(){return this.wpGraphConfiguration.formFor(this.query).then(e=>{this.wpStatesInitialization.initialize(this.query,this.query.results),this.wpStatesInitialization.updateStatesFromForm(this.query,e)})}}var Wi=i("70hh");function Xi(e,t){if(1&e){const e=n.ic();n.hc(0,"query-filters",1),n.pc("filtersChanged",(function(t){n.Lc(e);return n.rc().filters=t})),n.gc()}if(2&e){const e=n.rc();n.wc("filters",e.filters)}}class Ui extends Qi{constructor(e,t,i,n,s){super(e,n,s),this.I18n=e,this.wpTableFilters=t,this.wpFiltersService=i,this.wpStatesInitialization=n,this.wpGraphConfiguration=s,this.filters=[],this.text={multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect")}}ngOnInit(){this.initializeQuerySpace().then(()=>{this.wpTableFilters.onReady().then(()=>{this.filters=this.wpTableFilters.current})})}onSave(){this.filters&&(this.wpTableFilters.replaceIfComplete(this.filters),this.wpTableFilters.applyToQuery(this.wpGraphConfiguration.queries[0]))}get query(){return this.wpGraphConfiguration.queries[0]}}Ui.\u0275fac=function(e){return new(e||Ui)(n.bc(y.a),n.bc(Qe.a),n.bc(zi.a),n.bc(Hi.a),n.bc(ui))},Ui.\u0275cmp=n.Vb({type:Ui,selectors:[["filters-tab-inner"]],features:[n.Mb],decls:1,vars:1,consts:[[3,"filters","filtersChanged",4,"ngIf"],[3,"filters","filtersChanged"]],template:function(e,t){1&e&&n.Tc(0,Xi,1,1,"query-filters",0),2&e&&n.wc("ngIf",!!t.filters)},directives:[oe.q,Wi.a],encapsulation:2});var Gi=i("AeZM");function Yi(e,t){if(1&e&&n.cc(0,"option",9),2&e){const e=t.$implicit;n.wc("ngValue",e)("textContent",e.name)}}function Ki(e,t){if(1&e&&n.cc(0,"option",9),2&e){const e=t.$implicit;n.wc("ngValue",e)("textContent",e.label)}}const Zi=function(){return{standalone:!0}};class Ji extends Qi{constructor(e,t,i,n){super(e,i,n),this.I18n=e,this.wpTableGroupBy=t,this.wpStatesInitialization=i,this.wpGraphConfiguration=n,this.availableGroups=[],this.text={group_by:this.I18n.t("js.chart.axis_criteria"),chart_type:this.I18n.t("js.chart.type")}}onSave(){this.wpGraphConfiguration.chartType=this.currentChartType.identifier,this.wpGraphConfiguration.queries.forEach(e=>{this.wpTableGroupBy.applyToQuery(e)})}get currentGroup(){return this.wpTableGroupBy.current}set currentGroup(e){this.wpTableGroupBy.update(e)}ngOnInit(){this.initializeQuerySpace().then(()=>{this.wpTableGroupBy.onReady().then(()=>{this.initializeAvailableGroups(),this.initializeAvailableChartType()})})}initializeAvailableGroups(){let e=this.wpTableGroupBy.available,t=this.wpTableGroupBy.current;t&&(e=e.filter(e=>e.id!==t.id),e=e.concat(t)),this.availableGroups=_.sortBy(e,"name")}initializeAvailableChartType(){this.availableChartTypes=_.sortBy([{identifier:"horizontalBar",label:this.I18n.t("js.chart.types.horizontal_bar")},{identifier:"bar",label:this.I18n.t("js.chart.types.bar")},{identifier:"line",label:this.I18n.t("js.chart.types.line")},{identifier:"pie",label:this.I18n.t("js.chart.types.pie")},{identifier:"doughnut",label:this.I18n.t("js.chart.types.doughnut")},{identifier:"radar",label:this.I18n.t("js.chart.types.radar")},{identifier:"polarArea",label:this.I18n.t("js.chart.types.polar_area")}],"label"),this.currentChartType=this.availableChartTypes.find(e=>e.identifier===this.wpGraphConfiguration.configuration.chartType)||this.availableChartTypes[0]}get query(){return this.wpGraphConfiguration.queries[0]}}Ji.\u0275fac=function(e){return new(e||Ji)(n.bc(y.a),n.bc(Gi.a),n.bc(Hi.a),n.bc(ui))},Ji.\u0275cmp=n.Vb({type:Ji,selectors:[["settings-tab-inner"]],features:[n.Mb],decls:14,vars:10,consts:[[1,"form"],[1,"form--field"],["for","selected_grouping",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--select-container","-middle"],["id","selected_grouping",1,"form--select",3,"ngModel","ngModelOptions","ngModelChange"],[3,"ngValue","textContent",4,"ngFor","ngForOf"],["for","selected_chart_type",1,"form--label",3,"textContent"],["id","selected_chart_type",3,"ngModel","ngModelOptions","ngModelChange"],[3,"ngValue","textContent"]],template:function(e,t){1&e&&(n.hc(0,"div"),n.hc(1,"form",0),n.hc(2,"div",1),n.cc(3,"label",2),n.hc(4,"div",3),n.hc(5,"div",4),n.hc(6,"select",5),n.pc("ngModelChange",(function(e){return t.currentGroup=e})),n.Tc(7,Yi,1,2,"option",6),n.gc(),n.gc(),n.gc(),n.gc(),n.hc(8,"div",1),n.cc(9,"label",7),n.hc(10,"div",3),n.hc(11,"div",4),n.hc(12,"select",8),n.pc("ngModelChange",(function(e){return t.currentChartType=e})),n.Tc(13,Ki,1,2,"option",6),n.gc(),n.gc(),n.gc(),n.gc(),n.gc(),n.gc()),2&e&&(n.Pb(3),n.wc("textContent",t.text.group_by),n.Pb(3),n.wc("ngModel",t.currentGroup)("ngModelOptions",n.Ac(8,Zi)),n.Pb(1),n.wc("ngForOf",t.availableGroups),n.Pb(2),n.wc("textContent",t.text.chart_type),n.Pb(3),n.wc("ngModel",t.currentChartType)("ngModelOptions",n.Ac(9,Zi)),n.Pb(1),n.wc("ngForOf",t.availableChartTypes))},directives:[l.C,l.n,l.o,l.y,l.m,l.p,oe.p,l.r,l.B],encapsulation:2});const en=["wpEmbeddedGraphMulti"],tn=["wpEmbeddedGraphSingle"];function nn(e,t){if(1&e&&(n.hc(0,"option",4),n.Vc(1),n.gc()),2&e){const e=t.$implicit;n.wc("ngValue",e.key),n.Pb(1),n.Wc(e.label)}}function sn(e,t){if(1&e&&(n.hc(0,"div",5),n.cc(1,"div",6),n.gc()),2&e){const e=n.rc();n.Pb(1),n.wc("textContent",e.error)}}function rn(e,t){if(1&e&&n.cc(0,"wp-embedded-graph",7,8),2&e){const e=n.rc();n.wc("datasets",e.datasets)("chartOptions",e.chartOptions)}}function an(e,t){if(1&e&&n.cc(0,"wp-embedded-graph",7,9),2&e){const e=n.rc();n.wc("datasets",e.datasets)("chartOptions",e.chartOptions)}}class cn{constructor(e,t,i,n){this.elementRef=e,this.I18n=t,this.graphConfigurationService=i,this.cdr=n,this.groupBy="status",this.chartOptions={maintainAspectRatio:!1},this.datasets=[],this.displayModeSingle=!0,this.error=null,this.availableGroupBy=[{label:t.t("js.work_packages.properties.category"),key:"category"},{label:t.t("js.work_packages.properties.type"),key:"type"},{label:t.t("js.work_packages.properties.status"),key:"status"},{label:t.t("js.work_packages.properties.priority"),key:"priority"},{label:t.t("js.work_packages.properties.author"),key:"author"},{label:t.t("js.work_packages.properties.assignee"),key:"assignee"}]}ngOnInit(){const e=this.elementRef.nativeElement;this.additionalFilter=JSON.parse(e.getAttribute("additional-filter")),this.setQueryProps()}setQueryProps(){this.datasets=[];let e=this.graphParams;this.graphConfigurationService.configuration=new di(e,{},"horizontalBar"),this.graphConfigurationService.reloadQueries().then(()=>{this.datasets=this.sortedDatasets(this.graphConfigurationService.datasets,e),this.cdr.detectChanges()}).catch(()=>{this.error=this.I18n.t("js.chart.errors.could_not_load"),this.cdr.detectChanges()})}get graphParams(){let e=[];return"status"===this.groupBy?(this.displayModeSingle=!0,e.push({name:this.I18n.t("js.label_all"),props:this.propsBoth})):(this.displayModeSingle=!1,e.push({name:this.I18n.t("js.label_open_work_packages"),props:this.propsOpen}),e.push({name:this.I18n.t("js.label_closed_work_packages"),props:this.propsClosed})),e}sortedDatasets(e,t){let i=t.map(e=>e.name);return e.slice().sort((e,t)=>i.indexOf(e.label)-i.indexOf(t.label))}get propsBoth(){return this.baseProps()}get propsOpen(){return this.baseProps({status:{operator:"o",values:[]}})}get propsClosed(){return this.baseProps({status:{operator:"c",values:[]}})}baseProps(e){let t=[{subprojectId:{operator:"*",values:[]}}];return e&&t.push(e),this.additionalFilter&&t.push(this.additionalFilter),{"columns[]":[],filters:JSON.stringify(t),group_by:this.groupBy,pageSize:0}}get displaySingle(){return this.displayModeSingle}get displayMulti(){return!this.displayModeSingle}get currentGraph(){return this.displaySingle?this.embeddedGraphSingle:this.embeddedGraphMulti}}cn.\u0275fac=function(e){return new(e||cn)(n.bc(n.q),n.bc(y.a),n.bc(ui),n.bc(n.i))},cn.\u0275cmp=n.Vb({type:cn,selectors:[["wp-overview-graph"]],viewQuery:function(e,t){var i;(1&e&&(n.ad(en,!0),n.ad(tn,!0)),2&e)&&(n.Ic(i=n.qc())&&(t.embeddedGraphMulti=i.first),n.Ic(i=n.qc())&&(t.embeddedGraphSingle=i.first))},inputs:{additionalFilter:"additionalFilter",groupBy:"groupBy",chartOptions:"chartOptions"},features:[n.Ob([ui])],decls:5,vars:5,consts:[[3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],["class","notification-box -error",4,"ngIf"],[3,"datasets","chartOptions",4,"ngIf"],[3,"ngValue"],[1,"notification-box","-error"],[1,"notification-box--content",3,"textContent"],[3,"datasets","chartOptions"],["wpEmbeddedGraphMulti",""],["wpEmbeddedGraphSingle",""]],template:function(e,t){1&e&&(n.hc(0,"select",0),n.pc("ngModelChange",(function(e){return t.groupBy=e}))("ngModelChange",(function(){return t.setQueryProps()})),n.Tc(1,nn,2,2,"option",1),n.gc(),n.Tc(2,sn,2,1,"div",2),n.Tc(3,rn,2,2,"wp-embedded-graph",3),n.Tc(4,an,2,2,"wp-embedded-graph",3)),2&e&&(n.wc("ngModel",t.groupBy),n.Pb(1),n.wc("ngForOf",t.availableGroupBy),n.Pb(1),n.wc("ngIf",t.error),n.Pb(1),n.wc("ngIf",t.displayMulti),n.Pb(1),n.wc("ngIf",t.displaySingle))},directives:[l.y,l.m,l.p,oe.p,oe.q,l.r,l.B,Ti],styles:["wp-embedded-graph[_ngcontent-%COMP%]{margin-top:20px;display:block}"],changeDetection:0});i("qb46");var on=i("+rOU"),ln=i("vxfF"),dn=i("kor4"),un=i("1EAr"),hn=i("/Rze"),pn=i("ZOsW"),gn=i("ximh"),fn=i("ecJW"),bn=i("QihR"),mn=i("RN/J"),wn=i("th4C"),vn=i("oUDv"),yn=i("2hMx"),kn=i("+1L4"),Cn=i("cJ7v"),jn=i("lmKF"),Pn=i("HN1l"),xn=i("v9+U"),Sn=i("mRSd"),_n=i("X4Sm"),On=i("lfQJ"),In=i("IYP9"),Tn=i("upbp"),Rn=i("xFOf"),En=i("gh2L"),Mn=i("jQQo"),Fn=i("S8rk"),An=i("V0Il"),Ln=i("lmDM"),Dn=i("CVKj"),Vn=i("hvpr"),qn=i("SIjI"),$n=i("ZTEj"),Nn=i("f24R"),Bn=i("2orT"),zn=i("Eofd"),Hn=i("m3nR"),Qn=i("ZAVI"),Wn=i("9pt+"),Xn=i("S2zE"),Un=i("eJFM"),Gn=i("byj5"),Yn=i("2TbE"),Kn=i("XZlt"),Zn=i("2bW2"),Jn=i("aveh"),es=i("PwL/"),ts=i("DLfB");class is{constructor(){}}is.\u0275mod=n.Zb({type:is}),is.\u0275inj=n.Yb({factory:function(e){return new(e||is)},imports:[[f.a,ve.a,Si.b]]}),n.Pc(li,[zt.UISref,zt.AnchorUISref,zt.UIView,zt.UISrefActive,zt.UISrefStatus,oe.n,oe.o,oe.p,oe.q,oe.x,oe.t,oe.u,oe.v,oe.w,oe.r,oe.s,l.C,l.r,l.B,l.c,l.s,l.v,l.a,l.y,l.z,l.u,l.m,l.n,l.x,l.k,l.j,l.t,l.b,l.d,l.p,l.q,l.o,on.a,on.b,on.h,on.e,ln.a,je.e,je.f,je.a,je.b,je.d,je.c,dn.a,un.a,hn.a,pn.a,pn.n,pn.d,pn.c,pn.e,pn.f,pn.g,pn.h,pn.i,pn.j,pn.k,pn.l,pn.m,gn.a,fn.a,bn.a,yt.a,mn.a,wn.a,vn.a,yn.a,kn.a,Cn.a,jn.a,Pn.a,xn.a,Sn.a,_n.a,qt.a,On.a,Ve.a,Xt.a,In.a,Tn.a,Ee.a,Kt.a,Rn.a,Ce.c,Ce.d,Ce.a,Ce.b,Ce.e,En.a,Mn.a,Fn.a,An.a,Ln.a,Vi.a,Dn.a,Vn.a,qn.a,Vt.a,$t.a,Be.a,$n.a,Wi.a,Nn.a,Bn.a,zn.a,Hn.a,Qn.a,Wn.a,Xn.a,Un.a,Fi.a,Gn.a,Yn.a,Kn.a,Zn.a,Jn.a,es.a,ts.a,Si.a,ki,li,Ui,ci,Ji,Ti,cn],[oe.a,oe.C,oe.m,oe.j,oe.A,oe.f,oe.z,oe.B,oe.c,oe.e,oe.h,oe.i,oe.k]),n.Pc(ci,[zt.UISref,zt.AnchorUISref,zt.UIView,zt.UISrefActive,zt.UISrefStatus,oe.n,oe.o,oe.p,oe.q,oe.x,oe.t,oe.u,oe.v,oe.w,oe.r,oe.s,l.C,l.r,l.B,l.c,l.s,l.v,l.a,l.y,l.z,l.u,l.m,l.n,l.x,l.k,l.j,l.t,l.b,l.d,l.p,l.q,l.o,on.a,on.b,on.h,on.e,ln.a,je.e,je.f,je.a,je.b,je.d,je.c,dn.a,un.a,hn.a,pn.a,pn.n,pn.d,pn.c,pn.e,pn.f,pn.g,pn.h,pn.i,pn.j,pn.k,pn.l,pn.m,gn.a,fn.a,bn.a,yt.a,mn.a,wn.a,vn.a,yn.a,kn.a,Cn.a,jn.a,Pn.a,xn.a,Sn.a,_n.a,qt.a,On.a,Ve.a,Xt.a,In.a,Tn.a,Ee.a,Kt.a,Rn.a,Ce.c,Ce.d,Ce.a,Ce.b,Ce.e,En.a,Mn.a,Fn.a,An.a,Ln.a,Vi.a,Dn.a,Vn.a,qn.a,Vt.a,$t.a,Be.a,$n.a,Wi.a,Nn.a,Bn.a,zn.a,Hn.a,Qn.a,Wn.a,Xn.a,Un.a,Fi.a,Gn.a,Yn.a,Kn.a,Zn.a,Jn.a,es.a,ts.a,Si.a,ki,li,Ui,ci,Ji,Ti,cn],[oe.a,oe.C,oe.m,oe.j,oe.A,oe.f,oe.z,oe.B,oe.c,oe.e,oe.h,oe.i,oe.k]);var ns=i("RhL0"),ss=i("cI0L"),rs=i("711n"),as=i("80WE");function cs(e,t){if(1&e&&(n.hc(0,"edit-form",5),n.cc(1,"editable-attribute-field",6),n.gc()),2&e){const e=t.ngIf;n.wc("resource",e),n.Pb(1),n.wc("resource",e)}}class os extends Pe.a{constructor(e,t,i,n,s){super(e,t),this.i18n=e,this.injector=t,this.apiV3Service=i,this.currentProject=n,this.cdRef=s}ngOnInit(){this.project$=this.apiV3Service.projects.id(this.currentProject.id).get(),this.cdRef.detectChanges()}get isEditable(){return!1}}os.\u0275fac=function(e){return new(e||os)(n.bc(y.a),n.bc(n.A),n.bc(H.a),n.bc(xe.a),n.bc(n.i))},os.\u0275cmp=n.Vb({type:os,selectors:[["ng-component"]],features:[n.Ob([mt.a]),n.Mb],decls:6,vars:7,consts:[[3,"name","editable"],["slot","prepend","attribute","description",3,"attributeScope"],["slot","menu",3,"resource"],[1,"grid--widget-content","-allow-inner-overflow"],[3,"resource",4,"ngIf"],[3,"resource"],["fieldName","description",3,"resource"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.cc(1,"attribute-help-text",1),n.cc(2,"widget-menu",2),n.gc(),n.hc(3,"div",3),n.Tc(4,cs,2,2,"edit-form",4),n.sc(5,"async"),n.gc()),2&e&&(n.wc("name",t.widgetName)("editable",t.isEditable),n.Pb(1),n.wc("attributeScope","Project"),n.Pb(1),n.wc("resource",t.resource),n.Pb(2),n.wc("ngIf",n.tc(5,5,t.project$)))},directives:[Ae,ss.a,$e,oe.q,rs.a,as.a],pipes:[oe.a],encapsulation:2,changeDetection:0});class ls extends Pe.a{}ls.\u0275fac=function(e){return ds(e||ls)},ls.\u0275cmp=n.Vb({type:ls,selectors:[["ng-component"]],features:[n.Mb],decls:3,vars:3,consts:[[3,"name","onRenamed"],["slot","menu",3,"resource"],[1,"grid--widget-content","-no-overflow",3,"groupBy"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.pc("onRenamed",(function(e){return t.renameWidget(e)})),n.cc(1,"widget-menu",1),n.gc(),n.cc(2,"wp-overview-graph",2)),2&e&&(n.wc("name",t.widgetName),n.Pb(1),n.wc("resource",t.resource),n.Pb(1),n.wc("groupBy","type"))},directives:[Ae,$e,cn],encapsulation:2,changeDetection:0});const ds=n.jc(ls);var us=i("kgyZ"),hs=i("GntA");class ps extends us.a{constructor(e,t,i,n){super(),this.elementRef=e,this.injector=t,this.halResource=i,this.schemaCache=n,this.fieldName="text",this.inEdit=!1,this.inEditMode=!1,this.inFlight=!1}onFocusOut(){}initialize(e){this.initializeChangeset(e),this.valueChanged$=new Ie.a(e.options.text)}reinitialize(e){this.initializeChangeset(e)}handleUserSubmit(){return this.update()}reset(e=""){e.length>0&&(e+="\n"),this.changeset.setValue(this.fieldName,{raw:e})}get schema(){return{name:I18n.t("js.grid.widgets.custom_text.title"),writable:!0,required:!1,type:"Formattable",hasDefault:!1}}update(){return Object(w.b)(this,void 0,void 0,(function*(){return this.onSubmit().then(()=>{this.valueChanged$.next(this.rawText),this.deactivate()})}))}get rawText(){return _.get(this.textValue,"raw","")}get htmlText(){return _.get(this.textValue,"html","")}get textValue(){return this.changeset.value(this.fieldName)}handleUserCancel(){this.deactivate()}get active(){return this.inEdit}activate(e){this.inEdit=!0}deactivate(){this.changeset.clear(),this.inEdit=!1}focus(){const e=this.elementRef.nativeElement.querySelector(".inplace-editing--trigger-container");e&&e.focus()}setErrors(e){}handleUserKeydown(e,t){}isChanged(){return!this.changeset.isEmpty()}stopPropagation(e){return!1}initializeChangeset(e){let t="customtext-schema",i={text:e.options.text,getEditorTypeFor:()=>"full",canAddAttachments:e.grid.canAddAttachments,uploadAttachments:t=>e.grid.uploadAttachments(t),_links:{schema:{href:t}}},n=this.halResource.createHalResource(i,!0),s={text:this.schema,_links:{self:{href:t}}},r=this.halResource.createHalResource(s,!0);this.schemaCache.update(n,r),this.changeset=new hs.a(n)}}ps.\u0275fac=function(e){return new(e||ps)(n.lc(n.q),n.lc(n.A),n.lc(C.a),n.lc(it.a))},ps.\u0275prov=n.Xb({token:ps,factory:ps.\u0275fac});var gs=i("pLZG"),fs=i("7MH/"),bs=i("jEcX");const ms=["displayContainer"];function ws(e,t){if(1&e&&n.cc(0,"div",12),2&e){const e=n.rc(2);n.wc("innerHTML",e.customText,n.Mc)}}function vs(e,t){if(1&e&&n.cc(0,"div",13),2&e){const e=n.rc(2);n.wc("innerHTML",e.placeholderText,n.Mc)}}function ys(e,t){if(1&e&&(n.hc(0,"span",8,9),n.Tc(2,ws,1,1,"div",10),n.Tc(3,vs,1,1,"div",11),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("ngIf",!e.textEmpty),n.Pb(1),n.wc("ngIf",e.textEmpty)}}function ks(e,t){if(1&e&&n.cc(0,"edit-form-portal",14),2&e){const e=n.rc();n.wc("schemaInput",e.schema)("changeInput",e.changeset)("editFieldHandler",e.handler)}}function Cs(e,t){if(1&e&&n.cc(0,"attachments",15),2&e){const e=n.rc();n.wc("resource",e.resource.grid)}}function js(e,t){1&e&&n.dc(0)}function Ps(e,t){if(1&e){const e=n.ic();n.hc(0,"div",19),n.pc("accessibleClick",(function(t){n.Lc(e);return n.rc(2).activate(t)})),n.Tc(1,js,1,0,"ng-container",20),n.gc()}if(2&e){const e=n.rc(2),t=n.Jc(3);n.wc("accessibleClickStopEvent",!1)("ngClass",e.inplaceEditClasses),n.Pb(1),n.wc("ngTemplateOutlet",t)}}function xs(e,t){1&e&&n.dc(0)}function Ss(e,t){if(1&e&&(n.fc(0),n.Tc(1,xs,1,0,"ng-container",20),n.ec()),2&e){n.rc(2);const e=n.Jc(3);n.Pb(1),n.wc("ngTemplateOutlet",e)}}const _s=function(e){return{"inline-edit--container":e}};function Os(e,t){if(1&e&&(n.hc(0,"div",16),n.Tc(1,Ps,2,3,"div",17),n.Tc(2,Ss,2,1,"ng-container",18),n.gc()),2&e){const e=n.rc();n.wc("ngClass",n.Bc(3,_s,e.isTextEditable)),n.Pb(1),n.wc("ngIf",e.isTextEditable),n.Pb(1),n.wc("ngIf",!e.isTextEditable)}}class Is extends Pe.a{constructor(e,t,i,n,s,r,a){super(e,t),this.i18n=e,this.injector=t,this.handler=i,this.cdr=n,this.sanitization=s,this.appRef=r,this.layout=a}ngOnInit(){this.setupVariables(!0),this.handler.valueChanged$.pipe(this.untilDestroyed(),Object(gs.a)(e=>e!==this.resource.options.text)).subscribe(e=>{let t=this.setChangesetOptions({text:{raw:e}});this.resourceChanged.emit(t)})}ngOnChanges(e){e.resource.currentValue.options.text.raw!==this.currentRawText&&(this.setupVariables(),this.cdr.detectChanges())}activate(e){this.clickedElementIsLinkWithinDisplayContainer(e)||this.resource.grid.updateAttachments().then(()=>{this.handler.activate()})}get placeholderText(){return this.i18n.t("js.grid.widgets.work_packages_overview.placeholder")}get inplaceEditClasses(){let e="inplace-editing--container inline-edit--display-field -editable";return this.textEmpty&&(e+=" -placeholder"),e}get schema(){return this.handler.schema}get changeset(){return this.handler.changeset}get active(){return this.handler.active}get textEmpty(){return!this.currentRawText.length}get isTextEditable(){return this.layout.isEditable}setupVariables(e=!1){this.memorizeRawText(),e?this.handler.initialize(this.resource):this.handler.reinitialize(this.resource),this.memorizeCustomText()}memorizeRawText(){this.currentRawText=this.resource.options.text.raw}memorizeCustomText(){this.customText=this.sanitization.bypassSecurityTrustHtml(this.handler.htmlText),setTimeout(()=>{$.a.bootstrapOptionalEmbeddable(this.appRef,this.displayContainer.nativeElement)},100)}clickedElementIsLinkWithinDisplayContainer(e){return this.displayContainer.nativeElement.contains(e.target.closest("a,macro"))}}Is.\u0275fac=function(e){return new(e||Is)(n.bc(y.a),n.bc(n.A),n.bc(ps),n.bc(n.i),n.bc(D.b),n.bc(n.f),n.bc(Re))},Is.\u0275cmp=n.Vb({type:Is,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.ad(ms,!0),2&e)&&(n.Ic(i=n.qc())&&(t.displayContainer=i.first))},features:[n.Ob([ps]),n.Mb,n.Nb],decls:9,vars:5,consts:[[3,"name","onRenamed"],["slot","menu",3,"resource"],["text",""],[1,"grid--widget-content","-custom-text","-allow-inner-overflow"],[1,"inline-edit--container","inplace-edit"],[3,"schemaInput","changeInput","editFieldHandler",4,"ngIf"],["data-allow-uploading","true",3,"resource",4,"ngIf"],["class","inplace-edit--read wiki -no-label",3,"ngClass",4,"ngIf"],[1,"inline-edit--formattable-display-text","-default"],["displayContainer",""],["class","op-uc-container",3,"innerHTML",4,"ngIf"],[3,"innerHTML",4,"ngIf"],[1,"op-uc-container",3,"innerHTML"],[3,"innerHTML"],[3,"schemaInput","changeInput","editFieldHandler"],["data-allow-uploading","true",3,"resource"],[1,"inplace-edit--read","wiki","-no-label",3,"ngClass"],[3,"accessibleClickStopEvent","ngClass","accessibleClick",4,"ngIf"],[4,"ngIf"],[3,"accessibleClickStopEvent","ngClass","accessibleClick"],[4,"ngTemplateOutlet"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.pc("onRenamed",(function(e){return t.renameWidget(e)})),n.cc(1,"widget-menu",1),n.gc(),n.Tc(2,ys,4,2,"ng-template",null,2,n.Uc),n.hc(4,"div",3),n.hc(5,"div",4),n.Tc(6,ks,1,3,"edit-form-portal",5),n.Tc(7,Cs,1,1,"attachments",6),n.Tc(8,Os,3,5,"div",7),n.gc(),n.gc()),2&e&&(n.wc("name",t.widgetName),n.Pb(1),n.wc("resource",t.resource),n.Pb(5),n.wc("ngIf",t.active),n.Pb(1),n.wc("ngIf",t.active),n.Pb(1),n.wc("ngIf",!t.active))},directives:[Ae,$e,oe.q,fs.a,bs.a,oe.n,dn.a,oe.x],encapsulation:2,changeDetection:0});const Ts=["contentContainer"];function Rs(e,t){if(1&e&&(n.fc(0),n.hc(1,"div",7),n.Vc(2),n.cc(3,"attribute-help-text",8),n.gc(),n.hc(4,"div",9),n.cc(5,"editable-attribute-field",10),n.gc(),n.ec()),2&e){const e=t.$implicit,i=n.rc().ngIf;n.Pb(2),n.Xc(" ",e.label," "),n.Pb(1),n.wc("attribute",e.key)("attributeScope","Project"),n.Pb(2),n.wc("resource",i)("fieldName",e.key)}}function Es(e,t){if(1&e&&(n.hc(0,"edit-form",4),n.hc(1,"div",5),n.Tc(2,Rs,6,5,"ng-container",6),n.gc(),n.gc()),2&e){const e=t.ngIf,i=n.rc();n.wc("resource",e),n.Pb(2),n.wc("ngForOf",i.customFields)}}class Ms extends Pe.a{constructor(e,t,i,n,s){super(e,t),this.i18n=e,this.injector=t,this.apiV3Service=i,this.currentProject=n,this.cdRef=s,this.customFields=[]}ngOnInit(){this.loadAndRender(),this.project$=this.apiV3Service.projects.id(this.currentProject.id).requireAndStream()}get isEditable(){return!1}loadAndRender(){Promise.all([this.loadProjectSchema()]).then(([e])=>{this.setCustomFields(e)})}loadProjectSchema(){return this.apiV3Service.projects.schema.get().toPromise()}setCustomFields(e){Object.entries(e).forEach(([e,t])=>{e.match(/customField\d+/)&&this.customFields.push({key:e,label:t.name})}),this.cdRef.detectChanges()}}Ms.\u0275fac=function(e){return new(e||Ms)(n.bc(y.a),n.bc(n.A),n.bc(H.a),n.bc(xe.a),n.bc(n.i))},Ms.\u0275cmp=n.Vb({type:Ms,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(Ts,!0),2&e)&&(n.Ic(i=n.qc())&&(t.contentContainer=i.first))},features:[n.Ob([mt.a]),n.Mb],decls:5,vars:6,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"resource",4,"ngIf"],[3,"resource"],[1,"attributes-map"],[4,"ngFor","ngForOf"],[1,"attributes-map--key"],[3,"attribute","attributeScope"],[1,"attributes-map--value"],[3,"resource","fieldName"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.cc(1,"widget-menu",1),n.gc(),n.hc(2,"div",2),n.Tc(3,Es,3,2,"edit-form",3),n.sc(4,"async"),n.gc()),2&e&&(n.wc("name",t.widgetName)("editable",t.isEditable),n.Pb(1),n.wc("resource",t.resource),n.Pb(2),n.wc("ngIf",n.tc(4,4,t.project$)))},directives:[Ae,$e,oe.q,rs.a,oe.p,ss.a,as.a],pipes:[oe.a],encapsulation:2,changeDetection:0});class Fs extends Pe.a{constructor(e,t,i,n,s,r){super(i,e),this.injector=e,this.timezone=t,this.i18n=i,this.pathHelper=n,this.confirmDialog=s,this.cdr=r,this.text={activity:this.i18n.t("js.time_entry.activity"),comment:this.i18n.t("js.time_entry.comment"),hour:this.i18n.t("js.time_entry.hours"),workPackage:this.i18n.t("js.label_work_package"),edit:this.i18n.t("js.button_edit"),delete:this.i18n.t("js.button_delete"),confirmDelete:{text:this.i18n.t("js.modals.destroy_time_entry.text"),title:this.i18n.t("js.modals.destroy_time_entry.title")},noResults:this.i18n.t("js.grid.widgets.time_entries_list.no_results")},this.entries=[],this.entriesLoaded=!1,this.rows=[]}ngOnInit(){this.apiV3Service.time_entries.list({filters:this.dmFilters(),pageSize:500}).subscribe(e=>{this.buildEntries(e.elements),this.entriesLoaded=!0,this.cdr.detectChanges()})}get total(){let e=this.entries.reduce((e,t)=>e+this.timezone.toHours(t.hours),0);return this.i18n.t("js.units.hour",{count:this.formatNumber(e)})}get anyEntries(){return!!this.entries.length}activityName(e){return e.activity.name}projectName(e){return e.project.name}workPackageName(e){return`#${e.workPackage.id}: ${e.workPackage.name}`}workPackageId(e){return e.workPackage.id}comment(e){return e.comment&&e.comment.raw}hours(e){return this.formatNumber(this.timezone.toHours(e.hours))}workPackagePath(e){return this.pathHelper.workPackagePath(e.workPackage.idFromLink)}get isEditable(){return!1}editTimeEntry(e){this.apiV3Service.time_entries.id(e.id).get().subscribe(e=>{this.timeEntryEditService.edit(e).then(e=>{let t=this.entries.findIndex(t=>t.id===e.entry.id),i=this.entries;i[t]=e.entry,this.buildEntries(i)}).catch(()=>{})})}deleteIfConfirmed(e,t){var i,n,s;e.preventDefault(),this.confirmDialog.confirm({text:this.text.confirmDelete,closeByEscape:!0,showClose:!0,closeByDocument:!0,passedData:["#"+(null===(i=t.workPackage)||void 0===i?void 0:i.idFromLink)+" "+(null===(n=t.workPackage)||void 0===n?void 0:n.name),this.i18n.t("js.units.hour",{count:this.timezone.toHours(t.hours)})+" ("+(null===(s=t.activity)||void 0===s?void 0:s.name)+")"],dangerHighlighting:!0}).then(()=>{t.delete().then(()=>{let e=this.entries.filter(e=>t.id!==e.id);this.buildEntries(e)})}).catch(()=>{})}buildEntries(e){this.entries=e;let t={};e.forEach(e=>{let i=e.spentOn;t[i]||(t[i]=0),t[i]=t[i]+this.timezone.toHours(e.hours)});let i=e.sort((e,t)=>t.spentOn.localeCompare(e.spentOn));this.rows=[];let n=null;i.forEach(e=>{e.spentOn!==n&&(n=e.spentOn,this.rows.push({date:this.timezone.formattedDate(n),sum:this.formatNumber(t[n])})),this.rows.push({date:n,entry:e})})}formatNumber(e){return this.i18n.toNumber(e,{precision:2})}get noEntries(){return!this.entries.length&&this.entriesLoaded}}function As(e,t){if(1&e&&n.cc(0,"no-results",4),2&e){const e=n.rc();n.wc("title",e.text.noResults)}}function Ls(e,t){if(1&e&&n.cc(0,"td",26),2&e){const e=n.rc().$implicit,t=n.rc(3);n.wc("textContent",t.activityName(e.entry))}}function Ds(e,t){if(1&e&&(n.hc(0,"td",27),n.cc(1,"strong",6),n.gc()),2&e){const e=n.rc().$implicit;n.Pb(1),n.wc("textContent",e.date)}}function Vs(e,t){if(1&e&&(n.hc(0,"td",28),n.Vc(1),n.cc(2,"a",29),n.gc()),2&e){const e=n.rc().$implicit,t=n.rc(3);n.Pb(1),n.Xc(" ",t.projectName(e.entry)," - "),n.Pb(1),n.wc("href",t.workPackagePath(e.entry),n.Oc)("textContent",t.workPackageName(e.entry))}}function qs(e,t){if(1&e&&n.cc(0,"td",30),2&e){const e=n.rc().$implicit,t=n.rc(3);n.wc("textContent",t.projectName(e.entry))}}function $s(e,t){if(1&e&&n.cc(0,"td",31),2&e){const e=n.rc().$implicit,t=n.rc(3);n.wc("textContent",t.comment(e.entry))}}function Ns(e,t){if(1&e&&n.cc(0,"td",32),2&e){const e=n.rc().$implicit,t=n.rc(3);n.wc("textContent",t.hours(e.entry))}}function Bs(e,t){if(1&e&&(n.hc(0,"td",33),n.cc(1,"em",6),n.gc()),2&e){const e=n.rc().$implicit;n.Pb(1),n.wc("textContent",e.sum)}}function zs(e,t){if(1&e){const e=n.ic();n.hc(0,"a",34),n.pc("click",(function(){n.Lc(e);const t=n.rc().$implicit;return n.rc(3).editTimeEntry(t.entry)})),n.cc(1,"op-icon",35),n.gc()}if(2&e){const e=n.rc(4);n.wc("title",e.text.edit)}}function Hs(e,t){if(1&e){const e=n.ic();n.hc(0,"a",34),n.pc("click",(function(t){n.Lc(e);const i=n.rc().$implicit;return n.rc(3).deleteIfConfirmed(t,i.entry)})),n.cc(1,"op-icon",36),n.gc()}if(2&e){const e=n.rc(4);n.wc("title",e.text.delete)}}function Qs(e,t){if(1&e&&(n.hc(0,"tr",16),n.Tc(1,Ls,1,1,"td",17),n.Tc(2,Ds,2,1,"td",18),n.Tc(3,Vs,3,3,"td",19),n.Tc(4,qs,1,1,"td",20),n.Tc(5,$s,1,1,"td",21),n.Tc(6,Ns,1,1,"td",22),n.Tc(7,Bs,2,1,"td",23),n.hc(8,"td",24),n.Tc(9,zs,2,1,"a",25),n.Tc(10,Hs,2,1,"a",25),n.gc(),n.gc()),2&e){const e=t.$implicit;n.Pb(1),n.wc("ngIf",e.entry),n.Pb(1),n.wc("ngIf",e.sum),n.Pb(1),n.wc("ngIf",e.entry&&e.entry.workPackage),n.Pb(1),n.wc("ngIf",e.entry&&!e.entry.workPackage),n.Pb(1),n.wc("ngIf",e.entry),n.Pb(1),n.wc("ngIf",e.entry),n.Pb(1),n.wc("ngIf",e.sum),n.Pb(2),n.wc("ngIf",e.entry&&e.entry.updateImmediately),n.Pb(1),n.wc("ngIf",e.entry&&e.entry.delete)}}function Ws(e,t){if(1&e&&(n.hc(0,"div",8),n.hc(1,"table",9),n.hc(2,"colgroup"),n.cc(3,"col",10),n.cc(4,"col",10),n.cc(5,"col",10),n.cc(6,"col",10),n.cc(7,"col"),n.gc(),n.hc(8,"thead",11),n.hc(9,"tr"),n.hc(10,"th"),n.hc(11,"div",12),n.hc(12,"div",13),n.cc(13,"span",6),n.gc(),n.gc(),n.gc(),n.hc(14,"th"),n.hc(15,"div",12),n.hc(16,"div",13),n.cc(17,"span",6),n.gc(),n.gc(),n.gc(),n.hc(18,"th"),n.hc(19,"div",12),n.hc(20,"div",13),n.cc(21,"span",6),n.gc(),n.gc(),n.gc(),n.hc(22,"th"),n.hc(23,"div",12),n.hc(24,"div",13),n.cc(25,"span",6),n.gc(),n.gc(),n.gc(),n.hc(26,"th"),n.cc(27,"div",14),n.gc(),n.gc(),n.gc(),n.hc(28,"tbody"),n.Tc(29,Qs,11,9,"tr",15),n.gc(),n.gc(),n.gc()),2&e){const e=n.rc(2);n.Pb(13),n.wc("textContent",e.text.activity),n.Pb(4),n.wc("textContent",e.text.workPackage),n.Pb(4),n.wc("textContent",e.text.comment),n.Pb(4),n.wc("textContent",e.text.hour),n.Pb(4),n.wc("ngForOf",e.rows)}}function Xs(e,t){if(1&e&&(n.fc(0),n.hc(1,"div",5),n.hc(2,"p"),n.Vc(3,"Total: "),n.cc(4,"span",6),n.gc(),n.gc(),n.Tc(5,Ws,30,5,"div",7),n.ec()),2&e){const e=n.rc();n.Pb(4),n.wc("textContent",e.total),n.Pb(1),n.wc("ngIf",e.anyEntries)}}Fs.\u0275fac=function(e){return new(e||Fs)(n.bc(n.A),n.bc(ot.a),n.bc(y.a),n.bc(q.a),n.bc(p.a),n.bc(n.i))},Fs.\u0275dir=n.Wb({type:Fs,features:[n.Mb]}),Object(w.c)([Object(z.a)(),Object(w.e)("design:type",St)],Fs.prototype,"timeEntryEditService",void 0),Object(w.c)([Object(z.a)(),Object(w.e)("design:type",H.a)],Fs.prototype,"apiV3Service",void 0);class Us extends Fs{constructor(e,t,i,n,s,r,a){super(e,t,i,n,s,r),this.injector=e,this.timezone=t,this.i18n=i,this.pathHelper=n,this.confirmDialog=s,this.cdr=r,this.currentProject=a}dmFilters(){return[["spentOn",">t-",["7"]],["project_id","=",[this.currentProject.id]]]}}function Gs(e,t){if(1&e&&n.cc(0,"no-results",5),2&e){const e=n.rc();n.wc("title",e.text.noResults)}}function Ys(e,t){1&e&&(n.hc(0,"span"),n.Vc(1,", "),n.gc())}function Ks(e,t){if(1&e&&(n.hc(0,"span"),n.cc(1,"a",6),n.Tc(2,Ys,2,0,"span",7),n.gc()),2&e){const e=t.$implicit,i=t.last,s=n.rc();n.Pb(1),n.wc("href",s.projectPath(e),n.Oc)("textContent",s.projectName(e)),n.Pb(1),n.wc("ngIf",!i)}}Us.\u0275fac=function(e){return new(e||Us)(n.bc(n.A),n.bc(ot.a),n.bc(y.a),n.bc(q.a),n.bc(p.a),n.bc(n.i),n.bc(xe.a))},Us.\u0275cmp=n.Vb({type:Us,selectors:[["ng-component"]],features:[n.Mb],decls:4,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[3,"title",4,"ngIf"],[4,"ngIf"],[3,"title"],[1,"total-hours"],[3,"textContent"],["class","generic-table--results-container",4,"ngIf"],[1,"generic-table--results-container"],[1,"generic-table","time-entries"],["highlight-col",""],[1,"-sticky"],[1,"generic-table--sort-header-outer"],[1,"generic-table--sort-header"],[1,"generic-table--empty-header"],["class","time-entry",4,"ngFor","ngForOf"],[1,"time-entry"],["class","activity",3,"textContent",4,"ngIf"],["colspan","3",4,"ngIf"],["class","subject",4,"ngIf"],["class","subject",3,"textContent",4,"ngIf"],["class","comments",3,"textContent",4,"ngIf"],["class","hours",3,"textContent",4,"ngIf"],["class","hours",4,"ngIf"],[1,"buttons"],[3,"title","click",4,"ngIf"],[1,"activity",3,"textContent"],["colspan","3"],[1,"subject"],[3,"href","textContent"],[1,"subject",3,"textContent"],[1,"comments",3,"textContent"],[1,"hours",3,"textContent"],[1,"hours"],[3,"title","click"],["icon-classes","icon-context icon-edit"],["icon-classes","icon-context icon-delete"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.cc(1,"widget-menu",1),n.gc(),n.Tc(2,As,1,1,"no-results",2),n.Tc(3,Xs,6,2,"ng-container",3)),2&e&&(n.wc("name",t.widgetName)("editable",t.isEditable),n.Pb(1),n.wc("resource",t.resource),n.Pb(1),n.wc("ngIf",t.noEntries),n.Pb(1),n.wc("ngIf",!t.noEntries))},directives:[Ae,$e,oe.q,Xt.a,Pn.a,oe.p,yt.a],encapsulation:2});class Zs extends Pe.a{constructor(e,t,i,n,s,r,a,c){super(i,n),this.halResource=e,this.pathHelper=t,this.i18n=i,this.injector=n,this.timezone=s,this.apiV3Service=r,this.currentProject=a,this.cdr=c,this.text={noResults:this.i18n.t("js.grid.widgets.subprojects.no_results")}}ngOnInit(){this.apiV3Service.projects.list(this.projectListParams).subscribe(e=>{this.projects=e.elements,this.cdr.detectChanges()})}get isEditable(){return!1}projectPath(e){return this.pathHelper.projectPath(e.identifier)}projectName(e){return e.name}get noEntries(){return this.projects&&!this.projects.length}get projectListParams(){return{sortBy:[["name","asc"]],filters:[["parent_id","=",[this.currentProject.id]]]}}}function Js(e,t){if(1&e&&n.cc(0,"no-results",10),2&e){const e=n.rc();n.wc("title",e.text.noResults)}}function er(e,t){if(1&e&&(n.fc(0),n.cc(1,"span",14),n.ec()),2&e){const e=n.rc().$implicit,t=n.rc(2);n.Pb(1),n.wc("textContent",t.userName(e))}}function tr(e,t){if(1&e&&(n.fc(0),n.cc(1,"user-avatar",15),n.cc(2,"a",16),n.ec()),2&e){const e=n.rc().$implicit,t=n.rc(2);n.Pb(1),n.wc("user",e),n.Pb(1),n.wc("href",t.userPath(e),n.Oc)("textContent",t.userName(e))}}function ir(e,t){1&e&&(n.fc(0),n.Vc(1,", "),n.ec())}function nr(e,t){if(1&e&&(n.hc(0,"span"),n.Tc(1,er,2,1,"ng-container",13),n.Tc(2,tr,3,3,"ng-container",13),n.Tc(3,ir,2,0,"ng-container",13),n.gc()),2&e){const e=t.$implicit,i=t.last,s=n.rc(2);n.Pb(1),n.wc("ngIf",s.isGroup(e)),n.Pb(1),n.wc("ngIf",!s.isGroup(e)),n.Pb(1),n.wc("ngIf",!i)}}function sr(e,t){if(1&e&&(n.fc(0),n.hc(1,"div",11),n.Vc(2),n.gc(),n.hc(3,"div",12),n.Tc(4,nr,4,3,"span",5),n.gc(),n.ec()),2&e){const e=t.$implicit;n.Pb(2),n.Xc(" ",e.role.name," "),n.Pb(2),n.wc("ngForOf",e.users)}}function rr(e,t){if(1&e&&(n.hc(0,"div",17),n.Vc(1),n.gc()),2&e){const e=n.rc();n.Pb(1),n.Xc(" ",e.moreMembersText," ")}}function ar(e,t){if(1&e&&(n.hc(0,"a",18),n.cc(1,"i",19),n.cc(2,"span",20),n.gc()),2&e){const e=n.rc();n.wc("href",e.projectMembershipsPath+"?show_add_members=true",n.Oc),n.Pb(2),n.wc("textContent",e.text.add)}}function cr(e,t){if(1&e&&(n.hc(0,"a",21),n.cc(1,"i",22),n.cc(2,"span",20),n.gc()),2&e){const e=n.rc();n.wc("href",e.projectMembershipsPath,n.Oc),n.Pb(2),n.wc("textContent",e.text.viewAll)}}Zs.\u0275fac=function(e){return new(e||Zs)(n.bc(C.a),n.bc(q.a),n.bc(y.a),n.bc(n.A),n.bc(ot.a),n.bc(H.a),n.bc(xe.a),n.bc(n.i))},Zs.\u0275cmp=n.Vb({type:Zs,selectors:[["ng-component"]],features:[n.Mb],decls:5,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"title"],[3,"href","textContent"],[4,"ngIf"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.cc(1,"widget-menu",1),n.gc(),n.hc(2,"div",2),n.Tc(3,Gs,1,1,"no-results",3),n.Tc(4,Ks,3,3,"span",4),n.gc()),2&e&&(n.wc("name",t.widgetName)("editable",t.isEditable),n.Pb(1),n.wc("resource",t.resource),n.Pb(2),n.wc("ngIf",t.noEntries),n.Pb(1),n.wc("ngForOf",t.projects))},directives:[Ae,$e,oe.q,oe.p,Xt.a],encapsulation:2,changeDetection:0});class or extends Pe.a{constructor(e,t,i,n,s,r){super(i,n),this.pathHelper=e,this.apiV3Service=t,this.i18n=i,this.injector=n,this.currentProject=s,this.cdr=r,this.text={add:this.i18n.t("js.grid.widgets.members.add"),noResults:this.i18n.t("js.grid.widgets.members.no_results"),viewAll:this.i18n.t("js.grid.widgets.members.view_all_members")},this.entriesByRoles={},this.entriesLoaded=!1,this.membersAddable=!1}ngOnInit(){this.apiV3Service.memberships.list(this.listMembersParams).subscribe(e=>{this.partitionEntriesByRole(e.elements),this.sortUsersByName(),this.totalMembers=e.total,this.entriesLoaded=!0,this.cdr.detectChanges()}),this.apiV3Service.memberships.available_projects.list(this.listAvailableProjectsParams).subscribe(e=>{this.membersAddable=e.total>0})}get isEditable(){return!1}userPath(e){return this.pathHelper.userPath(e.id)}userName(e){return e.name}get noMembers(){return this.entriesLoaded&&!Object.keys(this.entriesByRoles).length}get moreMembers(){return this.entriesLoaded&&this.totalMembers>100}get moreMembersText(){return I18n.t("js.grid.widgets.members.too_many",{count:100,total:this.totalMembers})}get projectMembershipsPath(){return this.pathHelper.projectMembershipsPath(this.currentProject.identifier)}get usersByRole(){return Object.values(this.entriesByRoles)}isGroup(e){return this.apiV3Service.groups.id(e.id).toString()===e.href}partitionEntriesByRole(e){e.forEach(e=>{e.roles.forEach(t=>{this.entriesByRoles[t.id]||(this.entriesByRoles[t.id]={role:t,users:[]}),this.entriesByRoles[t.id].users.push(e.principal)})})}sortUsersByName(){Object.values(this.entriesByRoles).forEach(e=>{e.users.sort((e,t)=>this.userName(e).localeCompare(this.userName(t)))})}get listMembersParams(){let e={sortBy:[["created_at","desc"]],pageSize:100};return this.currentProject.id&&(e.filters=[["project_id","=",[this.currentProject.id]]]),e}get listAvailableProjectsParams(){let e={};return this.currentProject.id&&(e.filters=[["id","=",[this.currentProject.id]]]),e}}or.\u0275fac=function(e){return new(e||or)(n.bc(q.a),n.bc(H.a),n.bc(y.a),n.bc(n.A),n.bc(xe.a),n.bc(n.i))},or.\u0275cmp=n.Vb({type:or,selectors:[["ng-component"]],features:[n.Mb],decls:10,vars:8,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[1,"attributes-map","-minimal-keys"],[4,"ngFor","ngForOf"],["class","members-widget--notification",4,"ngIf"],[1,"grid--widget-footer"],["class","button -alt-highlight",3,"href",4,"ngIf"],["class","button -highlight-inverted",3,"href",4,"ngIf"],[3,"title"],[1,"attributes-map--key"],[1,"attributes-map--value"],[4,"ngIf"],[3,"textContent"],["data-class-list","avatar avatar-mini -spaced",3,"user"],[3,"href","textContent"],[1,"members-widget--notification"],[1,"button","-alt-highlight",3,"href"],["aria-hidden","true",1,"button--icon","icon-add"],[1,"button--text",3,"textContent"],[1,"button","-highlight-inverted",3,"href"],["aria-hidden","true",1,"button--icon","icon-group"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.cc(1,"widget-menu",1),n.gc(),n.hc(2,"div",2),n.Tc(3,Js,1,1,"no-results",3),n.hc(4,"div",4),n.Tc(5,sr,5,2,"ng-container",5),n.gc(),n.Tc(6,rr,2,1,"div",6),n.gc(),n.hc(7,"div",7),n.Tc(8,ar,3,2,"a",8),n.Tc(9,cr,3,2,"a",9),n.gc()),2&e&&(n.wc("name",t.widgetName)("editable",t.isEditable),n.Pb(1),n.wc("resource",t.resource),n.Pb(2),n.wc("ngIf",t.noMembers),n.Pb(2),n.wc("ngForOf",t.usersByRole),n.Pb(1),n.wc("ngIf",t.moreMembers),n.Pb(2),n.wc("ngIf",t.membersAddable),n.Pb(1),n.wc("ngIf",!t.noMembers))},directives:[Ae,$e,oe.q,oe.p,Xt.a,Kt.a],styles:[".members-widget--notification[_ngcontent-%COMP%]{font-style:italic;margin-top:.5rem}.grid--widget-footer[_ngcontent-%COMP%]{margin-top:.5rem}.grid--widget-footer[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin-bottom:0}.attributes-map[_ngcontent-%COMP%]{padding-bottom:.875rem;line-height:1.5rem}"],changeDetection:0});var lr=i("2Qcm");const dr=["contentContainer"];function ur(e,t){if(1&e&&(n.hc(0,"edit-form",5),n.hc(1,"div",6),n.cc(2,"editable-attribute-field",7),n.gc(),n.hc(3,"div",8),n.cc(4,"editable-attribute-field",9),n.gc(),n.gc()),2&e){const e=t.ngIf;n.wc("resource",e),n.Pb(2),n.wc("resource",e),n.Pb(2),n.wc("resource",e)}}class hr extends Pe.a{constructor(e,t,i,n,s){super(e,t),this.i18n=e,this.injector=t,this.apiV3Service=i,this.currentProject=n,this.cdRef=s,this.currentStatusCode="not set",this.explanation=""}ngOnInit(){this.project$=this.apiV3Service.projects.id(this.currentProject.id).get(),this.cdRef.detectChanges()}get isEditable(){return!1}}hr.\u0275fac=function(e){return new(e||hr)(n.bc(y.a),n.bc(n.A),n.bc(H.a),n.bc(xe.a),n.bc(n.i))},hr.\u0275cmp=n.Vb({type:hr,selectors:[["ng-component"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(dr,!0),2&e)&&(n.Ic(i=n.qc())&&(t.contentContainer=i.first))},features:[n.Ob([lr.a,He.a,mt.a]),n.Mb],decls:6,vars:7,consts:[[3,"name","editable"],["slot","prepend","attribute","status",3,"attributeScope"],["slot","menu",3,"resource"],[1,"grid--widget-content","-allow-inner-overflow"],[3,"resource",4,"ngIf"],[3,"resource"],[1,"project-status--container"],["fieldName","status","wrapperClasses","project-status--display-field",3,"resource"],[1,"project-status-explanation--container"],["fieldName","statusExplanation",3,"resource"]],template:function(e,t){1&e&&(n.hc(0,"widget-header",0),n.cc(1,"attribute-help-text",1),n.cc(2,"widget-menu",2),n.gc(),n.hc(3,"div",3),n.Tc(4,ur,5,3,"edit-form",4),n.sc(5,"async"),n.gc()),2&e&&(n.wc("name",t.widgetName)("editable",t.isEditable),n.Pb(1),n.wc("attributeScope","Project"),n.Pb(1),n.wc("resource",t.resource),n.Pb(2),n.wc("ngIf",n.tc(5,5,t.project$)))},directives:[Ae,ss.a,$e,oe.q,rs.a,as.a],pipes:[oe.a],encapsulation:2,changeDetection:0});class pr{constructor(e){!function(e){const t=e.get(m.a),i=e.get(y.a);t.register("gridWidgets",()=>{let e=["id","project","type","subject"],t=new ns.a;t.add("assignee","=",["me"]),t.add("status","o",[]);let n={"columns[]":e,filters:t.toJson()},s=new ns.a;s.add("responsible","=",["me"]),s.add("status","o",[]);let r={"columns[]":e,filters:s.toJson()},a=new ns.a;a.add("author","=",["me"]),a.add("status","o",[]);let c={"columns[]":e,filters:a.toJson()},o=new ns.a;o.add("watcher","=",["me"]),o.add("status","o",[]);let l={"columns[]":e,filters:o.toJson()};return[{identifier:"work_packages_assigned",component:Ni,title:i.t("js.grid.widgets.work_packages_assigned.title"),properties:{queryProps:n,name:i.t("js.grid.widgets.work_packages_assigned.title")}},{identifier:"work_packages_accountable",component:Ni,title:i.t("js.grid.widgets.work_packages_accountable.title"),properties:{queryProps:r,name:i.t("js.grid.widgets.work_packages_accountable.title")}},{identifier:"work_packages_created",component:Ni,title:i.t("js.grid.widgets.work_packages_created.title"),properties:{queryProps:c,name:i.t("js.grid.widgets.work_packages_created.title")}},{identifier:"work_packages_watched",component:Ni,title:i.t("js.grid.widgets.work_packages_watched.title"),properties:{queryProps:l,name:i.t("js.grid.widgets.work_packages_watched.title")}},{identifier:"work_packages_table",component:Ni,title:i.t("js.grid.widgets.work_packages_table.title"),properties:{name:i.t("js.grid.widgets.work_packages_table.title")}},{identifier:"work_packages_graph",component:Ri,title:i.t("js.grid.widgets.work_packages_graph.title"),properties:{name:i.t("js.grid.widgets.work_packages_graph.title")}},{identifier:"work_packages_calendar",component:ct,title:i.t("js.grid.widgets.work_packages_calendar.title"),properties:{name:i.t("js.grid.widgets.work_packages_calendar.title")}},{identifier:"work_packages_overview",component:ls,title:i.t("js.grid.widgets.work_packages_overview.title"),properties:{name:i.t("js.grid.widgets.work_packages_overview.title")}},{identifier:"time_entries_current_user",component:At,title:i.t("js.grid.widgets.time_entries_current_user.title"),properties:{name:i.t("js.grid.widgets.time_entries_current_user.title"),days:[!0,!0,!0,!0,!0,!0,!0]}},{identifier:"time_entries_project",component:Us,title:i.t("js.grid.widgets.time_entries_list.title"),properties:{name:i.t("js.grid.widgets.time_entries_list.title")}},{identifier:"documents",component:Yt,title:i.t("js.grid.widgets.documents.title"),properties:{name:i.t("js.grid.widgets.documents.title")}},{identifier:"members",component:or,title:i.t("js.grid.widgets.members.title"),properties:{name:i.t("js.grid.widgets.members.title")}},{identifier:"news",component:ni,title:i.t("js.grid.widgets.news.title"),properties:{name:i.t("js.grid.widgets.news.title")}},{identifier:"project_description",component:os,title:i.t("js.grid.widgets.project_description.title"),properties:{name:i.t("js.grid.widgets.project_description.title")}},{identifier:"custom_text",component:Is,title:i.t("js.grid.widgets.custom_text.title"),properties:{name:i.t("js.grid.widgets.custom_text.title"),text:{raw:""}}},{identifier:"project_details",component:Ms,title:i.t("js.grid.widgets.project_details.title"),properties:{name:i.t("js.grid.widgets.project_details.title")}},{identifier:"project_status",component:hr,title:i.t("js.grid.widgets.project_status.title"),properties:{name:i.t("js.grid.widgets.project_status.title")}},{identifier:"subprojects",component:Zs,title:i.t("js.grid.widgets.subprojects.title"),properties:{name:i.t("js.grid.widgets.subprojects.title")}}]})}(e)}}pr.\u0275mod=n.Zb({type:pr}),pr.\u0275inj=n.Yb({factory:function(e){return new(e||pr)(n.lc(n.A))},providers:[Lt,ri],imports:[[D.a,l.i,je.g,f.a,ve.a,is,Wt,Ht,ye.a,Ce.f.withComponents([Is,Yt,or,ni,Ni,Ri,ct,ls,os,Ms,hr,Zs,At,Us]),g.a]]});var gr=i("oqKi");const fr="openproject-base";class br{}br.\u0275fac=function(e){return new(e||br)},br.\u0275cmp=n.Vb({type:br,selectors:[["openproject-base"]],decls:2,vars:0,consts:[[1,"openproject-base--ui-view"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.cc(1,"ui-view"),n.gc())},directives:[zt.UIView],encapsulation:2});var mr=i("pQre");const wr=[{name:"root",url:"/{projects}/{projectPath}",component:br,abstract:!0,params:{projectPath:{type:"path",value:null,squash:!0},projects:{type:"path",value:null,squash:!0},flash_message:{dynamic:!0,value:null,inherit:!1}}},{name:"boards.**",parent:"root",url:"/boards",loadChildren:()=>i.e(25).then(i.bind(null,"lrTx")).then(e=>e.OpenprojectBoardsModule)},{name:"bim.**",parent:"root",url:"/bcf",loadChildren:()=>i.e(24).then(i.bind(null,"5VZj")).then(e=>e.OpenprojectIFCModelsModule)},{name:"backlogs.**",parent:"root",url:"/backlogs",loadChildren:()=>i.e(23).then(i.bind(null,"3r9q")).then(e=>e.OpenprojectBacklogsModule)},{name:"backlogs_sprint.**",parent:"root",url:"/sprints",loadChildren:()=>i.e(23).then(i.bind(null,"3r9q")).then(e=>e.OpenprojectBacklogsModule)},{name:"reporting.**",parent:"root",url:"/cost_reports",loadChildren:()=>i.e(31).then(i.bind(null,"1On3")).then(e=>e.OpenprojectReportingModule)},{name:"job-statuses.**",parent:"root",url:"/job_statuses",loadChildren:()=>i.e(27).then(i.bind(null,"lU+H")).then(e=>e.OpenProjectJobStatusModule)}];function vr(e,t="add"){e&&(Array.isArray(e)?e.forEach(e=>{document.body.classList[t](e)}):document.body.classList[t](e))}function yr(e,t="add"){if(!e)return;let i=jQuery("#main-menu ."+e)[0];if(!i)return;i.classList[t]("selected");let n=(i.getAttribute("title")||"").split(":").slice(-1)[0];"add"===t&&(n=I18n.t("js.description_current_position")+n),i.setAttribute("title",n)}class kr{constructor(e){!function(e){const t=e.get(Ue.TransitionService),i=e.get(Ue.StateService),n=e.get(v.a),s=e.get(xe.a),r=e.get(gr.a),a=e.get(mr.a);let c=document.querySelector(fr);t.onEnter({},(function(e,t){vr(_.get(t,"data.bodyClasses"),"add"),e.from().data&&_.get(t,"data.menuItem")!==e.from().data.menuItem&&yr(_.get(t,"data.menuItem"),"add"),window.scrollTo(0,0)})),t.onExit({},(function(e,t){vr(_.get(t,"data.bodyClasses"),"remove"),e.to().data&&_.get(t,"data.menuItem")!==e.to().data.menuItem&&yr(_.get(t,"data.menuItem"),"remove")})),t.onStart({},(function(e){const t=e.router.stateService,o=e.params("to"),l=(e.from(),e.to());if(o.start_onboarding_tour&&"work-packages.partitioned.list"!==l.name){const i=Object.assign({},e.params());return i.start_onboarding_tour=void 0,t.target(e.to(),i)}a.sync(e);const d=window.MiniProfiler;d&&d.pageTransition();const u=o.projectPath||s.identifier;if(!o.projects&&u){const e=_.clone(o);return _.assign(e,{projectPath:u,projects:"projects"}),t.target(l,e,{location:"replace"})}if(null===c){const e=window.location.pathname,t=e+window.location.search,n=i.href(l,o);if(n&&e!==n&&t!==n)return window.location.href=n,!1}return vr(_.get(l,"data.bodyClasses"),"add"),r.setIfFirst(l.name,o),e.to().name!==e.from().name&&n.clear(),o.flash_message&&n.add(o.flash_message),!0}))}(e)}}kr.\u0275mod=n.Zb({type:kr}),kr.\u0275inj=n.Yb({factory:function(e){return new(e||kr)(n.lc(n.A))},providers:[gr.a],imports:[[zt.UIRouterModule.forRoot({states:wr,useHash:!1,config:function(e,t,i){e.urlService.config.strictMode(!1),e.urlService.config.type("opQueryString",{encode:encodeURIComponent,decode:decodeURIComponent,raw:!0,dynamic:!0,is:e=>"string"==typeof e,equals:(e,t)=>_.isEqual(e,t)})}})]]});var Cr=i("ODu2"),jr=i("qs3h"),Pr=i("ylTo"),xr=i("kZPr"),Sr=i("VYxi"),_r=i("rJ6b"),Or=i("YefF"),Ir=i("fdeW"),Tr=i("hxzR"),Rr=i("/qfM");const Er="work-packages-menu-item",Mr=[{name:"work-packages",parent:"root",component:Or.a,url:"/work_packages?query_id&query_props&start_onboarding_tour",redirectTo:"work-packages.partitioned.list",data:{bodyClasses:"router--work-packages-base",menuItem:Er},params:{query_id:{type:"query",dynamic:!0},query_props:{type:"opQueryString"},start_onboarding_tour:{type:"query",squash:!0,value:void 0}}},{name:"work-packages.new",url:"/new?type&parent_id",component:xr.a,reloadOnSearch:!1,data:{baseRoute:"work-packages",allowMovingInEditMode:!0,bodyClasses:"router--work-packages-full-create",menuItem:Er}},{name:"work-packages.copy",url:"/{copiedFromWorkPackageId:[0-9]+}/copy",component:Sr.a,reloadOnSearch:!1,data:{baseRoute:"work-packages",allowMovingInEditMode:!0,bodyClasses:"router--work-packages-full-create",menuItem:Er}},{name:"work-packages.show",url:"/{workPackageId:[0-9]+}",redirectTo:"work-packages.show.activity",component:_r.a,data:{baseRoute:"work-packages",bodyClasses:"router--work-packages-full-view",newRoute:"work-packages.new",menuItem:Er}},{name:"work-packages.show.activity",url:"/activity",component:Cr.a,data:{parent:"work-packages.show",menuItem:Er}},{name:"work-packages.show.activity.details",url:"/activity/details/#{activity_no:d+}",component:Cr.a,data:{parent:"work-packages.show",menuItem:Er}},{name:"work-packages.show.relations",url:"/relations",component:jr.a,data:{parent:"work-packages.show",menuItem:Er}},{name:"work-packages.show.watchers",url:"/watchers",component:Pr.a,data:{parent:"work-packages.show",menuItem:Er}},{name:"work-packages.partitioned",component:Tr.a,url:"",data:{bodyClasses:""}},{name:"work-packages.partitioned.list",url:"",reloadOnSearch:!1,views:{"content-left":{component:Ir.a}},data:{bodyClasses:"router--work-packages-partitioned-split-view",menuItem:Er,partition:"-left-only"}},...Object(Rr.a)("work-packages.partitioned.list",Er,es.a)];class Fr{}Fr.\u0275mod=n.Zb({type:Fr}),Fr.\u0275inj=n.Yb({factory:function(e){return new(e||Fr)},imports:[[ve.a,zt.UIRouterModule.forChild({states:Mr})]]});class Ar{constructor(e,t,i,n){this.I18n=e,this.injector=t,this.PathHelper=i,this.currentProjectService=n,this._searchTerm=new Ie.a(""),this.searchTerm$=this._searchTerm.asObservable(),this._currentTab=new Ie.a("work_packages"),this.currentTab$=this._currentTab.asObservable(),this._projectScope=new Ie.a(""),this.projectScope$=this._projectScope.asObservable(),this._tabs=new Ie.a([]),this.tabs$=this._tabs.asObservable(),this._resultsHidden=new Ie.a(!1),this.resultsHidden$=this._resultsHidden.asObservable(),this.initialize()}initialize(){let e=this.loadGonData();e&&(e.available_search_types&&this._tabs.next(e.available_search_types),e.search_term&&this._searchTerm.next(e.search_term),e.current_tab&&this._currentTab.next(e.current_tab),e.project_scope?this._projectScope.next(e.project_scope):this.currentProjectService.path||this._projectScope.next("all"))}loadGonData(){try{return window.gon.global_search}catch(e){return null}}submitSearch(){window.location.href=this.searchPath()}searchPath(){let e=this.PathHelper.staticBase;return this.currentProjectService.path&&"all"!==this.projectScope&&(e=this.currentProjectService.path),e=e+"/search?"+this.searchQueryParams(),e}set searchTerm(e){this._searchTerm.next(e)}get searchTerm(){return this._searchTerm.value}get tabs(){return this._tabs.value}get currentTab(){return this._currentTab.value}set currentTab(e){this._currentTab.next(e)}get projectScope(){return this._projectScope.value}set projectScope(e){this._projectScope.next(e)}get resultsHidden(){return this._resultsHidden.value}set resultsHidden(e){this._resultsHidden.next(e)}searchQueryParams(){let e;return e="q="+encodeURIComponent(this.searchTerm),this.currentTab.length>0&&"all"!==this.currentTab&&(e=`${e}&${this.currentTab}=1`),this.projectScope.length>0&&(e=`${e}&scope=${this.projectScope}`),e}isAfterSearch(){return jQuery("body.controller-search").length>0}}Ar.\u0275fac=function(e){return new(e||Ar)(n.lc(y.a),n.lc(n.A),n.lc(q.a),n.lc(xe.a))},Ar.\u0275prov=n.Xb({token:Ar,factory:Ar.\u0275fac});class Lr{}Lr.\u0275mod=n.Zb({type:Lr}),Lr.\u0275inj=n.Yb({factory:function(e){return new(e||Lr)},providers:[Ar],imports:[[f.a,ve.a]]});var Dr=i("K018"),Vr=i("fbLK");class qr extends Vr.a{constructor(e,t,i){super(e),this.documentElement=e,this.confirmDialog=t,this.I18n=i}showEEOnlyHint(){this.confirmDialog.confirm({text:{title:this.I18n.t("js.types.attribute_groups.upgrade_to_ee"),text:this.I18n.t("js.types.attribute_groups.upgrade_to_ee_text"),button_continue:this.I18n.t("js.types.attribute_groups.more_information"),button_cancel:this.I18n.t("js.types.attribute_groups.nevermind")}}).then(()=>{window.location.href="https://www.openproject.org/enterprise-edition/?utm_source=unknown&utm_medium=community-edition&utm_campaign=form-configuration"})}}qr.\u0275fac=function(e){return new(e||qr)(n.lc(oe.d),n.lc(p.a),n.lc(y.a))},qr.\u0275prov=n.Xb({token:qr,factory:qr.\u0275fac});var $r=i("OW6k"),Nr=i("DHgU"),Br=i("WPBv"),zr=i("9Ejp");function Hr(e,t){if(1&e){const e=n.ic();n.hc(0,"type-form-attribute-group",25),n.pc("removeAttribute",(function(t){n.Lc(e);return n.rc(2).deactivateAttribute(t)}))("deleteGroup",(function(){n.Lc(e);const t=n.rc().$implicit;return n.rc().deleteGroup(t)})),n.gc()}if(2&e){const e=n.rc().$implicit;n.wc("group",e)}}function Qr(e,t){if(1&e){const e=n.ic();n.hc(0,"type-form-query-group",26),n.pc("editQuery",(function(){n.Lc(e);const t=n.rc().$implicit;return n.rc().editQuery(t)}))("deleteGroup",(function(){n.Lc(e);const t=n.rc().$implicit;return n.rc().deleteGroup(t)})),n.gc()}if(2&e){const e=n.rc().$implicit;n.wc("group",e)}}function Wr(e,t){if(1&e&&(n.fc(0),n.Tc(1,Hr,1,1,"type-form-attribute-group",23),n.Tc(2,Qr,1,1,"type-form-query-group",24),n.ec()),2&e){const e=t.$implicit;n.Pb(1),n.wc("ngIf","attribute"===e.type),n.Pb(1),n.wc("ngIf","query"===e.type)}}function Xr(e,t){if(1&e&&n.cc(0,"span",31),2&e){const e=n.rc(2);n.wc("textContent",e.text.custom_field)}}function Ur(e,t){if(1&e&&(n.hc(0,"div",27),n.cc(1,"span",28),n.hc(2,"span",29),n.Vc(3),n.Tc(4,Xr,1,1,"span",30),n.gc(),n.gc()),2&e){const e=t.$implicit;n.Qb("data-key",e.key),n.Pb(3),n.Xc(" ",e.translation," "),n.Pb(1),n.wc("ngIf",e.is_cf)}}const Gr="__empty";class Yr extends tt.a{constructor(e,t,i,n,s,r,a){super(),this.elementRef=e,this.I18n=t,this.Gon=i,this.dragula=n,this.confirmDialog=s,this.notificationsService=r,this.externalRelationQuery=a,this.text={drag_to_activate:this.I18n.t("js.admin.type_form.drag_to_activate"),reset:this.I18n.t("js.admin.type_form.reset_to_defaults"),label_group:this.I18n.t("js.label_group"),new_group:this.I18n.t("js.admin.type_form.new_group"),label_inactive:this.I18n.t("js.admin.type_form.inactive"),custom_field:this.I18n.t("js.admin.type_form.custom_field"),add_group:this.I18n.t("js.admin.type_form.add_group"),add_table:this.I18n.t("js.admin.type_form.add_table")},this.groups=[],this.inactives=[]}ngOnInit(){this.element=this.elementRef.nativeElement,this.no_filter_query=this.element.dataset.noFilterQuery,this.form=jQuery(this.element).closest("form"),this.submit=this.form.find(".form-configuration--save");let e=!1;this.form.on("submit",t=>{e=!0}),this.submit.on("mousedown",t=>(setTimeout(()=>{e||this.form.trigger("submit")},50),!0)),this.form.on("submit.typeformupdater",()=>(this.updateHiddenFields(),!0)),this.groupsDrake=this.dragula.createGroup("groups",{moves:(e,t,i)=>i.classList.contains("group-handle")}).drake,this.attributeDrake=this.dragula.createGroup("attributes",{moves:(e,t,i)=>i.classList.contains("attribute-handle")}).drake,this.groups=JSON.parse(this.element.dataset.activeGroups).filter(e=>(null==e?void 0:e.key)!==Gr),this.inactives=JSON.parse(this.element.dataset.inactiveAttributes);const t=this;this.autoscroll=new $r.a([document.getElementById("content-wrapper")],{margin:25,maxSpeed:10,scrollWhenOutside:!0,autoScroll:function(){const e=t.groupsDrake&&t.groupsDrake.dragging,i=t.attributeDrake&&t.attributeDrake.dragging;return e||i}})}ngAfterViewInit(){const e=jQuery(this.elementRef.nativeElement).find(".toolbar-items");Object(Br.a)(e)}deactivateAttribute(e){this.updateInactives(this.inactives.concat(e))}addGroupAndOpenQuery(){let e=this.createGroup("query");this.editQuery(e)}editQuery(e){const t={"display-settings":I18n.t("js.work_packages.table_configuration.embedded_tab_disabled"),timelines:I18n.t("js.work_packages.table_configuration.embedded_tab_disabled")};this.externalRelationQuery.show({currentQuery:JSON.parse(e.query),callback:t=>e.query=JSON.stringify(t),disabledTabs:t})}deleteGroup(e){return"attribute"===e.type&&this.updateInactives(this.inactives.concat(e.attributes)),this.groups=this.groups.filter(t=>t!==e),e}createGroup(e,t=""){let i={type:e,name:"",key:null,query:this.no_filter_query,attributes:[]};return this.groups.unshift(i),i}resetToDefault(e){return this.confirmDialog.confirm({text:{title:this.I18n.t("js.types.attribute_groups.reset_title"),text:this.I18n.t("js.types.attribute_groups.confirm_reset"),button_continue:this.I18n.t("js.label_reset")}}).then(()=>{this.form.find("input#type_attribute_groups").val(JSON.stringify([])),this.form.off("submit.typeformupdater"),this.form.trigger("submit")}),e.preventDefault(),!1}updateInactives(e){this.inactives=[...e].sort((e,t)=>e.translation.localeCompare(t.translation))}get emptyGroup(){return{type:"attribute",key:Gr,name:"empty",attributes:[]}}updateHiddenFields(){const e=this.form.find(".admin-type-form--hidden-field");0===this.groups.length?e.val(JSON.stringify([this.emptyGroup])):e.val(JSON.stringify(this.groups))}}function Kr(e,t){if(1&e){const e=n.ic();n.hc(0,"div",2),n.pc("click",(function(){n.Lc(e);return n.rc().startEditing()})),n.gc()}if(2&e){const e=n.rc();n.wc("textContent",e.name)}}function Zr(e,t){if(1&e){const e=n.ic();n.hc(0,"input",3,4),n.pc("ngModelChange",(function(t){n.Lc(e);return n.rc().editedName=t}))("blur",(function(t){n.Lc(e);return n.rc().saveEdition(t)}))("keydown.escape",(function(){n.Lc(e);return n.rc().reset()}))("keydown.enter",(function(t){n.Lc(e);return n.rc().saveEdition(t)})),n.gc()}if(2&e){const e=n.rc();n.wc("ngModel",e.editedName),n.Qb("placeholder",e.placeholder)}}Yr.\u0275fac=function(e){return new(e||Yr)(n.bc(n.q),n.bc(y.a),n.bc(Nr.a),n.bc(zr.c),n.bc(p.a),n.bc(v.a),n.bc(B.a))},Yr.\u0275cmp=n.Vb({type:Yr,selectors:[["admin-type-form-configuration"]],features:[n.Ob([qr]),n.Mb],decls:29,vars:10,consts:[[1,"toolbar-container","-with-dropdown"],[1,"toolbar"],[1,"toolbar-items"],[1,"toolbar-item"],["type","button -alt-highlight",1,"form-configuration--reset","button",3,"click"],["icon-classes","button--icon icon-undo"],[1,"button--text",3,"textContent"],[1,"toolbar-item","drop-down"],["aria-haspopup","true",1,"form-configuration--add-group","button","-alt-highlight"],["icon-classes","button--icon icon-add"],["icon-classes","button--dropdown-indicator"],[1,"menu-drop-down-container"],[1,"form-configuration--add-group",3,"textContent","accessibleClick"],[1,"grid-block","wrap"],[1,"grid-content","small-12","medium-6"],["id","draggable-groups","dragula","groups",3,"dragulaModel","dragulaModelChange"],[4,"ngFor","ngForOf"],["id","type-form-conf-inactive-group"],[1,"group-head"],[1,"group-name",3,"textContent"],[1,"advice",3,"textContent"],["dragula","attributes",1,"attributes",3,"dragulaModel","dragulaModelChange"],["class","type-form-conf-attribute",4,"ngFor","ngForOf"],[3,"group","removeAttribute","deleteGroup",4,"ngIf"],[3,"group","editQuery","deleteGroup",4,"ngIf"],[3,"group","removeAttribute","deleteGroup"],[3,"group","editQuery","deleteGroup"],[1,"type-form-conf-attribute"],[1,"attribute-handle","icon-drag-handle"],[1,"attribute-name"],["class","attribute-cf-label",3,"textContent",4,"ngIf"],[1,"attribute-cf-label",3,"textContent"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"ul",2),n.hc(3,"li",3),n.hc(4,"button",4),n.pc("click",(function(e){return t.resetToDefault(e)})),n.cc(5,"op-icon",5),n.cc(6,"span",6),n.gc(),n.gc(),n.hc(7,"li",7),n.hc(8,"a",8),n.cc(9,"op-icon",9),n.cc(10,"span",6),n.cc(11,"op-icon",10),n.gc(),n.hc(12,"ul",11),n.hc(13,"li"),n.hc(14,"a",12),n.pc("accessibleClick",(function(){return t.createGroup("attribute","")})),n.gc(),n.gc(),n.hc(15,"li"),n.hc(16,"a",12),n.pc("accessibleClick",(function(){return t.addGroupAndOpenQuery()})),n.gc(),n.gc(),n.gc(),n.gc(),n.gc(),n.gc(),n.gc(),n.hc(17,"div",13),n.hc(18,"div",14),n.hc(19,"div",15),n.pc("dragulaModelChange",(function(e){return t.groups=e})),n.Tc(20,Wr,3,2,"ng-container",16),n.gc(),n.gc(),n.hc(21,"div",14),n.hc(22,"div",17),n.hc(23,"div",18),n.cc(24,"span",19),n.Vc(25," "),n.cc(26,"span",20),n.gc(),n.hc(27,"div",21),n.pc("dragulaModelChange",(function(e){return t.inactives=e})),n.Tc(28,Ur,5,3,"div",22),n.gc(),n.gc(),n.gc(),n.gc()),2&e&&(n.Pb(6),n.wc("textContent",t.text.reset),n.Pb(4),n.wc("textContent",t.text.label_group),n.Pb(4),n.wc("textContent",t.text.add_group),n.Pb(2),n.wc("textContent",t.text.add_table),n.Pb(3),n.wc("dragulaModel",t.groups),n.Pb(1),n.wc("ngForOf",t.groups),n.Pb(4),n.wc("textContent",t.text.label_inactive),n.Pb(2),n.wc("textContent",t.text.drag_to_activate),n.Pb(1),n.wc("dragulaModel",t.inactives),n.Pb(1),n.wc("ngForOf",t.inactives))},encapsulation:2});class Jr{constructor(e,t){this.bannerService=e,this.cdRef=t,this.placeholder="",this.onValueChange=new n.s,this.editing=!1}ngOnInit(){this.editedName=this.name,this.name&&0!==this.name.length||this.startEditing()}startEditing(){this.bannerService.conditional(()=>this.bannerService.showEEOnlyHint(),()=>{this.editing=!0})}saveEdition(e){return this.leaveEditingMode(),this.name=this.editedName.trim(),this.cdRef.detectChanges(),""!==this.name&&this.onValueChange.emit(this.name),e.preventDefault(),e.stopPropagation(),!1}reset(){this.editing=!1,this.editedName=this.name}leaveEditingMode(){null!=this.editedName&&this.editedName.trim().length>0&&(this.editing=!1)}}function ea(e,t){if(1&e&&n.cc(0,"span",12),2&e){const e=n.rc(2);n.wc("textContent",e.text.custom_field)}}function ta(e,t){if(1&e){const e=n.ic();n.hc(0,"div",7),n.cc(1,"span",8),n.hc(2,"span",9),n.Vc(3),n.Tc(4,ea,1,1,"span",10),n.gc(),n.hc(5,"span",11),n.pc("click",(function(){n.Lc(e);const i=t.$implicit;return n.rc().removeFromGroup(i)})),n.gc(),n.gc()}if(2&e){const e=t.$implicit;n.Qb("data-key",e.key),n.Pb(3),n.Xc(" ",e.translation," "),n.Pb(1),n.wc("ngIf",e.is_cf)}}Jr.\u0275fac=function(e){return new(e||Jr)(n.bc(qr),n.bc(n.i))},Jr.\u0275cmp=n.Vb({type:Jr,selectors:[["group-edit-in-place"]],inputs:{placeholder:"placeholder",name:"name"},outputs:{onValueChange:"onValueChange"},decls:2,vars:2,consts:[["class","group-edit-handler",3,"textContent","click",4,"ngIf"],["class","group-edit-in-place--input","type","text","autoFocus","",3,"ngModel","ngModelChange","blur","keydown.escape","keydown.enter",4,"ngIf"],[1,"group-edit-handler",3,"textContent","click"],["type","text","autoFocus","",1,"group-edit-in-place--input",3,"ngModel","ngModelChange","blur","keydown.escape","keydown.enter"],["nameInput",""]],template:function(e,t){1&e&&(n.Tc(0,Kr,1,1,"div",0),n.Tc(1,Zr,2,2,"input",1)),2&e&&(n.wc("ngIf",!t.editing),n.Pb(1),n.wc("ngIf",t.editing))},directives:[oe.q,l.c,mn.a,l.m,l.p],encapsulation:2,changeDetection:0});class ia{constructor(e,t){this.I18n=e,this.cdRef=t,this.deleteGroup=new n.s,this.removeAttribute=new n.s,this.text={custom_field:this.I18n.t("js.admin.type_form.custom_field")}}rename(e){this.group.name=e,delete this.group.key,this.cdRef.detectChanges()}removeFromGroup(e){this.group.attributes=this.group.attributes.filter(t=>t!==e),this.removeAttribute.emit(e)}}ia.\u0275fac=function(e){return new(e||ia)(n.bc(y.a),n.bc(n.i))},ia.\u0275cmp=n.Vb({type:ia,selectors:[["type-form-attribute-group"]],inputs:{group:"group"},outputs:{deleteGroup:"deleteGroup",removeAttribute:"removeAttribute"},decls:7,vars:3,consts:[[1,"type-form-conf-group"],[1,"group-head"],[1,"group-handle","icon-drag-handle"],[1,"group-name",3,"name","onValueChange"],[1,"delete-group","icon-small","icon-close",3,"click"],["dragula","attributes",1,"attributes",3,"dragulaModel","dragulaModelChange"],["class","type-form-conf-attribute",4,"ngFor","ngForOf"],[1,"type-form-conf-attribute"],[1,"attribute-handle","icon-drag-handle"],[1,"attribute-name"],["class","attribute-cf-label",3,"textContent",4,"ngIf"],[1,"delete-attribute","icon-small","icon-close",3,"click"],[1,"attribute-cf-label",3,"textContent"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.cc(2,"span",2),n.hc(3,"group-edit-in-place",3),n.pc("onValueChange",(function(e){return t.rename(e)})),n.gc(),n.hc(4,"span",4),n.pc("click",(function(){return t.deleteGroup.emit()})),n.gc(),n.gc(),n.hc(5,"div",5),n.pc("dragulaModelChange",(function(e){return t.group.attributes=e})),n.Tc(6,ta,6,3,"div",6),n.gc(),n.gc()),2&e&&(n.Pb(3),n.wc("name",t.group.name),n.Pb(2),n.wc("dragulaModel",t.group.attributes),n.Pb(1),n.wc("ngForOf",t.group.attributes))},directives:[Jr,zr.a,oe.p,oe.q],encapsulation:2,changeDetection:0});class na{constructor(e,t){this.I18n=e,this.cdRef=t,this.text={edit_query:this.I18n.t("js.admin.type_form.edit_query")},this.editQuery=new n.s,this.deleteGroup=new n.s}rename(e){this.group.name=e,this.cdRef.detectChanges()}}na.\u0275fac=function(e){return new(e||na)(n.bc(y.a),n.bc(n.i))},na.\u0275cmp=n.Vb({type:na,selectors:[["type-form-query-group"]],inputs:{group:"group"},outputs:{editQuery:"editQuery",deleteGroup:"deleteGroup"},decls:9,vars:2,consts:[[1,"type-form-conf-group","type-form-query-group"],[1,"group-head"],[1,"group-handle","icon-drag-handle"],[1,"group-name",3,"name","onValueChange"],[1,"delete-group","icon-small","icon-close",3,"click"],[1,"type-form-query"],[1,"type-form-query-group--edit-button",3,"click"],["icon-classes","button--icon icon-edit"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.cc(2,"span",2),n.hc(3,"group-edit-in-place",3),n.pc("onValueChange",(function(e){return t.rename(e)})),n.gc(),n.hc(4,"span",4),n.pc("click",(function(){return t.deleteGroup.emit()})),n.gc(),n.gc(),n.hc(5,"div",5),n.hc(6,"span",6),n.pc("click",(function(){return t.editQuery.emit()})),n.cc(7,"op-icon",7),n.Vc(8),n.gc(),n.gc(),n.gc()),2&e&&(n.Pb(3),n.wc("name",t.group.name),n.Pb(5),n.Xc(" ",t.text.edit_query," "))},directives:[Jr,yt.a],encapsulation:2,changeDetection:0});var sa=i("8ggW");class ra{constructor(e,t,i,n,s){this.elementRef=e,this.I18n=t,this.cdRef=i,this.urlParamsHelper=n,this.externalQuery=s,this.urlParams=!1,this.text={edit_query:this.I18n.t("js.admin.type_form.edit_query")}}ngOnInit(){const e=this.elementRef.nativeElement;this.id=e.dataset.id,this.name=e.dataset.name,this.urlParams="true"===e.dataset.urlParams,this.queryProps=e.dataset.query}editQuery(){let e=this.queryProps;if(!this.urlParams)try{e=JSON.parse(this.queryProps)}catch(t){console.error(`Failed to parse query props from ${this.queryProps}: ${t}`),e={}}this.externalQuery.show({currentQuery:e,urlParams:this.urlParams,callback:e=>{this.queryProps=this.urlParams?e:JSON.stringify(e),this.cdRef.detectChanges()}})}}ra.\u0275fac=function(e){return new(e||ra)(n.bc(n.q),n.bc(y.a),n.bc(n.i),n.bc(Ei.a),n.bc(k.a))},ra.\u0275cmp=n.Vb({type:ra,selectors:[["editable-query-props"]],decls:2,vars:5,consts:[["type","hidden",3,"value"],[1,"button--link",3,"accessibleClickStopEvent","textContent","accessibleClick"]],template:function(e,t){1&e&&(n.cc(0,"input",0),n.hc(1,"a",1),n.pc("accessibleClick",(function(){return t.editQuery()})),n.gc()),2&e&&(n.wc("value",t.queryProps),n.Qb("name",t.name||void 0)("id",t.id||void 0),n.Pb(1),n.wc("accessibleClickStopEvent",!0)("textContent",t.text.edit_query))},directives:[dn.a],encapsulation:2,changeDetection:0});class aa{}function ca(e,t){if(1&e){const e=n.ic();n.hc(0,"div",9),n.pc("click",(function(i){n.Lc(e);const s=t.$implicit;return n.rc().select(i,s)})),n.gc()}if(2&e){const e=t.$implicit;n.wc("id",e.identifier)("textContent",e.title)}}function oa(e,t){if(1&e&&n.cc(0,"enterprise-banner",10),2&e){const e=n.rc();n.wc("linkMessage",e.text.upsale_link)("textMessage",e.text.upsale_text)}}aa.\u0275mod=n.Zb({type:aa}),aa.\u0275inj=n.Yb({factory:function(e){return new(e||aa)},providers:[],imports:[[zr.b.forRoot(),f.a,sa.a]]}),n.Pc(Yr,[zr.a,zt.UISref,zt.AnchorUISref,zt.UIView,zt.UISrefActive,zt.UISrefStatus,oe.n,oe.o,oe.p,oe.q,oe.x,oe.t,oe.u,oe.v,oe.w,oe.r,oe.s,l.C,l.r,l.B,l.c,l.s,l.v,l.a,l.y,l.z,l.u,l.m,l.n,l.x,l.k,l.j,l.t,l.b,l.d,l.p,l.q,l.o,on.a,on.b,on.h,on.e,ln.a,je.e,je.f,je.a,je.b,je.d,je.c,dn.a,un.a,hn.a,pn.a,pn.n,pn.d,pn.c,pn.e,pn.f,pn.g,pn.h,pn.i,pn.j,pn.k,pn.l,pn.m,gn.a,fn.a,bn.a,yt.a,mn.a,wn.a,vn.a,yn.a,kn.a,Cn.a,jn.a,Pn.a,xn.a,Sn.a,_n.a,qt.a,On.a,Ve.a,Xt.a,In.a,Tn.a,Ee.a,Kt.a,Rn.a,Ce.c,Ce.d,Ce.a,Ce.b,Ce.e,En.a,Mn.a,Fn.a,ia,na,Yr,Jr,ra],[oe.a,oe.C,oe.m,oe.j,oe.A,oe.f,oe.z,oe.B,oe.c,oe.e,oe.h,oe.i,oe.k]);class la extends I.a{constructor(e,t,i,n,s,r){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.widgetsService=n,this.i18n=s,this.bannerService=r,this.text={title:this.i18n.t("js.grid.add_widget"),close_popup:this.i18n.t("js.button_close"),upsale_link:this.i18n.t("js.grid.upsale.link"),upsale_text:this.i18n.t("js.grid.upsale.text")},this.eeShowBanners=!1}ngOnInit(){super.ngOnInit(),this.eeShowBanners=this.bannerService.eeShowBanners}get selectable(){return this.eligibleWidgets.sort((e,t)=>e.title.localeCompare(t.title))}select(e,t){this.chosenWidget=t,this.closeMe(e)}trackWidgetBy(e){return e.identifier}get eligibleWidgets(){let e=this.locals.schema.widgets.allowedValues.map(e=>e.identifier);return this.widgetsService.registered.filter(t=>e.includes(t.identifier))}}la.\u0275fac=function(e){return new(e||la)(n.bc(n.q),n.bc(O.a),n.bc(n.i),n.bc(Lt),n.bc(y.a),n.bc(Vr.a))},la.\u0275cmp=n.Vb({type:la,selectors:[["ng-component"]],features:[n.Mb],decls:9,vars:5,consts:[[1,"op-modal--portal","ngdialog-theme-openproject"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container","confirm-dialog--modal","loading-indicator--location"],[1,"op-modal--modal-header"],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[1,"icon-context","icon-attention",3,"textContent"],[1,"ngdialog-body","op-modal--modal-body"],["class","grid--addable-widget",3,"id","textContent","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--add-widget-ee","opReferrer","grids#add-widget",3,"linkMessage","textMessage",4,"ngIf"],[1,"grid--addable-widget",3,"id","textContent","click"],["opReferrer","grids#add-widget",1,"grid--add-widget-ee",3,"linkMessage","textMessage"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.hc(3,"a",3),n.hc(4,"i",4),n.pc("click",(function(e){return t.closeMe(e)})),n.gc(),n.gc(),n.cc(5,"h3",5),n.gc(),n.hc(6,"div",6),n.Tc(7,ca,1,2,"div",7),n.Tc(8,oa,1,2,"enterprise-banner",8),n.gc(),n.gc(),n.gc()),2&e&&(n.Pb(4),n.Qb("title",t.text.close_popup),n.Pb(1),n.wc("textContent",t.text.title),n.Pb(2),n.wc("ngForOf",t.selectable)("ngForTrackBy",t.trackWidgetBy),n.Pb(1),n.wc("ngIf",t.eeShowBanners))},directives:[oe.p,oe.q,Rn.a],encapsulation:2});class da{constructor(e){this.layout=e}down(e,t){let i=[],n=this.layout.widgetAreas.slice(0);for(t&&(n=n.filter(e=>e.guid!==t.guid)),n.sort((e,t)=>t.startRow-e.startRow);null!==e;)i.push(e),n=n.filter(t=>t.guid!==e.guid),e=this.moveOneDown(i,n)}moveOneDown(e,t){let i=this.firstAreaToMove(e,t);if(i){let e=i[0],t=i[1],n=e.widget.height;return e.startRow=t.endRow,e.endRow=e.startRow+n,this.layout.numRows<e.endRow-1&&(this.layout.numRows=e.endRow-1),e}return null}firstAreaToMove(e,t){let i=null,n=null;if(t.forEach(t=>{e.forEach(e=>{if(e.overlaps(t))return i=e,void(n=t)})}),null!==n){let t=i;return e.forEach(e=>{e.endRow>t.endRow&&n.columnOverlaps(e)&&(t=e)}),[n,t]}return null}}da.\u0275fac=function(e){return new(e||da)(n.lc(Re))},da.\u0275prov=n.Xb({token:da,factory:da.\u0275fac});var ua=i("gcYM"),ha=i("/uUt");class pa{constructor(e,t){this.layout=e,this.move=t,this.setupMousedOverAreaSubscription()}ngOnDestroy(){this.mousedOverAreaObserver.unsubscribe()}setupMousedOverAreaSubscription(){this.mousedOverAreaObserver=this.layout.$mousedOverArea.pipe(Object(ua.a)(10),Object(ha.a)(),Object(gs.a)(e=>this.currentlyDragging&&!!e&&!this.layout.isGap(e)&&(this.placeholderArea.startRow!==e.startRow||this.placeholderArea.startColumn!==e.startColumn))).subscribe(e=>{this.updateArea(e),this.layout.scrollPlaceholderIntoView()})}updateArea(e){this.layout.resetAreas(this.draggedArea),this.moveAreasOnDragging(e)}moveAreasOnDragging(e){if(!this.placeholderArea)return;let t=this.draggedArea;this.copyPositionButRestrict(e,this.placeholderArea),this.move.down(this.placeholderArea,t)}get currentlyDragging(){return!!this.draggedArea}isDropOnlyArea(e){return!this.currentlyDragging&&e.endRow===this.layout.numRows+2}isDragged(e){return this.currentlyDragging&&this.draggedArea.guid===e.guid}isPassive(e){return this.currentlyDragging&&!this.isDragged(e)}get isDraggable(){return this.layout.isEditable}start(e){this.placeholderArea=new _e(e.widget),this.draggedHeight=document.getElementById(e.guid).offsetHeight-2,this.draggedArea=e}abort(){document.dispatchEvent(new Event("mouseup")),this.draggedArea=null,this.placeholderArea=null,this.layout.resetAreas()}drop(){this.draggedArea&&(this.placeholderArea.copyDimensionsTo(this.draggedArea),this.draggedArea.unchangedSize||(this.layout.writeAreaChangesToWidgets(),this.layout.cleanupUnusedAreas(),this.layout.rebuildAndPersist()),this.draggedArea=null,this.placeholderArea=null)}copyPositionButRestrict(e,t){t.startRow=e.startRow,e.startRow===this.layout.numRows+1?t.endRow=this.layout.numRows+2:e.startRow+t.widget.height>this.layout.numRows+1?t.endRow=this.layout.numRows+1:t.endRow=e.startRow+t.widget.height,t.startColumn=e.startColumn,e.startColumn+t.widget.width>this.layout.numColumns+1?t.endColumn=this.layout.numColumns+1:t.endColumn=e.startColumn+t.widget.width}}pa.\u0275fac=function(e){return new(e||pa)(n.lc(Re),n.lc(da))},pa.\u0275prov=n.Xb({token:pa,factory:pa.\u0275fac});class ga{constructor(e,t,i){this.layout=e,this.move=t,this.drag=i}end(e){this.resizedArea&&(this.resizedArea=null,e.unchangedSize||(this.layout.writeAreaChangesToWidgets(),this.layout.cleanupUnusedAreas(),this.layout.rebuildAndPersist()))}abort(){this.resizedArea&&(this.layout.resetAreas(),this.resizedArea=null)}start(e){this.resizedArea=e;let t=this.layout.gridAreas.filter(e=>{let t=e.startRow===this.resizedArea.startRow&&e.startColumn>=this.resizedArea.startColumn,i=e.startRow>this.resizedArea.startRow&&e.startColumn>=this.resizedArea.startColumn&&this.layout.widgetAreas.some(t=>t.startRow===e.startRow&&(t.endColumn<=this.resizedArea.startColumn||t.startColumn>=e.endColumn));return t||i});this.targetIds=t.map(e=>e.guid)}moving(e){this.resizedArea&&this.layout.mousedOverArea&&this.targetIds.includes(this.layout.mousedOverArea.guid)&&(this.layout.resetAreas(),this.resizedArea.endRow=this.layout.mousedOverArea.endRow,this.resizedArea.endColumn=this.layout.mousedOverArea.endColumn,this.move.down(this.resizedArea,this.resizedArea))}isTarget(e){let t=e.guid;return this.resizedArea&&this.targetIds.includes(t)}isResized(e){return this.resizedArea&&this.resizedArea.guid===e.guid}isPassive(e){return this.currentlyResizing&&!this.isResized(e)}get currentlyResizing(){return!!this.resizedArea}get isResizable(){return!this.drag.currentlyDragging&&this.isAllowed}get isAllowed(){return this.layout.gridResource.updateImmediately}}ga.\u0275fac=function(e){return new(e||ga)(n.lc(Re),n.lc(da),n.lc(pa))},ga.\u0275prov=n.Xb({token:ga,factory:ga.\u0275fac});class fa{constructor(e,t,i,n,s,r,a,c){this.opModalService=e,this.injector=t,this.halResource=i,this.layout=n,this.drag=s,this.move=r,this.resize=a,this.i18n=c,this.text={add:this.i18n.t("js.grid.add_widget")}}isAddable(e){return!this.drag.currentlyDragging&&!this.resize.currentlyResizing&&(this.layout.mousedOverArea===e||this.layout.isSingleCell||this.layout.inHelpMode)&&this.isAllowed}widget(e){this.select(e).then(t=>{this.layout.isGap(e)&&this.addLine(e);let i=new _e(t);this.setMaxWidth(i),this.persist(i)}).catch(()=>{})}get addText(){return this.text.add}select(e){return new Promise((t,i)=>{this.opModalService.show(la,this.injector,{schema:this.layout.schema}).closingEvent.subscribe(n=>{let s=n.chosenWidget;if(!s)return void i();let r={_type:"GridWidget",identifier:s.identifier,startRow:e.startRow,endRow:e.endRow,startColumn:e.startColumn,endColumn:e.endColumn,options:s.properties||{}},a=this.halResource.createHalResource(r);a.grid=this.layout.gridResource,t(a)})})}addLine(e){e.isRow?this.layout.addRow(e.startRow-1,e.startColumn):e.isColumn&&this.layout.addColumn(e.startColumn-1,e.startRow)}setMaxWidth(e){e.endColumn=this.layout.numColumns+1,this.layout.widgetAreas.forEach(t=>{e.startColumnOverlaps(t)&&(e.endColumn=t.startColumn)})}persist(e){e.writeAreaChangeToWidget(),this.layout.widgetAreas.push(e),this.layout.widgetResources.push(e.widget),this.layout.rebuildAndPersist()}get isAllowed(){return this.layout.gridResource&&this.layout.gridResource.updateImmediately}}fa.\u0275fac=function(e){return new(e||fa)(n.lc(O.b),n.lc(n.A),n.lc(C.a),n.lc(Re),n.lc(pa),n.lc(da),n.lc(ga),n.lc(y.a))},fa.\u0275prov=n.Xb({token:fa,factory:fa.\u0275fac});class ba{constructor(e,t,i,n,s,r,a,c,o){this.gridInitialization=e,this.pathHelper=t,this.currentProject=i,this.i18n=n,this.cdRef=s,this.title=r,this.addWidget=a,this.renderer=c,this.areas=o,this.text={title:this.i18n.t(`js.${this.i18nNamespace()}.label`),html_title:this.i18n.t(`js.${this.i18nNamespace()}.label`)}}ngOnInit(){this.renderer.addClass(document.body,"widget-grid-layout"),this.gridInitialization.initialize(this.gridScopePath()).then(e=>{this.grid=e,this.cdRef.detectChanges()}),this.setHtmlTitle()}ngOnDestroy(){this.renderer.removeClass(document.body,"widget-grid-layout")}setHtmlTitle(){this.title.setTitle(this.text.html_title)}}ba.\u0275fac=function(e){return new(e||ba)(n.bc(ri),n.bc(q.a),n.bc(xe.a),n.bc(y.a),n.bc(n.i),n.bc(D.e),n.bc(fa),n.bc(n.R),n.bc(Re))},ba.\u0275dir=n.Wb({type:ba});i("uhGA");function ma(e,t){if(1&e&&n.cc(0,"span",10),2&e){const e=n.rc(2);n.wc("hidden",e.isMobileDevice)}}function wa(e,t){if(1&e){const e=n.ic();n.hc(0,"resizer",11),n.pc("end",(function(){n.Lc(e);const t=n.rc().$implicit;return n.rc().resize.end(t)}))("start",(function(){n.Lc(e);const t=n.rc().$implicit;return n.rc().resize.start(t)}))("move",(function(t){n.Lc(e);return n.rc(2).resize.moving(t)})),n.hc(1,"div",12),n.cc(2,"i",13),n.gc(),n.gc()}2&e&&n.wc("customHandler",!0)}const va=function(e,t,i){return{"-dragged":e,"-passive":t,"-resizing":i}};function ya(e,t){if(1&e){const e=n.ic();n.hc(0,"div",5),n.hc(1,"div",6),n.pc("cdkDragStarted",(function(){n.Lc(e);const i=t.$implicit;return n.rc().drag.start(i)}))("cdkDragDropped",(function(){n.Lc(e);return n.rc().drag.drop()})),n.Tc(2,ma,1,1,"span",7),n.cc(3,"ndc-dynamic",8),n.gc(),n.Tc(4,wa,3,1,"resizer",9),n.gc()}if(2&e){const e=t.$implicit,i=n.rc();n.Sc("grid-row-start",e.gridStartRow)("grid-row-end",e.gridEndRow)("grid-column-start",e.gridStartColumn)("grid-column-end",e.gridEndColumn),n.wc("ngClass",n.Dc(18,va,i.drag.isDragged(e),i.drag.isPassive(e)||i.resize.isPassive(e),i.resize.isResized(e)))("id",e.guid)("cdkDropListData",e)("cdkDropListConnectedTo",i.layout.gridAreaIds),n.Pb(1),n.wc("cdkDragDisabled",i.isMobileDevice||!i.drag.isDraggable),n.Pb(1),n.wc("ngIf",i.drag.isDraggable),n.Pb(1),n.wc("ndcDynamicComponent",i.widgetComponent(e))("ndcDynamicInputs",i.widgetComponentInput(e))("ndcDynamicOutputs",i.widgetComponentOutput(e)),n.Pb(1),n.wc("ngIf",i.resize.isResizable)}}function ka(e,t){if(1&e){const e=n.ic();n.hc(0,"div",16),n.pc("click",(function(){n.Lc(e);const t=n.rc().$implicit;return n.rc().add.widget(t)})),n.gc()}if(2&e){const e=n.rc(2);n.wc("title",e.add.addText)}}const Ca=function(e,t,i,n,s){return{"-drop-target":e,"-drop-only":t,"-resize-target":i,"-addable":n,"-help-mode":s}};function ja(e,t){if(1&e){const e=n.ic();n.hc(0,"div",14),n.pc("mouseover",(function(){n.Lc(e);const i=t.$implicit;return n.rc().layout.setMousedOverArea(i)})),n.Tc(1,ka,1,1,"div",15),n.gc()}if(2&e){const e=t.$implicit,i=n.rc();n.Sc("grid-row-start",e.gridStartRow)("grid-row-end",e.gridEndRow)("grid-column-start",e.gridStartColumn)("grid-column-end",e.gridEndColumn),n.wc("ngClass",n.Fc(13,Ca,i.drag.currentlyDragging,i.drag.isDropOnlyArea(e),i.resize.isTarget(e),i.add.isAddable(e),i.layout.inHelpMode))("id",e.guid)("cdkDropListData",e)("cdkDropListConnectedTo",i.layout.gridAreaIds),n.Pb(1),n.wc("ngIf",i.add.isAllowed)}}function Pa(e,t){if(1&e){const e=n.ic();n.hc(0,"div",19),n.pc("click",(function(){n.Lc(e);const t=n.rc().$implicit;return n.rc().add.widget(t)})),n.gc()}if(2&e){const e=n.rc(2);n.wc("title",e.add.addText)}}const xa=function(e,t,i,n){return{"-addable":e,"-help-mode":t,"-row":i,"-column":n}};function Sa(e,t){if(1&e){const e=n.ic();n.hc(0,"div",17),n.pc("mouseover",(function(){n.Lc(e);const i=t.$implicit;return n.rc().layout.setMousedOverArea(i)})),n.Tc(1,Pa,1,1,"div",18),n.gc()}if(2&e){const e=t.$implicit,i=n.rc();n.Sc("grid-row-start",e.gridStartRow)("grid-row-end",e.gridEndRow)("grid-column-start",e.gridStartColumn)("grid-column-end",e.gridEndColumn),n.wc("ngClass",n.Ec(11,xa,i.add.isAddable(e),i.layout.inHelpMode,e.isRow,e.isColumn))("id",e.guid),n.Pb(1),n.wc("ngIf",i.add.isAllowed)}}function _a(e,t){if(1&e&&(n.hc(0,"div",20),n.cc(1,"div",21),n.gc()),2&e){const e=n.rc();n.Sc("grid-row-start",e.drag.placeholderArea.gridStartRow)("grid-row-end",e.drag.placeholderArea.gridEndRow)("grid-column-start",e.drag.placeholderArea.gridStartColumn)("grid-column-end",e.drag.placeholderArea.gridEndColumn)("min-height",e.drag.draggedHeight,"px")}}const Oa=[Re,da,pa,ga,fa,Le];class Ia{constructor(e,t,i,n,s,r,a,c){this.sanitization=e,this.widgetsService=t,this.drag=i,this.resize=n,this.layout=s,this.add=r,this.remove=a,this.browserDetector=c,this.uiWidgets=[],this.GRID_AREA_HEIGHT="auto",this.GRID_GAP_DIMENSION="20px",this.component=Ri}ngOnInit(){this.layout.gridResource=this.grid}ngOnDestroy(){this.uiWidgets.forEach(e=>e.destroy())}handleKeyboardEvent(e){"Escape"===e.key&&(this.drag.currentlyDragging?this.drag.abort():this.resize.currentlyResizing&&this.resize.abort())}widgetComponent(e){let t=e.widget;if(!t)return null;let i=this.widgetsService.registered.find(e=>e.identifier===t.identifier);return i?i.component:null}widgetComponentInput(e){return{resource:e.widget}}widgetComponentOutput(e){return{resourceChanged:this.layout.saveWidgetChangeset.bind(this.layout)}}get gridColumnStyle(){return this.gridStyle(this.layout.numColumns,`calc((100% - ${this.GRID_GAP_DIMENSION} * ${this.layout.numColumns+1}) / ${this.layout.numColumns})`)}get gridRowStyle(){return this.gridStyle(this.layout.numRows,this.GRID_AREA_HEIGHT)}identifyGridArea(e,t){return t.guid}get isHeadersDisplayed(){return this.layout.isEditable}get isMobileDevice(){return this.browserDetector.isMobile}gridStyle(e,t){let i="";for(let n=0;n<e;n++)i+=`${this.GRID_GAP_DIMENSION} ${t} `;return i+=""+this.GRID_GAP_DIMENSION,this.sanitization.bypassSecurityTrustStyle(i)}}Ia.\u0275fac=function(e){return new(e||Ia)(n.bc(D.b),n.bc(Lt),n.bc(pa),n.bc(ga),n.bc(Re),n.bc(fa),n.bc(Le),n.bc(It.a))},Ia.\u0275cmp=n.Vb({type:Ia,selectors:[["grid"]],hostBindings:function(e,t){1&e&&n.pc("keyup",(function(e){return t.handleKeyboardEvent(e)}),!1,n.Kc)},inputs:{grid:"grid"},decls:5,vars:11,consts:[[1,"grid--container"],["class","grid--area -widgeted","cdkDropList","",3,"ngClass","grid-row-start","grid-row-end","grid-column-start","grid-column-end","id","cdkDropListData","cdkDropListConnectedTo",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--area hidden-for-mobile","cdkDropList","",3,"ngClass","grid-row-start","grid-row-end","grid-column-start","grid-column-end","id","cdkDropListData","cdkDropListConnectedTo","mouseover",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--area -gap hidden-for-mobile",3,"ngClass","grid-row-start","grid-row-end","grid-column-start","grid-column-end","id","mouseover",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--area -widgeted -placeholder",3,"grid-row-start","grid-row-end","grid-column-start","grid-column-end","min-height",4,"ngIf"],["cdkDropList","",1,"grid--area","-widgeted",3,"ngClass","id","cdkDropListData","cdkDropListConnectedTo"],["cdkDrag","",1,"grid--area-content","widget-box",3,"cdkDragDisabled","cdkDragStarted","cdkDragDropped"],["class","grid--area-drag-handle\n                   icon\n                   icon-drag-handle\n                   hidden-for-mobile","cdkDragHandle","",3,"hidden",4,"ngIf"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"],[3,"customHandler","end","start","move",4,"ngIf"],["cdkDragHandle","",1,"grid--area-drag-handle","icon","icon-drag-handle","hidden-for-mobile",3,"hidden"],[3,"customHandler","end","start","move"],[1,"grid--resizer"],["aria-hidden","true",1,"icon-resizer-bottom-right","hidden-for-mobile"],["cdkDropList","",1,"grid--area","hidden-for-mobile",3,"ngClass","id","cdkDropListData","cdkDropListConnectedTo","mouseover"],["class","grid--widget-add",3,"title","click",4,"ngIf"],[1,"grid--widget-add",3,"title","click"],[1,"grid--area","-gap","hidden-for-mobile",3,"ngClass","id","mouseover"],["class","grid--widget-add -gap",3,"title","click",4,"ngIf"],[1,"grid--widget-add","-gap",3,"title","click"],[1,"grid--area","-widgeted","-placeholder"],[1,"widget-box"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.Tc(1,ya,5,22,"div",1),n.Tc(2,ja,2,19,"div",2),n.Tc(3,Sa,2,16,"div",3),n.Tc(4,_a,2,10,"div",4),n.gc()),2&e&&(n.Sc("grid-template-columns",t.gridColumnStyle)("grid-template-rows",t.gridRowStyle),n.Pb(1),n.wc("ngForOf",t.layout.widgetAreas)("ngForTrackBy",t.identifyGridArea),n.Pb(1),n.wc("ngForOf",t.layout.gridAreas)("ngForTrackBy",t.identifyGridArea),n.Pb(1),n.wc("ngForOf",t.layout.gridGaps)("ngForTrackBy",t.identifyGridArea),n.Pb(1),n.wc("ngIf",t.drag.placeholderArea))},directives:[oe.p,oe.q,je.e,oe.n,je.a,Ce.c,Ce.d,je.b,xn.a],encapsulation:2});const Ta=function(e){return{"-active":e}};function Ra(e,t){if(1&e){const e=n.ic();n.hc(0,"button",9),n.pc("click",(function(){n.Lc(e);return n.rc().areas.toggleHelpMode()})),n.cc(1,"op-icon",10),n.gc()}if(2&e){const e=n.rc();n.wc("title",e.addWidget.addText)("ngClass",n.Bc(2,Ta,e.areas.inHelpMode))}}function Ea(e,t){if(1&e&&n.cc(0,"grid",11),2&e){const e=n.rc();n.wc("grid",e.grid)}}class Ma extends ba{i18nNamespace(){return"dashboards"}gridScopePath(){return this.pathHelper.projectDashboardsPath(this.currentProject.identifier)}}Ma.\u0275fac=function(e){return Fa(e||Ma)},Ma.\u0275cmp=n.Vb({type:Ma,selectors:[["dashboard"]],features:[n.Ob(Oa),n.Mb],decls:10,vars:3,consts:[[1,"toolbar-container"],[1,"toolbar"],[1,"title-container"],[3,"textContent"],[1,"toolbar-items","hidden-for-mobile"],[1,"toolbar-item","hidden-for-mobile"],[1,"toolbar-item"],["class","button",3,"title","ngClass","click",4,"ngIf"],[3,"grid",4,"ngIf"],[1,"button",3,"title","ngClass","click"],["icon-classes","button--icon icon-add"],[3,"grid"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.cc(3,"h2",3),n.gc(),n.hc(4,"ul",4),n.hc(5,"li",5),n.cc(6,"zen-mode-toggle-button"),n.gc(),n.hc(7,"li",6),n.Tc(8,Ra,2,4,"button",7),n.gc(),n.gc(),n.gc(),n.gc(),n.Tc(9,Ea,1,1,"grid",8)),2&e&&(n.Pb(3),n.wc("textContent",t.text.title),n.Pb(5),n.wc("ngIf",t.addWidget.isAllowed),n.Pb(1),n.wc("ngIf",t.grid))},directives:[qt.a,oe.q,oe.n,yt.a,Ia],styles:[".title-container[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:-5px}.toolbar-container[_ngcontent-%COMP%]{margin-bottom:0}.toolbar-items[_ngcontent-%COMP%]{padding-right:20px}@media only screen and (max-width:679px){.title-container[_ngcontent-%COMP%]{margin-left:0;margin-bottom:0}}"]});const Fa=n.jc(Ma),Aa=[{name:"dashboards",parent:"root",url:"/dashboards/",data:{bodyClasses:["router--dashboards-view-base","widget-grid-layout"],menuItem:"dashboards-menu-item"},component:Ma}];class La{}function Da(e,t){if(1&e){const e=n.ic();n.hc(0,"div",1),n.hc(1,"wp-single-card",2),n.pc("stateLinkClicked",(function(t){n.Lc(e);return n.rc().openStateLink(t)})),n.gc(),n.gc()}if(2&e){const e=n.rc();n.Pb(1),n.wc("workPackage",e.workPackage)}}La.\u0275mod=n.Zb({type:La}),La.\u0275inj=n.Yb({factory:function(e){return new(e||La)},providers:[],imports:[[f.a,pr,zt.UIRouterModule.forChild({states:Aa,config:function(e){e.urlService.rules.when(new RegExp("^/projects/(.*)/dashboards$"),e=>`/projects/${e[1]}/dashboards/`)}})]]});class Va extends I.a{constructor(e,t,i,n,s,r,a){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.i18n=n,this.apiV3Service=s,this.opModalService=r,this.$state=a,this.text={created_by:this.i18n.t("js.label_created_by")}}ngOnInit(){super.ngOnInit();const e=this.locals.workPackageLink,t=E.a.idFromLink(e);this.apiV3Service.work_packages.id(t).requireAndStream().subscribe(e=>{this.workPackage=e,this.cdRef.detectChanges();const t=jQuery(this.elementRef.nativeElement).find(".preview-modal--container");this.reposition(t,this.locals.event.target)})}reposition(e,t){e.position({my:"right top",at:"right bottom",of:t,collision:"flipfit"})}openStateLink(e){const t={workPackageId:e.workPackageId};this.$state.go(e.requestedState,t)}}Va.\u0275fac=function(e){return new(e||Va)(n.bc(n.q),n.bc(O.a),n.bc(n.i),n.bc(y.a),n.bc(H.a),n.bc(O.b),n.bc(Ue.StateService))},Va.\u0275cmp=n.Vb({type:Va,selectors:[["ng-component"]],features:[n.Mb],decls:1,vars:1,consts:[["class","preview-modal--container","wp-isolated-query-space","",4,"ngIf"],["wp-isolated-query-space","",1,"preview-modal--container"],["orientation","horizontal",3,"workPackage","stateLinkClicked"]],template:function(e,t){1&e&&n.Tc(0,Da,2,1,"div",0),2&e&&n.wc("ngIf",t.workPackage)},directives:[oe.q,Be.a,qn.a],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.preview-modal--container[_ngcontent-%COMP%]{position:absolute;z-index:5000;min-width:350px;padding:0;box-shadow:0 0 5px 2px rgba(0,0,0,.25)}"],changeDetection:0});class qa{constructor(e,t){this.opModalService=e,this.injector=t}setupListener(){jQuery(document.body).on("mouseenter",".preview-trigger",e=>{e.preventDefault(),e.stopPropagation();const t=jQuery(e.target),i=t.attr("href");i&&(this.previewModal=this.opModalService.show(Va,this.injector,{workPackageLink:i,event:e}),this.modalElement=this.previewModal.elementRef.nativeElement,this.previewModal.reposition(jQuery(this.modalElement),t),jQuery(this.modalElement).addClass("-no-width -no-height"))}),jQuery(document.body).on("mouseleave",".preview-trigger",e=>{e.preventDefault(),e.stopPropagation(),this.isMouseOverPreview(e)?jQuery(this.modalElement).on("mouseleave",()=>{this.opModalService.close()}):this.opModalService.close()})}isMouseOverPreview(e){if(!this.modalElement)return!1;const t=jQuery(this.modalElement.children[0]);if(t&&t.offset()){let i=e.pageX>=Math.floor(t.offset().left)&&e.pageX<t.offset().left+t.width(),n=e.pageY>=Math.floor(t.offset().top)&&e.pageY<t.offset().top+t.height();return i&&n}return!1}}qa.\u0275fac=function(e){return new(e||qa)(n.lc(O.b),n.lc(n.A))},qa.\u0275prov=n.Xb({token:qa,factory:qa.\u0275fac,providedIn:"root"});const $a=function(e){return{"-active":e}};function Na(e,t){if(1&e){const e=n.ic();n.hc(0,"button",9),n.pc("click",(function(){n.Lc(e);return n.rc().areas.toggleHelpMode()})),n.cc(1,"op-icon",10),n.gc()}if(2&e){const e=n.rc();n.wc("title",e.addWidget.addText)("ngClass",n.Bc(2,$a,e.areas.inHelpMode))}}function Ba(e,t){if(1&e&&n.cc(0,"grid",11),2&e){const e=n.rc();n.wc("grid",e.grid)}}class za extends ba{i18nNamespace(){return"overviews"}gridScopePath(){return this.pathHelper.projectPath(this.currentProject.identifier)}}za.\u0275fac=function(e){return Ha(e||za)},za.\u0275cmp=n.Vb({type:za,selectors:[["overview"]],features:[n.Ob(Oa),n.Mb],decls:10,vars:3,consts:[[1,"toolbar-container"],[1,"toolbar"],[1,"title-container"],[3,"textContent"],[1,"toolbar-items","hidden-for-mobile"],[1,"toolbar-item","hidden-for-mobile"],[1,"toolbar-item"],["class","button",3,"title","ngClass","click",4,"ngIf"],[3,"grid",4,"ngIf"],[1,"button",3,"title","ngClass","click"],["icon-classes","button--icon icon-add"],[3,"grid"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.cc(3,"h2",3),n.gc(),n.hc(4,"ul",4),n.hc(5,"li",5),n.cc(6,"zen-mode-toggle-button"),n.gc(),n.hc(7,"li",6),n.Tc(8,Na,2,4,"button",7),n.gc(),n.gc(),n.gc(),n.gc(),n.Tc(9,Ba,1,1,"grid",8)),2&e&&(n.Pb(3),n.wc("textContent",t.text.title),n.Pb(5),n.wc("ngIf",t.addWidget.isAllowed),n.Pb(1),n.wc("ngIf",t.grid))},directives:[qt.a,oe.q,oe.n,yt.a,Ia],styles:[".title-container[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:-5px}.toolbar-container[_ngcontent-%COMP%]{margin-bottom:0}.toolbar-items[_ngcontent-%COMP%]{padding-right:20px}@media only screen and (max-width:679px){.title-container[_ngcontent-%COMP%]{margin-left:0;margin-bottom:0}}"]});const Ha=n.jc(za),Qa=[{name:"overview",parent:"root",url:"/",data:{menuItem:"overview-menu-item"},component:za}];class Wa{}Wa.\u0275mod=n.Zb({type:Wa}),Wa.\u0275inj=n.Yb({factory:function(e){return new(e||Wa)},providers:[],imports:[[f.a,pr,zt.UIRouterModule.forChild({states:Qa,config:function(e){e.urlService.rules.when(new RegExp("^/projects(?!/new$)/([^/]+)$"),e=>`/projects/${e[1]}/`)}})]]});const Xa=function(e){return{"-active":e}};function Ua(e,t){if(1&e){const e=n.ic();n.hc(0,"button",9),n.pc("click",(function(){n.Lc(e);return n.rc().areas.toggleHelpMode()})),n.cc(1,"op-icon",10),n.gc()}if(2&e){const e=n.rc();n.wc("title",e.addWidget.addText)("ngClass",n.Bc(2,Xa,e.areas.inHelpMode))}}function Ga(e,t){if(1&e&&n.cc(0,"grid",11),2&e){const e=n.rc();n.wc("grid",e.grid)}}class Ya extends ba{i18nNamespace(){return"my_page"}gridScopePath(){return this.pathHelper.myPagePath()}}Ya.\u0275fac=function(e){return Ka(e||Ya)},Ya.\u0275cmp=n.Vb({type:Ya,selectors:[["ng-component"]],features:[n.Ob(Oa),n.Mb],decls:10,vars:3,consts:[[1,"toolbar-container"],[1,"toolbar"],[1,"title-container"],[3,"textContent"],[1,"toolbar-items","hidden-for-mobile"],[1,"toolbar-item","hidden-for-mobile"],[1,"toolbar-item"],["class","button",3,"title","ngClass","click",4,"ngIf"],[3,"grid",4,"ngIf"],[1,"button",3,"title","ngClass","click"],["icon-classes","button--icon icon-add"],[3,"grid"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.cc(3,"h2",3),n.gc(),n.hc(4,"ul",4),n.hc(5,"li",5),n.cc(6,"zen-mode-toggle-button"),n.gc(),n.hc(7,"li",6),n.Tc(8,Ua,2,4,"button",7),n.gc(),n.gc(),n.gc(),n.gc(),n.Tc(9,Ga,1,1,"grid",8)),2&e&&(n.Pb(3),n.wc("textContent",t.text.title),n.Pb(5),n.wc("ngIf",t.addWidget.isAllowed),n.Pb(1),n.wc("ngIf",t.grid))},directives:[qt.a,oe.q,oe.n,yt.a,Ia],styles:[".title-container[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:-5px}.toolbar-container[_ngcontent-%COMP%]{margin-bottom:0}.toolbar-items[_ngcontent-%COMP%]{padding-right:20px}@media only screen and (max-width:679px){.title-container[_ngcontent-%COMP%]{margin-left:0;margin-bottom:0}}"]});const Ka=n.jc(Ya),Za=[{name:"my_page",url:"/my/page",component:Ya,data:{bodyClasses:["router--work-packages-my-page","widget-grid-layout"],parent:"work-packages"}}];class Ja{}Ja.\u0275mod=n.Zb({type:Ja}),Ja.\u0275inj=n.Yb({factory:function(e){return new(e||Ja)},imports:[[f.a,pr,zt.UIRouterModule.forChild({states:Za})]]});var ec=i("GZlY"),tc=i("7ond");const ic={preview:1,newWorkPackage:2,edit:3,quickSearch:4,projectSearch:5,help:6,moreMenu:7,details:8};class nc{constructor(e,t,i){this.PathHelper=e,this.FocusHelper=t,this.currentProject=i,this.shortcuts={"?":()=>this.showHelpModal(),"g m":this.globalAction("myPagePath"),"g o":this.projectScoped("projectPath"),"g w p":this.projectScoped("projectWorkPackagesPath"),"g w i":this.projectScoped("projectWikiPath"),"g a":this.projectScoped("projectActivityPath"),"g c":this.projectScoped("projectCalendarPath"),"g n":this.projectScoped("projectNewsPath"),"n w p":this.projectScoped("projectWorkPackageNewPath"),"g e":this.accessKey("edit"),"g p":this.accessKey("preview"),"d w p":this.accessKey("details"),m:this.accessKey("moreMenu"),p:this.accessKey("projectSearch"),s:this.accessKey("quickSearch"),k:()=>this.focusPrevItem(),j:()=>this.focusNextItem()},this.register()}register(){_.each(this.shortcuts,(e,t)=>Mousetrap.bind(t,e))}accessKey(e){var t=ic[e];return()=>{var e=jQuery("[accesskey="+t+"]:first");e.is("input")||"global-search-input"===e.attr("id")?setTimeout(()=>this.FocusHelper.focus(e),200):e.is("[href]")?this.clickLink(e[0]):e[0].click()}}globalAction(e){return()=>{var t=this.PathHelper[e]();window.location.href=t}}projectScoped(e){return()=>{var t=this.currentProject.identifier;if(t){var i=this.PathHelper[e](t);window.location.href=i}}}clickLink(e){var t=!1;if(document.createEvent){var i=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});t=!e.dispatchEvent(i)}else e.fireEvent&&(t=!e.fireEvent("onclick"));t||(window.location.href=e.href)}showHelpModal(){window.open(this.PathHelper.keyboardShortcutsHelpPath())}findListInPage(){const e=jQuery("table.keyboard-accessible-list"),t=[];return e.find("tbody tr").each((function(e,i){var n=jQuery(i).find(":visible:tabbable")[0];void 0!==n&&t.push(n)})),t}focusItemOffset(e){const t=this.findListInPage();let i;if(null===t)return;i=t.indexOf(jQuery(document.activeElement).closest("table.keyboard-accessible-list tbody tr").find(":visible:tabbable")[0]);jQuery(t[(i+e+t.length)%t.length]).focus()}focusNextItem(){this.focusItemOffset(1)}focusPrevItem(){this.focusItemOffset(-1)}}nc.\u0275fac=function(e){return new(e||nc)(n.lc(q.a),n.lc(tc.a),n.lc(xe.a))},nc.\u0275prov=n.Xb({token:nc,factory:nc.\u0275fac,providedIn:"root"});var sc=i("saRB"),rc=i("RGDJ");function ac(e,t){if(1&e&&(n.hc(0,"span",3),n.Vc(1),n.gc()),2&e){const e=t.item,i=n.rc();n.wc("ngClass",i.highlightColor(e)),n.Pb(1),n.Wc(e.name)}}function cc(e,t){if(1&e&&(n.hc(0,"span",3),n.Vc(1),n.gc()),2&e){const e=t.item,i=n.rc();n.wc("ngClass",i.highlightColor(e)),n.Pb(1),n.Wc(e.name)}}class oc{constructor(e,t){this.elementRef=e,this.I18n=t,this.highlightTextInline=!1}ngOnInit(){this.setColorOptions(),this.updateInputField=document.getElementsByName(this.elementRef.nativeElement.dataset.updateInput)[0],this.highlightTextInline=JSON.parse(this.elementRef.nativeElement.dataset.highlightTextInline)}onModelChange(e){e&&this.updateInputField&&(this.updateInputField.value=e.value)}setColorOptions(){this.options=JSON.parse(this.elementRef.nativeElement.dataset.colors),this.options.unshift({name:this.I18n.t("js.label_no_color"),value:""}),this.selectedOption=this.options.find(e=>!0===e.selected),this.selectedOption?this.selectedOption=this.selectedOption.value:(this.selectedColorId=this.elementRef.nativeElement.dataset.selectedColor,this.selectedOption=this.selectedColorId?this.selectedColorId:"")}highlightColor(e){if(""===e.value)return;let t;return t=this.highlightTextInline?"__hl_inline_type_ ":"__hl_inline_ ",t+rc.a.colorClass(this.highlightTextInline,e.value)}}oc.\u0275fac=function(e){return new(e||oc)(n.bc(n.q),n.bc(y.a))},oc.\u0275cmp=n.Vb({type:oc,selectors:[["colors-autocompleter"]],decls:3,vars:4,consts:[["bindLabel","name","bindValue","value","appendTo","body",3,"items","virtualScroll","ngModel","clearable","ngModelChange","change"],["ng-label-tmp",""],["ng-option-tmp",""],[3,"ngClass"]],template:function(e,t){1&e&&(n.hc(0,"ng-select",0),n.pc("ngModelChange",(function(e){return t.selectedOption=e}))("change",(function(e){return t.onModelChange(e)})),n.Tc(1,ac,2,2,"ng-template",1),n.Tc(2,cc,2,2,"ng-template",2),n.gc()),2&e&&n.wc("items",t.options)("virtualScroll",!0)("ngModel",t.selectedOption)("clearable",!1)},directives:[pn.a,l.m,l.p,pn.e,pn.c,oe.n],encapsulation:2});var lc=i("itXk");function dc(e,t){if(1&e&&n.cc(0,"wp-embedded-table",1),2&e){const e=n.rc();n.wc("queryProps",e.queryProps)("configuration",e.tableConfiguration)}}class uc extends tt.a{constructor(e,t,i,n,s,r,a,c,o,l,d){super(),this.FocusHelper=e,this.elementRef=t,this.renderer=i,this.I18n=n,this.halResourceService=s,this.globalSearchService=r,this.wpTableFilters=a,this.querySpace=c,this.wpFilters=o,this.cdRef=l,this.UrlParamsHelper=d,this.resultsHidden=!1,this.tableConfiguration={actionsColumnEnabled:!1,columnMenuEnabled:!0,contextMenuEnabled:!1,inlineCreateEnabled:!1,withFilters:!0,showFilterButton:!0,filterButtonText:this.I18n.t("js.button_advanced_filter")}}ngAfterViewInit(){Object(lc.a)([this.globalSearchService.searchTerm$,this.globalSearchService.projectScope$]).pipe(Object(Mi.a)(1),Object(ha.a)(),Object(Je.a)(10),this.untilDestroyed()).subscribe(([e,t])=>{this.wpFilters.visible=!1,this.setQueryProps()}),this.globalSearchService.resultsHidden$.pipe(this.untilDestroyed()).subscribe(e=>this.resultsHidden=e)}ngOnInit(){this.setQueryProps()}setQueryProps(){let e=[],t=["id","project","subject","type","status","updatedAt"];this.globalSearchService.searchTerm.length>0&&e.push({search:{operator:"**",values:[this.globalSearchService.searchTerm]}}),"current_project"===this.globalSearchService.projectScope&&(e.push({subprojectId:{operator:"!*",values:[]}}),t=["id","subject","type","status","updatedAt"]),""===this.globalSearchService.projectScope&&e.push({subprojectId:{operator:"*",values:[]}}),this.queryProps={"columns[]":t,filters:JSON.stringify(e),sortBy:JSON.stringify([["updatedAt","desc"]]),showHierarchies:!1}}}uc.\u0275fac=function(e){return new(e||uc)(n.bc(tc.a),n.bc(n.q),n.bc(n.R),n.bc(y.a),n.bc(C.a),n.bc(Ar),n.bc(Qe.a),n.bc(He.a),n.bc(zi.a),n.bc(n.i),n.bc(Ei.a))},uc.\u0275cmp=n.Vb({type:uc,selectors:[["global-search-work-packages"]],features:[n.Mb],decls:1,vars:1,consts:[[3,"queryProps","configuration",4,"ngIf"],[3,"queryProps","configuration"]],template:function(e,t){1&e&&n.Tc(0,dc,1,2,"wp-embedded-table",0),2&e&&n.wc("ngIf",!t.resultsHidden)},directives:[oe.q,Vi.a],encapsulation:2});var hc=i("pXJr");class pc{constructor(e,t){this.i18n=e,this.domSanitizer=t,this.new_features_image=hc.a.imagePath("new_features.png"),this.text={newFeatures:this.i18n.t("js.label_new_features"),descriptionNewFeatures:this.i18n.t("js.homescreen.blocks.new_features.text_new_features"),learnAbout:this.i18n.t("js.homescreen.blocks.new_features.learn_about")},this.i18nBase="js.homescreen.blocks.new_features.",this.isStandardEdition=window.OpenProject.isStandardEdition}get teaserWebsiteUrl(){let e=this.translated("learn_about_link");return this.domSanitizer.bypassSecurityTrustResourceUrl(e)}get currentNewFeatureHtml(){return this.translated("current_new_feature_html")}translated(e){return this.i18n.t(this.i18nBase+this.i18nPrefix+"."+e,{list_styling_class:"widget-box--arrow-links",bcf_api_link:"https://github.com/opf/openproject/blob/dev/docs/api/bcf/bcf-rest-api.md"})}get i18nPrefix(){return this.isStandardEdition?"standard":"bim"}}pc.\u0275fac=function(e){return new(e||pc)(n.bc(y.a),n.bc(D.b))},pc.\u0275cmp=n.Vb({type:pc,selectors:[["homescreen-new-features-block"]],decls:8,vars:5,consts:[[1,"widget-box--additional-info"],[1,"widget-box--description"],[3,"innerHtml"],[3,"src"],[1,"widget-box--teaser-image"],["target","_blank",3,"href"]],template:function(e,t){1&e&&(n.hc(0,"p",0),n.Vc(1),n.gc(),n.hc(2,"div",1),n.cc(3,"p",2),n.cc(4,"img",3),n.cc(5,"a",4),n.gc(),n.hc(6,"a",5),n.Vc(7),n.gc()),2&e&&(n.Pb(1),n.Xc(" ",t.text.descriptionNewFeatures," "),n.Pb(2),n.wc("innerHtml",t.currentNewFeatureHtml,n.Mc),n.Pb(1),n.wc("src",t.new_features_image,n.Oc),n.Pb(2),n.wc("href",t.teaserWebsiteUrl,n.Oc),n.Pb(1),n.Wc(t.text.learnAbout))},styles:[".widget-box--description[_ngcontent-%COMP%]   .widget-box--teaser-image[_ngcontent-%COMP%]{background-image:var(--new-feature-teaser-image);min-width:170px;background-size:contain;background-repeat:no-repeat;background-position-x:right}"]});var gc=i("wOIT"),fc=i("yCBR");class bc{}bc.\u0275fac=function(e){return new(e||bc)},bc.\u0275cmp=n.Vb({type:bc,selectors:[["global-search-work-packages-entry"]],decls:2,vars:0,consts:[["wp-isolated-query-space",""]],template:function(e,t){1&e&&(n.fc(0,0),n.cc(1,"global-search-work-packages"),n.ec())},directives:[Be.a,uc],encapsulation:2});var mc=i("feia");class wc{constructor(e){this.elementRef=e,this.isHidden=!1}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.$targetNotification=this.getTargetNotification(),this.identifier=this.$element.data("identifier"),this.isHidden="true"===window.OpenProject.guardedLocalStorage(this.identifier),this.$targetNotification.prop("hidden",!!this.isHidden),this.$element.parent().find(".persistent-toggle--click-handler").on("click",()=>this.toggle(!this.isHidden)),this.$targetNotification.find(".notification-box--close").on("click",()=>this.toggle(!0))}getTargetNotification(){return this.$element.parent().find(".persistent-toggle--notification")}toggle(e){this.isHidden=e,window.OpenProject.guardedLocalStorage(this.identifier,(!!e).toString()),e?this.$targetNotification.slideUp(400,()=>{this.$targetNotification.prop("hidden",!0)}):(this.$targetNotification.slideDown(400),this.$targetNotification.prop("hidden",!1))}}wc.\u0275fac=function(e){return new(e||wc)(n.bc(n.q))},wc.\u0275cmp=n.Vb({type:wc,selectors:[["persistent-toggle"]],decls:0,vars:0,template:function(e,t){},encapsulation:2});class vc{constructor(e){this.displayed=Object(o.g)(),this.all=[];const t=e.get("hideSections");this.all=t.all,this.displayed.putValue(t.active.map(e=>(this.toggleVisibility(e.key,!0),e.key))),this.removeHiddenOnSubmit()}section(e){return document.querySelector(`section.hide-section[data-section-name="${e}"]`)}hide(e){this.displayed.doModify(t=>t.filter(t=>t!==e)),this.toggleVisibility(e,!1)}show(e){this.displayed.doModify(t=>[...t,e]),this.toggleVisibility(e,!0)}toggleVisibility(e,t){const i=this.section(e);i&&(i.hidden=!t)}removeHiddenOnSubmit(){jQuery(document.body).on("submit","form",(function(e){const t=jQuery(this),i=t.find("section.hide-section:hidden");return!(!t.data("hideSectionRemoved")&&0!==i.length)||(t.data("hideSectionRemoved",!0),i.remove(),t.trigger("submit"),e.preventDefault(),!1)}))}}vc.\u0275fac=function(e){return new(e||vc)(n.lc(Nr.a))},vc.\u0275prov=n.Xb({token:vc,factory:vc.\u0275fac,providedIn:"root"});class yc{constructor(e,t){this.elementRef=e,this.hideSectionService=t,this.displayed=!0}ngOnInit(){this.sectionName=this.elementRef.nativeElement.dataset.sectionName}hideSection(){return this.hideSectionService.hide(this.sectionName),!1}}yc.\u0275fac=function(e){return new(e||yc)(n.bc(n.q),n.bc(vc))},yc.\u0275cmp=n.Vb({type:yc,selectors:[["hide-section-link"]],decls:2,vars:0,consts:[["linkTitle","Remove","linkAriaLabel","Remove",3,"execute"],["icon-classes","icon-close icon-small","icon-title","Remove"]],template:function(e,t){1&e&&(n.hc(0,"accessible-by-keyboard",0),n.pc("execute",(function(){return t.hideSection()})),n.cc(1,"op-icon",1),n.gc())},directives:[hn.a,yt.a],encapsulation:2});class kc{constructor(e,t){this.HideSectionService=e,this.elementRef=t}ngOnInit(){const e=jQuery(this.elementRef.nativeElement);this.optValue=e.data("optValue"),this.hideSecWithName=e.data("hideSecWithName");jQuery(this.elementRef.nativeElement).prev().on("change",e=>{jQuery("option:selected",e.target).val()!==this.optValue?this.HideSectionService.hide(this.hideSecWithName):this.HideSectionService.show(this.hideSecWithName)})}}kc.\u0275fac=function(e){return new(e||kc)(n.bc(vc),n.bc(n.q))},kc.\u0275cmp=n.Vb({type:kc,selectors:[["show-section-dropdown"]],decls:0,vars:0,template:function(e,t){},encapsulation:2});var Cc=i("4EDS");const jc=["fallbackOption"];function Pc(e,t){if(1&e&&n.cc(0,"option",4),2&e){const e=t.$implicit;n.wc("value",e.key)("textContent",e.label)}}class xc extends tt.a{constructor(e,t,i){super(),this.hideSectionService=e,this.elementRef=t,this.I18n=i,this.trackByKey=Cc.a.trackByProperty("key"),this.selectable=[],this.active=[],this.placeholder=this.I18n.t("js.placeholders.selection")}ngOnInit(){this.htmlId=this.elementRef.nativeElement.dataset.htmlId,this.hideSectionService.displayed.values$().pipe(this.untilDestroyed()).subscribe(e=>{this.selectable=this.hideSectionService.all.filter(t=>-1===e.indexOf(t.key)).sort((e,t)=>e.label.localeCompare(t.label)),this.option.nativeElement.selected=!0})}show(e){this.hideSectionService.show(e)}}function Sc(e,t){if(1&e&&n.Vc(0),2&e){const e=t.item;n.Xc(" ",e.label," ")}}xc.\u0275fac=function(e){return new(e||xc)(n.bc(vc),n.bc(n.q),n.bc(y.a))},xc.\u0275cmp=n.Vb({type:xc,selectors:[["add-section-dropdown"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(jc,!0),2&e)&&(n.Ic(i=n.qc())&&(t.option=i.first))},features:[n.Mb],decls:4,vars:3,consts:[[1,"form--select",3,"id","change"],["value","","selected","","disabled","",3,"textContent"],["fallbackOption",""],[3,"value","textContent",4,"ngFor","ngForTrackByKey","ngForOf"],[3,"value","textContent"]],template:function(e,t){1&e&&(n.hc(0,"select",0),n.pc("change",(function(e){return t.show(e.target.value)})),n.cc(1,"option",1,2),n.Tc(3,Pc,1,2,"option",3),n.gc()),2&e&&(n.wc("id",t.htmlId),n.Pb(1),n.wc("textContent",t.placeholder),n.Pb(2),n.wc("ngForOf",t.selectable))},directives:[l.r,l.B,oe.p],encapsulation:2});class _c{constructor(e){this.elementRef=e,this.multiselect=!1}ngOnInit(){const e=this.elementRef.nativeElement;this.multiselect="true"===e.dataset.multiselect,this.labelForId=e.dataset.inputId,this.syncInputFieldName=e.dataset.inputName,this.multiselect&&(this.syncInputFieldName+="[]");const t=JSON.parse(e.dataset.options);this.setInitialSelection(t),this.multiselect||(this.selected=this.selected[0]),this.options=t,e.parentElement.hidden=!1}setInitialSelection(e){this.updateSelection(e.filter(e=>e.selected))}updateSelection(e){this.selected=e,e=_.castArray(e),this.removeCurrentSyncedFields(),e.forEach(e=>{this.createSyncedField(e.value)})}createSyncedField(e){jQuery(this.elementRef.nativeElement).parent().append(`<input type="hidden" name="${this.syncInputFieldName||""}" value="${e}" />`)}removeCurrentSyncedFields(){jQuery(this.elementRef.nativeElement).parent().find(`input[name="${this.syncInputFieldName}"]`).remove()}}function Oc(e,t){if(1&e){const e=n.ic();n.hc(0,"li"),n.hc(1,"a",11),n.pc("click",(function(){n.Lc(e);const i=t.$implicit;return n.rc().clickTab(i.id)})),n.gc(),n.gc()}if(2&e){const e=t.$implicit,i=n.rc();n.Tb("selected",e.id===i.currentTabId),n.Qb("tab-id",e.id),n.Pb(1),n.wc("href",e.path,n.Oc)("textContent",e.name)}}_c.\u0275fac=function(e){return new(e||_c)(n.bc(n.q))},_c.\u0275cmp=n.Vb({type:_c,selectors:[["autocomplete-select-decoration"]],viewQuery:function(e,t){var i;(1&e&&n.ad(pn.a,!0),2&e)&&(n.Ic(i=n.qc())&&(t.ngSelectComponent=i.first))},decls:2,vars:5,consts:[["bindLabel","label","appendTo","body","placeholder","Please select",3,"items","labelForId","multiple","virtualScroll","ngModel","ngModelChange"],["ng-option-tmp",""]],template:function(e,t){1&e&&(n.hc(0,"ng-select",0),n.pc("ngModelChange",(function(e){return t.updateSelection(e)})),n.Tc(1,Sc,1,1,"ng-template",1),n.gc()),2&e&&n.wc("items",t.options)("labelForId",t.labelForId)("multiple",t.multiselect)("virtualScroll",!0)("ngModel",t.selected)},directives:[pn.a,l.m,l.p,pn.c],encapsulation:2});class Ic extends Tn.a{constructor(e,t,i,n){super(),this.elementRef=e,this.$state=t,this.gon=i,this.I18n=n,this.classes=["content--tabs","scrollable-tabs"],this.gonTabs=JSON.parse(this.gon.get("contentTabs").tabs),this.currentTab=JSON.parse(this.gon.get("contentTabs").selected),this.tabs=this.gonTabs.map(e=>({id:e.name,name:this.I18n.t("js."+e.label,{defaultValue:e.label}),path:e.path})),this.currentTabId=this.currentTab.name}}Ic.\u0275fac=function(e){return new(e||Ic)(n.bc(n.q),n.bc(Ue.StateService),n.bc(Nr.a),n.bc(y.a))},Ic.\u0275cmp=n.Vb({type:Ic,selectors:[["content-tabs"]],features:[n.Mb],decls:11,vars:4,consts:[[3,"ngClass"],["scrollContainer",""],[1,"tabrow",3,"scroll"],["scrollPane",""],[3,"selected",4,"ngFor","ngForOf"],[1,"scrollable-tabs--button","-left",3,"hidden","click"],["scrollLeftBtn",""],[1,"icon-arrow-left2"],[1,"scrollable-tabs--button","-right",3,"hidden","click"],["scrollRightBtn",""],[1,"icon-arrow-right2"],[3,"href","textContent","click"]],template:function(e,t){1&e&&(n.hc(0,"div",0,1),n.hc(2,"ul",2,3),n.pc("scroll",(function(e){return t.onScroll(e)})),n.Tc(4,Oc,2,5,"li",4),n.gc(),n.hc(5,"div",5,6),n.pc("click",(function(){return t.scrollLeft()})),n.cc(7,"span",7),n.gc(),n.hc(8,"div",8,9),n.pc("click",(function(){return t.scrollRight()})),n.cc(10,"span",10),n.gc(),n.gc()),2&e&&(n.wc("ngClass",t.classes),n.Pb(4),n.wc("ngForOf",t.tabs),n.Pb(1),n.wc("hidden",t.hideLeftButton),n.Pb(3),n.wc("hidden",t.hideRightButton))},directives:[oe.n,oe.p],encapsulation:2,changeDetection:0});class Tc{constructor(e,t,i,n){this.NotificationsService=e,this.elementRef=t,this.I18n=i,this.ConfigurationService=n}ngOnInit(){const e=this.elementRef.nativeElement;this.clickTarget=e.getAttribute("click-target"),this.clipboardTarget=e.getAttribute("clipboard-target"),jQuery(this.clickTarget).on("click",e=>this.onClick(e)),e.classList.add("copy-to-clipboard"),this.target=jQuery(this.clipboardTarget?this.clipboardTarget:e)}addNotification(e,t){let i=this.NotificationsService[e](t);setTimeout(()=>this.NotificationsService.remove(i),5e3)}onClick(e){var t=document.queryCommandSupported&&document.queryCommandSupported("copy");if(e.preventDefault(),this.target.select().focus(),t)try{if(document.execCommand("copy"))return void this.addNotification("addSuccess",this.I18n.t("js.clipboard.copied_successful"))}catch(i){console.log("Your browser seems to support the clipboard API, but copying failed: "+i)}this.addNotification("addError",this.I18n.t("js.clipboard.browser_error"))}}Tc.\u0275fac=function(e){return new(e||Tc)(n.bc(v.a),n.bc(n.q),n.bc(y.a),n.bc(Q.a))},Tc.\u0275cmp=n.Vb({type:Tc,selectors:[["copy-to-clipboard"]],decls:0,vars:0,template:function(e,t){},encapsulation:2});class Rc{constructor(e,t,i){this.element=e,this.confirmDialog=t,this.I18n=i,this.confirmed=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text")}}ngOnInit(){this.$element=jQuery(this.element.nativeElement),this.$element.is("form")?this.$form=this.$element:this.$form=this.$element.closest("form"),this.$form.on("submit",e=>!!this.confirmed||(e.preventDefault(),this.openConfirmationDialog(),!1))}openConfirmationDialog(){this.confirmDialog.confirm({text:this.text,closeByEscape:!0,showClose:!0,closeByDocument:!0}).then(()=>{this.confirmed=!0,this.$form.trigger("submit")}).catch(()=>this.confirmed=!1)}}Rc.\u0275fac=function(e){return new(e||Rc)(n.bc(n.q),n.bc(p.a),n.bc(y.a))},Rc.\u0275cmp=n.Vb({type:Rc,selectors:[["confirm-form-submit"]],decls:0,vars:0,template:function(e,t){},encapsulation:2});var Ec=i("Sulb");const Mc=function(e){return{open:e}};class Fc extends tt.a{constructor(e,t,i){super(),this.toggleService=e,this.cdRef=t,this.elementRef=i,this.mainMenu=jQuery("#main-menu")[0],this.moving=!1}ngOnInit(){this.toggleService.titleData$.pipe(Object(ha.a)(),this.untilDestroyed()).subscribe(e=>{this.toggleTitle=e,this.cdRef.detectChanges()}),this.resizeEvent="main-menu-resize",this.localStorageKey="openProject-mainMenuWidth"}resizeStart(){this.elementWidth=this.mainMenu.clientWidth}resizeMove(e){this.toggleService.saveWidth(this.elementWidth+e.absolute.x)}resizeEnd(){const e=new Event(this.resizeEvent);window.dispatchEvent(e)}}Fc.\u0275fac=function(e){return new(e||Fc)(n.bc(Ec.a),n.bc(n.i),n.bc(n.q))},Fc.\u0275cmp=n.Vb({type:Fc,selectors:[["main-menu-resizer"]],features:[n.Mb],decls:4,vars:6,consts:[[1,"main-menu--resizer",3,"customHandler","cursorClass","end","start","move"],[1,"resizer-toggle-container"],[1,"main-menu--navigation-toggler",3,"ngClass","accessibleClick"],["aria-hidden","true",1,"icon-resizer-vertical-lines"]],template:function(e,t){1&e&&(n.hc(0,"resizer",0),n.pc("end",(function(){return t.resizeEnd()}))("start",(function(){return t.resizeStart()}))("move",(function(e){return t.resizeMove(e)})),n.hc(1,"div",1),n.hc(2,"i",2),n.pc("accessibleClick",(function(e){return t.toggleService.toggleNavigation(e)})),n.gc(),n.cc(3,"i",3),n.gc(),n.gc()),2&e&&(n.wc("customHandler",!0)("cursorClass","col-resize"),n.Pb(2),n.wc("ngClass",n.Bc(4,Mc,t.toggleService.showNavigation)),n.Qb("title",t.toggleTitle))},directives:[xn.a,oe.n,dn.a],encapsulation:2});var Ac=i("C21z"),Lc=i("K247"),Dc=i("LRne"),Vc=i("iuWW"),qc=i("13ri"),$c=i("vkgz"),Nc=i("lJxs");const Bc=["btn"];function zc(e,t){if(1&e){const e=n.ic();n.hc(0,"a",8),n.pc("click",(function(){n.Lc(e);return n.rc().toggleMobileSearch()})),n.cc(1,"i",9),n.gc()}if(2&e){const e=n.rc();n.xc("title",e.text.close_search)}}function Hc(e,t){if(1&e){const e=n.ic();n.hc(0,"div"),n.hc(1,"div",12),n.pc("click",(function(){n.Lc(e);const t=n.rc().item;return n.rc().followItem(t)})),n.hc(2,"div",13),n.hc(3,"span",14),n.Vc(4),n.gc(),n.hc(5,"span",15),n.Vc(6),n.gc(),n.gc(),n.gc(),n.gc()}if(2&e){const e=n.rc().item,t=n.rc();n.Pb(4),n.Xc(" ",t.currentValue," "),n.Pb(1),n.xc("title",e.projectScope),n.Pb(1),n.Xc(" ",e.text," \u21b5 ")}}function Qc(e,t){if(1&e){const e=n.ic();n.hc(0,"a",16),n.pc("click",(function(t){n.Lc(e);const i=n.rc().item;return n.rc().redirectToWp(i.id,t)})),n.hc(1,"div",13),n.cc(2,"user-avatar",17),n.hc(3,"span",18),n.Vc(4),n.gc(),n.hc(5,"div",19),n.cc(6,"span",20),n.hc(7,"a",21),n.Vc(8),n.gc(),n.cc(9,"span",22),n.gc(),n.gc(),n.gc()}if(2&e){const e=n.rc().item,t=n.rc();n.wc("href",t.wpPath(e.id),n.Oc),n.Pb(2),n.wc("user",e.author),n.Pb(2),n.Xc(" ",e.subject," "),n.Pb(2),n.wc("textContent",e.project),n.Pb(1),n.wc("ngClass",t.uiStateLinkClass),n.Pb(1),n.Xc(" #",e.id," "),n.Pb(1),n.wc("textContent",e.status)("ngClass",t.statusHighlighting(e.statusId))}}function Wc(e,t){if(1&e&&(n.Tc(0,Hc,7,3,"div",10),n.Tc(1,Qc,10,8,"ng-template",null,11,n.Uc)),2&e){const e=t.item,i=n.Jc(2);n.wc("ngIf",!e.id)("ngIfElse",i)}}const Xc=function(e){return{"top-menu-search--input":!0,"-markable":e}};class Uc{constructor(e,t,i,n,s,r,a,c,o,l){this.elementRef=e,this.I18n=t,this.apiV3Service=i,this.PathHelperService=n,this.halResourceService=s,this.globalSearchService=r,this.currentProjectService=a,this.deviceService=c,this.cdRef=o,this.halNotification=l,this.expanded=!1,this.markable=!1,this.requests=new Vc.a(e=>this.autocompleteWorkPackages(e).pipe(Object($c.a)(()=>{setTimeout(()=>this.setMarkedOption(),50)})),Object(Vc.b)(this.halNotification)),this.currentValue="",this.text={all_projects:this.I18n.t("js.global_search.all_projects"),current_project:this.I18n.t("js.global_search.current_project"),current_project_and_all_descendants:this.I18n.t("js.global_search.current_project_and_all_descendants"),search:this.I18n.t("js.global_search.search"),search_dots:this.I18n.t("js.global_search.search")+" ...",close_search:this.I18n.t("js.global_search.close_search")}}ngOnInit(){this.ngSelectComponent.searchTerm=this.currentValue=this.globalSearchService.searchTerm,this.expanded=this.ngSelectComponent.searchTerm.length>0,this.toggleTopMenuClass()}ngOnDestroy(){this.unregister()}handleClick(e){e.stopPropagation(),e.preventDefault(),Ac.a.insideOrSelf(this.btn.nativeElement,e.target)&&(this.deviceService.isMobile?(this.toggleMobileSearch(),jQuery(".ng-input input").focus()):0===this.ngSelectComponent.searchTerm.length?this.ngSelectComponent.focus():this.submitNonEmptySearch())}toggleMobileSearch(){this.expanded=!this.expanded,this.toggleTopMenuClass()}redirectToWp(e,t){return t.stopImmediatePropagation(),!!qc.a.isClickedWithModifier(t)||(window.location.href=this.wpPath(e),t.preventDefault(),!1)}wpPath(e){return this.PathHelperService.workPackagePath(e)}search(e){this.currentValue=this.ngSelectComponent.searchTerm,this.openCloseMenu(e.term)}openCloseMenu(e){this.ngSelectComponent.isOpen=e.trim().length>0}onFocus(){this.expanded=!0,this.toggleTopMenuClass(),this.openCloseMenu(this.currentValue)}onFocusOut(){this.deviceService.isMobile||(this.expanded=this.ngSelectComponent.searchTerm.length>0,this.ngSelectComponent.isOpen=!1,this.toggleTopMenuClass())}clearSearch(){this.currentValue=this.ngSelectComponent.searchTerm="",this.openCloseMenu(this.currentValue)}onEnterBeforeResultsLoaded(){this.requests.loading$.pipe(Object(gs.a)(e=>!1===e),Object(et.a)(1)).subscribe(()=>{this.selectedItem?this.followSelectedItem():this.searchInScope(this.currentScope)})}statusHighlighting(e){return rc.a.inlineClass("status",e)}get isDirectHit(){return this.selectedItem&&this.selectedItem.hasOwnProperty("id")}followItem(e){e.hasOwnProperty("id")?window.location.href=this.wpPath(e.id):(this.globalSearchService.searchTerm=this.currentValue,this.searchInScope(e.projectScope))}followSelectedItem(){this.selectedItem&&this.followItem(this.selectedItem)}customSearchFn(e,t){return void 0===t.id||-1!==t.subject.toLowerCase().indexOf(e.toLowerCase())}autocompleteWorkPackages(e){if(!e)return Object(Dc.a)([]);this.selectedItem=null,this.markable=!1;let t=this.queryWithoutHash(e);return this.fetchSearchResults(t,t!==e).get().pipe(Object(Nc.a)(e=>this.searchResultsToOptions(e.elements,t)))}queryWithoutHash(e){return e.match(/^#(\d+)/)?e.substr(1):e}fetchSearchResults(e,t){return this.apiV3Service.work_packages.filterBySubjectOrId(e,t)}searchResultsToOptions(e,t){let i=e.map(e=>{let i={id:e.id,subject:e.subject,status:e.status.name,statusId:e.status.idFromLink,$href:e.$href,project:e.project.name,author:e.author};return t===e.id.toString()&&(this.selectedItem=i),i}),n=this.detailedSearchOptions();return this.selectedItem||(this.selectedItem=n[0]),n.concat(i)}detailedSearchOptions(){let e=[];return this.currentProjectService.path&&(e.push("current_project_and_all_descendants"),e.push("current_project")),"current_project"===this.globalSearchService.projectScope&&e.reverse(),e.push("all_projects"),e.map(e=>({projectScope:e,text:this.text[e]}))}setMarkedOption(){this.markable=!0,this.ngSelectComponent.itemsList.markItem(this.ngSelectComponent.itemsList.selectedItems[0]),this.cdRef.detectChanges()}searchInScope(e){switch(e){case"all_projects":{let e=!1;"all"!==this.globalSearchService.projectScope&&(e=!0,this.globalSearchService.resultsHidden=!0),this.globalSearchService.projectScope="all",this.submitNonEmptySearch(e);break}case"current_project":this.globalSearchService.projectScope="current_project",this.submitNonEmptySearch();break;case"current_project_and_all_descendants":this.globalSearchService.projectScope="",this.submitNonEmptySearch()}}submitNonEmptySearch(e=!1){if(this.globalSearchService.searchTerm=this.currentValue,this.currentValue.length>0){if(this.ngSelectComponent.close(),!e&&this.globalSearchService.isAfterSearch()&&"work_packages"===this.globalSearchService.currentTab)return void window.history.replaceState({},`${I18n.t("global_search.search")}: ${this.ngSelectComponent.searchTerm}`,this.globalSearchService.searchPath());this.globalSearchService.submitSearch()}}blur(){this.ngSelectComponent.searchTerm="",document.activeElement.blur()}get currentScope(){let e=this.globalSearchService.projectScope;return""===e?"current_project_and_all_descendants":e}unregister(){this.unregisterGlobalListener&&(this.unregisterGlobalListener(),this.unregisterGlobalListener=void 0)}toggleTopMenuClass(){jQuery("#top-menu").toggleClass("-global-search-expanded",this.expanded)}}Uc.\u0275fac=function(e){return new(e||Uc)(n.bc(n.q),n.bc(y.a),n.bc(H.a),n.bc(q.a),n.bc(C.a),n.bc(Ar),n.bc(xe.a),n.bc(Lc.a),n.bc(n.i),n.bc(ee.a))},Uc.\u0275cmp=n.Vb({type:Uc,selectors:[["global-search-input"]],viewQuery:function(e,t){var i;(1&e&&(n.Rc(Bc,!0),n.Rc(pn.a,!0)),2&e)&&(n.Ic(i=n.qc())&&(t.btn=i.first),n.Ic(i=n.qc())&&(t.ngSelectComponent=i.first))},hostBindings:function(e,t){1&e&&n.pc("click",(function(e){return t.handleClick(e)}))},decls:10,vars:20,consts:[[1,"top-menu-search"],["class","top-menu-search--back-button","href","#",3,"title","click",4,"ngIf"],["name","global-search-input","id","global-search-input","accesskey","4",3,"items","placeholder","ngClass","ngModel","openOnEnter","searchFn","typeahead","loading","ngModelChange","focus","blur","search","open","close","change","keydown.enter","keydown.escape","clear"],["select",""],["ng-option-tmp",""],["id","top-menu-search-button","tabindex","0","role","button",1,"top-menu-search--button","search-form-normal",3,"title","accessibleClick"],["btn",""],["icon-classes","icon5 icon-search ellipsis"],["href","#",1,"top-menu-search--back-button",3,"title","click"],["aria-hidden","true",1,"icon-arrow-left1"],[4,"ngIf","ngIfElse"],["workPackageItemTemplate",""],["tabindex","-1",1,"global-search--option",3,"click"],[1,"global-search--option-wrapper"],[1,"global-search--search-term"],[1,"global-search--project-scope",3,"title"],["tabindex","-1",1,"global-search--option",2,"line-height","1",3,"href","click"],["data-class-list","avatar global-search-author-avatar hidden-for-mobile",3,"user"],[1,"global-search--wp-subject"],[1,"global-search--wp-content"],[1,"global-search--wp-project",3,"textContent"],[1,"global-search--wp-id",3,"ngClass"],[1,"global-search--wp-status",3,"textContent","ngClass"]],template:function(e,t){if(1&e){const e=n.ic();n.hc(0,"div",0),n.Tc(1,zc,2,1,"a",1),n.hc(2,"ng-select",2,3),n.pc("ngModelChange",(function(e){return t.selectedItem=e}))("focus",(function(){return t.onFocus()}))("blur",(function(){return t.onFocusOut()}))("search",(function(e){return t.search(e)}))("open",(function(){return t.openCloseMenu(t.currentValue)}))("close",(function(){n.Lc(e);return n.Jc(3).searchTerm=t.currentValue}))("change",(function(){return t.followSelectedItem()}))("keydown.enter",(function(){return t.onEnterBeforeResultsLoaded()}))("keydown.escape",(function(){return t.blur()}))("clear",(function(){return t.clearSearch()})),n.sc(4,"async"),n.sc(5,"async"),n.Tc(6,Wc,3,2,"ng-template",4),n.gc(),n.hc(7,"a",5,6),n.pc("accessibleClick",(function(e){return t.handleClick(e)})),n.cc(9,"op-icon",7),n.gc(),n.gc()}2&e&&(n.Pb(1),n.wc("ngIf",t.expanded),n.Pb(1),n.Tb("-expanded",t.expanded),n.xc("placeholder",t.text.search_dots),n.wc("items",n.tc(4,14,t.requests.output$))("ngClass",n.Bc(18,Xc,t.markable))("ngModel",t.selectedItem)("openOnEnter",!1)("searchFn",t.customSearchFn)("typeahead",t.requests.input$)("loading",n.tc(5,16,t.requests.loading$)),n.Pb(5),n.Tb("-input-focused",t.expanded),n.xc("title",t.text.search))},directives:[oe.q,pn.a,oe.n,l.m,l.p,vn.a,pn.c,dn.a,yt.a,Kt.a],pipes:[oe.a],styles:['.cdk-drag-preview{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}.top-menu-search{display:flex;align-items:center;position:relative;height:var(--header-height);line-height:var(--header-height);margin:0 15px}.top-menu-search .top-menu-search--back-button{display:none}.top-menu-search .top-menu-search--button{position:absolute;right:2px;font-size:var(--header-item-font-size);color:var(--header-item-font-color)}.top-menu-search .top-menu-search--button:hover{text-decoration:none}.top-menu-search .top-menu-search--button.-input-focused{color:var(--header-search-field-font-color)}.top-menu-search .top-menu-search--loading{top:var(--header-height)-11px;height:46px;z-index:1051}.top-menu-search #global-search-input{width:calc(160px + 3vw);font-size:.9rem;transition:width .2s ease-in-out}.top-menu-search #global-search-input::-ms-clear{margin-right:5px;width:20px}.top-menu-search #global-search-input .ng-select-container{background:transparent;border-color:var(--header-item-font-color)}.top-menu-search #global-search-input .ng-arrow-wrapper{display:none}.top-menu-search #global-search-input .ng-clear-wrapper{color:var(--header-item-font-color);top:1px;width:30px;right:25px;text-align:center}.top-menu-search #global-search-input .ng-input{top:0}.top-menu-search #global-search-input .ng-input input{color:var(--header-item-font-color);height:30px;cursor:text}.top-menu-search #global-search-input .ng-placeholder{color:var(--header-item-font-color)}.top-menu-search #global-search-input.-expanded{width:calc(160px + 13vw);background:#fff;border-radius:4px;color:var(--header-search-field-font-color)}.top-menu-search #global-search-input.-expanded .ng-clear-wrapper,.top-menu-search #global-search-input.-expanded .ng-placeholder,.top-menu-search #global-search-input.-expanded input{color:var(--header-search-field-font-color)}.top-menu-search #global-search-input .scroll-host{scrollbar-color:transparent transparent;scrollbar-width:thin;max-height:80vh;height:auto}.top-menu-search #global-search-input .scroll-host::-webkit-scrollbar{height:10px;width:10px}.top-menu-search #global-search-input .scroll-host::-webkit-scrollbar-track{background:transparent}.top-menu-search #global-search-input .scroll-host::-webkit-scrollbar-thumb{background:#ddd;visibility:hidden}.top-menu-search #global-search-input .scroll-host:hover{scrollbar-color:#ddd transparent}.top-menu-search #global-search-input .scroll-host:hover::-webkit-scrollbar-thumb{visibility:visible}.top-menu-search #global-search-input .ng-option{border-bottom:1px solid #eaeaea;white-space:normal;padding:5px 10px;background-color:unset}.top-menu-search #global-search-input .ng-option:last-child{border-bottom:none}.top-menu-search #global-search-input .ng-option.ng-option-marked{color:var(--header-drop-down-item-font-hover-color)}.top-menu-search #global-search-input .ng-option.ng-option-disabled{display:none}.top-menu-search #global-search-input .ng-option.ng-option-selected{color:var(--header-drop-down-item-font-hover-color)}.top-menu-search #global-search-input.-markable .ng-option.ng-option-marked{background-color:var(--drop-down-hover-bg-color)}.top-menu-search #global-search-input.-markable .ng-option.ng-option-selected{background-color:var(--drop-down-selected-bg-color)}.global-search--wp-id{color:var(--gray-dark);font-size:13px;white-space:nowrap}.top-menu-search--input .ng-spinner-loader{position:relative;right:14px}.global-search--option-wrapper{padding:5px;line-height:15px;min-height:25px;word-break:break-word}.global-search--option,.global-search--option:hover{color:var(--body-font-color);text-decoration:none}.global-search--project-scope{position:absolute;right:7px;border:1px solid var(--button--border-color);font-size:13px;background:var(--button--background-color);border-radius:2px;padding:0 4px;color:var(--body-font-color)}.global-search-author-avatar{margin-right:5px;float:left}.global-search--wp-content{display:grid;grid-template-columns:50% 1fr auto;grid-template-areas:"project idlink status";font-size:.8rem;padding:5px 0}.global-search--wp-content .global-search--wp-project{grid-area:project}.global-search--wp-content .global-search--wp-id{grid-area:idlink;place-self:right;font-style:italic}.global-search--wp-content .global-search--wp-status{grid-area:status;overflow:hidden;font-style:italic}.global-search--wp-subject{font-weight:700;display:inline-block;width:85%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}',".cdk-drag-preview{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}@media only screen and (max-width:679px){#top-menu.-global-search-expanded #account-nav-left,#top-menu.-global-search-expanded #account-nav-right,#top-menu.-global-search-expanded #main-menu-toggle{display:none}#top-menu.-global-search-expanded .top-menu-search{width:100vw;margin:0;padding-right:15px}#top-menu.-global-search-expanded .top-menu-search .top-menu-search--button{display:none;color:var(--header-item-font-color)}#top-menu #global-search-input{display:none}#top-menu #global-search-input.-expanded{display:block;width:calc(100vw - 50px);min-width:unset;position:unset}#top-menu #global-search-input.-expanded .scroll-host{max-height:calc(100vh - var(--header-height))}#top-menu #global-search-input.-expanded .ng-clear-wrapper{width:40px;right:0}#top-menu #global-search-input.-expanded .ng-select-bottom{height:calc(100vh - var(--header-height));overflow-y:auto;margin:0}#top-menu #global-search-input.-expanded .ng-select-container{height:36px!important;border-radius:4px}#top-menu #global-search-input.-expanded .ng-input input{height:36px}#top-menu .top-menu-search--back-button{display:initial;width:50px;text-align:center;color:var(--header-item-font-color)}#top-menu .top-menu-search--back-button:active,#top-menu .top-menu-search--back-button:focus,#top-menu .top-menu-search--back-button:hover{text-decoration:none}#top-menu .top-menu-search--loading{top:var(--header-height)1px}#top-menu .top-menu-search--button.-input-focused{color:var(--header-item-font-color)}}"],encapsulation:2,changeDetection:0});const Gc=["sectionBody"],Yc=function(e){return{"-expanded":e}};class Kc{constructor(e){this.elementRef=e,this.expanded=!1}ngOnInit(){const e=this.elementRef.nativeElement;this.sectionTitle=e.getAttribute("section-title"),"true"===e.getAttribute("initially-expanded")&&(this.expanded=!0);const t=e.nextElementSibling;this.sectionBody.nativeElement.appendChild(t),t.removeAttribute("hidden")}toggle(){this.expanded=!this.expanded}}Kc.\u0275fac=function(e){return new(e||Kc)(n.bc(n.q))},Kc.\u0275cmp=n.Vb({type:Kc,selectors:[["collapsible-section-augment"]],viewQuery:function(e,t){var i;(1&e&&n.Rc(Gc,!0),2&e)&&(n.Ic(i=n.qc())&&(t.sectionBody=i.first))},decls:5,vars:6,consts:[[1,"collapsible-section",3,"ngClass"],["linkClass","collapsible-section--toggle-link","spanClass","collapsible-section--legend",3,"linkAriaLabel","execute"],[3,"textContent"],[1,"collapsible-section--body","toggle-slide-animation",3,"hidden"],["sectionBody",""]],template:function(e,t){1&e&&(n.hc(0,"section",0),n.hc(1,"accessible-by-keyboard",1),n.pc("execute",(function(){return t.toggle()})),n.cc(2,"span",2),n.gc(),n.cc(3,"div",3,4),n.gc()),2&e&&(n.wc("ngClass",n.Bc(4,Yc,t.expanded)),n.Pb(1),n.wc("linkAriaLabel",t.sectionTitle),n.Pb(1),n.wc("textContent",t.sectionTitle),n.Pb(1),n.wc("hidden",!t.expanded))},directives:[oe.n,hn.a],encapsulation:2});class Zc{constructor(e,t){this.elementRef=e,this.i18n=t}ngOnInit(){let e=jQuery(this.elementRef.nativeElement);this.textMessage=e.attr("text-message"),this.linkMessage=e.attr("link-message")||this.i18n.t("js.work_packages.table_configuration.upsale.check_out_link"),this.referrer=e.attr("referrer")}}Zc.\u0275fac=function(e){return new(e||Zc)(n.bc(n.q),n.bc(y.a))},Zc.\u0275cmp=n.Vb({type:Zc,selectors:[["enterprise-banner-bootstrap"]],decls:1,vars:3,consts:[[3,"textMessage","linkMessage","opReferrer"]],template:function(e,t){1&e&&n.cc(0,"enterprise-banner",0),2&e&&n.wc("textMessage",t.textMessage)("linkMessage",t.linkMessage)("opReferrer",t.referrer)},directives:[Rn.a],encapsulation:2});var Jc,eo=i("/+cc");!function(e){e.register=function(e,t){jQuery.widget("custom."+e,jQuery.ui.autocomplete,{_create:function(){t.currentPage=0,this._super(),this.widget().menu("option","items","> .ui-matched-item"),this._search("")},_renderMenu:function(e,t){jQuery(e).unbind("scroll"),this._renderLazyMenu(e,t)},_renderMenuPage(e,i,n=null){let s=this,r=i.length,a=i,c=t.maxItemsPerPage;if(null!==n&&(a=i.slice(n*c,n*c+c),r=Math.min(i.length,n*c+c)),jQuery.each(a,(function(t,i){s._renderItemData(e,i)})),e.css("height","auto"),r<i.length){const t=32*r;t<.55*document.body.offsetHeight&&e.css("height",t-50)}},_pages:e=>Math.ceil(e.length/t.maxItemsPerPage),_repositionMenu:function(e){const t=this,i=t.menu;i.refresh(),t._resizeMenu(),e.position(jQuery.extend({of:t.element},t.options.position)),t.options.autoFocus&&i.next(new jQuery.Event("mouseover"))},_resizeMenu:function(){this.menu.element.outerWidth(this.element.outerWidth())},_renderItem:function(e,i){const n=this.element.val(),s="disabled"===i.render,r=jQuery("<div>").addClass("ui-menu-item-wrapper");t.renderItem(i,r);const a=jQuery("<li>").toggleClass("ui-state-disabled",s).toggleClass("ui-matched-item",!s).append(r).appendTo(e);return""!==n&&a.mark(n,{className:"ui-autocomplete-match"}),a},_renderLazyMenu:function(e,i){const n=this,s=jQuery(e),r=this._pages(i);if(r<=1)return n._renderMenuPage(e,i);n._renderMenuPage(e,i,0),s.scroll((function(){if(function(e){var t=e.outerHeight(),i=e[0].scrollHeight;return e.scrollTop()>=i-t}(s)){if(++t.currentPage>=r)return;n._renderMenuPage(e,i,t.currentPage),n._repositionMenu(e)}}))}})}}(Jc||(Jc={}));var to=i("E5Dd");class io extends class{constructor(e){this.widgetName=e,Jc.register(e,this)}renderItem(e,t){t.text(e.label)}fuzzySearch(e,t){if(""===t)return e;if(t.length>=3){const i=this.literalSearch(e,t);if(i.length>0)return i}return this.fuseInstance.search(t)}literalSearch(e,t){const i=[],n=t.toLowerCase();return e.forEach(e=>{-1!==e.label.toLowerCase().indexOf(n)&&i.push(e)}),i}augmentedResultSet(e,t){const i=[];return t.forEach(e=>{i.push({label:e.label,object:e.object,render:"match"})}),i}setup(e,t){this.currentPage=0,this.input=e,this.input[this.widgetName].call(this.input,this.setupParams(t));this.fuseInstance=new eo(t,{shouldSort:!0,tokenize:!1,threshold:.2,location:0,distance:1e4,maxPatternLength:16,minMatchCharLength:2,keys:["label"]})}setupParams(e){const t=this;return{delay:50,source:function(i,n){const s=t.fuzzySearch(e,i.term);n(t.augmentedResultSet(e,s))},select:(e,i)=>{"match"===i.item.render&&t.onItemSelected(i.item.object)},create:()=>t.input.focus(),response:(e,i)=>{t.onNoResultsFound(e,i)},autoFocus:!0,minLength:0}}}{constructor(e,t,i,n,s,r){super("projectMenuAutocomplete"),this.PathHelper=e,this.elementRef=t,this.http=i,this.cdRef=n,this.I18n=s,this.currentProject=r,this.results=null,this.loaded=!1,this.text={label:s.t("js.projects.autocompleter.label"),no_results:s.t("js.notice_no_principals_found"),loading:s.t("js.ajax.loading")}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.dropdownMenu=this.$element.parents("li.drop-down"),this.input=this.$element.find(".project-menu-autocomplete--input"),this.noResults=this.$element.find(".project-menu-autocomplete--no-results"),this.dropdownMenu.on("opened",()=>this.open()),this.dropdownMenu.on("closed",()=>this.close())}close(){try{this.input.projectMenuAutocomplete("destroy")}catch(e){console.warn("Failed to destroy autocomplete: %O",e)}this.$element.find(".project-search-results").css("visibility","hidden")}open(){this.$element.find(".project-search-results").css("visibility","visible"),this.loadProjects().then(e=>{let t=_.map(e,e=>({label:e.name,render:"match",object:e}));this.setup(this.input,t),this.addInputHandlers(),this.addClickHandler(),this.loaded=!0,this.cdRef.detectChanges(),this.scrollCurrentProjectIntoView()})}get maxItemsPerPage(){return 250}onItemSelected(e){window.location.href=this.projectLink(e.identifier)}onNoResultsFound(e,t){this.noResults.toggle(0===t.content.length)}renderItem(e,t){const i=jQuery("<a>").attr("href",this.projectLink(e.object.identifier)).text(e.label).appendTo(t);e.object.level>0&&i.text("\xbb "+e.label).css("padding-left",4+16*e.object.level+"px"),e.object.identifier===this.currentProject.identifier&&t.addClass("selected")}projectLink(e){const t=jQuery('meta[name="current_menu_item"]').attr("content");let i=this.PathHelper.projectPath(e);return t&&(i+="?jump="+encodeURIComponent(t)),i}get loadingText(){return this.loaded?"":this.text.loading}loadProjects(){if(null!==this.results)return Promise.resolve(this.results);const e=this.PathHelper.projectLevelListPath();return this.http.get(e).toPromise().then(e=>this.results=this.augmentWithParents(e.projects))}augmentWithParents(e){const t=[];let i=-1;return e.map(e=>{for(;i>=e.level;)t.pop(),i--;return t.push(e),i=e.level,e.parents=t.slice(0,-1),e})}augmentedResultSet(e,t){const i=t.map(e=>e.object.identifier),n=_.flatten(t.map(e=>e.object.parents)),s=[];return e.forEach(e=>{const t=e.object.identifier;let r;if(i.indexOf(t)>=0)r="match";else{if(!_.find(n,e=>e.identifier===t))return;r="disabled"}s.push({label:e.label,object:e.object,render:r})}),s}addInputHandlers(){this.input.off("blur"),this.input.keydown(e=>e.which!==to.a.ESCAPE||(this.input.val(""),this.input[this.widgetName].call(this.input,"search",""),!1))}addClickHandler(){var e=!1;this.$element.find(".project-menu-autocomplete--results").on("click",".ui-menu-item a",e=>(qc.a.isClickedWithModifier(e)&&e.stopImmediatePropagation(),!0)).on("touchend",".ui-menu-item a",(function(t){e||(window.location.href=t.target.href)})).on("touchmove",".ui-menu-item a",(function(){e=!0})).on("touchstart",".ui-menu-item a",(function(){e=!1}))}setupParams(e){const t=super.setupParams(e);return t.appendTo=".project-menu-autocomplete--wrapper",t.classes={"ui-autocomplete":"-inplace project-menu-autocomplete--results"},t.position={of:".project-menu-autocomplete--input-container"},t}scrollCurrentProjectIntoView(){let e=document.querySelector(".ui-menu-item-wrapper.selected");if(!e)return;let t=e.offsetHeight,i=document.getElementsByClassName("project-menu-autocomplete--results")[0],n=e.offsetTop-i.offsetHeight/2+t/2;i.scrollTop=n%t==0?n:n-n%t}}io.\u0275fac=function(e){return new(e||io)(n.bc(q.a),n.bc(n.q),n.bc(te.b),n.bc(n.i),n.bc(y.a),n.bc(xe.a))},io.\u0275cmp=n.Vb({type:io,selectors:[["project-menu-autocomplete"]],features:[n.Mb],decls:7,vars:3,consts:[["id","project_autocompletion_wrapper",1,"dropdown","dropdown-relative","project-search-results"],[1,"project-menu-autocomplete--wrapper"],[1,"project-menu-autocomplete--input-container"],["for","project_autocompletion_input",1,"hidden-for-sighted",3,"textContent"],["type","text","id","project_autocompletion_input","name","project_autocompletion_input",1,"ui-autocomplete--input","project-menu-autocomplete--input"],[1,"project-menu-autocomplete--search-icon","icon-search"],["hidden","",1,"project-menu-autocomplete--no-results",3,"textContent"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.cc(3,"label",3),n.cc(4,"input",4),n.cc(5,"i",5),n.gc(),n.cc(6,"p",6),n.gc(),n.gc()),2&e&&(n.Pb(3),n.wc("textContent",t.text.label),n.Pb(1),n.Qb("placeholder",t.loadingText),n.Pb(2),n.wc("textContent",t.text.no_results))},encapsulation:2,changeDetection:0});class no{constructor(e,t){this.elementRef=e,this.http=t}ngOnInit(){const e=jQuery(this.elementRef.nativeElement),t=e.parent();this.inputs=t.find(".remote-field--input"),this.target=t.find(".remote-field--target"),this.url=e.data("url"),this.htmlMode="html"===e.data("mode"),this.inputs.on("keyup change",_.debounce(e=>{let t=[to.a.TAB,to.a.ENTER,to.a.SHIFT];("change"===e.type||e.which&&-1===t.indexOf(e.which))&&this.updater()},500))}request(e){const t={};return this.htmlMode?t.Accept="text/html":t.Accept="application/json",this.http.get(this.url,{params:e,headers:t,responseType:this.htmlMode?"text":"json",withCredentials:!0})}updater(){let e={};this.inputs.each((t,i)=>{e[i.dataset.remoteFieldKey]=i.value}),this.request(e).subscribe(e=>{this.htmlMode?this.target.html(e):_.each(e,(e,t)=>{let i=document.getElementById(t);i instanceof HTMLInputElement?i.value=e:i&&(i.textContent=e)})})}}no.\u0275fac=function(e){return new(e||no)(n.bc(n.q),n.bc(te.b))},no.\u0275cmp=n.Vb({type:no,selectors:[["remote-field-updater"]],decls:0,vars:0,template:function(e,t){},encapsulation:2});var so=i("5gqY");class ro extends tt.a{constructor(e,t,i,n,s){super(),this.elementRef=e,this.cdRef=t,this.globalSearchService=i,this.I18n=n,this.injector=s,this.text={all_projects:this.I18n.t("js.global_search.title.all_projects"),project_and_subprojects:this.I18n.t("js.global_search.title.project_and_subprojects"),search_for:this.I18n.t("js.global_search.title.search_for"),in:this.I18n.t("js.label_in")}}ngOnInit(){Object(lc.a)([this.globalSearchService.searchTerm$,this.globalSearchService.projectScope$]).pipe(Object(ha.a)(),this.untilDestroyed()).subscribe(([e,t])=>{this.searchTerm=e,this.project=this.projectText(t),this.searchTitle=`${this.text.search_for} ${this.searchTerm} ${""===this.project?"":this.text.in} ${this.project}`,this.cdRef.detectChanges()})}projectText(e){let t=this.currentProjectService.name?this.currentProjectService.name:"";switch(e){case"all":return this.text.all_projects;case"current_project":return t;case"":return t+" "+this.text.project_and_subprojects;default:return""}}}function ao(e,t){if(1&e){const e=n.ic();n.hc(0,"li"),n.hc(1,"a",11),n.pc("click",(function(){n.Lc(e);const i=t.$implicit;return n.rc().clickTab(i.id)})),n.gc(),n.gc()}if(2&e){const e=t.$implicit,i=n.rc();n.Tb("selected",e.id===i.currentTabId),n.Qb("tab-id",e.id),n.Pb(1),n.wc("href",e.path,n.Oc)("textContent",e.name)}}ro.\u0275fac=function(e){return new(e||ro)(n.bc(n.q),n.bc(n.i),n.bc(Ar),n.bc(y.a),n.bc(n.A))},ro.\u0275cmp=n.Vb({type:ro,selectors:[["global-search-title"]],inputs:{searchTerm:"searchTerm",project:"project",projectScope:"projectScope",searchTitle:"searchTitle"},features:[n.Mb],decls:11,vars:5,consts:[[1,"toolbar-container"],[1,"toolbar"],[1,"title-container"],[1,"toolbar-items"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.hc(3,"h2"),n.Vc(4),n.hc(5,"i"),n.Vc(6),n.gc(),n.Vc(7),n.hc(8,"i"),n.Vc(9),n.gc(),n.gc(),n.cc(10,"ul",3),n.gc(),n.gc(),n.gc()),2&e&&(n.Pb(3),n.Qb("title",t.searchTitle),n.Pb(1),n.Xc(" ",t.text.search_for," "),n.Pb(2),n.Xc('"',t.searchTerm,'"'),n.Pb(1),n.Xc(" ",""===t.project?"":t.text.in," "),n.Pb(2),n.Wc(t.project))},encapsulation:2}),Object(w.c)([Object(z.a)(),Object(w.e)("design:type",xe.a)],ro.prototype,"currentProjectService",void 0);class co extends Tn.a{constructor(e){super(),this.globalSearchService=e,this.classes=["global-search--tabs","scrollable-tabs"]}ngOnInit(){this.currentTabSub=this.globalSearchService.currentTab$.subscribe(e=>{this.currentTabId=e}),this.tabsSub=this.globalSearchService.tabs$.subscribe(e=>{this.tabs=e,this.tabs.map(e=>e.path="#")})}clickTab(e){super.clickTab(e),this.globalSearchService.currentTab=e,this.globalSearchService.submitSearch()}ngOnDestroy(){this.currentTabSub.unsubscribe(),this.tabsSub.unsubscribe()}}function oo(e,t){if(1&e){const e=n.ic();n.hc(0,"div",1),n.pc("accessibleClick",(function(t){n.Lc(e);return n.rc().toggleService.toggleNavigation(t)})),n.hc(1,"a",2),n.cc(2,"i",3),n.gc(),n.gc()}if(2&e){const e=n.rc();n.Qb("title",e.toggleTitle)}}co.\u0275fac=function(e){return new(e||co)(n.bc(Ar))},co.\u0275cmp=n.Vb({type:co,selectors:[["global-search-tabs"]],features:[n.Mb],decls:11,vars:4,consts:[[3,"ngClass"],["scrollContainer",""],[1,"tabrow",3,"scroll"],["scrollPane",""],[3,"selected",4,"ngFor","ngForOf"],[1,"scrollable-tabs--button","-left",3,"hidden","click"],["scrollLeftBtn",""],[1,"icon-arrow-left2"],[1,"scrollable-tabs--button","-right",3,"hidden","click"],["scrollRightBtn",""],[1,"icon-arrow-right2"],[3,"href","textContent","click"]],template:function(e,t){1&e&&(n.hc(0,"div",0,1),n.hc(2,"ul",2,3),n.pc("scroll",(function(e){return t.onScroll(e)})),n.Tc(4,ao,2,5,"li",4),n.gc(),n.hc(5,"div",5,6),n.pc("click",(function(){return t.scrollLeft()})),n.cc(7,"span",7),n.gc(),n.hc(8,"div",8,9),n.pc("click",(function(){return t.scrollRight()})),n.cc(10,"span",10),n.gc(),n.gc()),2&e&&(n.wc("ngClass",t.classes),n.Pb(4),n.wc("ngForOf",t.tabs),n.Pb(1),n.wc("hidden",t.hideLeftButton),n.Pb(3),n.wc("hidden",t.hideRightButton))},directives:[oe.n,oe.p],encapsulation:2});class lo extends tt.a{constructor(e,t,i,n){super(),this.toggleService=e,this.cdRef=t,this.deviceService=i,this.injector=n,this.toggleTitle=""}ngOnInit(){this.toggleService.initializeMenu(),this.toggleService.titleData$.pipe(Object(ha.a)(),this.untilDestroyed()).subscribe(e=>{this.toggleTitle=e,this.cdRef.detectChanges()})}}lo.\u0275fac=function(e){return new(e||lo)(n.bc(Ec.a),n.bc(n.i),n.bc(Lc.a),n.bc(n.A))},lo.\u0275cmp=n.Vb({type:lo,selectors:[["main-menu-toggle"]],features:[n.Mb],decls:1,vars:1,consts:[["id","main-menu-toggle","aria-haspopup","true","tabindex","0",3,"accessibleClick",4,"ngIf"],["id","main-menu-toggle","aria-haspopup","true","tabindex","0",3,"accessibleClick"],["icon","icon-hamburger"],["aria-hidden","true",1,"icon-hamburger"]],template:function(e,t){1&e&&n.Tc(0,oo,3,1,"div",0),2&e&&n.wc("ngIf",null!==t.currentProject.id||t.deviceService.isMobile)},directives:[oe.q,dn.a],encapsulation:2,changeDetection:0}),Object(w.c)([Object(z.a)(),Object(w.e)("design:type",xe.a)],lo.prototype,"currentProject",void 0);var uo=i("Ng29");function ho(e,t){if(1&e&&n.cc(0,"user-avatar",3),2&e){const e=n.rc().item;n.wc("user",e)}}function po(e,t){if(1&e&&(n.Tc(0,ho,1,1,"user-avatar",2),n.Vc(1)),2&e){const e=t.item;n.wc("ngIf",e&&e.href),n.Pb(1),n.Xc(" ",e.name," ")}}class go extends In.a{getAvailableUsers(e,t){return this.http.get(e,{params:new te.f({encoder:new uo.a,fromObject:{q:t}}),responseType:"json",headers:{"Content-Type":"application/json; charset=utf-8"}}).pipe(Object(Nc.a)(e=>e.results.items.map(e=>{const t=/^\d+$/.test(e.id.toString())?this.pathHelper.userPath(e.id):null;return{name:e.name,id:e.id,href:t}})))}}go.\u0275fac=function(e){return fo(e||go)},go.\u0275cmp=n.Vb({type:go,selectors:[["members-autocompleter"]],features:[n.Mb],decls:4,vars:12,consts:[["bindLabel","name","bindValue","id",3,"items","ngModel","virtualScroll","trackByFn","typeahead","loading","appendTo","multiple","focus","change"],["ng-option-tmp",""],["data-class-list","avatar-mini",3,"user",4,"ngIf"],["data-class-list","avatar-mini",3,"user"]],template:function(e,t){1&e&&(n.hc(0,"ng-select",0),n.pc("focus",(function(){return t.onFocus()}))("change",(function(e){return t.onModelChange(e)})),n.sc(1,"async"),n.sc(2,"async"),n.Tc(3,po,2,2,"ng-template",1),n.gc()),2&e&&n.wc("items",n.tc(1,8,t.requests.output$))("ngModel",t.initialSelection)("virtualScroll",!0)("trackByFn",t.userTracker)("typeahead",t.requests.input$)("loading",n.tc(2,10,t.requests.loading$))("appendTo",t.appendTo)("multiple",t.multiple)},directives:[pn.a,l.m,l.p,vn.a,pn.c,oe.q,Kt.a],pipes:[oe.a],encapsulation:2}),Object(w.c)([Object(z.a)(),Object(w.e)("design:type",te.b)],go.prototype,"http",void 0),Object(w.c)([Object(z.a)(),Object(w.e)("design:type",q.a)],go.prototype,"pathHelper",void 0);const fo=n.jc(go);class bo{constructor(e,t,i,n){this.I18n=e,this.http=t,this.pathHelper=i,this.notificationsService=n,this.userData$=Object(o.g)(),this.modalOpen=!1,this.cancelled=!1,this.emailInvalid=!1,this.text={invalid_email:this.I18n.t("js.admin.enterprise.trial.form.invalid_email"),taken_email:this.I18n.t("js.admin.enterprise.trial.form.taken_email"),taken_domain:this.I18n.t("js.admin.enterprise.trial.form.taken_domain")};let s=window.gon;this.baseUrlAugur=s.augur_url,this.tokenVersion=s.token_version,window.gon.ee_trial_key&&this.setMailSubmittedStatus()}sendForm(e){const t=Object.assign(Object.assign({},e.value),{token_version:this.tokenVersion});this.http.post(this.baseUrlAugur+"/public/v1/trials",t).toPromise().then(t=>{this.userData$.putValue(e.value),this.cancelled=!1,this.trialLink=t._links.self.href,this.saveTrialKey(this.trialLink),this.retryConfirmation()}).catch(e=>{422===e.status||400===e.status?this.error=e:this.notificationsService.addWarning(e.error.description||I18n.t("js.error.internal"))})}getToken(){this.http.get(this.trialLink).toPromise().then(e=>Object(w.b)(this,void 0,void 0,(function*(){this.confirmed=!0,e.token_retrieved||(yield this.saveToken(e.token))}))).catch(e=>{422===e.status&&"waiting_for_email_verification"===e.error.identifier?(this.resendLink=e.error._links.resend.href,this.status&&!this.cancelled||this.saveTrialKey(this.resendLink),this.setMailSubmittedStatus(),this.confirmed=!1):"Error"===_.get(e,"error._type")?this.notificationsService.addError(e.error.message):this.notificationsService.addError(e.error||I18n.t("js.error.internal"))})}saveTrialKey(e){let t=e.split("/")[6];return this.http.post(this.pathHelper.appBasePath+"/admin/enterprise/save_trial_key",{trial_key:t},{withCredentials:!0}).toPromise().catch(e=>{this.notificationsService.addError(e.error.message||e.message||e)})}saveToken(e){return this.http.post(this.pathHelper.appBasePath+"/admin/enterprise",{enterprise_token:{encoded_token:e}},{withCredentials:!0}).toPromise().then(()=>{this.modalOpen||setTimeout(()=>{window.location.reload()},500)}).catch(e=>{this.http.delete(this.pathHelper.api.v3.apiV3Base+"/admin/enterprise/delete_trial_key",{withCredentials:!0}).toPromise(),this.notificationsService.addError(e.error.description||I18n.t("js.error.internal"))})}retryConfirmation(e=5e3,t=60){this.cancelled||this.confirmed||(0===t?this.cancelled=!0:(this.getToken(),setTimeout(()=>{this.retryConfirmation(e,t-1)},e)))}setStartTrialStatus(){this.status="startTrial"}setMailSubmittedStatus(){this.status="mailSubmitted"}get trialStarted(){return"startTrial"===this.status}get mailSubmitted(){return"mailSubmitted"===this.status}get domainTaken(){return!!this.error&&"domain_taken"===this.error.error.identifier}get emailTaken(){return!!this.error&&"user_already_created_trial"===this.error.error.identifier}get emailError(){return!!this.emailInvalid||!!this.error&&this.emailTaken}get errorMsg(){let e="";return this.emailInvalid?e=this.text.invalid_email:this.domainTaken?e=this.text.taken_domain:this.emailTaken&&(e=this.text.taken_email),e}}bo.\u0275fac=function(e){return new(e||bo)(n.lc(y.a),n.lc(te.b),n.lc(q.a),n.lc(v.a))},bo.\u0275prov=n.Xb({token:bo,factory:bo.\u0275fac});var mo,wo=i("vK8y");function vo(e,t){if(1&e&&(n.hc(0,"div",26),n.Vc(1),n.gc()),2&e){const e=n.rc();n.Pb(1),n.Wc(e.eeTrialService.errorMsg)}}function yo(e,t){if(1&e&&(n.hc(0,"div",27),n.Vc(1),n.gc()),2&e){const e=n.rc();n.Pb(1),n.Wc(e.eeTrialService.errorMsg)}}!function(e){e.localizeLink=function(e){return e[I18n.locale]||e.en}}(mo||(mo={}));const ko=function(e){return{"-required-highlighting":e}};class Co{constructor(e,t,i,n,s){this.elementRef=e,this.I18n=t,this.formBuilder=i,this.currentUserService=n,this.eeTrialService=s,this.userData=this.eeTrialService.userData$.getValueOr({}),this.trialForm=this.formBuilder.group({company:[this.userData.company,l.A.required],first_name:[this.userData.first_name,l.A.required],last_name:[this.userData.last_name,l.A.required],email:["",[l.A.required,l.A.email]],domain:[this.userData.domain||window.location.host,l.A.required],general_consent:[null,l.A.required],newsletter_consent:null,language:this.currentUserService.language}),this.text={general_consent:this.I18n.t("js.admin.enterprise.trial.form.general_consent",{link_terms:mo.localizeLink({en:"https://www.openproject.com/terms-of-service/",de:"https://www.openproject.org/de/nutzungsbedingungen/"}),link_privacy:mo.localizeLink({en:"https://www.openproject.org/data-privacy-and-security/",de:"https://www.openproject.org/de/datenschutz/"})}),label_test_ee:this.I18n.t("js.admin.enterprise.trial.form.test_ee"),label_company:this.I18n.t("js.admin.enterprise.trial.form.label_company"),label_first_name:this.I18n.t("js.admin.enterprise.trial.form.label_first_name"),label_last_name:this.I18n.t("js.admin.enterprise.trial.form.label_last_name"),label_email:this.I18n.t("js.admin.enterprise.trial.form.label_email"),label_domain:this.I18n.t("js.admin.enterprise.trial.form.label_domain"),privacy_policy:this.I18n.t("js.admin.enterprise.trial.form.privacy_policy"),receive_newsletter:this.I18n.t("js.admin.enterprise.trial.form.receive_newsletter",{link:"https://www.openproject.com/newsletter/"}),terms_of_service:this.I18n.t("js.admin.enterprise.trial.form.terms_of_service")}}checkMailField(){""!==this.trialForm.value.email&&this.trialForm.controls.email.errors?this.eeTrialService.emailInvalid=!0:(this.eeTrialService.emailInvalid=!1,this.eeTrialService.error=void 0)}}Co.\u0275fac=function(e){return new(e||Co)(n.bc(n.q),n.bc(y.a),n.bc(l.e),n.bc(wo.a),n.bc(bo))},Co.\u0275cmp=n.Vb({type:Co,selectors:[["enterprise-trial-form"]],decls:45,vars:16,consts:[["id","enterprise-trial-form",1,"form",3,"formGroup"],[1,"form--field","-wide-label","-required"],["for","trial-company-name",1,"form--label"],[1,"form--field-container"],[1,"form--text-field-container"],["type","text","id","trial-company-name","formControlName","company",1,"form--text-field"],["for","trial-first-name",1,"form--label"],["type","text","id","trial-first-name","formControlName","first_name",1,"form--text-field"],["for","trial-last-name",1,"form--label"],["type","text","id","trial-last-name","formControlName","last_name",1,"form--text-field"],["for","trial-email",1,"form--label"],[1,"form--text-field-container",3,"ngClass"],["type","email","id","trial-email","formControlName","email",1,"form--text-field",3,"blur"],["class","form--field-instructions ee-trial-email-error",4,"ngIf"],["for","trial-domain-name",1,"form--label"],["type","text","id","trial-domain-name","formControlName","domain","disabled","",1,"form--text-field"],["class","form--field-instructions",4,"ngIf"],[1,"form--field","-required"],["for","trial-general-consent",1,"form--label-with-check-box","-no-ellipsis"],[1,"form--check-box-container"],["type","checkbox","id","trial-general-consent","formControlName","general_consent","required","",1,"form--check-box"],[3,"innerHTML"],[1,"form--field"],["for","trial-newsletter-consent",1,"form--label-with-check-box","-no-ellipsis"],["type","checkbox","id","trial-newsletter-consent","formControlName","newsletter_consent",1,"form--check-box"],[3,"innerHtml"],[1,"form--field-instructions","ee-trial-email-error"],[1,"form--field-instructions"]],template:function(e,t){1&e&&(n.hc(0,"form",0),n.hc(1,"div",1),n.hc(2,"label",2),n.Vc(3),n.gc(),n.hc(4,"div",3),n.hc(5,"div",4),n.cc(6,"input",5),n.gc(),n.gc(),n.gc(),n.hc(7,"div",1),n.hc(8,"label",6),n.Vc(9),n.gc(),n.hc(10,"div",3),n.hc(11,"div",4),n.cc(12,"input",7),n.gc(),n.gc(),n.gc(),n.hc(13,"div",1),n.hc(14,"label",8),n.Vc(15),n.gc(),n.hc(16,"div",3),n.hc(17,"div",4),n.cc(18,"input",9),n.gc(),n.gc(),n.gc(),n.hc(19,"div",1),n.hc(20,"label",10),n.Vc(21),n.gc(),n.hc(22,"div",3),n.hc(23,"div",11),n.hc(24,"input",12),n.pc("blur",(function(){return t.checkMailField()})),n.gc(),n.gc(),n.gc(),n.Tc(25,vo,2,1,"div",13),n.gc(),n.hc(26,"div",1),n.hc(27,"label",14),n.Vc(28),n.gc(),n.hc(29,"div",3),n.hc(30,"div",11),n.cc(31,"input",15),n.gc(),n.gc(),n.Tc(32,yo,2,1,"div",16),n.gc(),n.hc(33,"div",17),n.hc(34,"div",3),n.hc(35,"label",18),n.hc(36,"div",19),n.cc(37,"input",20),n.gc(),n.cc(38,"span",21),n.gc(),n.gc(),n.gc(),n.hc(39,"div",22),n.hc(40,"div",3),n.hc(41,"label",23),n.hc(42,"div",19),n.cc(43,"input",24),n.gc(),n.cc(44,"span",25),n.gc(),n.gc(),n.gc(),n.gc()),2&e&&(n.wc("formGroup",t.trialForm),n.Pb(3),n.Wc(t.text.label_company),n.Pb(6),n.Wc(t.text.label_first_name),n.Pb(6),n.Wc(t.text.label_last_name),n.Pb(6),n.Wc(t.text.label_email),n.Pb(2),n.wc("ngClass",n.Bc(12,ko,t.eeTrialService.emailError)),n.Pb(2),n.wc("ngIf",t.eeTrialService.emailError),n.Pb(3),n.Wc(t.text.label_domain),n.Pb(2),n.wc("ngClass",n.Bc(14,ko,t.eeTrialService.domainTaken)),n.Pb(2),n.wc("ngIf",t.eeTrialService.domainTaken),n.Pb(6),n.wc("innerHTML",t.text.general_consent,n.Mc),n.Pb(6),n.wc("innerHtml",t.text.receive_newsletter,n.Mc))},directives:[l.C,l.n,l.h,l.c,l.m,l.g,oe.n,oe.q,l.a,l.b],styles:[".ee-trial-email-error[_ngcontent-%COMP%]{width:min-content}"]});class jo extends tt.a{constructor(e){super(),this.I18n=e,this.text={label_email:this.I18n.t("js.admin.enterprise.trial.form.label_email"),label_expires_at:this.I18n.t("js.admin.enterprise.trial.form.label_expires_at"),label_maximum_users:this.I18n.t("js.admin.enterprise.trial.form.label_maximum_users"),label_company:this.I18n.t("js.admin.enterprise.trial.form.label_company"),label_domain:this.I18n.t("js.admin.enterprise.trial.form.label_domain"),label_starts_at:this.I18n.t("js.admin.enterprise.trial.form.label_starts_at"),label_subscriber:this.I18n.t("js.admin.enterprise.trial.form.label_subscriber")}}}function Po(e,t){if(1&e&&n.cc(0,"div",3),2&e){const e=n.rc();n.wc("textContent",e.text.label_company)}}function xo(e,t){if(1&e&&(n.hc(0,"div",4),n.hc(1,"div",5),n.cc(2,"span",6),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.company)}}function So(e,t){if(1&e&&n.cc(0,"div",3),2&e){const e=n.rc();n.wc("textContent",e.text.label_domain)}}function _o(e,t){if(1&e&&(n.hc(0,"div",4),n.hc(1,"div",5),n.cc(2,"span",6),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.domain)}}function Oo(e,t){if(1&e&&n.cc(0,"div",3),2&e){const e=n.rc();n.wc("textContent",e.text.label_maximum_users)}}function Io(e,t){if(1&e&&(n.hc(0,"div",4),n.hc(1,"div",5),n.cc(2,"span",6),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.userCount)}}function To(e,t){if(1&e&&n.cc(0,"div",3),2&e){const e=n.rc();n.wc("textContent",e.text.label_starts_at)}}function Ro(e,t){if(1&e&&(n.hc(0,"div",4),n.hc(1,"div",5),n.cc(2,"span",6),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.startsAt)}}function Eo(e,t){if(1&e&&n.cc(0,"div",3),2&e){const e=n.rc();n.wc("textContent",e.text.label_expires_at)}}function Mo(e,t){if(1&e&&(n.hc(0,"div",4),n.hc(1,"div",5),n.cc(2,"span",6),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.expiresAt)}}class Fo extends jo{constructor(e,t,i,n,s,r){super(i),this.elementRef=e,this.cdRef=t,this.I18n=i,this.http=n,this.Gon=s,this.eeTrialService=r}ngOnInit(){this.subscriber||(this.eeTrialService.userData$.values$().pipe(Object(ha.a)(),this.untilDestroyed()).subscribe(e=>{this.formatUserData(e),this.cdRef.detectChanges()}),this.initialize())}initialize(){let e=this.Gon.get("ee_trial_key");e&&!this.eeTrialService.userData$.hasValue()&&(this.eeTrialService.trialLink=this.eeTrialService.baseUrlAugur+"/public/v1/trials/"+e.value,this.getUserDataFromAugur())}getUserDataFromAugur(){this.http.get(this.eeTrialService.trialLink+"/details").toPromise().then(e=>{this.eeTrialService.userData$.putValue(e),this.eeTrialService.retryConfirmation()}).catch(e=>{this.eeTrialService.getToken()})}formatUserData(e){this.subscriber=e.first_name+" "+e.last_name,this.email=e.email,this.company=e.company,this.domain=e.domain}}function Ao(e,t){if(1&e&&(n.hc(0,"p"),n.Vc(1),n.gc()),2&e){const e=n.rc(2);n.Pb(1),n.Wc(e.text.session_timeout)}}function Lo(e,t){if(1&e){const e=n.ic();n.hc(0,"span",2),n.Vc(1),n.hc(2,"a",3),n.pc("click",(function(){n.Lc(e);return n.rc().resendMail()})),n.Vc(3),n.gc(),n.Tc(4,Ao,2,1,"p",4),n.gc()}if(2&e){const e=n.rc();n.Pb(1),n.Xc(" ",e.text.status_waiting," "),n.Pb(2),n.Wc(e.text.resend),n.Pb(1),n.wc("ngIf",e.eeTrialService.cancelled)}}function Do(e,t){if(1&e&&(n.hc(0,"span",5),n.Vc(1),n.gc()),2&e){const e=n.rc();n.Pb(1),n.Xc(" ",e.text.status_confirmed,"")}}Fo.\u0275fac=function(e){return new(e||Fo)(n.bc(n.q),n.bc(n.i),n.bc(y.a),n.bc(te.b),n.bc(Nr.a),n.bc(bo))},Fo.\u0275cmp=n.Vb({type:Fo,selectors:[["enterprise-active-trial"]],features:[n.Mb],decls:21,vars:14,consts:[[1,"enterprise--active-token"],[1,"attributes-group"],[1,"attributes-key-value"],[1,"attributes-key-value--key",3,"textContent"],[1,"attributes-key-value--value-container"],[1,"attributes-key-value--value","-text"],[3,"textContent"],["class","attributes-key-value--key",3,"textContent",4,"ngIf"],["class","attributes-key-value--value-container",4,"ngIf"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.cc(3,"div",3),n.hc(4,"div",4),n.hc(5,"div",5),n.cc(6,"span",6),n.gc(),n.gc(),n.cc(7,"div",3),n.hc(8,"div",4),n.hc(9,"div",5),n.cc(10,"span",6),n.gc(),n.gc(),n.Tc(11,Po,1,1,"div",7),n.Tc(12,xo,3,1,"div",8),n.Tc(13,So,1,1,"div",7),n.Tc(14,_o,3,1,"div",8),n.Tc(15,Oo,1,1,"div",7),n.Tc(16,Io,3,1,"div",8),n.Tc(17,To,1,1,"div",7),n.Tc(18,Ro,3,1,"div",8),n.Tc(19,Eo,1,1,"div",7),n.Tc(20,Mo,3,1,"div",8),n.gc(),n.gc(),n.gc()),2&e&&(n.Pb(3),n.wc("textContent",t.text.label_subscriber),n.Pb(3),n.wc("textContent",t.subscriber),n.Pb(1),n.wc("textContent",t.text.label_email),n.Pb(3),n.wc("textContent",t.email),n.Pb(1),n.wc("ngIf",t.company),n.Pb(1),n.wc("ngIf",t.company),n.Pb(1),n.wc("ngIf",t.domain),n.Pb(1),n.wc("ngIf",t.domain),n.Pb(1),n.wc("ngIf",t.userCount),n.Pb(1),n.wc("ngIf",t.userCount),n.Pb(1),n.wc("ngIf",t.startsAt),n.Pb(1),n.wc("ngIf",t.startsAt),n.Pb(1),n.wc("ngIf",t.expiresAt),n.Pb(1),n.wc("ngIf",t.expiresAt))},directives:[oe.q],styles:[".attributes-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}"]});class Vo{constructor(e,t,i,n,s,r){this.elementRef=e,this.I18n=t,this.http=i,this.notificationsService=n,this.eeTrialService=s,this.timezoneService=r,this.created=this.timezoneService.formattedDate((new Date).toString()),this.email="",this.text={confirmation_info:(e,t)=>this.I18n.t("js.admin.enterprise.trial.confirmation_info",{date:e,email:t}),resend:this.I18n.t("js.admin.enterprise.trial.resend_link"),resend_success:this.I18n.t("js.admin.enterprise.trial.resend_success"),resend_warning:this.I18n.t("js.admin.enterprise.trial.resend_warning"),session_timeout:this.I18n.t("js.admin.enterprise.trial.session_timeout"),status_confirmed:this.I18n.t("js.admin.enterprise.trial.status_confirmed"),status_label:this.I18n.t("js.admin.enterprise.trial.status_label"),status_waiting:this.I18n.t("js.admin.enterprise.trial.status_waiting")}}ngOnInit(){let e=window.gon.ee_trial_key;if(e){let t=e.created.split(" ")[0];this.created=this.timezoneService.formattedDate(t)}this.eeTrialService.userData$.values$().pipe(Object(ha.a)()).subscribe(e=>{this.email=e.email})}resendMail(){this.eeTrialService.cancelled=!1,this.http.post(this.eeTrialService.resendLink,{}).toPromise().then(()=>{this.notificationsService.addSuccess(this.text.resend_success),this.eeTrialService.retryConfirmation()}).catch(()=>{this.eeTrialService.trialLink?this.eeTrialService.getToken():this.notificationsService.addError(this.text.resend_warning)})}}function qo(e,t){if(1&e){const e=n.ic();n.hc(0,"a",10),n.hc(1,"i",11),n.pc("click",(function(t){n.Lc(e);return n.rc().closeModal(t)})),n.gc(),n.gc()}if(2&e){const e=n.rc();n.Pb(1),n.Qb("title",e.text.close_popup)}}function $o(e,t){1&e&&(n.hc(0,"div"),n.cc(1,"enterprise-trial-form"),n.gc())}function No(e,t){1&e&&(n.hc(0,"div"),n.cc(1,"enterprise-trial-waiting"),n.gc())}function Bo(e,t){if(1&e&&(n.hc(0,"div"),n.hc(1,"div",12),n.hc(2,"div",13),n.hc(3,"span"),n.Vc(4),n.gc(),n.gc(),n.hc(5,"div",14),n.cc(6,"iframe",15),n.gc(),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(4),n.Wc(e.text.quick_overview),n.Pb(2),n.wc("src",e.trustedEEVideoURL,n.Nc)}}function zo(e,t){if(1&e){const e=n.ic();n.hc(0,"div"),n.hc(1,"button",16),n.pc("click",(function(){n.Lc(e);return n.rc().onSubmit()})),n.gc(),n.hc(2,"button",17),n.pc("click",(function(t){n.Lc(e);return n.rc().closeModal(t)})),n.gc(),n.gc()}if(2&e){const e=n.rc();n.Pb(1),n.wc("disabled",!e.trialForm||e.trialForm.invalid)("textContent",e.text.button_submit)("hidden",e.eeTrialService.mailSubmitted&&!e.eeTrialService.cancelled),n.Qb("title",e.text.button_submit),n.Pb(1),n.wc("textContent",e.text.button_cancel),n.Qb("title",e.text.button_cancel)}}function Ho(e,t){if(1&e){const e=n.ic();n.hc(0,"button",20),n.pc("click",(function(t){n.Lc(e);return n.rc(2).closeModal(t)})),n.gc()}if(2&e){const e=n.rc(2);n.wc("textContent",e.text.button_continue),n.Qb("title",e.text.button_continue)}}function Qo(e,t){if(1&e){const e=n.ic();n.hc(0,"button",18),n.pc("click",(function(){n.Lc(e);return n.rc().startEnterpriseTrial()})),n.gc(),n.Tc(1,Ho,1,2,"button",19)}if(2&e){const e=n.rc();n.wc("textContent",e.text.button_continue)("disabled",!e.eeTrialService.confirmed)("hidden",e.eeTrialService.trialStarted),n.Qb("title",e.text.button_continue),n.Pb(1),n.wc("ngIf",e.eeTrialService.trialStarted)}}Vo.\u0275fac=function(e){return new(e||Vo)(n.bc(n.q),n.bc(y.a),n.bc(te.b),n.bc(v.a),n.bc(bo),n.bc(ot.a))},Vo.\u0275cmp=n.Vb({type:Vo,selectors:[["enterprise-trial-waiting"]],decls:9,vars:4,consts:[["class","status--waiting",4,"ngIf","ngIfElse"],["confirmedStatus",""],[1,"status--waiting"],["id","resend-link",3,"click"],[4,"ngIf"],[1,"status--confirmed","icon-yes"]],template:function(e,t){if(1&e&&(n.cc(0,"enterprise-active-trial"),n.hc(1,"p"),n.Vc(2),n.gc(),n.hc(3,"p"),n.hc(4,"span"),n.Vc(5),n.gc(),n.Tc(6,Lo,5,3,"span",0),n.Tc(7,Do,2,1,"ng-template",null,1,n.Uc),n.gc()),2&e){const e=n.Jc(8);n.Pb(2),n.Wc(t.text.confirmation_info(t.created,t.email)),n.Pb(3),n.Xc("",t.text.status_label," "),n.Pb(1),n.wc("ngIf",!t.eeTrialService.confirmed)("ngIfElse",e)}},directives:[Fo,oe.q],styles:["#resend-link[_ngcontent-%COMP%]{float:right}.status--confirmed[_ngcontent-%COMP%]{color:var(--button--alt-highlight-background-color)}.status--waiting[_ngcontent-%COMP%]{color:orange}"]});class Wo extends I.a{constructor(e,t,i,n,s,r){super(t,i,e),this.elementRef=e,this.locals=t,this.cdRef=i,this.I18n=n,this.domSanitizer=s,this.eeTrialService=r,this.showClose=!0,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={button_submit:this.I18n.t("js.modals.button_submit"),button_cancel:this.I18n.t("js.modals.button_cancel"),button_continue:this.I18n.t("js.button_continue"),close_popup:this.I18n.t("js.close_popup_title"),heading_confirmation:this.I18n.t("js.admin.enterprise.trial.confirmation"),heading_next_steps:this.I18n.t("js.admin.enterprise.trial.next_steps"),heading_test_ee:this.I18n.t("js.admin.enterprise.trial.test_ee"),quick_overview:this.I18n.t("js.admin.enterprise.trial.quick_overview")},this.trustedEEVideoURL=this.trustedURL("https://www.youtube.com/embed/zLMSydhFSkw?autoplay=1")}ngAfterViewInit(){this.trialForm=this.formComponent.trialForm}onSubmit(){this.trialForm.valid&&(this.trialForm.addControl("_type",new l.f("enterprise-trial")),this.eeTrialService.sendForm(this.trialForm))}startEnterpriseTrial(){this.eeTrialService.setStartTrialStatus()}headerText(){return this.eeTrialService.mailSubmitted?this.text.heading_confirmation:this.eeTrialService.trialStarted?this.text.heading_next_steps:this.text.heading_test_ee}closeModal(e){this.closeMe(e),(this.eeTrialService.trialStarted||this.eeTrialService.confirmed)&&window.location.reload(),this.eeTrialService.modalOpen=!1}trustedURL(e){return this.domSanitizer.bypassSecurityTrustResourceUrl(e)}openWindow(){return!this.eeTrialService.status||this.eeTrialService.cancelled?1:this.eeTrialService.mailSubmitted&&!this.eeTrialService.cancelled?2:3}}function Xo(e,t){if(1&e){const e=n.ic();n.hc(0,"div"),n.hc(1,"p"),n.Vc(2),n.gc(),n.hc(3,"p",2),n.Vc(4),n.gc(),n.hc(5,"p"),n.hc(6,"span",2),n.Vc(7),n.gc(),n.cc(8,"br"),n.hc(9,"span"),n.Vc(10),n.gc(),n.gc(),n.hc(11,"button",3),n.pc("click",(function(){n.Lc(e);return n.rc().openTrialModal()})),n.Vc(12),n.gc(),n.gc()}if(2&e){const e=n.rc();n.Pb(2),n.Wc(e.text.enterprise_edition),n.Pb(2),n.Wc(e.text.confidence),n.Pb(3),n.Wc(e.text.become_hero),n.Pb(3),n.Wc(e.text.you_contribute),n.Pb(2),n.Xc(" ",e.text.button_trial," ")}}function Uo(e,t){if(1&e){const e=n.ic();n.cc(0,"enterprise-trial-waiting"),n.hc(1,"p",4),n.Vc(2),n.hc(3,"a",5),n.pc("click",(function(){n.Lc(e);return n.rc().openTrialModal()})),n.Vc(4),n.gc(),n.gc()}if(2&e){const e=n.rc();n.Pb(2),n.Xc("",e.text.email_not_received," "),n.Pb(2),n.Wc(e.text.try_another_email)}}Wo.\u0275fac=function(e){return new(e||Wo)(n.bc(n.q),n.bc(O.a),n.bc(n.i),n.bc(y.a),n.bc(D.b),n.bc(bo))},Wo.\u0275cmp=n.Vb({type:Wo,selectors:[["enterprise-trial-modal"]],viewQuery:function(e,t){var i;(1&e&&n.ad(Co,!0),2&e)&&(n.Ic(i=n.qc())&&(t.formComponent=i.first))},inputs:{opReferrer:"opReferrer"},features:[n.Mb],decls:13,vars:8,consts:[[1,"op-modal--portal"],["data-indicator-name","modal","tabindex","0",1,"op-modal--modal-container"],[1,"op-modal--modal-header"],[3,"textContent"],["class","op-modal--modal-close-button",4,"ngIf"],[1,"op-modal--modal-body",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"op-modal--modal-footer"],[4,"ngIf","ngIfElse"],["mailSubmitted",""],[1,"op-modal--modal-close-button"],[1,"icon-close",3,"click"],[1,"onboarding--video-block"],[1,"onboarding--video-text"],[1,"onboarding--video","iframe-target-wrapper"],["frameborder","0","height","400","width","100%","allowfullscreen","",3,"src"],[1,"confirm-form-submit--continue","button","-highlight",3,"disabled","textContent","hidden","click"],[1,"confirm-form-submit--cancel","button",3,"textContent","click"],[1,"confirm-form-submit--continue","button","-highlight",3,"textContent","disabled","hidden","click"],["class","confirm-form-submit--continue button -highlight",3,"textContent","click",4,"ngIf"],[1,"confirm-form-submit--continue","button","-highlight",3,"textContent","click"]],template:function(e,t){if(1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.cc(3,"h3",3),n.Tc(4,qo,2,1,"a",4),n.gc(),n.hc(5,"div",5),n.Tc(6,$o,2,0,"div",6),n.Tc(7,No,2,0,"div",6),n.Tc(8,Bo,7,2,"div",6),n.gc(),n.hc(9,"div",7),n.Tc(10,zo,3,6,"div",8),n.Tc(11,Qo,2,5,"ng-template",null,9,n.Uc),n.gc(),n.gc(),n.gc()),2&e){const e=n.Jc(12);n.Pb(3),n.wc("textContent",t.headerText()),n.Pb(1),n.wc("ngIf",t.showClose),n.Pb(1),n.wc("ngSwitch",t.openWindow()),n.Pb(1),n.wc("ngSwitchCase",1),n.Pb(1),n.wc("ngSwitchCase",2),n.Pb(1),n.wc("ngSwitchCase",3),n.Pb(2),n.wc("ngIf",!t.eeTrialService.status||t.eeTrialService.cancelled)("ngIfElse",e)}},directives:[oe.q,oe.u,oe.v,Co,Vo],styles:[".onboarding--video-text[_ngcontent-%COMP%]{margin-bottom:1.25rem}"]});class Go{constructor(e,t,i,n){this.I18n=e,this.opModalService=t,this.injector=i,this.eeTrialService=n,this.text={button_trial:this.I18n.t("js.admin.enterprise.upsale.button_start_trial"),button_book:this.I18n.t("js.admin.enterprise.upsale.button_book_now"),link_quote:this.I18n.t("js.admin.enterprise.upsale.link_quote"),become_hero:this.I18n.t("js.admin.enterprise.upsale.become_hero"),you_contribute:this.I18n.t("js.admin.enterprise.upsale.you_contribute"),email_not_received:this.I18n.t("js.admin.enterprise.trial.email_not_received"),enterprise_edition:this.I18n.t("js.admin.enterprise.upsale.text"),confidence:this.I18n.t("js.admin.enterprise.upsale.confidence"),try_another_email:this.I18n.t("js.admin.enterprise.trial.try_another_email")}}openTrialModal(){this.eeTrialService.cancelled=!0,this.eeTrialService.modalOpen=!0,this.opModalService.show(Wo,this.injector)}get noTrialRequested(){return void 0===this.eeTrialService.status}}function Yo(e,t){if(1&e&&n.cc(0,"div",3),2&e){const e=n.rc();n.wc("textContent",e.text.label_company)}}function Ko(e,t){if(1&e&&(n.hc(0,"div",4),n.hc(1,"div",5),n.cc(2,"span",6),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.company)}}function Zo(e,t){if(1&e&&n.cc(0,"div",3),2&e){const e=n.rc();n.wc("textContent",e.text.label_domain)}}function Jo(e,t){if(1&e&&(n.hc(0,"div",4),n.hc(1,"div",5),n.cc(2,"span",6),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.domain)}}function el(e,t){if(1&e&&n.cc(0,"div",3),2&e){const e=n.rc();n.wc("textContent",e.text.label_maximum_users)}}function tl(e,t){if(1&e&&(n.hc(0,"div",4),n.hc(1,"div",5),n.cc(2,"span",6),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.userCount)}}function il(e,t){if(1&e&&n.cc(0,"div",3),2&e){const e=n.rc();n.wc("textContent",e.text.label_starts_at)}}function nl(e,t){if(1&e&&(n.hc(0,"div",4),n.hc(1,"div",5),n.cc(2,"span",6),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.startsAt)}}function sl(e,t){if(1&e&&n.cc(0,"div",3),2&e){const e=n.rc();n.wc("textContent",e.text.label_expires_at)}}function rl(e,t){if(1&e&&(n.hc(0,"div",4),n.hc(1,"div",5),n.cc(2,"span",6),n.gc(),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.expiresAt)}}Go.\u0275fac=function(e){return new(e||Go)(n.bc(y.a),n.bc(O.b),n.bc(n.A),n.bc(bo))},Go.\u0275cmp=n.Vb({type:Go,selectors:[["enterprise-base"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["alreadyRequested",""],[1,"-bold"],[1,"button","-alt-highlight",3,"click"],[1,"confirmation-hint"],[3,"click"]],template:function(e,t){if(1&e&&(n.Tc(0,Xo,13,5,"div",0),n.Tc(1,Uo,5,2,"ng-template",null,1,n.Uc)),2&e){const e=n.Jc(2);n.wc("ngIf",t.noTrialRequested)("ngIfElse",e)}},directives:[oe.q,Vo],styles:[".button[_ngcontent-%COMP%]{float:left}.confirmation-hint[_ngcontent-%COMP%]{font-size:.9em;font-style:italic;margin-bottom:2rem}"]});class al extends jo{constructor(e,t){super(t),this.elementRef=e,this.I18n=t,this.subscriber=this.elementRef.nativeElement.dataset.subscriber,this.email=this.elementRef.nativeElement.dataset.email,this.company=this.elementRef.nativeElement.dataset.company,this.domain=this.elementRef.nativeElement.dataset.domain,this.userCount=this.elementRef.nativeElement.dataset.userCount,this.startsAt=this.elementRef.nativeElement.dataset.startsAt,this.expiresAt=this.elementRef.nativeElement.dataset.expiresAt}}al.\u0275fac=function(e){return new(e||al)(n.bc(n.q),n.bc(y.a))},al.\u0275cmp=n.Vb({type:al,selectors:[["enterprise-active-saved-trial"]],features:[n.Mb],decls:21,vars:14,consts:[[1,"enterprise--active-token"],[1,"attributes-group"],[1,"attributes-key-value"],[1,"attributes-key-value--key",3,"textContent"],[1,"attributes-key-value--value-container"],[1,"attributes-key-value--value","-text"],[3,"textContent"],["class","attributes-key-value--key",3,"textContent",4,"ngIf"],["class","attributes-key-value--value-container",4,"ngIf"]],template:function(e,t){1&e&&(n.hc(0,"div",0),n.hc(1,"div",1),n.hc(2,"div",2),n.cc(3,"div",3),n.hc(4,"div",4),n.hc(5,"div",5),n.cc(6,"span",6),n.gc(),n.gc(),n.cc(7,"div",3),n.hc(8,"div",4),n.hc(9,"div",5),n.cc(10,"span",6),n.gc(),n.gc(),n.Tc(11,Yo,1,1,"div",7),n.Tc(12,Ko,3,1,"div",8),n.Tc(13,Zo,1,1,"div",7),n.Tc(14,Jo,3,1,"div",8),n.Tc(15,el,1,1,"div",7),n.Tc(16,tl,3,1,"div",8),n.Tc(17,il,1,1,"div",7),n.Tc(18,nl,3,1,"div",8),n.Tc(19,sl,1,1,"div",7),n.Tc(20,rl,3,1,"div",8),n.gc(),n.gc(),n.gc()),2&e&&(n.Pb(3),n.wc("textContent",t.text.label_subscriber),n.Pb(3),n.wc("textContent",t.subscriber),n.Pb(1),n.wc("textContent",t.text.label_email),n.Pb(3),n.wc("textContent",t.email),n.Pb(1),n.wc("ngIf",t.company),n.Pb(1),n.wc("ngIf",t.company),n.Pb(1),n.wc("ngIf",t.domain),n.Pb(1),n.wc("ngIf",t.domain),n.Pb(1),n.wc("ngIf",t.userCount),n.Pb(1),n.wc("ngIf",t.userCount),n.Pb(1),n.wc("ngIf",t.startsAt),n.Pb(1),n.wc("ngIf",t.startsAt),n.Pb(1),n.wc("ngIf",t.expiresAt),n.Pb(1),n.wc("ngIf",t.expiresAt))},directives:[oe.q],styles:[".attributes-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}"]});class cl{constructor(e){this.injector=e,this.text={edit:this.i18n.t("js.button_edit"),delete:this.i18n.t("js.button_delete"),error:this.i18n.t("js.error.internal"),areYouSure:this.i18n.t("js.text_are_you_sure")}}editTimeEntry(){this.loadEntry().then(e=>{this.timeEntryEditService.edit(e).then(()=>{window.location.reload()}).catch(()=>{})})}deleteTimeEntry(){window.confirm(this.text.areYouSure)&&this.loadEntry().then(e=>{this.apiv3Service.time_entries.id(e).delete().subscribe(()=>window.location.reload(),e=>this.notificationsService.addError(e||this.text.error))})}loadEntry(){let e=this.elementRef.nativeElement.dataset.entry;return this.apiv3Service.time_entries.id(e).get().toPromise()}}cl.\u0275fac=function(e){return new(e||cl)(n.bc(n.A))},cl.\u0275cmp=n.Vb({type:cl,selectors:[["time-entry--trigger-actions-entry"]],features:[n.Ob([mt.a,St])],decls:4,vars:2,consts:[[1,"no-decoration-on-hover",3,"title","click"],["icon-classes","icon-context icon-edit"],["icon-classes","icon-context icon-delete"]],template:function(e,t){1&e&&(n.hc(0,"a",0),n.pc("click",(function(){return t.editTimeEntry()})),n.cc(1,"op-icon",1),n.gc(),n.hc(2,"a",0),n.pc("click",(function(){return t.deleteTimeEntry()})),n.cc(3,"op-icon",2),n.gc()),2&e&&(n.wc("title",t.text.edit),n.Pb(2),n.wc("title",t.text.delete))},directives:[yt.a],encapsulation:2,changeDetection:0}),Object(w.c)([Object(z.a)(),Object(w.e)("design:type",St)],cl.prototype,"timeEntryEditService",void 0),Object(w.c)([Object(z.a)(),Object(w.e)("design:type",H.a)],cl.prototype,"apiv3Service",void 0),Object(w.c)([Object(z.a)(),Object(w.e)("design:type",v.a)],cl.prototype,"notificationsService",void 0),Object(w.c)([Object(z.a)(),Object(w.e)("design:type",n.q)],cl.prototype,"elementRef",void 0),Object(w.c)([Object(z.a)(),Object(w.e)("design:type",y.a)],cl.prototype,"i18n",void 0),Object(w.c)([Object(z.a)(),Object(w.e)("design:type",n.i)],cl.prototype,"cdRef",void 0);var ol=i("iZDB"),ll=i("5yfJ"),dl=i("z6cu");class ul{constructor(e,t,i,n){this.apiV3Service=e,this.transitions=t,this.currentProject=i,this.I18n=n,this.text={not_found:this.I18n.t("js.editor.macro.attribute_reference.not_found")},this.cache$=Object(o.h)(),t.onStart({},()=>(this.cache$.clear(),!0))}require(e,t){const i=`${e}-${t}`,n=this.cache$.get(i);if(n.isPristine()){const i=this.load(e,t).toPromise();return n.clearAndPutFromPromise(i),i}return n.values$().pipe(Object(et.a)(1),Object($c.a)(e=>console.log("VAL "+e),e=>console.error("ERR "+e))).toPromise()}load(e,t){switch(e){case"workPackage":return this.loadWorkPackage(t);case"project":return this.loadProject(t);default:return ll.a}}loadProject(e){return(e=e||this.currentProject.id)?this.apiV3Service.projects.id(e).get().pipe(Object(et.a)(1)):Object(dl.a)(this.text.not_found)}loadWorkPackage(e){return e?/^[1-9]\d*$/.test(e)?this.apiV3Service.work_packages.id(e).get().pipe(Object(et.a)(1)):this.apiV3Service.withOptionalProject(this.currentProject.id).work_packages.filterBySubjectOrId(e,!1,{pageSize:"1"}).get().pipe(Object(et.a)(1),Object(Nc.a)(e=>e.elements[0]||null)):Object(dl.a)(this.text.not_found)}}ul.\u0275fac=function(e){return new(e||ul)(n.lc(H.a),n.lc(Ue.TransitionService),n.lc(xe.a),n.lc(y.a))},ul.\u0275prov=n.Xb({token:ul,factory:ul.\u0275fac,providedIn:"root"});const hl=["displayFieldContainer"];class pl{constructor(e,t,i){this.injector=e,this.displayFieldService=t,this.schemaCache=i,this.containerType="table",this.displayFieldOptions={}}ngOnInit(){this.schemaCache.ensureLoaded(this.resource).then(e=>{this.render(e[this.fieldName])})}render(e){const t=this.getDisplayFieldInstance(e),i=this.container.nativeElement;i.hidden=!1,t.isEmpty()?i.textContent="-":t.render(i,t.valueString)}getDisplayFieldInstance(e){if(this.displayClass){let t=new this.displayClass(this.fieldName,this.displayFieldContext);return t.apply(this.resource,e),t}return this.displayFieldService.getField(this.resource,this.fieldName,e,this.displayFieldContext)}get displayFieldContext(){return{injector:this.injector,container:this.containerType,options:this.displayFieldOptions}}}pl.\u0275fac=function(e){return new(e||pl)(n.bc(n.A),n.bc(M.a),n.bc(it.a))},pl.\u0275cmp=n.Vb({type:pl,selectors:[["display-field"]],viewQuery:function(e,t){var i;(1&e&&n.ad(hl,!0),2&e)&&(n.Ic(i=n.qc())&&(t.container=i.first))},inputs:{resource:"resource",fieldName:"fieldName",displayClass:"displayClass",containerType:"containerType",displayFieldOptions:"displayFieldOptions"},decls:2,vars:0,consts:[["displayFieldContainer",""]],template:function(e,t){1&e&&n.cc(0,"span",null,0)},encapsulation:2,changeDetection:0});const gl=["displayContainer"];function fl(e,t){if(1&e&&(n.hc(0,"span"),n.cc(1,"i",2),n.cc(2,"em",3),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.error)}}const bl=function(){return{writable:!1}};function ml(e,t){if(1&e&&n.cc(0,"display-field",4),2&e){const e=n.rc();n.wc("resource",e.resource)("displayFieldOptions",n.Ac(3,bl))("fieldName",e.fieldName)}}class wl{constructor(e,t,i,n,s,r,a){this.elementRef=e,this.injector=t,this.resourceLoader=i,this.schemaCache=n,this.displayField=s,this.I18n=r,this.cdRef=a,this.error=null,this.text={help:this.I18n.t("js.editor.macro.attribute_reference.macro_help_tooltip"),placeholder:this.I18n.t("js.placeholders.default"),not_found:this.I18n.t("js.editor.macro.attribute_reference.not_found"),invalid_attribute:e=>this.I18n.t("js.editor.macro.attribute_reference.invalid_attribute",{name:e})},this.hostTitle=this.text.help}ngOnInit(){const e=this.elementRef.nativeElement,t=e.dataset.model,i=e.dataset.id,n=e.dataset.attribute;this.loadAndRender(t,i,n)}loadAndRender(e,t,i){return Object(w.b)(this,void 0,void 0,(function*(){let n;try{n=yield this.resourceLoader.require(e,t)}catch(a){return console.error("Failed to render macro "+a),this.markError(this.text.not_found)}if(!n)return void this.markError(this.text.not_found);const s=yield this.schemaCache.ensureLoaded(n),r=s.attributeFromLocalizedName(i)||i;s[r]?(this.resource=n,this.fieldName=r):this.markError(this.text.invalid_attribute(i)),this.cdRef.detectChanges()}))}markError(e){this.error=this.I18n.t("js.editor.macro.error",{message:e}),this.cdRef.detectChanges()}}var vl;wl.\u0275fac=function(e){return new(e||wl)(n.bc(n.q),n.bc(n.A),n.bc(ul),n.bc(it.a),n.bc(M.a),n.bc(y.a),n.bc(n.i))},wl.\u0275cmp=n.Vb({type:wl,selectors:[["macro",8,"macro--attribute-value"]],viewQuery:function(e,t){var i;(1&e&&n.ad(gl,!0),2&e)&&(n.Ic(i=n.qc())&&(t.displayContainer=i.first))},hostVars:1,hostBindings:function(e,t){2&e&&n.kc("title",t.hostTitle)},features:[n.Ob([mt.a])],attrs:["class","macro--attribute-value"],decls:2,vars:2,consts:[[4,"ngIf"],[3,"resource","displayFieldOptions","fieldName",4,"ngIf"],[1,"icon","icon-error"],[3,"textContent"],[3,"resource","displayFieldOptions","fieldName"]],template:function(e,t){1&e&&(n.Tc(0,fl,3,1,"span",0),n.Tc(1,ml,1,4,"display-field",1)),2&e&&(n.wc("ngIf",t.error),n.Pb(1),n.wc("ngIf",!!t.resource))},directives:[oe.q,pl],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}@media screen{[_nghost-%COMP%]{display:inline-block;background:rgba(218,223,225,.19);border:1px solid transparent;padding:2px}[_nghost-%COMP%]:hover{cursor:default;border-color:#c7c7c7;background:rgba(218,223,225,.75)}}"],changeDetection:0}),function(e){e.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}}(vl||(vl={}));function yl(e,t){if(1&e&&(n.fc(0),n.cc(1,"span",1),n.cc(2,"attribute-help-text",2),n.ec()),2&e){const e=n.rc();n.Pb(1),n.wc("textContent",e.label),n.Pb(1),n.wc("attribute",e.attribute)("attributeScope",e.attributeScope)}}function kl(e,t){if(1&e&&(n.hc(0,"span"),n.cc(1,"i",3),n.cc(2,"em",1),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.error)}}class Cl{constructor(e,t,i,n,s,r,a){this.elementRef=e,this.injector=t,this.resourceLoader=i,this.schemaCache=n,this.displayField=s,this.I18n=r,this.cdRef=a,this.error=null,this.text={help:this.I18n.t("js.editor.macro.attribute_reference.macro_help_tooltip"),not_found:this.I18n.t("js.editor.macro.attribute_reference.not_found"),invalid_attribute:e=>this.I18n.t("js.editor.macro.attribute_reference.invalid_attribute",{name:e})},this.hostTitle=this.text.help,this.resource=null}ngOnInit(){const e=this.elementRef.nativeElement,t=e.dataset.model,i=e.dataset.id,n=e.dataset.attribute;this.attributeScope=vl.capitalize(t),this.loadResourceAttribute(t,i,n)}loadResourceAttribute(e,t,i){var n;return Object(w.b)(this,void 0,void 0,(function*(){let s;try{this.resource=s=yield this.resourceLoader.require(e,t)}catch(a){return console.error("Failed to render macro "+a),this.markError(this.text.not_found)}if(!s)return void this.markError(this.text.not_found);const r=yield this.schemaCache.ensureLoaded(s);this.attribute=r.attributeFromLocalizedName(i)||i,this.label=null===(n=r[this.attribute])||void 0===n?void 0:n.name,this.label||this.markError(this.text.invalid_attribute(i)),this.cdRef.detectChanges()}))}markError(e){this.error=this.I18n.t("js.editor.macro.error",{message:e}),this.cdRef.detectChanges()}}Cl.\u0275fac=function(e){return new(e||Cl)(n.bc(n.q),n.bc(n.A),n.bc(ul),n.bc(it.a),n.bc(M.a),n.bc(y.a),n.bc(n.i))},Cl.\u0275cmp=n.Vb({type:Cl,selectors:[["macro",8,"macro--attribute-label"]],hostVars:1,hostBindings:function(e,t){2&e&&n.kc("title",t.hostTitle)},features:[n.Ob([mt.a])],attrs:["class","macro--attribute-label"],decls:2,vars:2,consts:[[4,"ngIf"],[3,"textContent"],[3,"attribute","attributeScope"],[1,"icon","icon-error"]],template:function(e,t){1&e&&(n.Tc(0,yl,3,3,"ng-container",0),n.Tc(1,kl,3,1,"span",0)),2&e&&(n.wc("ngIf",t.resource),n.Pb(1),n.wc("ngIf",t.error))},directives:[oe.q,ss.a],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}@media screen{[_nghost-%COMP%]{display:inline-block;background:rgba(218,223,225,.19);border:1px solid transparent;padding:2px}[_nghost-%COMP%]:hover{cursor:default;border-color:#c7c7c7;background:rgba(218,223,225,.75)}}"],changeDetection:0});var jl=i("TNkA");const Pl=function(){return{writable:!1}};function xl(e,t){if(1&e&&n.cc(0,"display-field",5),2&e){const e=n.rc().ngIf;n.wc("resource",e)("displayFieldOptions",n.Ac(2,Pl))}}function Sl(e,t){if(1&e&&n.cc(0,"display-field",8),2&e){const e=n.rc(2).ngIf;n.wc("resource",e)("displayFieldOptions",n.Ac(2,Pl))}}function _l(e,t){if(1&e&&n.cc(0,"display-field",9),2&e){const e=n.rc(2).ngIf,t=n.rc();n.wc("resource",e)("displayFieldOptions",n.Ac(3,Pl))("displayClass",t.dateDisplayField)}}function Ol(e,t){if(1&e&&(n.fc(0),n.Vc(1," ("),n.Tc(2,Sl,1,3,"display-field",6),n.Tc(3,_l,1,4,"display-field",7),n.Vc(4,") "),n.ec()),2&e){const e=n.rc().ngIf;n.Pb(2),n.wc("ngIf",!!e.date),n.Pb(1),n.wc("ngIf",!e.date)}}function Il(e,t){if(1&e&&(n.fc(0),n.Tc(1,xl,1,3,"display-field",1),n.cc(2,"display-field",2),n.hc(3,"a",3),n.Vc(4),n.gc(),n.cc(5,"display-field",4),n.Tc(6,Ol,5,2,"ng-container",0),n.ec()),2&e){const e=t.ngIf,i=n.rc();n.Pb(1),n.wc("ngIf",i.detailed),n.Pb(1),n.wc("resource",e)("displayFieldOptions",n.Ac(9,Pl)),n.Pb(1),n.wc("href",i.workPackageLink,n.Oc),n.Qb("data-work-package-id",e.id),n.Pb(1),n.Xc(" #",e.id,": "),n.Pb(1),n.wc("resource",e)("displayFieldOptions",n.Ac(10,Pl)),n.Pb(1),n.wc("ngIf",i.detailed)}}function Tl(e,t){if(1&e&&(n.hc(0,"span"),n.cc(1,"i",10),n.cc(2,"em",11),n.gc()),2&e){const e=n.rc();n.Pb(2),n.wc("textContent",e.error)}}class Rl{constructor(e,t,i,n,s,r,a,c){this.elementRef=e,this.injector=t,this.apiV3Service=i,this.schemaCache=n,this.displayField=s,this.pathHelper=r,this.I18n=a,this.cdRef=c,this.error=null,this.text={not_found:this.I18n.t("js.editor.macro.attribute_reference.not_found"),help:this.I18n.t("js.editor.macro.attribute_reference.macro_help_tooltip")},this.hostTitle=this.text.help,this.dateDisplayField=jl.a,this.detailed=!1}ngOnInit(){const e=this.elementRef.nativeElement,t=e.dataset.id;this.detailed="true"===e.dataset.detailed,this.workPackageLink=this.pathHelper.workPackagePath(t),this.workPackage$=this.apiV3Service.work_packages.id(t).get().pipe(Object($c.a)({error:e=>this.markError(this.text.not_found)}))}markError(e){console.error("Failed to render macro "+e),this.error=this.I18n.t("js.editor.macro.error",{message:e}),this.cdRef.detectChanges()}}Rl.\u0275fac=function(e){return new(e||Rl)(n.bc(n.q),n.bc(n.A),n.bc(H.a),n.bc(it.a),n.bc(M.a),n.bc(q.a),n.bc(y.a),n.bc(n.i))},Rl.\u0275cmp=n.Vb({type:Rl,selectors:[["macro",8,"macro--wp-quickinfo"]],hostVars:1,hostBindings:function(e,t){2&e&&n.kc("title",t.hostTitle)},features:[n.Ob([mt.a])],attrs:["class","macro--wp-quickinfo"],decls:3,vars:4,consts:[[4,"ngIf"],["fieldName","status",3,"resource","displayFieldOptions",4,"ngIf"],["fieldName","type",3,"resource","displayFieldOptions"],[1,"work-package--quickinfo","preview-trigger",3,"href"],["fieldName","subject",3,"resource","displayFieldOptions"],["fieldName","status",3,"resource","displayFieldOptions"],["fieldName","date",3,"resource","displayFieldOptions",4,"ngIf"],["fieldName","startDate",3,"resource","displayFieldOptions","displayClass",4,"ngIf"],["fieldName","date",3,"resource","displayFieldOptions"],["fieldName","startDate",3,"resource","displayFieldOptions","displayClass"],[1,"icon","icon-error"],[3,"textContent"]],template:function(e,t){1&e&&(n.Tc(0,Il,7,11,"ng-container",0),n.sc(1,"async"),n.Tc(2,Tl,3,1,"span",0)),2&e&&(n.wc("ngIf",n.tc(1,2,t.workPackage$)),n.Pb(2),n.wc("ngIf",t.error))},directives:[oe.q,pl],pipes:[oe.a],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px rgba(0,0,0,.1);z-index:10000!important}@media screen{[_nghost-%COMP%]{display:inline-block;background:rgba(218,223,225,.19);border:1px solid transparent;padding:2px}[_nghost-%COMP%]:hover{cursor:default;border-color:#c7c7c7;background:rgba(218,223,225,.75)}}display-field[_ngcontent-%COMP%]{padding-right:2px}"],changeDetection:0});const El=[{selector:fr,cls:br},{selector:ss.b,cls:ss.a},{selector:sc.b,cls:sc.a,embeddable:!0},{selector:"colors-autocompleter",cls:oc},{selector:qt.b,cls:qt.a},{selector:bs.b,cls:bs.a,embeddable:!0},{selector:In.b,cls:In.a},{selector:"members-autocompleter",cls:go},{selector:"global-search-tabs",cls:co},{selector:"global-search-work-packages",cls:uc},{selector:"homescreen-new-features-block",cls:pc},{selector:gc.b,cls:gc.a},{selector:fc.b,cls:fc.a},{selector:"global-search-work-packages-entry",cls:bc},{selector:kn.b,cls:kn.a},{selector:"admin-type-form-configuration",cls:Yr},{selector:mc.b,cls:mc.a,embeddable:!0},{selector:"persistent-toggle",cls:wc},{selector:Kt.b,cls:Kt.a},{selector:"hide-section-link",cls:yc},{selector:"show-section-dropdown",cls:kc},{selector:"add-section-dropdown",cls:xc},{selector:"autocomplete-select-decoration",cls:_c},{selector:"content-tabs",cls:Ic},{selector:"global-search-title",cls:ro},{selector:"copy-to-clipboard",cls:Tc},{selector:"confirm-form-submit",cls:Rc},{selector:"main-menu-resizer",cls:Fc},{selector:"main-menu-toggle",cls:lo},{selector:"global-search-input",cls:Uc},{selector:"collapsible-section-augment",cls:Kc},{selector:"enterprise-banner-bootstrap",cls:Zc},{selector:"enterprise-base",cls:Go},{selector:"enterprise-active-saved-trial",cls:al},{selector:"project-menu-autocomplete",cls:io},{selector:"remote-field-updater",cls:no},{selector:"wp-overview-graph",cls:cn},{selector:so.b,cls:so.a},{selector:"time-entry--trigger-actions-entry",cls:cl,embeddable:!0},{selector:ol.b,cls:ol.a},{selector:"macro.macro--attribute-value",cls:wl,embeddable:!0},{selector:"macro.macro--attribute-label",cls:Cl,embeddable:!0},{selector:"macro.macro--wp-quickinfo",cls:Rl,embeddable:!0},{selector:"editable-query-props",cls:ra},{selector:Fn.b,cls:Fn.a}];class Ml{}Ml.\u0275mod=n.Zb({type:Ml}),Ml.\u0275inj=n.Yb({factory:function(e){return new(e||Ml)},imports:[[f.a,pn.b]]});class Fl{}Fl.\u0275mod=n.Zb({type:Fl}),Fl.\u0275inj=n.Yb({factory:function(e){return new(e||Fl)},providers:[bo],imports:[[f.a,l.i,l.w]]});class Al{constructor(e,t,i){this.documentElement=e,this.injector=t,this.opModalService=i}setupListener(){const e=this.documentElement.querySelectorAll("section[data-augmented-model-wrapper]");for(let t=0;t<e.length;++t)this.wrapElement(jQuery(e[t]))}wrapElement(e){let t=e.find(".modal-wrapper--activation-link"),i=e.data("activationSelector");i&&(t=jQuery(i));e.data("modalInitializeNow")?this.show(e):t.click(t=>{this.show(e),t.preventDefault()})}show(e){const t=e.data("modalClassName"),i=e.data("modalIframeUrl");let n=e.find(".modal-wrapper--content").html();i&&(n=this.appendIframe(n,i)),this.opModalService.show(T,this.injector,{modalBody:n,modalClassName:t})}appendIframe(e,t){let i=jQuery(e),n=jQuery('<iframe frameborder="0" height="400" allowfullscreen>></iframe>');return n.attr("src",t),i.find(".iframe-target-wrapper").append(n),i.html()}}Al.\u0275fac=function(e){return new(e||Al)(n.lc(oe.d),n.lc(n.A),n.lc(O.b))},Al.\u0275prov=n.Xb({token:Al,factory:Al.\u0275fac,providedIn:"root"});class Ll{constructor(e){this.documentElement=e}loadRequiredScripts(){const e=this.documentElement.querySelectorAll('meta[name="required_script"]');for(let t=0;t<e.length;++t){const n=e[t].content;Object(c.a)("Loading required script "+n),i("VbPg")("./"+n)}}}Ll.\u0275fac=function(e){return new(e||Ll)(n.lc(oe.d))},Ll.\u0275prov=n.Xb({token:Ll,factory:Ll.\u0275fac,providedIn:"root"});class Dl{constructor(e,t){e.setupListener(),t.loadRequiredScripts()}}Dl.\u0275mod=n.Zb({type:Dl}),Dl.\u0275inj=n.Yb({factory:function(e){return new(e||Dl)(n.lc(Al),n.lc(Ll))},providers:[Al,Ll]});class Vl{constructor(e,t){this.injector=e,this.i18n=t;window.navigator.userAgent.search("Revit")>-1&&(this.labelText=t.t("js.revit.revit_add_in_settings"),this.groupLabelText=t.t("js.revit.revit_add_in"),this.addUserMenuItem(),this.addLoginMenuItem())}addUserMenuItem(){const e=document.getElementById("user-menu");if(e){const t=document.createElement("li");t.dataset.name=this.labelText,t.innerHTML=`\n        <a class="revit-addin-settings-menu-item ellipsis" title="${this.labelText}" href="#">\n          <span class="menu-item--title ellipsis ">${this.labelText}</span>\n        </a>\n      `,t.addEventListener("click",()=>this.goToSettings()),e.appendChild(t)}}addLoginMenuItem(){const e=document.querySelector("#nav-login-content");if(e){const t=document.createElement("div");t.dataset.name=this.labelText,t.innerHTML=`\n        <div class="login-auth-providers">\n          <h3 class="login-auth-providers-title">\n            <span>\n              ${this.groupLabelText}\n            </span>\n           </h3>\n          <div class="login-auth-provider-list revit-add-in-button">\n            <div class="auth-provider auth-provider-developer button">\n              <span class="auth-provider-name">${this.labelText}</span>\n            </div>\n          </div>\n        </div>\n      `,e.appendChild(t);e.querySelector(".revit-add-in-button").addEventListener("click",()=>this.goToSettings())}}goToSettings(){window.RevitBridge.sendMessageToRevit("GoToSettings","1","")}}Vl.\u0275fac=function(e){return new(e||Vl)(n.lc(n.A),n.lc(y.a))},Vl.\u0275prov=n.Xb({token:Vl,factory:Vl.\u0275fac});class ql{ngDoBootstrap(e){$.a.register(...El),$.a.bootstrapOptionalDocument(e,document);e._injector.get(m.a).call("openProjectAngularBootstrap").forEach(t=>{$.a.bootstrapOptionalDocument(e,document,t)})}}ql.\u0275mod=n.Zb({type:ql}),ql.\u0275inj=n.Yb({factory:function(e){return new(e||ql)},providers:[{provide:u.a,useValue:new u.a},{provide:n.c,useFactory:function(e){return()=>{const t=e.get(qa),i=e.get(Dr.a),n=e.get(nc);e.get(Vl),i.register(),t.setupListener(),n.register()}},deps:[n.A],multi:!0},h.a,A.a,U.a,b.a,p.a,Vl],imports:[[D.a,f.a,kr,d.a,ke.a,g.a,pr,ye.a,ec.a,ve.a,Fr,is,Wt,La,Wa,Ja,Lr,aa,Fl,X,we,Ml,l.w,Dl]]}),window.global=window;window.appBasePath=s("meta[name=app_base_path]").attr("content")||"",i.p=window.appBasePath+"/assets/frontend/",window.ErrorReporter=new class{constructor(){this.contextCallbacks=[],this.messageStack=[],this.sentryConfigured=!0;const e=document.querySelector("meta[name=openproject_sentry]");e?i.e(32).then(i.bind(null,"WSEr")).then(t=>{t.init({dsn:e.dataset.dsn,debug:!r.a.production,ignoreErrors:["The transition has been superseded by a different transition","Uncaught (in promise)"],beforeSend:e=>this.filterEvent(e)}),this.sentryLoaded(t)}):(this.sentryConfigured=!1,this.messageStack=[])}sentryLoaded(e){this.client=e,e.configureScope(this.setupContext.bind(this)),this.messageStack.forEach(e=>{this[e.type].bind(this).apply(e.args)})}captureMessage(e,t="info"){if(!this.client)return this.handleOfflineMessage("captureMessage",Array.from(arguments));this.client.withScope(i=>{this.setupContext(i),this.client.captureMessage(e,a.a.fromString(t))})}captureException(e){if(!this.client||!e)throw this.handleOfflineMessage("captureException",Array.from(arguments)),e;if("string"==typeof e)return this.captureMessage(e,"error");this.client.withScope(t=>{this.setupContext(t),this.client.captureException(e)})}addContext(...e){this.contextCallbacks.push(...e),this.client&&e.forEach(e=>this.client.configureScope(e))}handleOfflineMessage(e,t){this.sentryConfigured?this.messageStack.push({type:e,args:t}):console.log("[ErrorReporter] Would queue sentry message %O %O, but is not configured.",e,t)}setupContext(e){e.setTag("locale",I18n.locale),e.setTag("domain",window.location.hostname),e.setTag("url_path",window.location.pathname),e.setExtra("url_query",window.location.search),this.contextCallbacks.forEach(t=>t(e))}filterEvent(e){return document.body.classList.contains("-unsupported-browser")?(console.warn("Browser is not supported, skipping sentry reporting completely."),null):e}},i("GDA9"),i("buKu");const $l=s("meta[name=openproject_initializer]");I18n.locale=$l.data("locale")||"en",I18n.firstDayOfWeek=parseInt($l.data("firstDayOfWeek"),10),r.a.production&&Object(n.hb)(),Object(c.c)(()=>{window.enableReactiveStatesLogging=()=>Object(o.f)(!0),window.disableReactiveStatesLogging=()=>Object(o.f)(!1)}),i("0Int")(`./${I18n.locale}.js`).then(()=>{s((function(){D.f().bootstrapModule(ql).then(e=>{s("body").addClass("__ng2-bootstrap-has-run")})}))})},zqrF:function(e,t,i){"use strict";i.d(t,"b",(function(){return d})),i.d(t,"a",(function(){return u}));var n=i("E2tj"),s=i("FnNU"),r=i("IzEk"),a=i("CqXF"),c=i("lJxs"),o=i("VRyK"),l=i("fXoL");class d{constructor(e){this.querySpace=e,this.updatesState=Object(s.g)(),this.pristineState=Object(s.g)()}initialize(e,t,i){const n=this.valueFromQuery(e,t);this.pristineState.putValue(n)}update(e){this.updatesState.putValue(e)}clear(e){this.pristineState.clear(e),this.updatesState.clear(e)}live$(){return Object(o.a)(this.pristineState.values$(),this.updatesState.values$())}pristine$(){return this.pristineState.values$()}updates$(){return this.updatesState.values$()}changes$(){return this.updatesState.changes$()}onReady(){return this.pristineState.values$().pipe(Object(r.a)(1),Object(a.a)(null)).toPromise()}get lastUpdatedState(){const e=Object(s.c)(this.pristineState,this.updatesState);return Object(s.e)(e,e=>e.pipe(Object(c.a)(([e,t])=>void 0===t?e:t)))}set current(e){e?this.updatesState.putValue(e):this.updatesState.clear()}get current(){return this.lastUpdatedState.value}}d.\u0275fac=function(e){return new(e||d)(l.lc(n.a))},d.\u0275prov=l.Xb({token:d,factory:d.\u0275fac});class u extends d{}u.\u0275fac=function(e){return h(e||u)},u.\u0275prov=l.Xb({token:u,factory:u.\u0275fac});const h=l.jc(u)}},[[0,4,34]]]);
//# sourceMappingURL=main.3a78a1e53985d05c4e85.js.map