{"version":3,"sources":["./src/app/modules/augmenting/dynamic-scripts/repository_navigation.js"],"names":["$","jQuery","revision","form","closest","tag","branch","selects","add","branch_selected","length","val","tag_selected","sendForm","prop","submit","on","select","this","e","keyCode","repoBrowser","el","id","data","content","hasClass","collapseScmEntry","find","attr","each","hide","toggleClass","title","I18n","t","expandScmEntry","show","expandDir","addClass","ajax","url","success","response","after","removeClass"],"mappings":"6EA4BC,IAASA,KAuHRC,SAtHE,WACA,IAAIC,EAAWF,EAAE,8BACbG,EAAOD,EAASE,QAAQ,QACxBC,EAAML,EAAE,wBACRM,EAASN,EAAE,2BACXO,EAAUF,EAAIG,IAAIF,GAClBG,EAAkBH,EAAOI,OAAS,GAAKR,EAASS,OAASL,EAAOK,MAChEC,EAAeP,EAAIK,OAAS,GAAKR,EAASS,OAASN,EAAIM,MAEvDE,EAAW,WACbN,EAAQO,KAAK,WAAW,GACxBX,EAAKY,SACLR,EAAQO,KAAK,WAAW,KAOtBL,GAAmBG,IACrBV,EAASS,IAAI,IAOfJ,EAAQS,GAAG,UAAU,WACnB,IAAIC,EAASjB,EAAEkB,MACfhB,EAASS,IAAIM,EAAON,OACpBE,OAMFX,EAASc,GAAG,WAAW,SAASG,GACb,IAAbA,EAAEC,SACJP,OAMJ,IAAIQ,EAAcrB,EAAE,YACpBqB,EAAYL,GAAG,QAAS,iBAAiB,WACvC,IAAIM,EAAKtB,EAAEkB,MACPK,EAAKvB,EAAEkB,MAAMM,KAAK,WAClBC,EAAUzB,EAAEuB,IAwDlB,SAAmBE,GACf,OAAIA,EAAQC,SAAS,SAtCzB,SAASC,EAAiBF,GACxBJ,EAAYO,KAAK,IAAMH,EAAQI,KAAK,OAAOC,MAAK,WAC9C,IAAIR,EAAKtB,EAAEkB,MACPI,EAAGI,SAAS,SACdC,EAAiBL,GAGnBA,EAAGS,OACHT,EAAGU,YAAY,qBAGjBP,EAAQO,YAAY,kBACpBP,EAAQG,KAAK,kBAAkB,GAAGK,MAAQC,KAAKC,EAAE,mBA2B3CR,CAAiBF,IACV,GACAA,EAAQC,SAAS,WAvBhC,SAASU,EAAeX,GACtBJ,EAAYO,KAAK,IAAMH,EAAQI,KAAK,OAAOC,MAAK,WAC9C,IAAIR,EAAKtB,EAAEkB,MACXI,EAAGe,OACCf,EAAGI,SAAS,YAAcJ,EAAGI,SAAS,cACxCU,EAAed,GAGjBA,EAAGU,YAAY,qBAGjBP,EAAQO,YAAY,kBACpBP,EAAQG,KAAK,kBAAkB,GAAGK,MAAQC,KAAKC,EAAE,qBAY3CC,CAAeX,IACR,IAEPA,EAAQC,SAAS,YA9DfY,CAAUb,KACZA,EAAQc,SAAS,WACjBvC,EAAEwC,KAAK,CACLC,IAAKnB,EAAGE,KAAK,OACbkB,QAAS,SAASC,GAChBlB,EAAQmB,MAAMD,GACdlB,EAAQoB,YAAY,WACpBpB,EAAQc,SAAS,eACjBd,EAAQG,KAAK,kBAAkB,GAAGK,MAAQC,KAAKC,EAAE","file":"21.b089a47e07fd2f223a3e.js","sourcesContent":["//-- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2020 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2017 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See docs/COPYRIGHT.rdoc for more details.\n//++\n\n(function($) {\n  $(function() {\n    var revision = $('#revision-identifier-input'),\n        form = revision.closest('form'),\n        tag = $('#revision-tag-select'),\n        branch = $('#revision-branch-select'),\n        selects = tag.add(branch),\n        branch_selected = branch.length > 0 && revision.val() == branch.val(),\n        tag_selected = tag.length > 0 && revision.val() == tag.val();\n\n    var sendForm = function() {\n      selects.prop('disable', true);\n      form.submit();\n      selects.prop('disable', false);\n    };\n\n    /*\n    If we're viewing a tag or branch, don't display it in the\n    revision box\n    */\n    if (branch_selected || tag_selected) {\n      revision.val('');\n    }\n\n    /*\n    Copy the branch/tag value into the revision box, then disable\n    the dropdowns before submitting the form\n    */\n    selects.on('change', function() {\n      var select = $(this);\n      revision.val(select.val());\n      sendForm();\n    });\n\n    /*\n    Disable the branch/tag dropdowns before submitting the revision form\n    */\n    revision.on('keydown', function(e) {\n      if (e.keyCode == 13) {\n        sendForm();\n      }\n    });\n\n\n    // Dir expanders\n    var repoBrowser = $('#browser');\n    repoBrowser.on('click', '.dir-expander', function() {\n      var el = $(this),\n          id = $(this).data('element'),\n          content = $(id);\n\n          if (expandDir(content)) {\n            content.addClass('loading');\n            $.ajax({\n              url: el.data('url'),\n              success: function(response) {\n                content.after(response);\n                content.removeClass('loading');\n                content.addClass('loaded open');\n                content.find('a.dir-expander')[0].title = I18n.t('js.label_collapse');\n              }\n            });\n          }\n    });\n\n    /**\n     * Collapses a directory listing in the repository module\n     */\n    function collapseScmEntry(content) {\n      repoBrowser.find('.' + content.attr('id')).each(function() {\n        var el = $(this);\n        if (el.hasClass('open')) {\n          collapseScmEntry(el);\n        }\n\n        el.hide();\n        el.toggleClass('open collapsed');\n      });\n\n      content.toggleClass('open collapsed')\n      content.find('a.dir-expander')[0].title = I18n.t('js.label_expand');\n    }\n\n    /**\n     * Expands an SCM entry if its loaded\n     */\n    function expandScmEntry(content) {\n      repoBrowser.find('.' + content.attr('id')).each(function() {\n        var el = $(this);\n        el.show();\n        if (el.hasClass('loaded') && !el.hasClass('collapsed')) {\n          expandScmEntry(el);\n        }\n\n        el.toggleClass('open collapsed')\n      });\n\n      content.toggleClass('open collapsed')\n      content.find('a.dir-expander')[0].title = I18n.t('js.label_collapse');\n    }\n\n    /**\n     * Determines whether a dir-expander should load content\n     * or simply expand already loaded content.\n     */\n    function expandDir(content) {\n        if (content.hasClass('open')) {\n            collapseScmEntry(content);\n            return false;\n        } else if (content.hasClass('loaded')) {\n            expandScmEntry(content);\n            return false;\n        }\n        if (content.hasClass('loading')) {\n            return false;\n        }\n        return true;\n    }\n  });\n}(jQuery));\n\n"],"sourceRoot":"webpack:///"}